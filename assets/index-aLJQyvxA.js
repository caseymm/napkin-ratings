var Jv=Object.defineProperty;var y_=v=>{throw TypeError(v)};var e0=(v,y,b)=>y in v?Jv(v,y,{enumerable:!0,configurable:!0,writable:!0,value:b}):v[y]=b;var Qt=(v,y,b)=>e0(v,typeof y!="symbol"?y+"":y,b),v_=(v,y,b)=>y.has(v)||y_("Cannot "+b);var ze=(v,y,b)=>(v_(v,y,"read from private field"),b?b.call(v):y.get(v)),pi=(v,y,b)=>y.has(v)?y_("Cannot add the same private member more than once"):y instanceof WeakSet?y.add(v):y.set(v,b),hi=(v,y,b,T)=>(v_(v,y,"write to private field"),T?T.call(v,b):y.set(v,b),b);(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const R of document.querySelectorAll('link[rel="modulepreload"]'))T(R);new MutationObserver(R=>{for(const F of R)if(F.type==="childList")for(const z of F.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&T(z)}).observe(document,{childList:!0,subtree:!0});function b(R){const F={};return R.integrity&&(F.integrity=R.integrity),R.referrerPolicy&&(F.referrerPolicy=R.referrerPolicy),R.crossOrigin==="use-credentials"?F.credentials="include":R.crossOrigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function T(R){if(R.ep)return;R.ep=!0;const F=b(R);fetch(R.href,F)}})();function t0(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}var Eg={exports:{}},Np={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b_;function i0(){if(b_)return Np;b_=1;var v=Symbol.for("react.transitional.element"),y=Symbol.for("react.fragment");function b(T,R,F){var z=null;if(F!==void 0&&(z=""+F),R.key!==void 0&&(z=""+R.key),"key"in R){F={};for(var u in R)u!=="key"&&(F[u]=R[u])}else F=R;return R=F.ref,{$$typeof:v,type:T,key:z,ref:R!==void 0?R:null,props:F}}return Np.Fragment=y,Np.jsx=b,Np.jsxs=b,Np}var x_;function r0(){return x_||(x_=1,Eg.exports=i0()),Eg.exports}var Si=r0(),Cg={exports:{}},mi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w_;function n0(){if(w_)return mi;w_=1;var v=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),z=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),Q=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Te=Symbol.iterator;function Ee(ue){return ue===null||typeof ue!="object"?null:(ue=Te&&ue[Te]||ue["@@iterator"],typeof ue=="function"?ue:null)}var ne={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pe=Object.assign,Ze={};function bt(ue,Ke,lt){this.props=ue,this.context=Ke,this.refs=Ze,this.updater=lt||ne}bt.prototype.isReactComponent={},bt.prototype.setState=function(ue,Ke){if(typeof ue!="object"&&typeof ue!="function"&&ue!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ue,Ke,"setState")},bt.prototype.forceUpdate=function(ue){this.updater.enqueueForceUpdate(this,ue,"forceUpdate")};function Vt(){}Vt.prototype=bt.prototype;function Ot(ue,Ke,lt){this.props=ue,this.context=Ke,this.refs=Ze,this.updater=lt||ne}var Tt=Ot.prototype=new Vt;Tt.constructor=Ot,Pe(Tt,bt.prototype),Tt.isPureReactComponent=!0;var qt=Array.isArray,xt={H:null,A:null,T:null,S:null,V:null},Bt=Object.prototype.hasOwnProperty;function Pi(ue,Ke,lt,ut,vt,Ct){return lt=Ct.ref,{$$typeof:v,type:ue,key:Ke,ref:lt!==void 0?lt:null,props:Ct}}function ti(ue,Ke){return Pi(ue.type,Ke,void 0,void 0,void 0,ue.props)}function Oi(ue){return typeof ue=="object"&&ue!==null&&ue.$$typeof===v}function Mi(ue){var Ke={"=":"=0",":":"=2"};return"$"+ue.replace(/[=:]/g,function(lt){return Ke[lt]})}var Ut=/\/+/g;function wi(ue,Ke){return typeof ue=="object"&&ue!==null&&ue.key!=null?Mi(""+ue.key):Ke.toString(36)}function xr(){}function Et(ue){switch(ue.status){case"fulfilled":return ue.value;case"rejected":throw ue.reason;default:switch(typeof ue.status=="string"?ue.then(xr,xr):(ue.status="pending",ue.then(function(Ke){ue.status==="pending"&&(ue.status="fulfilled",ue.value=Ke)},function(Ke){ue.status==="pending"&&(ue.status="rejected",ue.reason=Ke)})),ue.status){case"fulfilled":return ue.value;case"rejected":throw ue.reason}}throw ue}function pt(ue,Ke,lt,ut,vt){var Ct=typeof ue;(Ct==="undefined"||Ct==="boolean")&&(ue=null);var It=!1;if(ue===null)It=!0;else switch(Ct){case"bigint":case"string":case"number":It=!0;break;case"object":switch(ue.$$typeof){case v:case y:It=!0;break;case ve:return It=ue._init,pt(It(ue._payload),Ke,lt,ut,vt)}}if(It)return vt=vt(ue),It=ut===""?"."+wi(ue,0):ut,qt(vt)?(lt="",It!=null&&(lt=It.replace(Ut,"$&/")+"/"),pt(vt,Ke,lt,"",function(er){return er})):vt!=null&&(Oi(vt)&&(vt=ti(vt,lt+(vt.key==null||ue&&ue.key===vt.key?"":(""+vt.key).replace(Ut,"$&/")+"/")+It)),Ke.push(vt)),1;It=0;var di=ut===""?".":ut+":";if(qt(ue))for(var li=0;li<ue.length;li++)ut=ue[li],Ct=di+wi(ut,li),It+=pt(ut,Ke,lt,Ct,vt);else if(li=Ee(ue),typeof li=="function")for(ue=li.call(ue),li=0;!(ut=ue.next()).done;)ut=ut.value,Ct=di+wi(ut,li++),It+=pt(ut,Ke,lt,Ct,vt);else if(Ct==="object"){if(typeof ue.then=="function")return pt(Et(ue),Ke,lt,ut,vt);throw Ke=String(ue),Error("Objects are not valid as a React child (found: "+(Ke==="[object Object]"?"object with keys {"+Object.keys(ue).join(", ")+"}":Ke)+"). If you meant to render a collection of children, use an array instead.")}return It}function we(ue,Ke,lt){if(ue==null)return ue;var ut=[],vt=0;return pt(ue,ut,"","",function(Ct){return Ke.call(lt,Ct,vt++)}),ut}function We(ue){if(ue._status===-1){var Ke=ue._result;Ke=Ke(),Ke.then(function(lt){(ue._status===0||ue._status===-1)&&(ue._status=1,ue._result=lt)},function(lt){(ue._status===0||ue._status===-1)&&(ue._status=2,ue._result=lt)}),ue._status===-1&&(ue._status=0,ue._result=Ke)}if(ue._status===1)return ue._result.default;throw ue._result}var Ge=typeof reportError=="function"?reportError:function(ue){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ke=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ue=="object"&&ue!==null&&typeof ue.message=="string"?String(ue.message):String(ue),error:ue});if(!window.dispatchEvent(Ke))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ue);return}console.error(ue)};function gt(){}return mi.Children={map:we,forEach:function(ue,Ke,lt){we(ue,function(){Ke.apply(this,arguments)},lt)},count:function(ue){var Ke=0;return we(ue,function(){Ke++}),Ke},toArray:function(ue){return we(ue,function(Ke){return Ke})||[]},only:function(ue){if(!Oi(ue))throw Error("React.Children.only expected to receive a single React element child.");return ue}},mi.Component=bt,mi.Fragment=b,mi.Profiler=R,mi.PureComponent=Ot,mi.StrictMode=T,mi.Suspense=oe,mi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=xt,mi.__COMPILER_RUNTIME={__proto__:null,c:function(ue){return xt.H.useMemoCache(ue)}},mi.cache=function(ue){return function(){return ue.apply(null,arguments)}},mi.cloneElement=function(ue,Ke,lt){if(ue==null)throw Error("The argument must be a React element, but you passed "+ue+".");var ut=Pe({},ue.props),vt=ue.key,Ct=void 0;if(Ke!=null)for(It in Ke.ref!==void 0&&(Ct=void 0),Ke.key!==void 0&&(vt=""+Ke.key),Ke)!Bt.call(Ke,It)||It==="key"||It==="__self"||It==="__source"||It==="ref"&&Ke.ref===void 0||(ut[It]=Ke[It]);var It=arguments.length-2;if(It===1)ut.children=lt;else if(1<It){for(var di=Array(It),li=0;li<It;li++)di[li]=arguments[li+2];ut.children=di}return Pi(ue.type,vt,void 0,void 0,Ct,ut)},mi.createContext=function(ue){return ue={$$typeof:z,_currentValue:ue,_currentValue2:ue,_threadCount:0,Provider:null,Consumer:null},ue.Provider=ue,ue.Consumer={$$typeof:F,_context:ue},ue},mi.createElement=function(ue,Ke,lt){var ut,vt={},Ct=null;if(Ke!=null)for(ut in Ke.key!==void 0&&(Ct=""+Ke.key),Ke)Bt.call(Ke,ut)&&ut!=="key"&&ut!=="__self"&&ut!=="__source"&&(vt[ut]=Ke[ut]);var It=arguments.length-2;if(It===1)vt.children=lt;else if(1<It){for(var di=Array(It),li=0;li<It;li++)di[li]=arguments[li+2];vt.children=di}if(ue&&ue.defaultProps)for(ut in It=ue.defaultProps,It)vt[ut]===void 0&&(vt[ut]=It[ut]);return Pi(ue,Ct,void 0,void 0,null,vt)},mi.createRef=function(){return{current:null}},mi.forwardRef=function(ue){return{$$typeof:u,render:ue}},mi.isValidElement=Oi,mi.lazy=function(ue){return{$$typeof:ve,_payload:{_status:-1,_result:ue},_init:We}},mi.memo=function(ue,Ke){return{$$typeof:Q,type:ue,compare:Ke===void 0?null:Ke}},mi.startTransition=function(ue){var Ke=xt.T,lt={};xt.T=lt;try{var ut=ue(),vt=xt.S;vt!==null&&vt(lt,ut),typeof ut=="object"&&ut!==null&&typeof ut.then=="function"&&ut.then(gt,Ge)}catch(Ct){Ge(Ct)}finally{xt.T=Ke}},mi.unstable_useCacheRefresh=function(){return xt.H.useCacheRefresh()},mi.use=function(ue){return xt.H.use(ue)},mi.useActionState=function(ue,Ke,lt){return xt.H.useActionState(ue,Ke,lt)},mi.useCallback=function(ue,Ke){return xt.H.useCallback(ue,Ke)},mi.useContext=function(ue){return xt.H.useContext(ue)},mi.useDebugValue=function(){},mi.useDeferredValue=function(ue,Ke){return xt.H.useDeferredValue(ue,Ke)},mi.useEffect=function(ue,Ke,lt){var ut=xt.H;if(typeof lt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ut.useEffect(ue,Ke)},mi.useId=function(){return xt.H.useId()},mi.useImperativeHandle=function(ue,Ke,lt){return xt.H.useImperativeHandle(ue,Ke,lt)},mi.useInsertionEffect=function(ue,Ke){return xt.H.useInsertionEffect(ue,Ke)},mi.useLayoutEffect=function(ue,Ke){return xt.H.useLayoutEffect(ue,Ke)},mi.useMemo=function(ue,Ke){return xt.H.useMemo(ue,Ke)},mi.useOptimistic=function(ue,Ke){return xt.H.useOptimistic(ue,Ke)},mi.useReducer=function(ue,Ke,lt){return xt.H.useReducer(ue,Ke,lt)},mi.useRef=function(ue){return xt.H.useRef(ue)},mi.useState=function(ue){return xt.H.useState(ue)},mi.useSyncExternalStore=function(ue,Ke,lt){return xt.H.useSyncExternalStore(ue,Ke,lt)},mi.useTransition=function(){return xt.H.useTransition()},mi.version="19.1.0",mi}var T_;function Xg(){return T_||(T_=1,Cg.exports=n0()),Cg.exports}var Ug=Xg(),Ag={exports:{}},Vp={},zg={exports:{}},Pg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_;function a0(){return S_||(S_=1,function(v){function y(we,We){var Ge=we.length;we.push(We);e:for(;0<Ge;){var gt=Ge-1>>>1,ue=we[gt];if(0<R(ue,We))we[gt]=We,we[Ge]=ue,Ge=gt;else break e}}function b(we){return we.length===0?null:we[0]}function T(we){if(we.length===0)return null;var We=we[0],Ge=we.pop();if(Ge!==We){we[0]=Ge;e:for(var gt=0,ue=we.length,Ke=ue>>>1;gt<Ke;){var lt=2*(gt+1)-1,ut=we[lt],vt=lt+1,Ct=we[vt];if(0>R(ut,Ge))vt<ue&&0>R(Ct,ut)?(we[gt]=Ct,we[vt]=Ge,gt=vt):(we[gt]=ut,we[lt]=Ge,gt=lt);else if(vt<ue&&0>R(Ct,Ge))we[gt]=Ct,we[vt]=Ge,gt=vt;else break e}}return We}function R(we,We){var Ge=we.sortIndex-We.sortIndex;return Ge!==0?Ge:we.id-We.id}if(v.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var F=performance;v.unstable_now=function(){return F.now()}}else{var z=Date,u=z.now();v.unstable_now=function(){return z.now()-u}}var oe=[],Q=[],ve=1,Te=null,Ee=3,ne=!1,Pe=!1,Ze=!1,bt=!1,Vt=typeof setTimeout=="function"?setTimeout:null,Ot=typeof clearTimeout=="function"?clearTimeout:null,Tt=typeof setImmediate<"u"?setImmediate:null;function qt(we){for(var We=b(Q);We!==null;){if(We.callback===null)T(Q);else if(We.startTime<=we)T(Q),We.sortIndex=We.expirationTime,y(oe,We);else break;We=b(Q)}}function xt(we){if(Ze=!1,qt(we),!Pe)if(b(oe)!==null)Pe=!0,Bt||(Bt=!0,wi());else{var We=b(Q);We!==null&&pt(xt,We.startTime-we)}}var Bt=!1,Pi=-1,ti=5,Oi=-1;function Mi(){return bt?!0:!(v.unstable_now()-Oi<ti)}function Ut(){if(bt=!1,Bt){var we=v.unstable_now();Oi=we;var We=!0;try{e:{Pe=!1,Ze&&(Ze=!1,Ot(Pi),Pi=-1),ne=!0;var Ge=Ee;try{t:{for(qt(we),Te=b(oe);Te!==null&&!(Te.expirationTime>we&&Mi());){var gt=Te.callback;if(typeof gt=="function"){Te.callback=null,Ee=Te.priorityLevel;var ue=gt(Te.expirationTime<=we);if(we=v.unstable_now(),typeof ue=="function"){Te.callback=ue,qt(we),We=!0;break t}Te===b(oe)&&T(oe),qt(we)}else T(oe);Te=b(oe)}if(Te!==null)We=!0;else{var Ke=b(Q);Ke!==null&&pt(xt,Ke.startTime-we),We=!1}}break e}finally{Te=null,Ee=Ge,ne=!1}We=void 0}}finally{We?wi():Bt=!1}}}var wi;if(typeof Tt=="function")wi=function(){Tt(Ut)};else if(typeof MessageChannel<"u"){var xr=new MessageChannel,Et=xr.port2;xr.port1.onmessage=Ut,wi=function(){Et.postMessage(null)}}else wi=function(){Vt(Ut,0)};function pt(we,We){Pi=Vt(function(){we(v.unstable_now())},We)}v.unstable_IdlePriority=5,v.unstable_ImmediatePriority=1,v.unstable_LowPriority=4,v.unstable_NormalPriority=3,v.unstable_Profiling=null,v.unstable_UserBlockingPriority=2,v.unstable_cancelCallback=function(we){we.callback=null},v.unstable_forceFrameRate=function(we){0>we||125<we?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ti=0<we?Math.floor(1e3/we):5},v.unstable_getCurrentPriorityLevel=function(){return Ee},v.unstable_next=function(we){switch(Ee){case 1:case 2:case 3:var We=3;break;default:We=Ee}var Ge=Ee;Ee=We;try{return we()}finally{Ee=Ge}},v.unstable_requestPaint=function(){bt=!0},v.unstable_runWithPriority=function(we,We){switch(we){case 1:case 2:case 3:case 4:case 5:break;default:we=3}var Ge=Ee;Ee=we;try{return We()}finally{Ee=Ge}},v.unstable_scheduleCallback=function(we,We,Ge){var gt=v.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?gt+Ge:gt):Ge=gt,we){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=Ge+ue,we={id:ve++,callback:We,priorityLevel:we,startTime:Ge,expirationTime:ue,sortIndex:-1},Ge>gt?(we.sortIndex=Ge,y(Q,we),b(oe)===null&&we===b(Q)&&(Ze?(Ot(Pi),Pi=-1):Ze=!0,pt(xt,Ge-gt))):(we.sortIndex=ue,y(oe,we),Pe||ne||(Pe=!0,Bt||(Bt=!0,wi()))),we},v.unstable_shouldYield=Mi,v.unstable_wrapCallback=function(we){var We=Ee;return function(){var Ge=Ee;Ee=We;try{return we.apply(this,arguments)}finally{Ee=Ge}}}}(Pg)),Pg}var M_;function s0(){return M_||(M_=1,zg.exports=a0()),zg.exports}var Ig={exports:{}},Ea={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E_;function o0(){if(E_)return Ea;E_=1;var v=Xg();function y(oe){var Q="https://react.dev/errors/"+oe;if(1<arguments.length){Q+="?args[]="+encodeURIComponent(arguments[1]);for(var ve=2;ve<arguments.length;ve++)Q+="&args[]="+encodeURIComponent(arguments[ve])}return"Minified React error #"+oe+"; visit "+Q+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function b(){}var T={d:{f:b,r:function(){throw Error(y(522))},D:b,C:b,L:b,m:b,X:b,S:b,M:b},p:0,findDOMNode:null},R=Symbol.for("react.portal");function F(oe,Q,ve){var Te=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:Te==null?null:""+Te,children:oe,containerInfo:Q,implementation:ve}}var z=v.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(oe,Q){if(oe==="font")return"";if(typeof Q=="string")return Q==="use-credentials"?Q:""}return Ea.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Ea.createPortal=function(oe,Q){var ve=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q||Q.nodeType!==1&&Q.nodeType!==9&&Q.nodeType!==11)throw Error(y(299));return F(oe,Q,null,ve)},Ea.flushSync=function(oe){var Q=z.T,ve=T.p;try{if(z.T=null,T.p=2,oe)return oe()}finally{z.T=Q,T.p=ve,T.d.f()}},Ea.preconnect=function(oe,Q){typeof oe=="string"&&(Q?(Q=Q.crossOrigin,Q=typeof Q=="string"?Q==="use-credentials"?Q:"":void 0):Q=null,T.d.C(oe,Q))},Ea.prefetchDNS=function(oe){typeof oe=="string"&&T.d.D(oe)},Ea.preinit=function(oe,Q){if(typeof oe=="string"&&Q&&typeof Q.as=="string"){var ve=Q.as,Te=u(ve,Q.crossOrigin),Ee=typeof Q.integrity=="string"?Q.integrity:void 0,ne=typeof Q.fetchPriority=="string"?Q.fetchPriority:void 0;ve==="style"?T.d.S(oe,typeof Q.precedence=="string"?Q.precedence:void 0,{crossOrigin:Te,integrity:Ee,fetchPriority:ne}):ve==="script"&&T.d.X(oe,{crossOrigin:Te,integrity:Ee,fetchPriority:ne,nonce:typeof Q.nonce=="string"?Q.nonce:void 0})}},Ea.preinitModule=function(oe,Q){if(typeof oe=="string")if(typeof Q=="object"&&Q!==null){if(Q.as==null||Q.as==="script"){var ve=u(Q.as,Q.crossOrigin);T.d.M(oe,{crossOrigin:ve,integrity:typeof Q.integrity=="string"?Q.integrity:void 0,nonce:typeof Q.nonce=="string"?Q.nonce:void 0})}}else Q==null&&T.d.M(oe)},Ea.preload=function(oe,Q){if(typeof oe=="string"&&typeof Q=="object"&&Q!==null&&typeof Q.as=="string"){var ve=Q.as,Te=u(ve,Q.crossOrigin);T.d.L(oe,ve,{crossOrigin:Te,integrity:typeof Q.integrity=="string"?Q.integrity:void 0,nonce:typeof Q.nonce=="string"?Q.nonce:void 0,type:typeof Q.type=="string"?Q.type:void 0,fetchPriority:typeof Q.fetchPriority=="string"?Q.fetchPriority:void 0,referrerPolicy:typeof Q.referrerPolicy=="string"?Q.referrerPolicy:void 0,imageSrcSet:typeof Q.imageSrcSet=="string"?Q.imageSrcSet:void 0,imageSizes:typeof Q.imageSizes=="string"?Q.imageSizes:void 0,media:typeof Q.media=="string"?Q.media:void 0})}},Ea.preloadModule=function(oe,Q){if(typeof oe=="string")if(Q){var ve=u(Q.as,Q.crossOrigin);T.d.m(oe,{as:typeof Q.as=="string"&&Q.as!=="script"?Q.as:void 0,crossOrigin:ve,integrity:typeof Q.integrity=="string"?Q.integrity:void 0})}else T.d.m(oe)},Ea.requestFormReset=function(oe){T.d.r(oe)},Ea.unstable_batchedUpdates=function(oe,Q){return oe(Q)},Ea.useFormState=function(oe,Q,ve){return z.H.useFormState(oe,Q,ve)},Ea.useFormStatus=function(){return z.H.useHostTransitionStatus()},Ea.version="19.1.0",Ea}var C_;function l0(){if(C_)return Ig.exports;C_=1;function v(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v)}catch(y){console.error(y)}}return v(),Ig.exports=o0(),Ig.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A_;function c0(){if(A_)return Vp;A_=1;var v=s0(),y=Xg(),b=l0();function T(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function R(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function F(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function z(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(F(i)!==i)throw Error(T(188))}function oe(i){var s=i.alternate;if(!s){if(s=F(i),s===null)throw Error(T(188));return s!==i?null:i}for(var c=i,p=s;;){var S=c.return;if(S===null)break;var A=S.alternate;if(A===null){if(p=S.return,p!==null){c=p;continue}break}if(S.child===A.child){for(A=S.child;A;){if(A===c)return u(S),i;if(A===p)return u(S),s;A=A.sibling}throw Error(T(188))}if(c.return!==p.return)c=S,p=A;else{for(var Z=!1,K=S.child;K;){if(K===c){Z=!0,c=S,p=A;break}if(K===p){Z=!0,p=S,c=A;break}K=K.sibling}if(!Z){for(K=A.child;K;){if(K===c){Z=!0,c=A,p=S;break}if(K===p){Z=!0,p=A,c=S;break}K=K.sibling}if(!Z)throw Error(T(189))}}if(c.alternate!==p)throw Error(T(190))}if(c.tag!==3)throw Error(T(188));return c.stateNode.current===c?i:s}function Q(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=Q(i),s!==null)return s;i=i.sibling}return null}var ve=Object.assign,Te=Symbol.for("react.element"),Ee=Symbol.for("react.transitional.element"),ne=Symbol.for("react.portal"),Pe=Symbol.for("react.fragment"),Ze=Symbol.for("react.strict_mode"),bt=Symbol.for("react.profiler"),Vt=Symbol.for("react.provider"),Ot=Symbol.for("react.consumer"),Tt=Symbol.for("react.context"),qt=Symbol.for("react.forward_ref"),xt=Symbol.for("react.suspense"),Bt=Symbol.for("react.suspense_list"),Pi=Symbol.for("react.memo"),ti=Symbol.for("react.lazy"),Oi=Symbol.for("react.activity"),Mi=Symbol.for("react.memo_cache_sentinel"),Ut=Symbol.iterator;function wi(i){return i===null||typeof i!="object"?null:(i=Ut&&i[Ut]||i["@@iterator"],typeof i=="function"?i:null)}var xr=Symbol.for("react.client.reference");function Et(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===xr?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Pe:return"Fragment";case bt:return"Profiler";case Ze:return"StrictMode";case xt:return"Suspense";case Bt:return"SuspenseList";case Oi:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case ne:return"Portal";case Tt:return(i.displayName||"Context")+".Provider";case Ot:return(i._context.displayName||"Context")+".Consumer";case qt:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Pi:return s=i.displayName||null,s!==null?s:Et(i.type)||"Memo";case ti:s=i._payload,i=i._init;try{return Et(i(s))}catch{}}return null}var pt=Array.isArray,we=y.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We=b.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ge={pending:!1,data:null,method:null,action:null},gt=[],ue=-1;function Ke(i){return{current:i}}function lt(i){0>ue||(i.current=gt[ue],gt[ue]=null,ue--)}function ut(i,s){ue++,gt[ue]=i.current,i.current=s}var vt=Ke(null),Ct=Ke(null),It=Ke(null),di=Ke(null);function li(i,s){switch(ut(It,s),ut(Ct,i),ut(vt,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Lp(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Lp(s),i=Op(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}lt(vt),ut(vt,i)}function er(){lt(vt),lt(Ct),lt(It)}function lr(i){i.memoizedState!==null&&ut(di,i);var s=vt.current,c=Op(s,i.type);s!==c&&(ut(Ct,i),ut(vt,c))}function Bi(i){Ct.current===i&&(lt(vt),lt(Ct)),di.current===i&&(lt(di),le._currentValue=Ge)}var cr=Object.prototype.hasOwnProperty,tr=v.unstable_scheduleCallback,Ri=v.unstable_cancelCallback,qa=v.unstable_shouldYield,Ks=v.unstable_requestPaint,Rr=v.unstable_now,wc=v.unstable_getCurrentPriorityLevel,Ml=v.unstable_ImmediatePriority,Fn=v.unstable_UserBlockingPriority,Qn=v.unstable_NormalPriority,Io=v.unstable_LowPriority,Ws=v.unstable_IdlePriority,bs=v.log,El=v.unstable_setDisableYieldValue,$a=null,Wr=null;function mn(i){if(typeof bs=="function"&&El(i),Wr&&typeof Wr.setStrictMode=="function")try{Wr.setStrictMode($a,i)}catch{}}var kr=Math.clz32?Math.clz32:pa,Js=Math.log,Cl=Math.LN2;function pa(i){return i>>>=0,i===0?32:31-(Js(i)/Cl|0)|0}var cn=256,Kn=4194304;function Ce(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function X(i,s,c){var p=i.pendingLanes;if(p===0)return 0;var S=0,A=i.suspendedLanes,Z=i.pingedLanes;i=i.warmLanes;var K=p&134217727;return K!==0?(p=K&~A,p!==0?S=Ce(p):(Z&=K,Z!==0?S=Ce(Z):c||(c=K&~i,c!==0&&(S=Ce(c))))):(K=p&~A,K!==0?S=Ce(K):Z!==0?S=Ce(Z):c||(c=p&~i,c!==0&&(S=Ce(c)))),S===0?0:s!==0&&s!==S&&(s&A)===0&&(A=S&-S,c=s&-s,A>=c||A===32&&(c&4194048)!==0)?s:S}function Y(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function te(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function he(){var i=cn;return cn<<=1,(cn&4194048)===0&&(cn=256),i}function be(){var i=Kn;return Kn<<=1,(Kn&62914560)===0&&(Kn=4194304),i}function ee(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function Re(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Se(i,s,c,p,S,A){var Z=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var K=i.entanglements,me=i.expirationTimes,Be=i.hiddenUpdates;for(c=Z&~c;0<c;){var tt=31-kr(c),nt=1<<tt;K[tt]=0,me[tt]=-1;var Ve=Be[tt];if(Ve!==null)for(Be[tt]=null,tt=0;tt<Ve.length;tt++){var He=Ve[tt];He!==null&&(He.lane&=-536870913)}c&=~nt}p!==0&&De(i,p,0),A!==0&&S===0&&i.tag!==0&&(i.suspendedLanes|=A&~(Z&~s))}function De(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var p=31-kr(s);i.entangledLanes|=s,i.entanglements[p]=i.entanglements[p]|1073741824|c&4194090}function je(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var p=31-kr(c),S=1<<p;S&s|i[p]&s&&(i[p]|=s),c&=~S}}function Ae(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function et(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ft(){var i=We.p;return i!==0?i:(i=window.event,i===void 0?32:Mt(i.type))}function _t(i,s){var c=We.p;try{return We.p=i,s()}finally{We.p=c}}var At=Math.random().toString(36).slice(2),kt="__reactFiber$"+At,zt="__reactProps$"+At,qe="__reactContainer$"+At,yi="__reactEvents$"+At,ci="__reactListeners$"+At,vi="__reactHandles$"+At,Zt="__reactResources$"+At,Je="__reactMarker$"+At;function Ft(i){delete i[kt],delete i[zt],delete i[yi],delete i[ci],delete i[vi]}function Gt(i){var s=i[kt];if(s)return s;for(var c=i.parentNode;c;){if(s=c[qe]||c[kt]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=bl(i);i!==null;){if(c=i[kt])return c;i=bl(i)}return s}i=c,c=i.parentNode}return null}function ji(i){if(i=i[kt]||i[qe]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function qi(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(T(33))}function $r(i){var s=i[Zt];return s||(s=i[Zt]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Lt(i){i[Je]=!0}var Do=new Set,Al={};function Wn(i,s){Ga(i,s),Ga(i+"Capture",s)}function Ga(i,s){for(Al[i]=s,i=0;i<s.length;i++)Do.add(s[i])}var xs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),eo={},wr={};function Jn(i){return cr.call(wr,i)?!0:cr.call(eo,i)?!1:xs.test(i)?wr[i]=!0:(eo[i]=!0,!1)}function Fi(i,s,c){if(Jn(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var p=s.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function to(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Un(i,s,c,p){if(p===null)i.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+p)}}var Tc,io;function Nn(i){if(Tc===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);Tc=s&&s[1]||"",io=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tc+i+io}var _u=!1;function Sc(i,s){if(!i||_u)return"";_u=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(s){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(He){var Ve=He}Reflect.construct(i,[],nt)}else{try{nt.call()}catch(He){Ve=He}i.call(nt.prototype)}}else{try{throw Error()}catch(He){Ve=He}(nt=i())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(He){if(He&&Ve&&typeof He.stack=="string")return[He.stack,Ve.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=p.DetermineComponentFrameRoot(),Z=A[0],K=A[1];if(Z&&K){var me=Z.split(`
`),Be=K.split(`
`);for(S=p=0;p<me.length&&!me[p].includes("DetermineComponentFrameRoot");)p++;for(;S<Be.length&&!Be[S].includes("DetermineComponentFrameRoot");)S++;if(p===me.length||S===Be.length)for(p=me.length-1,S=Be.length-1;1<=p&&0<=S&&me[p]!==Be[S];)S--;for(;1<=p&&0<=S;p--,S--)if(me[p]!==Be[S]){if(p!==1||S!==1)do if(p--,S--,0>S||me[p]!==Be[S]){var tt=`
`+me[p].replace(" at new "," at ");return i.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",i.displayName)),tt}while(1<=p&&0<=S);break}}}finally{_u=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Nn(c):""}function Sd(i){switch(i.tag){case 26:case 27:case 5:return Nn(i.type);case 16:return Nn("Lazy");case 13:return Nn("Suspense");case 19:return Nn("SuspenseList");case 0:case 15:return Sc(i.type,!1);case 11:return Sc(i.type.render,!1);case 1:return Sc(i.type,!0);case 31:return Nn("Activity");default:return""}}function Ro(i){try{var s="";do s+=Sd(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function ea(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Md(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Gf(i){var s=Md(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),p=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var S=c.get,A=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return S.call(this)},set:function(Z){p=""+Z,A.call(this,Z)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(Z){p=""+Z},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function yu(i){i._valueTracker||(i._valueTracker=Gf(i))}function Ch(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),p="";return i&&(p=Md(i)?i.checked?"true":"false":i.value),i=p,i!==c?(s.setValue(i),!0):!1}function zl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ko=/[\n"\\]/g;function Vn(i){return i.replace(ko,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function vu(i,s,c,p,S,A,Z,K){i.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?i.type=Z:i.removeAttribute("type"),s!=null?Z==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+ea(s)):i.value!==""+ea(s)&&(i.value=""+ea(s)):Z!=="submit"&&Z!=="reset"||i.removeAttribute("value"),s!=null?Mc(i,Z,ea(s)):c!=null?Mc(i,Z,ea(c)):p!=null&&i.removeAttribute("value"),S==null&&A!=null&&(i.defaultChecked=!!A),S!=null&&(i.checked=S&&typeof S!="function"&&typeof S!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?i.name=""+ea(K):i.removeAttribute("name")}function ro(i,s,c,p,S,A,Z,K){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.type=A),s!=null||c!=null){if(!(A!=="submit"&&A!=="reset"||s!=null))return;c=c!=null?""+ea(c):"",s=s!=null?""+ea(s):c,K||s===i.value||(i.value=s),i.defaultValue=s}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=K?i.checked:!!p,i.defaultChecked=!!p,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(i.name=Z)}function Mc(i,s,c){s==="number"&&zl(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Pl(i,s,c,p){if(i=i.options,s){s={};for(var S=0;S<c.length;S++)s["$"+c[S]]=!0;for(c=0;c<i.length;c++)S=s.hasOwnProperty("$"+i[c].value),i[c].selected!==S&&(i[c].selected=S),S&&p&&(i[c].defaultSelected=!0)}else{for(c=""+ea(c),s=null,S=0;S<i.length;S++){if(i[S].value===c){i[S].selected=!0,p&&(i[S].defaultSelected=!0);return}s!==null||i[S].disabled||(s=i[S])}s!==null&&(s.selected=!0)}}function Il(i,s,c){if(s!=null&&(s=""+ea(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+ea(c):""}function Dl(i,s,c,p){if(s==null){if(p!=null){if(c!=null)throw Error(T(92));if(pt(p)){if(1<p.length)throw Error(T(93));p=p[0]}c=p}c==null&&(c=""),s=c}c=ea(s),i.defaultValue=c,p=i.textContent,p===c&&p!==""&&p!==null&&(i.value=p)}function no(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var zn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fi(i,s,c){var p=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?p?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":p?i.setProperty(s,c):typeof c!="number"||c===0||zn.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function Lo(i,s,c){if(s!=null&&typeof s!="object")throw Error(T(62));if(i=i.style,c!=null){for(var p in c)!c.hasOwnProperty(p)||s!=null&&s.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var S in s)p=s[S],s.hasOwnProperty(S)&&c[S]!==p&&fi(i,S,p)}else for(var A in s)s.hasOwnProperty(A)&&fi(i,A,s[A])}function un(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Oo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ui=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ao(i){return ui.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Bo=null;function so(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Gr=null,Tr=null;function Sr(i){var s=ji(i);if(s&&(i=s.stateNode)){var c=i[zt]||null;e:switch(i=s.stateNode,s.type){case"input":if(vu(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Vn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var p=c[s];if(p!==i&&p.form===i.form){var S=p[zt]||null;if(!S)throw Error(T(90));vu(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(s=0;s<c.length;s++)p=c[s],p.form===i.form&&Ch(p)}break e;case"textarea":Il(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Pl(i,!!c.multiple,s,!1)}}}var Hr=!1;function $i(i,s,c){if(Hr)return i(s,c);Hr=!0;try{var p=i(s);return p}finally{if(Hr=!1,(Gr!==null||Tr!==null)&&(En(),Gr&&(s=Gr,i=Tr,Tr=Gr=null,Sr(s),i)))for(s=0;s<i.length;s++)Sr(i[s])}}function Ha(i,s){var c=i.stateNode;if(c===null)return null;var p=c[zt]||null;if(p===null)return null;c=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(T(231,s,typeof c));return c}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pn=!1;if(mr)try{var Jr={};Object.defineProperty(Jr,"passive",{get:function(){Pn=!0}}),window.addEventListener("test",Jr,Jr),window.removeEventListener("test",Jr,Jr)}catch{Pn=!1}var ma=null,Ai=null,Qi=null;function ai(){if(Qi)return Qi;var i,s=Ai,c=s.length,p,S="value"in ma?ma.value:ma.textContent,A=S.length;for(i=0;i<c&&s[i]===S[i];i++);var Z=c-i;for(p=1;p<=Z&&s[c-p]===S[A-p];p++);return Qi=S.slice(i,1<p?1-p:void 0)}function Ht(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function ws(){return!0}function Jt(){return!1}function hn(i){function s(c,p,S,A,Z){this._reactName=c,this._targetInst=S,this.type=p,this.nativeEvent=A,this.target=Z,this.currentTarget=null;for(var K in i)i.hasOwnProperty(K)&&(c=i[K],this[K]=c?c(A):A[K]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?ws:Jt,this.isPropagationStopped=Jt,this}return ve(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ws)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ws)},persist:function(){},isPersistent:ws}),s}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rl=hn(Mr),jo=ve({},Mr,{view:0,detail:0}),Ec=hn(jo),oo,Fo,Uo,No=ve({},jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Go,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Uo&&(Uo&&i.type==="mousemove"?(oo=i.screenX-Uo.screenX,Fo=i.screenY-Uo.screenY):Fo=oo=0,Uo=i),oo)},movementY:function(i){return"movementY"in i?i.movementY:Fo}}),kl=hn(No),Vo=ve({},No,{dataTransfer:0}),en=hn(Vo),Zo=ve({},jo,{relatedTarget:0}),qo=hn(Zo),lo=ve({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),tn=hn(lo),bu=ve({},Mr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),xu=hn(bu),Ed=ve({},Mr,{data:0}),Cd=hn(Ed),gn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $o(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Xa[i])?!!s[i]:!1}function Go(){return $o}var ga=ve({},jo,{key:function(i){if(i.key){var s=gn[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Ht(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Cc[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Go,charCode:function(i){return i.type==="keypress"?Ht(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ht(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ho=hn(ga),wu=ve({},No,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ad=hn(wu),Ah=ve({},jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Go}),Hf=hn(Ah),Xf=ve({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yf=hn(Xf),Tu=ve({},No,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ll=hn(Tu),Su=ve({},Mr,{newState:0,oldState:0}),Mu=hn(Su),Eu=[9,13,27,32],_a=mr&&"CompositionEvent"in window,Ol=null;mr&&"documentMode"in document&&(Ol=document.documentMode);var zh=mr&&"TextEvent"in window&&!Ol,Bl=mr&&(!_a||Ol&&8<Ol&&11>=Ol),jl=" ",zd=!1;function Ac(i,s){switch(i){case"keyup":return Eu.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ph(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ya=!1;function Pd(i,s){switch(i){case"compositionend":return Ph(s);case"keypress":return s.which!==32?null:(zd=!0,jl);case"textInput":return i=s.data,i===jl&&zd?null:i;default:return null}}function Id(i,s){if(ya)return i==="compositionend"||!_a&&Ac(i,s)?(i=ai(),Qi=Ai=ma=null,ya=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Bl&&s.locale!=="ko"?null:s.data;default:return null}}var Qf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ih(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Qf[i.type]:s==="textarea"}function Fl(i,s,c,p){Gr?Tr?Tr.push(p):Tr=[p]:Gr=p,s=fc(s,"onChange"),0<s.length&&(c=new Rl("onChange","change",null,c,p),i.push({event:c,listeners:s}))}var Ul=null,Nl=null;function Dd(i){yl(i,0)}function Vl(i){var s=qi(i);if(Ch(s))return i}function Ts(i,s){if(i==="change")return s}var Dh=!1;if(mr){var Cu;if(mr){var co="oninput"in document;if(!co){var Rh=document.createElement("div");Rh.setAttribute("oninput","return;"),co=typeof Rh.oninput=="function"}Cu=co}else Cu=!1;Dh=Cu&&(!document.documentMode||9<document.documentMode)}function zc(){Ul&&(Ul.detachEvent("onpropertychange",Rd),Nl=Ul=null)}function Rd(i){if(i.propertyName==="value"&&Vl(Nl)){var s=[];Fl(s,Nl,i,so(i)),$i(Dd,s)}}function Kf(i,s,c){i==="focusin"?(zc(),Ul=s,Nl=c,Ul.attachEvent("onpropertychange",Rd)):i==="focusout"&&zc()}function kh(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Vl(Nl)}function kd(i,s){if(i==="click")return Vl(s)}function Ld(i,s){if(i==="input"||i==="change")return Vl(s)}function Lh(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Zn=typeof Object.is=="function"?Object.is:Lh;function si(i,s){if(Zn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),p=Object.keys(s);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var S=c[p];if(!cr.call(s,S)||!Zn(i[S],s[S]))return!1}return!0}function Ya(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Au(i,s){var c=Ya(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=s&&p>=s)return{node:c,offset:s-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Ya(c)}}function zu(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?zu(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Pu(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=zl(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=zl(i.document)}return s}function Iu(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var Oh=mr&&"documentMode"in document&&11>=document.documentMode,va=null,Pc=null,Ic=null,Bh=!1;function Od(i,s,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Bh||va==null||va!==zl(p)||(p=va,"selectionStart"in p&&Iu(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ic&&si(Ic,p)||(Ic=p,p=fc(Pc,"onSelect"),0<p.length&&(s=new Rl("onSelect","select",null,s,c),i.push({event:s,listeners:p}),s.target=va)))}function Xo(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var Yo={animationend:Xo("Animation","AnimationEnd"),animationiteration:Xo("Animation","AnimationIteration"),animationstart:Xo("Animation","AnimationStart"),transitionrun:Xo("Transition","TransitionRun"),transitionstart:Xo("Transition","TransitionStart"),transitioncancel:Xo("Transition","TransitionCancel"),transitionend:Xo("Transition","TransitionEnd")},jh={},Fh={};mr&&(Fh=document.createElement("div").style,"AnimationEvent"in window||(delete Yo.animationend.animation,delete Yo.animationiteration.animation,delete Yo.animationstart.animation),"TransitionEvent"in window||delete Yo.transitionend.transition);function Qa(i){if(jh[i])return jh[i];if(!Yo[i])return i;var s=Yo[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in Fh)return jh[i]=s[c];return i}var Dc=Qa("animationend"),Rc=Qa("animationiteration"),Du=Qa("animationstart"),Qo=Qa("transitionrun"),Ru=Qa("transitionstart"),Zl=Qa("transitioncancel"),ta=Qa("transitionend"),Uh=new Map,ku="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ku.push("scrollEnd");function ia(i,s){Uh.set(i,s),Wn(s,[i])}var uo=new WeakMap;function In(i,s){if(typeof i=="object"&&i!==null){var c=uo.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Ro(s)},uo.set(i,s),s)}return{value:i,source:s,stack:Ro(s)}}var Dn=[],Ka=0,ql=0;function Ko(){for(var i=Ka,s=ql=Ka=0;s<i;){var c=Dn[s];Dn[s++]=null;var p=Dn[s];Dn[s++]=null;var S=Dn[s];Dn[s++]=null;var A=Dn[s];if(Dn[s++]=null,p!==null&&S!==null){var Z=p.pending;Z===null?S.next=S:(S.next=Z.next,Z.next=S),p.pending=S}A!==0&&kc(c,S,A)}}function Ss(i,s,c,p){Dn[Ka++]=i,Dn[Ka++]=s,Dn[Ka++]=c,Dn[Ka++]=p,ql|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function ho(i,s,c,p){return Ss(i,s,c,p),ri(i)}function Wo(i,s){return Ss(i,null,null,s),ri(i)}function kc(i,s,c){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c);for(var S=!1,A=i.return;A!==null;)A.childLanes|=c,p=A.alternate,p!==null&&(p.childLanes|=c),A.tag===22&&(i=A.stateNode,i===null||i._visibility&1||(S=!0)),i=A,A=A.return;return i.tag===3?(A=i.stateNode,S&&s!==null&&(S=31-kr(c),i=A.hiddenUpdates,p=i[S],p===null?i[S]=[s]:p.push(s),s.lane=c|536870912),A):null}function ri(i){if(50<rd)throw rd=0,lf=null,Error(T(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Ms={};function Lu(i,s,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(i,s,c,p){return new Lu(i,s,c,p)}function Jo(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Es(i,s){var c=i.alternate;return c===null?(c=Rn(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Bd(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Lc(i,s,c,p,S,A){var Z=0;if(p=i,typeof i=="function")Jo(i)&&(Z=1);else if(typeof i=="string")Z=P(i,c,vt.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case Oi:return i=Rn(31,c,s,S),i.elementType=Oi,i.lanes=A,i;case Pe:return el(c.children,S,A,s);case Ze:Z=8,S|=24;break;case bt:return i=Rn(12,c,s,S|2),i.elementType=bt,i.lanes=A,i;case xt:return i=Rn(13,c,s,S),i.elementType=xt,i.lanes=A,i;case Bt:return i=Rn(19,c,s,S),i.elementType=Bt,i.lanes=A,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Vt:case Tt:Z=10;break e;case Ot:Z=9;break e;case qt:Z=11;break e;case Pi:Z=14;break e;case ti:Z=16,p=null;break e}Z=29,c=Error(T(130,i===null?"null":typeof i,"")),p=null}return s=Rn(Z,c,s,S),s.elementType=i,s.type=p,s.lanes=A,s}function el(i,s,c,p){return i=Rn(7,i,p,s),i.lanes=c,i}function $l(i,s,c){return i=Rn(6,i,null,s),i.lanes=c,i}function tl(i,s,c){return s=Rn(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Cs=[],fo=0,il=null,Gl=0,_n=[],yn=0,za=null,Pa=1,ra="";function Wa(i,s){Cs[fo++]=Gl,Cs[fo++]=il,il=i,Gl=s}function Nh(i,s,c){_n[yn++]=Pa,_n[yn++]=ra,_n[yn++]=za,za=i;var p=Pa;i=ra;var S=32-kr(p)-1;p&=~(1<<S),c+=1;var A=32-kr(s)+S;if(30<A){var Z=S-S%5;A=(p&(1<<Z)-1).toString(32),p>>=Z,S-=Z,Pa=1<<32-kr(s)+S|c<<S|p,ra=A+i}else Pa=1<<A|c<<S|p,ra=i}function Hl(i){i.return!==null&&(Wa(i,1),Nh(i,1,0))}function Oc(i){for(;i===il;)il=Cs[--fo],Cs[fo]=null,Gl=Cs[--fo],Cs[fo]=null;for(;i===za;)za=_n[--yn],_n[yn]=null,ra=_n[--yn],_n[yn]=null,Pa=_n[--yn],_n[yn]=null}var vn=null,gr=null,bi=!1,Ja=null,Ia=!1,rl=Error(T(519));function Ui(i){var s=Error(T(418,""));throw $n(In(s,i)),rl}function As(i){var s=i.stateNode,c=i.type,p=i.memoizedProps;switch(s[kt]=i,s[zt]=p,c){case"dialog":_i("cancel",s),_i("close",s);break;case"iframe":case"object":case"embed":_i("load",s);break;case"video":case"audio":for(c=0;c<ld.length;c++)_i(ld[c],s);break;case"source":_i("error",s);break;case"img":case"image":case"link":_i("error",s),_i("load",s);break;case"details":_i("toggle",s);break;case"input":_i("invalid",s),ro(s,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),yu(s);break;case"select":_i("invalid",s);break;case"textarea":_i("invalid",s),Dl(s,p.value,p.defaultValue,p.children),yu(s)}c=p.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||p.suppressHydrationWarning===!0||Rp(s.textContent,c)?(p.popover!=null&&(_i("beforetoggle",s),_i("toggle",s)),p.onScroll!=null&&_i("scroll",s),p.onScrollEnd!=null&&_i("scrollend",s),p.onClick!=null&&(s.onclick=hd),s=!0):s=!1,s||Ui(i)}function qn(i){for(vn=i.return;vn;)switch(vn.tag){case 5:case 13:Ia=!1;return;case 27:case 3:Ia=!0;return;default:vn=vn.return}}function nl(i){if(i!==vn)return!1;if(!bi)return qn(i),bi=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Tf(i.type,i.memoizedProps)),c=!c),c&&gr&&Ui(i),qn(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(T(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){gr=Hn(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}gr=null}}else s===27?(s=gr,vl(i.type)?(i=sn,sn=null,gr=i):gr=s):gr=vn?Hn(i.stateNode.nextSibling):null;return!0}function zs(){gr=vn=null,bi=!1}function Ou(){var i=Ja;return i!==null&&(ha===null?ha=i:ha.push.apply(ha,i),Ja=null),i}function $n(i){Ja===null?Ja=[i]:Ja.push(i)}var Bc=Ke(null),Da=null,Ra=null;function Ps(i,s,c){ut(Bc,s._currentValue),s._currentValue=c}function es(i){i._currentValue=Bc.current,lt(Bc)}function Bu(i,s,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),i===c)break;i=i.return}}function po(i,s,c,p){var S=i.child;for(S!==null&&(S.return=i);S!==null;){var A=S.dependencies;if(A!==null){var Z=S.child;A=A.firstContext;e:for(;A!==null;){var K=A;A=S;for(var me=0;me<s.length;me++)if(K.context===s[me]){A.lanes|=c,K=A.alternate,K!==null&&(K.lanes|=c),Bu(A.return,c,i),p||(Z=null);break e}A=K.next}}else if(S.tag===18){if(Z=S.return,Z===null)throw Error(T(341));Z.lanes|=c,A=Z.alternate,A!==null&&(A.lanes|=c),Bu(Z,c,i),Z=null}else Z=S.child;if(Z!==null)Z.return=S;else for(Z=S;Z!==null;){if(Z===i){Z=null;break}if(S=Z.sibling,S!==null){S.return=Z.return,Z=S;break}Z=Z.return}S=Z}}function ts(i,s,c,p){i=null;for(var S=s,A=!1;S!==null;){if(!A){if((S.flags&524288)!==0)A=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var Z=S.alternate;if(Z===null)throw Error(T(387));if(Z=Z.memoizedProps,Z!==null){var K=S.type;Zn(S.pendingProps.value,Z.value)||(i!==null?i.push(K):i=[K])}}else if(S===di.current){if(Z=S.alternate,Z===null)throw Error(T(387));Z.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(i!==null?i.push(le):i=[le])}S=S.return}i!==null&&po(s,i,c,p),s.flags|=262144}function Er(i){for(i=i.firstContext;i!==null;){if(!Zn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ba(i){Da=i,Ra=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function rn(i){return Vh(Da,i)}function jc(i,s){return Da===null&&ba(i),Vh(i,s)}function Vh(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Ra===null){if(i===null)throw Error(T(308));Ra=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ra=Ra.next=s;return c}var Xl=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,p){i.push(p)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},Zh=v.unstable_scheduleCallback,ju=v.unstable_NormalPriority,Vr={$$typeof:Tt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mo(){return{controller:new Xl,data:new Map,refCount:0}}function Yl(i){i.refCount--,i.refCount===0&&Zh(ju,function(){i.controller.abort()})}var Zr=null,na=0,ka=0,bn=null;function Ql(i,s){if(Zr===null){var c=Zr=[];na=0,ka=_f(),bn={status:"pending",value:void 0,then:function(p){c.push(p)}}}return na++,s.then(Fc,Fc),s}function Fc(){if(--na===0&&Zr!==null){bn!==null&&(bn.status="fulfilled");var i=Zr;Zr=null,ka=0,bn=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function Wf(i,s){var c=[],p={status:"pending",value:null,reason:null,then:function(S){c.push(S)}};return i.then(function(){p.status="fulfilled",p.value=s;for(var S=0;S<c.length;S++)(0,c[S])(s)},function(S){for(p.status="rejected",p.reason=S,S=0;S<c.length;S++)(0,c[S])(void 0)}),p}var Fu=we.S;we.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&Ql(i,s),Fu!==null&&Fu(i,s)};var is=Ke(null);function Uc(){var i=is.current;return i!==null?i:Vi.pooledCache}function Is(i,s){s===null?ut(is,is.current):ut(is,s.pool)}function La(){var i=Uc();return i===null?null:{parent:Vr._currentValue,pool:i}}var yt=Error(T(460)),Nc=Error(T(474)),al=Error(T(542)),Uu={then:function(){}};function sl(i){return i=i.status,i==="fulfilled"||i==="rejected"}function go(){}function Nu(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(go,go),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,jd(i),i;default:if(typeof s.status=="string")s.then(go,go);else{if(i=Vi,i!==null&&100<i.shellSuspendCounter)throw Error(T(482));i=s,i.status="pending",i.then(function(p){if(s.status==="pending"){var S=s;S.status="fulfilled",S.value=p}},function(p){if(s.status==="pending"){var S=s;S.status="rejected",S.reason=p}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,jd(i),i}throw ii=s,yt}}var ii=null;function Vc(){if(ii===null)throw Error(T(459));var i=ii;return ii=null,i}function jd(i){if(i===yt||i===al)throw Error(T(483))}var rs=!1;function Vu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zu(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ns(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Oa(i,s,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Hi&2)!==0){var S=p.pending;return S===null?s.next=s:(s.next=S.next,S.next=s),p.pending=s,s=ri(i),kc(i,null,c),s}return Ss(i,p,s,c),ri(i)}function Ds(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,je(i,c)}}function qh(i,s){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var S=null,A=null;if(c=c.firstBaseUpdate,c!==null){do{var Z={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};A===null?S=A=Z:A=A.next=Z,c=c.next}while(c!==null);A===null?S=A=s:A=A.next=s}else S=A=s;c={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:A,shared:p.shared,callbacks:p.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var Kl=!1;function Zc(){if(Kl){var i=bn;if(i!==null)throw i}}function qc(i,s,c,p){Kl=!1;var S=i.updateQueue;rs=!1;var A=S.firstBaseUpdate,Z=S.lastBaseUpdate,K=S.shared.pending;if(K!==null){S.shared.pending=null;var me=K,Be=me.next;me.next=null,Z===null?A=Be:Z.next=Be,Z=me;var tt=i.alternate;tt!==null&&(tt=tt.updateQueue,K=tt.lastBaseUpdate,K!==Z&&(K===null?tt.firstBaseUpdate=Be:K.next=Be,tt.lastBaseUpdate=me))}if(A!==null){var nt=S.baseState;Z=0,tt=Be=me=null,K=A;do{var Ve=K.lane&-536870913,He=Ve!==K.lane;if(He?(Ei&Ve)===Ve:(p&Ve)===Ve){Ve!==0&&Ve===ka&&(Kl=!0),tt!==null&&(tt=tt.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var Kt=i,Xt=K;Ve=s;var Ji=c;switch(Xt.tag){case 1:if(Kt=Xt.payload,typeof Kt=="function"){nt=Kt.call(Ji,nt,Ve);break e}nt=Kt;break e;case 3:Kt.flags=Kt.flags&-65537|128;case 0:if(Kt=Xt.payload,Ve=typeof Kt=="function"?Kt.call(Ji,nt,Ve):Kt,Ve==null)break e;nt=ve({},nt,Ve);break e;case 2:rs=!0}}Ve=K.callback,Ve!==null&&(i.flags|=64,He&&(i.flags|=8192),He=S.callbacks,He===null?S.callbacks=[Ve]:He.push(Ve))}else He={lane:Ve,tag:K.tag,payload:K.payload,callback:K.callback,next:null},tt===null?(Be=tt=He,me=nt):tt=tt.next=He,Z|=Ve;if(K=K.next,K===null){if(K=S.shared.pending,K===null)break;He=K,K=He.next,He.next=null,S.lastBaseUpdate=He,S.shared.pending=null}}while(!0);tt===null&&(me=nt),S.baseState=me,S.firstBaseUpdate=Be,S.lastBaseUpdate=tt,A===null&&(S.shared.lanes=0),pl|=Z,i.lanes=Z,i.memoizedState=nt}}function as(i,s){if(typeof i!="function")throw Error(T(191,i));i.call(s)}function Gi(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)as(c[i],s)}var ss=Ke(null),Wl=Ke(0);function $h(i,s){i=Mo,ut(Wl,i),ut(ss,s),Mo=i|s.baseLanes}function qu(){ut(Wl,Mo),ut(ss,ss.current)}function $u(){Mo=Wl.current,lt(ss),lt(Wl)}var _o=0,$t=null,zi=null,mt=null,jt=!1,os=!1,Rs=!1,Jl=0,ur=0,yo=null,xa=0;function Cr(){throw Error(T(321))}function ks(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!Zn(i[c],s[c]))return!1;return!0}function ir(i,s,c,p,S,A){return _o=A,$t=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,we.H=i===null||i.memoizedState===null?Xc:Gh,Rs=!1,A=c(p,S),Rs=!1,os&&(A=ol(s,c,p,S)),rr(i),A}function rr(i){we.H=Li;var s=zi!==null&&zi.next!==null;if(_o=0,mt=zi=$t=null,jt=!1,ur=0,yo=null,s)throw Error(T(300));i===null||dn||(i=i.dependencies,i!==null&&Er(i)&&(dn=!0))}function ol(i,s,c,p){$t=i;var S=0;do{if(os&&(yo=null),ur=0,os=!1,25<=S)throw Error(T(301));if(S+=1,mt=zi=null,i.updateQueue!=null){var A=i.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}we.H=Fd,A=s(c,p)}while(os);return A}function $c(){var i=we.H,s=i.useState()[0];return s=typeof s.then=="function"?f(s):s,i=i.useState()[0],(zi!==null?zi.memoizedState:null)!==i&&($t.flags|=1024),s}function ll(){var i=Jl!==0;return Jl=0,i}function Ls(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function Gc(i){if(jt){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}jt=!1}_o=0,mt=zi=$t=null,os=!1,ur=Jl=0,yo=null}function xn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?$t.memoizedState=mt=i:mt=mt.next=i,mt}function nr(){if(zi===null){var i=$t.alternate;i=i!==null?i.memoizedState:null}else i=zi.next;var s=mt===null?$t.memoizedState:mt.next;if(s!==null)mt=s,zi=i;else{if(i===null)throw $t.alternate===null?Error(T(467)):Error(T(310));zi=i,i={memoizedState:zi.memoizedState,baseState:zi.baseState,baseQueue:zi.baseQueue,queue:zi.queue,next:null},mt===null?$t.memoizedState=mt=i:mt=mt.next=i}return mt}function Hc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function f(i){var s=ur;return ur+=1,yo===null&&(yo=[]),i=Nu(yo,i,s),s=$t,(mt===null?s.memoizedState:mt.next)===null&&(s=s.alternate,we.H=s===null||s.memoizedState===null?Xc:Gh),i}function e(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return f(i);if(i.$$typeof===Tt)return rn(i)}throw Error(T(438,String(i)))}function r(i){var s=null,c=$t.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var p=$t.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(s={data:p.data.map(function(S){return S.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Hc(),$t.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),p=0;p<i;p++)c[p]=Mi;return s.index++,c}function l(i,s){return typeof s=="function"?s(i):s}function h(i){var s=nr();return m(s,zi,i)}function m(i,s,c){var p=i.queue;if(p===null)throw Error(T(311));p.lastRenderedReducer=c;var S=i.baseQueue,A=p.pending;if(A!==null){if(S!==null){var Z=S.next;S.next=A.next,A.next=Z}s.baseQueue=S=A,p.pending=null}if(A=i.baseState,S===null)i.memoizedState=A;else{s=S.next;var K=Z=null,me=null,Be=s,tt=!1;do{var nt=Be.lane&-536870913;if(nt!==Be.lane?(Ei&nt)===nt:(_o&nt)===nt){var Ve=Be.revertLane;if(Ve===0)me!==null&&(me=me.next={lane:0,revertLane:0,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),nt===ka&&(tt=!0);else if((_o&Ve)===Ve){Be=Be.next,Ve===ka&&(tt=!0);continue}else nt={lane:0,revertLane:Be.revertLane,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},me===null?(K=me=nt,Z=A):me=me.next=nt,$t.lanes|=Ve,pl|=Ve;nt=Be.action,Rs&&c(A,nt),A=Be.hasEagerState?Be.eagerState:c(A,nt)}else Ve={lane:nt,revertLane:Be.revertLane,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},me===null?(K=me=Ve,Z=A):me=me.next=Ve,$t.lanes|=nt,pl|=nt;Be=Be.next}while(Be!==null&&Be!==s);if(me===null?Z=A:me.next=K,!Zn(A,i.memoizedState)&&(dn=!0,tt&&(c=bn,c!==null)))throw c;i.memoizedState=A,i.baseState=Z,i.baseQueue=me,p.lastRenderedState=A}return S===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function x(i){var s=nr(),c=s.queue;if(c===null)throw Error(T(311));c.lastRenderedReducer=i;var p=c.dispatch,S=c.pending,A=s.memoizedState;if(S!==null){c.pending=null;var Z=S=S.next;do A=i(A,Z.action),Z=Z.next;while(Z!==S);Zn(A,s.memoizedState)||(dn=!0),s.memoizedState=A,s.baseQueue===null&&(s.baseState=A),c.lastRenderedState=A}return[A,p]}function M(i,s,c){var p=$t,S=nr(),A=bi;if(A){if(c===void 0)throw Error(T(407));c=c()}else c=s();var Z=!Zn((zi||S).memoizedState,c);Z&&(S.memoizedState=c,dn=!0),S=S.queue;var K=k.bind(null,p,S,i);if(it(2048,8,K,[i]),S.getSnapshot!==s||Z||mt!==null&&mt.memoizedState.tag&1){if(p.flags|=2048,Ue(9,$e(),I.bind(null,p,S,c,s),null),Vi===null)throw Error(T(349));A||(_o&124)!==0||C(p,s,c)}return c}function C(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=$t.updateQueue,s===null?(s=Hc(),$t.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function I(i,s,c,p){s.value=c,s.getSnapshot=p,j(s)&&B(i)}function k(i,s,c){return c(function(){j(s)&&B(i)})}function j(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!Zn(i,c)}catch{return!0}}function B(i){var s=Wo(i,2);s!==null&&Na(s,i,2)}function $(i){var s=xn();if(typeof i=="function"){var c=i;if(i=c(),Rs){mn(!0);try{c()}finally{mn(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:i},s}function G(i,s,c,p){return i.baseState=c,m(i,zi,typeof p=="function"?p:l)}function re(i,s,c,p,S){if(_r(i))throw Error(T(485));if(i=s.action,i!==null){var A={payload:S,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){A.listeners.push(Z)}};we.T!==null?c(!0):A.isTransition=!1,p(A),c=s.pending,c===null?(A.next=s.pending=A,ie(s,A)):(A.next=c.next,s.pending=c.next=A)}}function ie(i,s){var c=s.action,p=s.payload,S=i.state;if(s.isTransition){var A=we.T,Z={};we.T=Z;try{var K=c(S,p),me=we.S;me!==null&&me(Z,K),ae(i,s,K)}catch(Be){pe(i,s,Be)}finally{we.T=A}}else try{A=c(S,p),ae(i,s,A)}catch(Be){pe(i,s,Be)}}function ae(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(p){ce(i,s,p)},function(p){return pe(i,s,p)}):ce(i,s,c)}function ce(i,s,c){s.status="fulfilled",s.value=c,fe(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,ie(i,c)))}function pe(i,s,c){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do s.status="rejected",s.reason=c,fe(s),s=s.next;while(s!==p)}i.action=null}function fe(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function ge(i,s){return s}function xe(i,s){if(bi){var c=Vi.formState;if(c!==null){e:{var p=$t;if(bi){if(gr){t:{for(var S=gr,A=Ia;S.nodeType!==8;){if(!A){S=null;break t}if(S=Hn(S.nextSibling),S===null){S=null;break t}}A=S.data,S=A==="F!"||A==="F"?S:null}if(S){gr=Hn(S.nextSibling),p=S.data==="F!";break e}}Ui(p)}p=!1}p&&(s=c[0])}}return c=xn(),c.memoizedState=c.baseState=s,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ge,lastRenderedState:s},c.queue=p,c=Fs.bind(null,$t,p),p.dispatch=c,p=$(!1),A=cs.bind(null,$t,!1,p.queue),p=xn(),S={state:s,dispatch:null,action:i,pending:null},p.queue=S,c=re.bind(null,$t,S,A,c),S.dispatch=c,p.memoizedState=i,[s,c,!1]}function _e(i){var s=nr();return ke(s,zi,i)}function ke(i,s,c){if(s=m(i,s,ge)[0],i=h(l)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var p=f(s)}catch(Z){throw Z===yt?al:Z}else p=s;s=nr();var S=s.queue,A=S.dispatch;return c!==s.memoizedState&&($t.flags|=2048,Ue(9,$e(),Ye.bind(null,S,c),null)),[p,A,i]}function Ye(i,s){i.action=s}function Ne(i){var s=nr(),c=zi;if(c!==null)return ke(s,c,i);nr(),s=s.memoizedState,c=nr();var p=c.queue.dispatch;return c.memoizedState=i,[s,p,!1]}function Ue(i,s,c,p){return i={tag:i,create:c,deps:p,inst:s,next:null},s=$t.updateQueue,s===null&&(s=Hc(),$t.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,s.lastEffect=i),i}function $e(){return{destroy:void 0,resource:void 0}}function dt(){return nr().memoizedState}function ht(i,s,c,p){var S=xn();p=p===void 0?null:p,$t.flags|=i,S.memoizedState=Ue(1|s,$e(),c,p)}function it(i,s,c,p){var S=nr();p=p===void 0?null:p;var A=S.memoizedState.inst;zi!==null&&p!==null&&ks(p,zi.memoizedState.deps)?S.memoizedState=Ue(s,A,c,p):($t.flags|=i,S.memoizedState=Ue(1|s,A,c,p))}function St(i,s){ht(8390656,8,i,s)}function ei(i,s){it(2048,8,i,s)}function oi(i,s){return it(4,2,i,s)}function ar(i,s){return it(4,4,i,s)}function ki(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function sr(i,s,c){c=c!=null?c.concat([i]):null,it(4,4,ki.bind(null,s,i),c)}function Ki(){}function Ni(i,s){var c=nr();s=s===void 0?null:s;var p=c.memoizedState;return s!==null&&ks(s,p[1])?p[0]:(c.memoizedState=[i,s],i)}function xi(i,s){var c=nr();s=s===void 0?null:s;var p=c.memoizedState;if(s!==null&&ks(s,p[1]))return p[0];if(p=i(),Rs){mn(!0);try{i()}finally{mn(!1)}}return c.memoizedState=[p,s],p}function Lr(i,s,c){return c===void 0||(_o&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=cf(),$t.lanes|=i,pl|=i,c)}function Xr(i,s,c,p){return Zn(c,s)?c:ss.current!==null?(i=Lr(i,c,p),Zn(i,s)||(dn=!0),i):(_o&42)===0?(dn=!0,i.memoizedState=c):(i=cf(),$t.lanes|=i,pl|=i,s)}function nn(i,s,c,p,S){var A=We.p;We.p=A!==0&&8>A?A:8;var Z=we.T,K={};we.T=K,cs(i,!1,s,c);try{var me=S(),Be=we.S;if(Be!==null&&Be(K,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var tt=Wf(me,p);sa(i,s,tt,da(i))}else sa(i,s,p,da(i))}catch(nt){sa(i,s,{then:function(){},status:"rejected",reason:nt},da())}finally{We.p=A,we.T=Z}}function Ti(){}function ls(i,s,c,p){if(i.tag!==5)throw Error(T(476));var S=Ba(i).queue;nn(i,S,s,Ge,c===null?Ti:function(){return Os(i),c(p)})}function Ba(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ge,baseState:Ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:Ge},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Os(i){var s=Ba(i).next.queue;sa(i,s,{},da())}function Bs(){return rn(le)}function ec(){return nr().memoizedState}function js(){return nr().memoizedState}function cl(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=da();i=ns(c);var p=Oa(s,i,c);p!==null&&(Na(p,s,c),Ds(p,s,c)),s={cache:mo()},i.payload=s;return}s=s.return}}function aa(i,s,c){var p=da();c={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},_r(i)?Or(s,c):(c=ho(i,s,c,p),c!==null&&(Na(c,i,p),wn(c,s,p)))}function Fs(i,s,c){var p=da();sa(i,s,c,p)}function sa(i,s,c,p){var S={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(_r(i))Or(s,S);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=s.lastRenderedReducer,A!==null))try{var Z=s.lastRenderedState,K=A(Z,c);if(S.hasEagerState=!0,S.eagerState=K,Zn(K,Z))return Ss(i,s,S,0),Vi===null&&Ko(),!1}catch{}finally{}if(c=ho(i,s,S,p),c!==null)return Na(c,i,p),wn(c,s,p),!0}return!1}function cs(i,s,c,p){if(p={lane:2,revertLane:_f(),action:p,hasEagerState:!1,eagerState:null,next:null},_r(i)){if(s)throw Error(T(479))}else s=ho(i,c,p,2),s!==null&&Na(s,i,2)}function _r(i){var s=i.alternate;return i===$t||s!==null&&s===$t}function Or(i,s){os=jt=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function wn(i,s,c){if((c&4194048)!==0){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,je(i,c)}}var Li={readContext:rn,use:e,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useLayoutEffect:Cr,useInsertionEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useSyncExternalStore:Cr,useId:Cr,useHostTransitionStatus:Cr,useFormState:Cr,useActionState:Cr,useOptimistic:Cr,useMemoCache:Cr,useCacheRefresh:Cr},Xc={readContext:rn,use:e,useCallback:function(i,s){return xn().memoizedState=[i,s===void 0?null:s],i},useContext:rn,useEffect:St,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,ht(4194308,4,ki.bind(null,s,i),c)},useLayoutEffect:function(i,s){return ht(4194308,4,i,s)},useInsertionEffect:function(i,s){ht(4,2,i,s)},useMemo:function(i,s){var c=xn();s=s===void 0?null:s;var p=i();if(Rs){mn(!0);try{i()}finally{mn(!1)}}return c.memoizedState=[p,s],p},useReducer:function(i,s,c){var p=xn();if(c!==void 0){var S=c(s);if(Rs){mn(!0);try{c(s)}finally{mn(!1)}}}else S=s;return p.memoizedState=p.baseState=S,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:S},p.queue=i,i=i.dispatch=aa.bind(null,$t,i),[p.memoizedState,i]},useRef:function(i){var s=xn();return i={current:i},s.memoizedState=i},useState:function(i){i=$(i);var s=i.queue,c=Fs.bind(null,$t,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:Ki,useDeferredValue:function(i,s){var c=xn();return Lr(c,i,s)},useTransition:function(){var i=$(!1);return i=nn.bind(null,$t,i.queue,!0,!1),xn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var p=$t,S=xn();if(bi){if(c===void 0)throw Error(T(407));c=c()}else{if(c=s(),Vi===null)throw Error(T(349));(Ei&124)!==0||C(p,s,c)}S.memoizedState=c;var A={value:c,getSnapshot:s};return S.queue=A,St(k.bind(null,p,A,i),[i]),p.flags|=2048,Ue(9,$e(),I.bind(null,p,A,c,s),null),c},useId:function(){var i=xn(),s=Vi.identifierPrefix;if(bi){var c=ra,p=Pa;c=(p&~(1<<32-kr(p)-1)).toString(32)+c,s=""+s+"R"+c,c=Jl++,0<c&&(s+="H"+c.toString(32)),s+=""}else c=xa++,s=""+s+"r"+c.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Bs,useFormState:xe,useActionState:xe,useOptimistic:function(i){var s=xn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=cs.bind(null,$t,!0,c),c.dispatch=s,[i,s]},useMemoCache:r,useCacheRefresh:function(){return xn().memoizedState=cl.bind(null,$t)}},Gh={readContext:rn,use:e,useCallback:Ni,useContext:rn,useEffect:ei,useImperativeHandle:sr,useInsertionEffect:oi,useLayoutEffect:ar,useMemo:xi,useReducer:h,useRef:dt,useState:function(){return h(l)},useDebugValue:Ki,useDeferredValue:function(i,s){var c=nr();return Xr(c,zi.memoizedState,i,s)},useTransition:function(){var i=h(l)[0],s=nr().memoizedState;return[typeof i=="boolean"?i:f(i),s]},useSyncExternalStore:M,useId:ec,useHostTransitionStatus:Bs,useFormState:_e,useActionState:_e,useOptimistic:function(i,s){var c=nr();return G(c,zi,i,s)},useMemoCache:r,useCacheRefresh:js},Fd={readContext:rn,use:e,useCallback:Ni,useContext:rn,useEffect:ei,useImperativeHandle:sr,useInsertionEffect:oi,useLayoutEffect:ar,useMemo:xi,useReducer:x,useRef:dt,useState:function(){return x(l)},useDebugValue:Ki,useDeferredValue:function(i,s){var c=nr();return zi===null?Lr(c,i,s):Xr(c,zi.memoizedState,i,s)},useTransition:function(){var i=x(l)[0],s=nr().memoizedState;return[typeof i=="boolean"?i:f(i),s]},useSyncExternalStore:M,useId:ec,useHostTransitionStatus:Bs,useFormState:Ne,useActionState:Ne,useOptimistic:function(i,s){var c=nr();return zi!==null?G(c,zi,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:r,useCacheRefresh:js},tc=null,ul=0;function vo(i){var s=ul;return ul+=1,tc===null&&(tc=[]),Nu(tc,i,s)}function Tn(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function oa(i,s){throw s.$$typeof===Te?Error(T(525)):(i=Object.prototype.toString.call(s),Error(T(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function la(i){var s=i._init;return s(i._payload)}function us(i){function s(Ie,Me){if(i){var Oe=Ie.deletions;Oe===null?(Ie.deletions=[Me],Ie.flags|=16):Oe.push(Me)}}function c(Ie,Me){if(!i)return null;for(;Me!==null;)s(Ie,Me),Me=Me.sibling;return null}function p(Ie){for(var Me=new Map;Ie!==null;)Ie.key!==null?Me.set(Ie.key,Ie):Me.set(Ie.index,Ie),Ie=Ie.sibling;return Me}function S(Ie,Me){return Ie=Es(Ie,Me),Ie.index=0,Ie.sibling=null,Ie}function A(Ie,Me,Oe){return Ie.index=Oe,i?(Oe=Ie.alternate,Oe!==null?(Oe=Oe.index,Oe<Me?(Ie.flags|=67108866,Me):Oe):(Ie.flags|=67108866,Me)):(Ie.flags|=1048576,Me)}function Z(Ie){return i&&Ie.alternate===null&&(Ie.flags|=67108866),Ie}function K(Ie,Me,Oe,st){return Me===null||Me.tag!==6?(Me=$l(Oe,Ie.mode,st),Me.return=Ie,Me):(Me=S(Me,Oe),Me.return=Ie,Me)}function me(Ie,Me,Oe,st){var Rt=Oe.type;return Rt===Pe?tt(Ie,Me,Oe.props.children,st,Oe.key):Me!==null&&(Me.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===ti&&la(Rt)===Me.type)?(Me=S(Me,Oe.props),Tn(Me,Oe),Me.return=Ie,Me):(Me=Lc(Oe.type,Oe.key,Oe.props,null,Ie.mode,st),Tn(Me,Oe),Me.return=Ie,Me)}function Be(Ie,Me,Oe,st){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Oe.containerInfo||Me.stateNode.implementation!==Oe.implementation?(Me=tl(Oe,Ie.mode,st),Me.return=Ie,Me):(Me=S(Me,Oe.children||[]),Me.return=Ie,Me)}function tt(Ie,Me,Oe,st,Rt){return Me===null||Me.tag!==7?(Me=el(Oe,Ie.mode,st,Rt),Me.return=Ie,Me):(Me=S(Me,Oe),Me.return=Ie,Me)}function nt(Ie,Me,Oe){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=$l(""+Me,Ie.mode,Oe),Me.return=Ie,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case Ee:return Oe=Lc(Me.type,Me.key,Me.props,null,Ie.mode,Oe),Tn(Oe,Me),Oe.return=Ie,Oe;case ne:return Me=tl(Me,Ie.mode,Oe),Me.return=Ie,Me;case ti:var st=Me._init;return Me=st(Me._payload),nt(Ie,Me,Oe)}if(pt(Me)||wi(Me))return Me=el(Me,Ie.mode,Oe,null),Me.return=Ie,Me;if(typeof Me.then=="function")return nt(Ie,vo(Me),Oe);if(Me.$$typeof===Tt)return nt(Ie,jc(Ie,Me),Oe);oa(Ie,Me)}return null}function Ve(Ie,Me,Oe,st){var Rt=Me!==null?Me.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Rt!==null?null:K(Ie,Me,""+Oe,st);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case Ee:return Oe.key===Rt?me(Ie,Me,Oe,st):null;case ne:return Oe.key===Rt?Be(Ie,Me,Oe,st):null;case ti:return Rt=Oe._init,Oe=Rt(Oe._payload),Ve(Ie,Me,Oe,st)}if(pt(Oe)||wi(Oe))return Rt!==null?null:tt(Ie,Me,Oe,st,null);if(typeof Oe.then=="function")return Ve(Ie,Me,vo(Oe),st);if(Oe.$$typeof===Tt)return Ve(Ie,Me,jc(Ie,Oe),st);oa(Ie,Oe)}return null}function He(Ie,Me,Oe,st,Rt){if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return Ie=Ie.get(Oe)||null,K(Me,Ie,""+st,Rt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case Ee:return Ie=Ie.get(st.key===null?Oe:st.key)||null,me(Me,Ie,st,Rt);case ne:return Ie=Ie.get(st.key===null?Oe:st.key)||null,Be(Me,Ie,st,Rt);case ti:var Wt=st._init;return st=Wt(st._payload),He(Ie,Me,Oe,st,Rt)}if(pt(st)||wi(st))return Ie=Ie.get(Oe)||null,tt(Me,Ie,st,Rt,null);if(typeof st.then=="function")return He(Ie,Me,Oe,vo(st),Rt);if(st.$$typeof===Tt)return He(Ie,Me,Oe,jc(Me,st),Rt);oa(Me,st)}return null}function Kt(Ie,Me,Oe,st){for(var Rt=null,Wt=null,Nt=Me,Yt=Me=0,An=null;Nt!==null&&Yt<Oe.length;Yt++){Nt.index>Yt?(An=Nt,Nt=null):An=Nt.sibling;var Di=Ve(Ie,Nt,Oe[Yt],st);if(Di===null){Nt===null&&(Nt=An);break}i&&Nt&&Di.alternate===null&&s(Ie,Nt),Me=A(Di,Me,Yt),Wt===null?Rt=Di:Wt.sibling=Di,Wt=Di,Nt=An}if(Yt===Oe.length)return c(Ie,Nt),bi&&Wa(Ie,Yt),Rt;if(Nt===null){for(;Yt<Oe.length;Yt++)Nt=nt(Ie,Oe[Yt],st),Nt!==null&&(Me=A(Nt,Me,Yt),Wt===null?Rt=Nt:Wt.sibling=Nt,Wt=Nt);return bi&&Wa(Ie,Yt),Rt}for(Nt=p(Nt);Yt<Oe.length;Yt++)An=He(Nt,Ie,Yt,Oe[Yt],st),An!==null&&(i&&An.alternate!==null&&Nt.delete(An.key===null?Yt:An.key),Me=A(An,Me,Yt),Wt===null?Rt=An:Wt.sibling=An,Wt=An);return i&&Nt.forEach(function(mc){return s(Ie,mc)}),bi&&Wa(Ie,Yt),Rt}function Xt(Ie,Me,Oe,st){if(Oe==null)throw Error(T(151));for(var Rt=null,Wt=null,Nt=Me,Yt=Me=0,An=null,Di=Oe.next();Nt!==null&&!Di.done;Yt++,Di=Oe.next()){Nt.index>Yt?(An=Nt,Nt=null):An=Nt.sibling;var mc=Ve(Ie,Nt,Di.value,st);if(mc===null){Nt===null&&(Nt=An);break}i&&Nt&&mc.alternate===null&&s(Ie,Nt),Me=A(mc,Me,Yt),Wt===null?Rt=mc:Wt.sibling=mc,Wt=mc,Nt=An}if(Di.done)return c(Ie,Nt),bi&&Wa(Ie,Yt),Rt;if(Nt===null){for(;!Di.done;Yt++,Di=Oe.next())Di=nt(Ie,Di.value,st),Di!==null&&(Me=A(Di,Me,Yt),Wt===null?Rt=Di:Wt.sibling=Di,Wt=Di);return bi&&Wa(Ie,Yt),Rt}for(Nt=p(Nt);!Di.done;Yt++,Di=Oe.next())Di=He(Nt,Ie,Yt,Di.value,st),Di!==null&&(i&&Di.alternate!==null&&Nt.delete(Di.key===null?Yt:Di.key),Me=A(Di,Me,Yt),Wt===null?Rt=Di:Wt.sibling=Di,Wt=Di);return i&&Nt.forEach(function(jn){return s(Ie,jn)}),bi&&Wa(Ie,Yt),Rt}function Ji(Ie,Me,Oe,st){if(typeof Oe=="object"&&Oe!==null&&Oe.type===Pe&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case Ee:e:{for(var Rt=Oe.key;Me!==null;){if(Me.key===Rt){if(Rt=Oe.type,Rt===Pe){if(Me.tag===7){c(Ie,Me.sibling),st=S(Me,Oe.props.children),st.return=Ie,Ie=st;break e}}else if(Me.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===ti&&la(Rt)===Me.type){c(Ie,Me.sibling),st=S(Me,Oe.props),Tn(st,Oe),st.return=Ie,Ie=st;break e}c(Ie,Me);break}else s(Ie,Me);Me=Me.sibling}Oe.type===Pe?(st=el(Oe.props.children,Ie.mode,st,Oe.key),st.return=Ie,Ie=st):(st=Lc(Oe.type,Oe.key,Oe.props,null,Ie.mode,st),Tn(st,Oe),st.return=Ie,Ie=st)}return Z(Ie);case ne:e:{for(Rt=Oe.key;Me!==null;){if(Me.key===Rt)if(Me.tag===4&&Me.stateNode.containerInfo===Oe.containerInfo&&Me.stateNode.implementation===Oe.implementation){c(Ie,Me.sibling),st=S(Me,Oe.children||[]),st.return=Ie,Ie=st;break e}else{c(Ie,Me);break}else s(Ie,Me);Me=Me.sibling}st=tl(Oe,Ie.mode,st),st.return=Ie,Ie=st}return Z(Ie);case ti:return Rt=Oe._init,Oe=Rt(Oe._payload),Ji(Ie,Me,Oe,st)}if(pt(Oe))return Kt(Ie,Me,Oe,st);if(wi(Oe)){if(Rt=wi(Oe),typeof Rt!="function")throw Error(T(150));return Oe=Rt.call(Oe),Xt(Ie,Me,Oe,st)}if(typeof Oe.then=="function")return Ji(Ie,Me,vo(Oe),st);if(Oe.$$typeof===Tt)return Ji(Ie,Me,jc(Ie,Oe),st);oa(Ie,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint"?(Oe=""+Oe,Me!==null&&Me.tag===6?(c(Ie,Me.sibling),st=S(Me,Oe),st.return=Ie,Ie=st):(c(Ie,Me),st=$l(Oe,Ie.mode,st),st.return=Ie,Ie=st),Z(Ie)):c(Ie,Me)}return function(Ie,Me,Oe,st){try{ul=0;var Rt=Ji(Ie,Me,Oe,st);return tc=null,Rt}catch(Nt){if(Nt===yt||Nt===al)throw Nt;var Wt=Rn(29,Nt,null,Ie.mode);return Wt.lanes=st,Wt.return=Ie,Wt}finally{}}}var Us=us(!0),Ns=us(!1),Gn=Ke(null),Vs=null;function bo(i){var s=i.alternate;ut(an,an.current&1),ut(Gn,i),Vs===null&&(s===null||ss.current!==null||s.memoizedState!==null)&&(Vs=i)}function Jf(i){if(i.tag===22){if(ut(an,an.current),ut(Gn,i),Vs===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(Vs=i)}}else wa()}function wa(){ut(an,an.current),ut(Gn,Gn.current)}function ca(i){lt(Gn),Vs===i&&(Vs=null),lt(an)}var an=Ke(0);function Ud(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Bp(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Hh(i,s,c,p){s=i.memoizedState,c=c(p,s),c=c==null?s:ve({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Nd={enqueueSetState:function(i,s,c){i=i._reactInternals;var p=da(),S=ns(p);S.payload=s,c!=null&&(S.callback=c),s=Oa(i,S,p),s!==null&&(Na(s,i,p),Ds(s,i,p))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var p=da(),S=ns(p);S.tag=1,S.payload=s,c!=null&&(S.callback=c),s=Oa(i,S,p),s!==null&&(Na(s,i,p),Ds(s,i,p))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=da(),p=ns(c);p.tag=2,s!=null&&(p.callback=s),s=Oa(i,p,c),s!==null&&(Na(s,i,c),Ds(s,i,c))}};function fm(i,s,c,p,S,A,Z){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,A,Z):s.prototype&&s.prototype.isPureReactComponent?!si(c,p)||!si(S,A):!0}function ep(i,s,c,p){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,p),s.state!==i&&Nd.enqueueReplaceState(s,s.state,null)}function Yc(i,s){var c=s;if("ref"in s){c={};for(var p in s)p!=="ref"&&(c[p]=s[p])}if(i=i.defaultProps){c===s&&(c=ve({},c));for(var S in i)c[S]===void 0&&(c[S]=i[S])}return c}var Gu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function pm(i){Gu(i)}function Vd(i){console.error(i)}function tp(i){Gu(i)}function Xh(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(p){setTimeout(function(){throw p})}}function ic(i,s,c){try{var p=i.onCaughtError;p(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function ip(i,s,c){return c=ns(c),c.tag=3,c.payload={element:null},c.callback=function(){Xh(i,s)},c}function Hu(i){return i=ns(i),i.tag=3,i}function Yh(i,s,c,p){var S=c.type.getDerivedStateFromError;if(typeof S=="function"){var A=p.value;i.payload=function(){return S(A)},i.callback=function(){ic(s,c,p)}}var Z=c.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(i.callback=function(){ic(s,c,p),typeof S!="function"&&(cc===null?cc=new Set([this]):cc.add(this));var K=p.stack;this.componentDidCatch(p.value,{componentStack:K!==null?K:""})})}function Zd(i,s,c,p,S){if(c.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(s=c.alternate,s!==null&&ts(s,c,S,!0),c=Gn.current,c!==null){switch(c.tag){case 13:return Vs===null?hc():c.alternate===null&&Pr===0&&(Pr=3),c.flags&=-257,c.flags|=65536,c.lanes=S,p===Uu?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([p]):s.add(p),pf(i,p,S)),!1;case 22:return c.flags|=65536,p===Uu?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([p])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([p]):c.add(p)),pf(i,p,S)),!1}throw Error(T(435,c.tag))}return pf(i,p,S),hc(),!1}if(bi)return s=Gn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=S,p!==rl&&(i=Error(T(422),{cause:p}),$n(In(i,c)))):(p!==rl&&(s=Error(T(423),{cause:p}),$n(In(s,c))),i=i.current.alternate,i.flags|=65536,S&=-S,i.lanes|=S,p=In(p,c),S=ip(i.stateNode,p,S),qh(i,S),Pr!==4&&(Pr=2)),!1;var A=Error(T(520),{cause:p});if(A=In(A,c),td===null?td=[A]:td.push(A),Pr!==4&&(Pr=2),s===null)return!0;p=In(p,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=S&-S,c.lanes|=i,i=ip(c.stateNode,p,i),qh(c,i),!1;case 1:if(s=c.type,A=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(cc===null||!cc.has(A))))return c.flags|=65536,S&=-S,c.lanes|=S,S=Hu(S),Yh(S,i,c,p),qh(c,S),!1}c=c.return}while(c!==null);return!1}var rp=Error(T(461)),dn=!1;function kn(i,s,c,p){s.child=i===null?Ns(s,null,c,p):Us(s,i.child,c,p)}function mm(i,s,c,p,S){c=c.render;var A=s.ref;if("ref"in p){var Z={};for(var K in p)K!=="ref"&&(Z[K]=p[K])}else Z=p;return ba(s),p=ir(i,s,c,Z,A,S),K=ll(),i!==null&&!dn?(Ls(i,s,S),xo(i,s,S)):(bi&&K&&Hl(s),s.flags|=1,kn(i,s,p,S),s.child)}function np(i,s,c,p,S){if(i===null){var A=c.type;return typeof A=="function"&&!Jo(A)&&A.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=A,ap(i,s,A,p,S)):(i=Lc(c.type,null,p,s,s.mode,S),i.ref=s.ref,i.return=s,s.child=i)}if(A=i.child,!hl(i,S)){var Z=A.memoizedProps;if(c=c.compare,c=c!==null?c:si,c(Z,p)&&i.ref===s.ref)return xo(i,s,S)}return s.flags|=1,i=Es(A,p),i.ref=s.ref,i.return=s,s.child=i}function ap(i,s,c,p,S){if(i!==null){var A=i.memoizedProps;if(si(A,p)&&i.ref===s.ref)if(dn=!1,s.pendingProps=p=A,hl(i,S))(i.flags&131072)!==0&&(dn=!0);else return s.lanes=i.lanes,xo(i,s,S)}return qd(i,s,c,p,S)}function sp(i,s,c){var p=s.pendingProps,S=p.children,A=i!==null?i.memoizedState:null;if(p.mode==="hidden"){if((s.flags&128)!==0){if(p=A!==null?A.baseLanes|c:c,i!==null){for(S=s.child=i.child,A=0;S!==null;)A=A|S.lanes|S.childLanes,S=S.sibling;s.childLanes=A&~p}else s.childLanes=0,s.child=null;return gm(i,s,p,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Is(s,A!==null?A.cachePool:null),A!==null?$h(s,A):qu(),Jf(s);else return s.lanes=s.childLanes=536870912,gm(i,s,A!==null?A.baseLanes|c:c,c)}else A!==null?(Is(s,A.cachePool),$h(s,A),wa(),s.memoizedState=null):(i!==null&&Is(s,null),qu(),wa());return kn(i,s,S,c),s.child}function gm(i,s,c,p){var S=Uc();return S=S===null?null:{parent:Vr._currentValue,pool:S},s.memoizedState={baseLanes:c,cachePool:S},i!==null&&Is(s,null),qu(),Jf(s),i!==null&&ts(i,s,p,!0),null}function Xu(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(T(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function qd(i,s,c,p,S){return ba(s),c=ir(i,s,c,p,void 0,S),p=ll(),i!==null&&!dn?(Ls(i,s,S),xo(i,s,S)):(bi&&p&&Hl(s),s.flags|=1,kn(i,s,c,S),s.child)}function $d(i,s,c,p,S,A){return ba(s),s.updateQueue=null,c=ol(s,p,c,S),rr(i),p=ll(),i!==null&&!dn?(Ls(i,s,A),xo(i,s,A)):(bi&&p&&Hl(s),s.flags|=1,kn(i,s,c,A),s.child)}function Yu(i,s,c,p,S){if(ba(s),s.stateNode===null){var A=Ms,Z=c.contextType;typeof Z=="object"&&Z!==null&&(A=rn(Z)),A=new c(p,A),s.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Nd,s.stateNode=A,A._reactInternals=s,A=s.stateNode,A.props=p,A.state=s.memoizedState,A.refs={},Vu(s),Z=c.contextType,A.context=typeof Z=="object"&&Z!==null?rn(Z):Ms,A.state=s.memoizedState,Z=c.getDerivedStateFromProps,typeof Z=="function"&&(Hh(s,c,Z,p),A.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(Z=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),Z!==A.state&&Nd.enqueueReplaceState(A,A.state,null),qc(s,p,A,S),Zc(),A.state=s.memoizedState),typeof A.componentDidMount=="function"&&(s.flags|=4194308),p=!0}else if(i===null){A=s.stateNode;var K=s.memoizedProps,me=Yc(c,K);A.props=me;var Be=A.context,tt=c.contextType;Z=Ms,typeof tt=="object"&&tt!==null&&(Z=rn(tt));var nt=c.getDerivedStateFromProps;tt=typeof nt=="function"||typeof A.getSnapshotBeforeUpdate=="function",K=s.pendingProps!==K,tt||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(K||Be!==Z)&&ep(s,A,p,Z),rs=!1;var Ve=s.memoizedState;A.state=Ve,qc(s,p,A,S),Zc(),Be=s.memoizedState,K||Ve!==Be||rs?(typeof nt=="function"&&(Hh(s,c,nt,p),Be=s.memoizedState),(me=rs||fm(s,c,me,p,Ve,Be,Z))?(tt||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(s.flags|=4194308)):(typeof A.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=Be),A.props=p,A.state=Be,A.context=Z,p=me):(typeof A.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{A=s.stateNode,Zu(i,s),Z=s.memoizedProps,tt=Yc(c,Z),A.props=tt,nt=s.pendingProps,Ve=A.context,Be=c.contextType,me=Ms,typeof Be=="object"&&Be!==null&&(me=rn(Be)),K=c.getDerivedStateFromProps,(Be=typeof K=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(Z!==nt||Ve!==me)&&ep(s,A,p,me),rs=!1,Ve=s.memoizedState,A.state=Ve,qc(s,p,A,S),Zc();var He=s.memoizedState;Z!==nt||Ve!==He||rs||i!==null&&i.dependencies!==null&&Er(i.dependencies)?(typeof K=="function"&&(Hh(s,c,K,p),He=s.memoizedState),(tt=rs||fm(s,c,tt,p,Ve,He,me)||i!==null&&i.dependencies!==null&&Er(i.dependencies))?(Be||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,He,me),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,He,me)),typeof A.componentDidUpdate=="function"&&(s.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof A.componentDidUpdate!="function"||Z===i.memoizedProps&&Ve===i.memoizedState||(s.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||Z===i.memoizedProps&&Ve===i.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=He),A.props=p,A.state=He,A.context=me,p=tt):(typeof A.componentDidUpdate!="function"||Z===i.memoizedProps&&Ve===i.memoizedState||(s.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||Z===i.memoizedProps&&Ve===i.memoizedState||(s.flags|=1024),p=!1)}return A=p,Xu(i,s),p=(s.flags&128)!==0,A||p?(A=s.stateNode,c=p&&typeof c.getDerivedStateFromError!="function"?null:A.render(),s.flags|=1,i!==null&&p?(s.child=Us(s,i.child,null,S),s.child=Us(s,null,c,S)):kn(i,s,c,S),s.memoizedState=A.state,i=s.child):i=xo(i,s,S),i}function Ta(i,s,c,p){return zs(),s.flags|=256,kn(i,s,c,p),s.child}var Gd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qh(i){return{baseLanes:i,cachePool:La()}}function op(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=ds),i}function lp(i,s,c){var p=s.pendingProps,S=!1,A=(s.flags&128)!==0,Z;if((Z=A)||(Z=i!==null&&i.memoizedState===null?!1:(an.current&2)!==0),Z&&(S=!0,s.flags&=-129),Z=(s.flags&32)!==0,s.flags&=-33,i===null){if(bi){if(S?bo(s):wa(),bi){var K=gr,me;if(me=K){e:{for(me=K,K=Ia;me.nodeType!==8;){if(!K){K=null;break e}if(me=Hn(me.nextSibling),me===null){K=null;break e}}K=me}K!==null?(s.memoizedState={dehydrated:K,treeContext:za!==null?{id:Pa,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},me=Rn(18,null,null,0),me.stateNode=K,me.return=s,s.child=me,vn=s,gr=null,me=!0):me=!1}me||Ui(s)}if(K=s.memoizedState,K!==null&&(K=K.dehydrated,K!==null))return Bp(K)?s.lanes=32:s.lanes=536870912,null;ca(s)}return K=p.children,p=p.fallback,S?(wa(),S=s.mode,K=Hd({mode:"hidden",children:K},S),p=el(p,S,c,null),K.return=s,p.return=s,K.sibling=p,s.child=K,S=s.child,S.memoizedState=Qh(c),S.childLanes=op(i,Z,c),s.memoizedState=Gd,p):(bo(s),cp(s,K))}if(me=i.memoizedState,me!==null&&(K=me.dehydrated,K!==null)){if(A)s.flags&256?(bo(s),s.flags&=-257,s=up(i,s,c)):s.memoizedState!==null?(wa(),s.child=i.child,s.flags|=128,s=null):(wa(),S=p.fallback,K=s.mode,p=Hd({mode:"visible",children:p.children},K),S=el(S,K,c,null),S.flags|=2,p.return=s,S.return=s,p.sibling=S,s.child=p,Us(s,i.child,null,c),p=s.child,p.memoizedState=Qh(c),p.childLanes=op(i,Z,c),s.memoizedState=Gd,s=S);else if(bo(s),Bp(K)){if(Z=K.nextSibling&&K.nextSibling.dataset,Z)var Be=Z.dgst;Z=Be,p=Error(T(419)),p.stack="",p.digest=Z,$n({value:p,source:null,stack:null}),s=up(i,s,c)}else if(dn||ts(i,s,c,!1),Z=(c&i.childLanes)!==0,dn||Z){if(Z=Vi,Z!==null&&(p=c&-c,p=(p&42)!==0?1:Ae(p),p=(p&(Z.suspendedLanes|c))!==0?0:p,p!==0&&p!==me.retryLane))throw me.retryLane=p,Wo(i,p),Na(Z,i,p),rp;K.data==="$?"||hc(),s=up(i,s,c)}else K.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=me.treeContext,gr=Hn(K.nextSibling),vn=s,bi=!0,Ja=null,Ia=!1,i!==null&&(_n[yn++]=Pa,_n[yn++]=ra,_n[yn++]=za,Pa=i.id,ra=i.overflow,za=s),s=cp(s,p.children),s.flags|=4096);return s}return S?(wa(),S=p.fallback,K=s.mode,me=i.child,Be=me.sibling,p=Es(me,{mode:"hidden",children:p.children}),p.subtreeFlags=me.subtreeFlags&65011712,Be!==null?S=Es(Be,S):(S=el(S,K,c,null),S.flags|=2),S.return=s,p.return=s,p.sibling=S,s.child=p,p=S,S=s.child,K=i.child.memoizedState,K===null?K=Qh(c):(me=K.cachePool,me!==null?(Be=Vr._currentValue,me=me.parent!==Be?{parent:Be,pool:Be}:me):me=La(),K={baseLanes:K.baseLanes|c,cachePool:me}),S.memoizedState=K,S.childLanes=op(i,Z,c),s.memoizedState=Gd,p):(bo(s),c=i.child,i=c.sibling,c=Es(c,{mode:"visible",children:p.children}),c.return=s,c.sibling=null,i!==null&&(Z=s.deletions,Z===null?(s.deletions=[i],s.flags|=16):Z.push(i)),s.child=c,s.memoizedState=null,c)}function cp(i,s){return s=Hd({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Hd(i,s){return i=Rn(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function up(i,s,c){return Us(s,i.child,null,c),i=cp(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function _m(i,s,c){i.lanes|=s;var p=i.alternate;p!==null&&(p.lanes|=s),Bu(i.return,s,c)}function Kh(i,s,c,p,S){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:S}:(A.isBackwards=s,A.rendering=null,A.renderingStartTime=0,A.last=p,A.tail=c,A.tailMode=S)}function Xd(i,s,c){var p=s.pendingProps,S=p.revealOrder,A=p.tail;if(kn(i,s,p.children,c),p=an.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&_m(i,c,s);else if(i.tag===19)_m(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(ut(an,p),S){case"forwards":for(c=s.child,S=null;c!==null;)i=c.alternate,i!==null&&Ud(i)===null&&(S=c),c=c.sibling;c=S,c===null?(S=s.child,s.child=null):(S=c.sibling,c.sibling=null),Kh(s,!1,S,c,A);break;case"backwards":for(c=null,S=s.child,s.child=null;S!==null;){if(i=S.alternate,i!==null&&Ud(i)===null){s.child=S;break}i=S.sibling,S.sibling=c,c=S,S=i}Kh(s,!0,c,null,A);break;case"together":Kh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function xo(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),pl|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(ts(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(T(153));if(s.child!==null){for(i=s.child,c=Es(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Es(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function hl(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Er(i)))}function Wh(i,s,c){switch(s.tag){case 3:li(s,s.stateNode.containerInfo),Ps(s,Vr,i.memoizedState.cache),zs();break;case 27:case 5:lr(s);break;case 4:li(s,s.stateNode.containerInfo);break;case 10:Ps(s,s.type,s.memoizedProps.value);break;case 13:var p=s.memoizedState;if(p!==null)return p.dehydrated!==null?(bo(s),s.flags|=128,null):(c&s.child.childLanes)!==0?lp(i,s,c):(bo(s),i=xo(i,s,c),i!==null?i.sibling:null);bo(s);break;case 19:var S=(i.flags&128)!==0;if(p=(c&s.childLanes)!==0,p||(ts(i,s,c,!1),p=(c&s.childLanes)!==0),S){if(p)return Xd(i,s,c);s.flags|=128}if(S=s.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),ut(an,an.current),p)break;return null;case 22:case 23:return s.lanes=0,sp(i,s,c);case 24:Ps(s,Vr,i.memoizedState.cache)}return xo(i,s,c)}function ym(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)dn=!0;else{if(!hl(i,c)&&(s.flags&128)===0)return dn=!1,Wh(i,s,c);dn=(i.flags&131072)!==0}else dn=!1,bi&&(s.flags&1048576)!==0&&Nh(s,Gl,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var p=s.elementType,S=p._init;if(p=S(p._payload),s.type=p,typeof p=="function")Jo(p)?(i=Yc(p,i),s.tag=1,s=Yu(null,s,p,i,c)):(s.tag=0,s=qd(null,s,p,i,c));else{if(p!=null){if(S=p.$$typeof,S===qt){s.tag=11,s=mm(null,s,p,i,c);break e}else if(S===Pi){s.tag=14,s=np(null,s,p,i,c);break e}}throw s=Et(p)||p,Error(T(306,s,""))}}return s;case 0:return qd(i,s,s.type,s.pendingProps,c);case 1:return p=s.type,S=Yc(p,s.pendingProps),Yu(i,s,p,S,c);case 3:e:{if(li(s,s.stateNode.containerInfo),i===null)throw Error(T(387));p=s.pendingProps;var A=s.memoizedState;S=A.element,Zu(i,s),qc(s,p,null,c);var Z=s.memoizedState;if(p=Z.cache,Ps(s,Vr,p),p!==A.cache&&po(s,[Vr],c,!0),Zc(),p=Z.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:Z.cache},s.updateQueue.baseState=A,s.memoizedState=A,s.flags&256){s=Ta(i,s,p,c);break e}else if(p!==S){S=In(Error(T(424)),s),$n(S),s=Ta(i,s,p,c);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(gr=Hn(i.firstChild),vn=s,bi=!0,Ja=null,Ia=!0,c=Ns(s,null,p,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(zs(),p===S){s=xo(i,s,c);break e}kn(i,s,p,c)}s=s.child}return s;case 26:return Xu(i,s),i===null?(c=mh(s.type,null,s.pendingProps,null))?s.memoizedState=c:bi||(c=s.type,i=s.pendingProps,p=Gs(It.current).createElement(c),p[kt]=s,p[zt]=i,Cn(p,c,i),Lt(p),s.stateNode=p):s.memoizedState=mh(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return lr(s),i===null&&bi&&(p=s.stateNode=Cf(s.type,s.pendingProps,It.current),vn=s,Ia=!0,S=gr,vl(s.type)?(sn=S,gr=Hn(p.firstChild)):gr=S),kn(i,s,s.pendingProps.children,c),Xu(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&bi&&((S=p=gr)&&(p=Ef(p,s.type,s.pendingProps,Ia),p!==null?(s.stateNode=p,vn=s,gr=Hn(p.firstChild),Ia=!1,S=!0):S=!1),S||Ui(s)),lr(s),S=s.type,A=s.pendingProps,Z=i!==null?i.memoizedProps:null,p=A.children,Tf(S,A)?p=null:Z!==null&&Tf(S,Z)&&(s.flags|=32),s.memoizedState!==null&&(S=ir(i,s,$c,null,null,c),le._currentValue=S),Xu(i,s),kn(i,s,p,c),s.child;case 6:return i===null&&bi&&((i=c=gr)&&(c=wg(c,s.pendingProps,Ia),c!==null?(s.stateNode=c,vn=s,gr=null,i=!0):i=!1),i||Ui(s)),null;case 13:return lp(i,s,c);case 4:return li(s,s.stateNode.containerInfo),p=s.pendingProps,i===null?s.child=Us(s,null,p,c):kn(i,s,p,c),s.child;case 11:return mm(i,s,s.type,s.pendingProps,c);case 7:return kn(i,s,s.pendingProps,c),s.child;case 8:return kn(i,s,s.pendingProps.children,c),s.child;case 12:return kn(i,s,s.pendingProps.children,c),s.child;case 10:return p=s.pendingProps,Ps(s,s.type,p.value),kn(i,s,p.children,c),s.child;case 9:return S=s.type._context,p=s.pendingProps.children,ba(s),S=rn(S),p=p(S),s.flags|=1,kn(i,s,p,c),s.child;case 14:return np(i,s,s.type,s.pendingProps,c);case 15:return ap(i,s,s.type,s.pendingProps,c);case 19:return Xd(i,s,c);case 31:return p=s.pendingProps,c=s.mode,p={mode:p.mode,children:p.children},i===null?(c=Hd(p,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=Es(i.child,p),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return sp(i,s,c);case 24:return ba(s),p=rn(Vr),i===null?(S=Uc(),S===null&&(S=Vi,A=mo(),S.pooledCache=A,A.refCount++,A!==null&&(S.pooledCacheLanes|=c),S=A),s.memoizedState={parent:p,cache:S},Vu(s),Ps(s,Vr,S)):((i.lanes&c)!==0&&(Zu(i,s),qc(s,null,null,c),Zc()),S=i.memoizedState,A=s.memoizedState,S.parent!==p?(S={parent:p,cache:p},s.memoizedState=S,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=S),Ps(s,Vr,p)):(p=A.cache,Ps(s,Vr,p),p!==S.cache&&po(s,[Vr],c,!0))),kn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(T(156,s.tag))}function dl(i){i.flags|=4}function vm(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!D(s)){if(s=Gn.current,s!==null&&((Ei&4194048)===Ei?Vs!==null:(Ei&62914560)!==Ei&&(Ei&536870912)===0||s!==Vs))throw ii=Uu,Nc;i.flags|=8192}}function Yd(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?be():536870912,i.lanes|=s,ml|=s)}function Jh(i,s){if(!bi)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Br(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(s)for(var S=i.child;S!==null;)c|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=i,S=S.sibling;else for(S=i.child;S!==null;)c|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=i,S=S.sibling;return i.subtreeFlags|=p,i.childLanes=c,s}function fg(i,s,c){var p=s.pendingProps;switch(Oc(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Br(s),null;case 1:return Br(s),null;case 3:return c=s.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),s.memoizedState.cache!==p&&(s.flags|=2048),es(Vr),er(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(nl(s)?dl(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Ou())),Br(s),null;case 26:return c=s.memoizedState,i===null?(dl(s),c!==null?(Br(s),vm(s,c)):(Br(s),s.flags&=-16777217)):c?c!==i.memoizedState?(dl(s),Br(s),vm(s,c)):(Br(s),s.flags&=-16777217):(i.memoizedProps!==p&&dl(s),Br(s),s.flags&=-16777217),null;case 27:Bi(s),c=It.current;var S=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==p&&dl(s);else{if(!p){if(s.stateNode===null)throw Error(T(166));return Br(s),null}i=vt.current,nl(s)?As(s):(i=Cf(S,p,c),s.stateNode=i,dl(s))}return Br(s),null;case 5:if(Bi(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==p&&dl(s);else{if(!p){if(s.stateNode===null)throw Error(T(166));return Br(s),null}if(i=vt.current,nl(s))As(s);else{switch(S=Gs(It.current),i){case 1:i=S.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=S.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=S.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=S.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=S.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?S.createElement("select",{is:p.is}):S.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?S.createElement(c,{is:p.is}):S.createElement(c)}}i[kt]=s,i[zt]=p;e:for(S=s.child;S!==null;){if(S.tag===5||S.tag===6)i.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===s)break e;for(;S.sibling===null;){if(S.return===null||S.return===s)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}s.stateNode=i;e:switch(Cn(i,c,p),c){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&dl(s)}}return Br(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==p&&dl(s);else{if(typeof p!="string"&&s.stateNode===null)throw Error(T(166));if(i=It.current,nl(s)){if(i=s.stateNode,c=s.memoizedProps,p=null,S=vn,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}i[kt]=s,i=!!(i.nodeValue===c||p!==null&&p.suppressHydrationWarning===!0||Rp(i.nodeValue,c)),i||Ui(s)}else i=Gs(i).createTextNode(p),i[kt]=s,s.stateNode=i}return Br(s),null;case 13:if(p=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(S=nl(s),p!==null&&p.dehydrated!==null){if(i===null){if(!S)throw Error(T(318));if(S=s.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(T(317));S[kt]=s}else zs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Br(s),S=!1}else S=Ou(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=S),S=!0;if(!S)return s.flags&256?(ca(s),s):(ca(s),null)}if(ca(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=p!==null,i=i!==null&&i.memoizedState!==null,c){p=s.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool);var A=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(A=p.memoizedState.cachePool.pool),A!==S&&(p.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),Yd(s,s.updateQueue),Br(s),null;case 4:return er(),i===null&&vf(s.stateNode.containerInfo),Br(s),null;case 10:return es(s.type),Br(s),null;case 19:if(lt(an),S=s.memoizedState,S===null)return Br(s),null;if(p=(s.flags&128)!==0,A=S.rendering,A===null)if(p)Jh(S,!1);else{if(Pr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(A=Ud(i),A!==null){for(s.flags|=128,Jh(S,!1),i=A.updateQueue,s.updateQueue=i,Yd(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Bd(c,i),c=c.sibling;return ut(an,an.current&1|2),s.child}i=i.sibling}S.tail!==null&&Rr()>af&&(s.flags|=128,p=!0,Jh(S,!1),s.lanes=4194304)}else{if(!p)if(i=Ud(A),i!==null){if(s.flags|=128,p=!0,i=i.updateQueue,s.updateQueue=i,Yd(s,i),Jh(S,!0),S.tail===null&&S.tailMode==="hidden"&&!A.alternate&&!bi)return Br(s),null}else 2*Rr()-S.renderingStartTime>af&&c!==536870912&&(s.flags|=128,p=!0,Jh(S,!1),s.lanes=4194304);S.isBackwards?(A.sibling=s.child,s.child=A):(i=S.last,i!==null?i.sibling=A:s.child=A,S.last=A)}return S.tail!==null?(s=S.tail,S.rendering=s,S.tail=s.sibling,S.renderingStartTime=Rr(),s.sibling=null,i=an.current,ut(an,p?i&1|2:i&1),s):(Br(s),null);case 22:case 23:return ca(s),$u(),p=s.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(s.flags|=8192):p&&(s.flags|=8192),p?(c&536870912)!==0&&(s.flags&128)===0&&(Br(s),s.subtreeFlags&6&&(s.flags|=8192)):Br(s),c=s.updateQueue,c!==null&&Yd(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),p=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),p!==c&&(s.flags|=2048),i!==null&&lt(is),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),es(Vr),Br(s),null;case 25:return null;case 30:return null}throw Error(T(156,s.tag))}function hp(i,s){switch(Oc(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return es(Vr),er(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Bi(s),null;case 13:if(ca(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(T(340));zs()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return lt(an),null;case 4:return er(),null;case 10:return es(s.type),null;case 22:case 23:return ca(s),$u(),i!==null&&lt(is),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return es(Vr),null;case 25:return null;default:return null}}function bm(i,s){switch(Oc(s),s.tag){case 3:es(Vr),er();break;case 26:case 27:case 5:Bi(s);break;case 4:er();break;case 13:ca(s);break;case 19:lt(an);break;case 10:es(s.type);break;case 22:case 23:ca(s),$u(),i!==null&&lt(is);break;case 24:es(Vr)}}function Qu(i,s){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var S=p.next;c=S;do{if((c.tag&i)===i){p=void 0;var A=c.create,Z=c.inst;p=A(),Z.destroy=p}c=c.next}while(c!==S)}}catch(K){or(s,s.return,K)}}function hs(i,s,c){try{var p=s.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var A=S.next;p=A;do{if((p.tag&i)===i){var Z=p.inst,K=Z.destroy;if(K!==void 0){Z.destroy=void 0,S=s;var me=c,Be=K;try{Be()}catch(tt){or(S,me,tt)}}}p=p.next}while(p!==A)}}catch(tt){or(s,s.return,tt)}}function xm(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{Gi(s,c)}catch(p){or(i,i.return,p)}}}function Ar(i,s,c){c.props=Yc(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(p){or(i,s,p)}}function wo(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof c=="function"?i.refCleanup=c(p):c.current=p}}catch(S){or(i,s,S)}}function Zs(i,s){var c=i.ref,p=i.refCleanup;if(c!==null)if(typeof p=="function")try{p()}catch(S){or(i,s,S)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(S){or(i,s,S)}else c.current=null}function ed(i){var s=i.type,c=i.memoizedProps,p=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&p.focus();break e;case"img":c.src?p.src=c.src:c.srcSet&&(p.srcset=c.srcSet)}}catch(S){or(i,i.return,S)}}function Ku(i,s,c){try{var p=i.stateNode;Fm(p,i.type,c,s),p[zt]=s}catch(S){or(i,i.return,S)}}function Wu(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&vl(i.type)||i.tag===4}function Qd(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Wu(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&vl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Kd(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=hd));else if(p!==4&&(p===27&&vl(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(Kd(i,s,c),i=i.sibling;i!==null;)Kd(i,s,c),i=i.sibling}function rc(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(p!==4&&(p===27&&vl(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(rc(i,s,c),i=i.sibling;i!==null;)rc(i,s,c),i=i.sibling}function Wd(i){var s=i.stateNode,c=i.memoizedProps;try{for(var p=i.type,S=s.attributes;S.length;)s.removeAttributeNode(S[0]);Cn(s,p,c),s[kt]=i,s[zt]=c}catch(A){or(i,i.return,A)}}var Sa=!1,zr=!1,nc=!1,Ju=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function wm(i,s){if(i=i.containerInfo,kp=ot,i=Pu(i),Iu(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var S=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{c.nodeType,A.nodeType}catch{c=null;break e}var Z=0,K=-1,me=-1,Be=0,tt=0,nt=i,Ve=null;t:for(;;){for(var He;nt!==c||S!==0&&nt.nodeType!==3||(K=Z+S),nt!==A||p!==0&&nt.nodeType!==3||(me=Z+p),nt.nodeType===3&&(Z+=nt.nodeValue.length),(He=nt.firstChild)!==null;)Ve=nt,nt=He;for(;;){if(nt===i)break t;if(Ve===c&&++Be===S&&(K=Z),Ve===A&&++tt===p&&(me=Z),(He=nt.nextSibling)!==null)break;nt=Ve,Ve=nt.parentNode}nt=He}c=K===-1||me===-1?null:{start:K,end:me}}else c=null}c=c||{start:0,end:0}}else c=null;for(wf={focusedElem:i,selectionRange:c},ot=!1,Sn=s;Sn!==null;)if(s=Sn,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,Sn=i;else for(;Sn!==null;){switch(s=Sn,A=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&A!==null){i=void 0,c=s,S=A.memoizedProps,A=A.memoizedState,p=c.stateNode;try{var Kt=Yc(c.type,S,c.elementType===c.type);i=p.getSnapshotBeforeUpdate(Kt,A),p.__reactInternalSnapshotBeforeUpdate=i}catch(Xt){or(c,c.return,Xt)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)fh(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":fh(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(T(163))}if(i=s.sibling,i!==null){i.return=s.return,Sn=i;break}Sn=s.return}}function ac(i,s,c){var p=c.flags;switch(c.tag){case 0:case 11:case 15:To(i,c),p&4&&Qu(5,c);break;case 1:if(To(i,c),p&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(Z){or(c,c.return,Z)}else{var S=Yc(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(S,s,i.__reactInternalSnapshotBeforeUpdate)}catch(Z){or(c,c.return,Z)}}p&64&&xm(c),p&512&&wo(c,c.return);break;case 3:if(To(i,c),p&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Gi(i,s)}catch(Z){or(c,c.return,Z)}}break;case 27:s===null&&p&4&&Wd(c);case 26:case 5:To(i,c),s===null&&p&4&&ed(c),p&512&&wo(c,c.return);break;case 12:To(i,c);break;case 13:To(i,c),p&4&&fp(i,c),p&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=Eo.bind(null,c),Tg(i,c))));break;case 22:if(p=c.memoizedState!==null||Sa,!p){s=s!==null&&s.memoizedState!==null||zr,S=Sa;var A=zr;Sa=p,(zr=s)&&!A?So(i,c,(c.subtreeFlags&8772)!==0):To(i,c),Sa=S,zr=A}break;case 30:break;default:To(i,c)}}function Tm(i){var s=i.alternate;s!==null&&(i.alternate=null,Tm(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Ft(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var yr=null,Mn=!1;function qs(i,s,c){for(c=c.child;c!==null;)dp(i,s,c),c=c.sibling}function dp(i,s,c){if(Wr&&typeof Wr.onCommitFiberUnmount=="function")try{Wr.onCommitFiberUnmount($a,c)}catch{}switch(c.tag){case 26:zr||Zs(c,s),qs(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:zr||Zs(c,s);var p=yr,S=Mn;vl(c.type)&&(yr=c.stateNode,Mn=!1),qs(i,s,c),ph(c.stateNode),yr=p,Mn=S;break;case 5:zr||Zs(c,s);case 6:if(p=yr,S=Mn,yr=null,qs(i,s,c),yr=p,Mn=S,yr!==null)if(Mn)try{(yr.nodeType===9?yr.body:yr.nodeName==="HTML"?yr.ownerDocument.body:yr).removeChild(c.stateNode)}catch(A){or(c,s,A)}else try{yr.removeChild(c.stateNode)}catch(A){or(c,s,A)}break;case 18:yr!==null&&(Mn?(i=yr,dd(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),fr(i)):dd(yr,c.stateNode));break;case 4:p=yr,S=Mn,yr=c.stateNode.containerInfo,Mn=!0,qs(i,s,c),yr=p,Mn=S;break;case 0:case 11:case 14:case 15:zr||hs(2,c,s),zr||hs(4,c,s),qs(i,s,c);break;case 1:zr||(Zs(c,s),p=c.stateNode,typeof p.componentWillUnmount=="function"&&Ar(c,s,p)),qs(i,s,c);break;case 21:qs(i,s,c);break;case 22:zr=(p=zr)||c.memoizedState!==null,qs(i,s,c),zr=p;break;default:qs(i,s,c)}}function fp(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{fr(i)}catch(c){or(s,s.return,c)}}function pg(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Ju),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Ju),s;default:throw Error(T(435,i.tag))}}function pp(i,s){var c=pg(i);s.forEach(function(p){var S=dc.bind(null,i,p);c.has(p)||(c.add(p),p.then(S,S))})}function ja(i,s){var c=s.deletions;if(c!==null)for(var p=0;p<c.length;p++){var S=c[p],A=i,Z=s,K=Z;e:for(;K!==null;){switch(K.tag){case 27:if(vl(K.type)){yr=K.stateNode,Mn=!1;break e}break;case 5:yr=K.stateNode,Mn=!1;break e;case 3:case 4:yr=K.stateNode.containerInfo,Mn=!0;break e}K=K.return}if(yr===null)throw Error(T(160));dp(A,Z,S),yr=null,Mn=!1,A=S.alternate,A!==null&&(A.return=null),S.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Sm(s,i),s=s.sibling}var $s=null;function Sm(i,s){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ja(s,i),ua(i),p&4&&(hs(3,i,i.return),Qu(3,i),hs(5,i,i.return));break;case 1:ja(s,i),ua(i),p&512&&(zr||c===null||Zs(c,c.return)),p&64&&Sa&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?p:c.concat(p))));break;case 26:var S=$s;if(ja(s,i),ua(i),p&512&&(zr||c===null||Zs(c,c.return)),p&4){var A=c!==null?c.memoizedState:null;if(p=i.memoizedState,c===null)if(p===null)if(i.stateNode===null){e:{p=i.type,c=i.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":A=S.getElementsByTagName("title")[0],(!A||A[Je]||A[kt]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=S.createElement(p),S.head.insertBefore(A,S.querySelector("head > title"))),Cn(A,p,c),A[kt]=i,Lt(A),p=A;break e;case"link":var Z=w("link","href",S).get(p+(c.href||""));if(Z){for(var K=0;K<Z.length;K++)if(A=Z[K],A.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&A.getAttribute("rel")===(c.rel==null?null:c.rel)&&A.getAttribute("title")===(c.title==null?null:c.title)&&A.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){Z.splice(K,1);break t}}A=S.createElement(p),Cn(A,p,c),S.head.appendChild(A);break;case"meta":if(Z=w("meta","content",S).get(p+(c.content||""))){for(K=0;K<Z.length;K++)if(A=Z[K],A.getAttribute("content")===(c.content==null?null:""+c.content)&&A.getAttribute("name")===(c.name==null?null:c.name)&&A.getAttribute("property")===(c.property==null?null:c.property)&&A.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&A.getAttribute("charset")===(c.charSet==null?null:c.charSet)){Z.splice(K,1);break t}}A=S.createElement(p),Cn(A,p,c),S.head.appendChild(A);break;default:throw Error(T(468,p))}A[kt]=i,Lt(A),p=A}i.stateNode=p}else E(S,i.type,i.stateNode);else i.stateNode=n(S,p,i.memoizedProps);else A!==p?(A===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):A.count--,p===null?E(S,i.type,i.stateNode):n(S,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Ku(i,i.memoizedProps,c.memoizedProps)}break;case 27:ja(s,i),ua(i),p&512&&(zr||c===null||Zs(c,c.return)),c!==null&&p&4&&Ku(i,i.memoizedProps,c.memoizedProps);break;case 5:if(ja(s,i),ua(i),p&512&&(zr||c===null||Zs(c,c.return)),i.flags&32){S=i.stateNode;try{no(S,"")}catch(He){or(i,i.return,He)}}p&4&&i.stateNode!=null&&(S=i.memoizedProps,Ku(i,S,c!==null?c.memoizedProps:S)),p&1024&&(nc=!0);break;case 6:if(ja(s,i),ua(i),p&4){if(i.stateNode===null)throw Error(T(162));p=i.memoizedProps,c=i.stateNode;try{c.nodeValue=p}catch(He){or(i,i.return,He)}}break;case 3:if(_=null,S=$s,$s=zf(s.containerInfo),ja(s,i),$s=S,ua(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{fr(s.containerInfo)}catch(He){or(i,i.return,He)}nc&&(nc=!1,mp(i));break;case 4:p=$s,$s=zf(i.stateNode.containerInfo),ja(s,i),ua(i),$s=p;break;case 12:ja(s,i),ua(i);break;case 13:ja(s,i),ua(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(bp=Rr()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,pp(i,p)));break;case 22:S=i.memoizedState!==null;var me=c!==null&&c.memoizedState!==null,Be=Sa,tt=zr;if(Sa=Be||S,zr=tt||me,ja(s,i),zr=tt,Sa=Be,ua(i),p&8192)e:for(s=i.stateNode,s._visibility=S?s._visibility&-2:s._visibility|1,S&&(c===null||me||Sa||zr||sc(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){me=c=s;try{if(A=me.stateNode,S)Z=A.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{K=me.stateNode;var nt=me.memoizedProps.style,Ve=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;K.style.display=Ve==null||typeof Ve=="boolean"?"":(""+Ve).trim()}}catch(He){or(me,me.return,He)}}}else if(s.tag===6){if(c===null){me=s;try{me.stateNode.nodeValue=S?"":me.memoizedProps}catch(He){or(me,me.return,He)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}p&4&&(p=i.updateQueue,p!==null&&(c=p.retryQueue,c!==null&&(p.retryQueue=null,pp(i,c))));break;case 19:ja(s,i),ua(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,pp(i,p)));break;case 30:break;case 21:break;default:ja(s,i),ua(i)}}function ua(i){var s=i.flags;if(s&2){try{for(var c,p=i.return;p!==null;){if(Wu(p)){c=p;break}p=p.return}if(c==null)throw Error(T(160));switch(c.tag){case 27:var S=c.stateNode,A=Qd(i);rc(i,A,S);break;case 5:var Z=c.stateNode;c.flags&32&&(no(Z,""),c.flags&=-33);var K=Qd(i);rc(i,K,Z);break;case 3:case 4:var me=c.stateNode.containerInfo,Be=Qd(i);Kd(i,Be,me);break;default:throw Error(T(161))}}catch(tt){or(i,i.return,tt)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function mp(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;mp(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function To(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ac(i,s.alternate,s),s=s.sibling}function sc(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:hs(4,s,s.return),sc(s);break;case 1:Zs(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&Ar(s,s.return,c),sc(s);break;case 27:ph(s.stateNode);case 26:case 5:Zs(s,s.return),sc(s);break;case 22:s.memoizedState===null&&sc(s);break;case 30:sc(s);break;default:sc(s)}i=i.sibling}}function So(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var p=s.alternate,S=i,A=s,Z=A.flags;switch(A.tag){case 0:case 11:case 15:So(S,A,c),Qu(4,A);break;case 1:if(So(S,A,c),p=A,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Be){or(p,p.return,Be)}if(p=A,S=p.updateQueue,S!==null){var K=p.stateNode;try{var me=S.shared.hiddenCallbacks;if(me!==null)for(S.shared.hiddenCallbacks=null,S=0;S<me.length;S++)as(me[S],K)}catch(Be){or(p,p.return,Be)}}c&&Z&64&&xm(A),wo(A,A.return);break;case 27:Wd(A);case 26:case 5:So(S,A,c),c&&p===null&&Z&4&&ed(A),wo(A,A.return);break;case 12:So(S,A,c);break;case 13:So(S,A,c),c&&Z&4&&fp(S,A);break;case 22:A.memoizedState===null&&So(S,A,c),wo(A,A.return);break;case 30:break;default:So(S,A,c)}s=s.sibling}}function Jd(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Yl(c))}function ef(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Yl(i))}function Fa(i,s,c,p){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)gp(i,s,c,p),s=s.sibling}function gp(i,s,c,p){var S=s.flags;switch(s.tag){case 0:case 11:case 15:Fa(i,s,c,p),S&2048&&Qu(9,s);break;case 1:Fa(i,s,c,p);break;case 3:Fa(i,s,c,p),S&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Yl(i)));break;case 12:if(S&2048){Fa(i,s,c,p),i=s.stateNode;try{var A=s.memoizedProps,Z=A.id,K=A.onPostCommit;typeof K=="function"&&K(Z,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(me){or(s,s.return,me)}}else Fa(i,s,c,p);break;case 13:Fa(i,s,c,p);break;case 23:break;case 22:A=s.stateNode,Z=s.alternate,s.memoizedState!==null?A._visibility&2?Fa(i,s,c,p):eh(i,s):A._visibility&2?Fa(i,s,c,p):(A._visibility|=2,Qc(i,s,c,p,(s.subtreeFlags&10256)!==0)),S&2048&&Jd(Z,s);break;case 24:Fa(i,s,c,p),S&2048&&ef(s.alternate,s);break;default:Fa(i,s,c,p)}}function Qc(i,s,c,p,S){for(S=S&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var A=i,Z=s,K=c,me=p,Be=Z.flags;switch(Z.tag){case 0:case 11:case 15:Qc(A,Z,K,me,S),Qu(8,Z);break;case 23:break;case 22:var tt=Z.stateNode;Z.memoizedState!==null?tt._visibility&2?Qc(A,Z,K,me,S):eh(A,Z):(tt._visibility|=2,Qc(A,Z,K,me,S)),S&&Be&2048&&Jd(Z.alternate,Z);break;case 24:Qc(A,Z,K,me,S),S&&Be&2048&&ef(Z.alternate,Z);break;default:Qc(A,Z,K,me,S)}s=s.sibling}}function eh(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,p=s,S=p.flags;switch(p.tag){case 22:eh(c,p),S&2048&&Jd(p.alternate,p);break;case 24:eh(c,p),S&2048&&ef(p.alternate,p);break;default:eh(c,p)}s=s.sibling}}var fl=8192;function th(i){if(i.subtreeFlags&fl)for(i=i.child;i!==null;)tf(i),i=i.sibling}function tf(i){switch(i.tag){case 26:th(i),i.flags&fl&&i.memoizedState!==null&&V($s,i.memoizedState,i.memoizedProps);break;case 5:th(i);break;case 3:case 4:var s=$s;$s=zf(i.stateNode.containerInfo),th(i),$s=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=fl,fl=16777216,th(i),fl=s):th(i));break;default:th(i)}}function ih(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Kc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];Sn=p,_p(p,i)}ih(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Mm(i),i=i.sibling}function Mm(i){switch(i.tag){case 0:case 11:case 15:Kc(i),i.flags&2048&&hs(9,i,i.return);break;case 3:Kc(i);break;case 12:Kc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,rf(i)):Kc(i);break;default:Kc(i)}}function rf(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];Sn=p,_p(p,i)}ih(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:hs(8,s,s.return),rf(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,rf(s));break;default:rf(s)}i=i.sibling}}function _p(i,s){for(;Sn!==null;){var c=Sn;switch(c.tag){case 0:case 11:case 15:hs(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var p=c.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Yl(c.memoizedState.cache)}if(p=c.child,p!==null)p.return=c,Sn=p;else e:for(c=i;Sn!==null;){p=Sn;var S=p.sibling,A=p.return;if(Tm(p),p===c){Sn=null;break e}if(S!==null){S.return=A,Sn=S;break e}Sn=A}}}var Em={getCacheForType:function(i){var s=rn(Vr),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},mg=typeof WeakMap=="function"?WeakMap:Map,Hi=0,Vi=null,gi=null,Ei=0,Xi=0,Ua=null,oc=!1,rh=!1,yp=!1,Mo=0,Pr=0,pl=0,lc=0,nf=0,ds=0,ml=0,td=null,ha=null,vp=!1,bp=0,af=1/0,id=null,cc=null,Ln=0,fs=null,Wc=null,uc=0,sf=0,jr=null,of=null,rd=0,lf=null;function da(){if((Hi&2)!==0&&Ei!==0)return Ei&-Ei;if(we.T!==null){var i=ka;return i!==0?i:_f()}return ft()}function cf(){ds===0&&(ds=(Ei&536870912)===0||bi?he():536870912);var i=Gn.current;return i!==null&&(i.flags|=32),ds}function Na(i,s,c){(i===Vi&&(Xi===2||Xi===9)||i.cancelPendingCommit!==null)&&(Jc(i,0),gl(i,Ei,ds,!1)),Re(i,c),((Hi&2)===0||i!==Vi)&&(i===Vi&&((Hi&2)===0&&(lc|=c),Pr===4&&gl(i,Ei,ds,!1)),ps(i))}function Cm(i,s,c){if((Hi&6)!==0)throw Error(T(327));var p=!c&&(s&124)===0&&(s&i.expiredLanes)===0||Y(i,s),S=p?_g(i,s):ah(i,s,!0),A=p;do{if(S===0){rh&&!p&&gl(i,s,0,!1);break}else{if(c=i.current.alternate,A&&!gg(c)){S=ah(i,s,!1),A=!1;continue}if(S===2){if(A=s,i.errorRecoveryDisabledLanes&A)var Z=0;else Z=i.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){s=Z;e:{var K=i;S=td;var me=K.current.memoizedState.isDehydrated;if(me&&(Jc(K,Z).flags|=256),Z=ah(K,Z,!1),Z!==2){if(yp&&!me){K.errorRecoveryDisabledLanes|=A,lc|=A,S=4;break e}A=ha,ha=S,A!==null&&(ha===null?ha=A:ha.push.apply(ha,A))}S=Z}if(A=!1,S!==2)continue}}if(S===1){Jc(i,0),gl(i,s,0,!0);break}e:{switch(p=i,A=S,A){case 0:case 1:throw Error(T(345));case 4:if((s&4194048)!==s)break;case 6:gl(p,s,ds,!oc);break e;case 2:ha=null;break;case 3:case 5:break;default:throw Error(T(329))}if((s&62914560)===s&&(S=bp+300-Rr(),10<S)){if(gl(p,s,ds,!oc),X(p,0,!0)!==0)break e;p.timeoutHandle=Um(Am.bind(null,p,c,ha,id,vp,s,ds,lc,ml,oc,A,2,-0,0),S);break e}Am(p,c,ha,id,vp,s,ds,lc,ml,oc,A,0,-0,0)}}break}while(!0);ps(i)}function Am(i,s,c,p,S,A,Z,K,me,Be,tt,nt,Ve,He){if(i.timeoutHandle=-1,nt=s.subtreeFlags,(nt&8192||(nt&16785408)===16785408)&&(O={stylesheets:null,count:0,unsuspend:U},tf(s),nt=q(),nt!==null)){i.cancelPendingCommit=nt(hf.bind(null,i,s,A,c,p,S,Z,K,me,tt,1,Ve,He)),gl(i,A,Z,!Be);return}hf(i,s,A,c,p,S,Z,K,me)}function gg(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var p=0;p<c.length;p++){var S=c[p],A=S.getSnapshot;S=S.value;try{if(!Zn(A(),S))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gl(i,s,c,p){s&=~nf,s&=~lc,i.suspendedLanes|=s,i.pingedLanes&=~s,p&&(i.warmLanes|=s),p=i.expirationTimes;for(var S=s;0<S;){var A=31-kr(S),Z=1<<A;p[A]=-1,S&=~Z}c!==0&&De(i,c,s)}function En(){return(Hi&6)===0?(iu(0),!1):!0}function nd(){if(gi!==null){if(Xi===0)var i=gi.return;else i=gi,Ra=Da=null,Gc(i),tc=null,ul=0,i=gi;for(;i!==null;)bm(i.alternate,i),i=i.return;gi=null}}function Jc(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,Nm(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),nd(),Vi=i,gi=c=Es(i.current,null),Ei=s,Xi=0,Ua=null,oc=!1,rh=Y(i,s),yp=!1,ml=ds=nf=lc=pl=Pr=0,ha=td=null,vp=!1,(s&8)!==0&&(s|=s&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=s;0<p;){var S=31-kr(p),A=1<<S;s|=i[S],p&=~A}return Mo=s,Ko(),c}function _l(i,s){$t=null,we.H=Li,s===yt||s===al?(s=Vc(),Xi=3):s===Nc?(s=Vc(),Xi=4):Xi=s===rp?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Ua=s,gi===null&&(Pr=1,Xh(i,In(s,i.current)))}function ad(){var i=we.H;return we.H=Li,i===null?Li:i}function nh(){var i=we.A;return we.A=Em,i}function hc(){Pr=4,oc||(Ei&4194048)!==Ei&&Gn.current!==null||(rh=!0),(pl&134217727)===0&&(lc&134217727)===0||Vi===null||gl(Vi,Ei,ds,!1)}function ah(i,s,c){var p=Hi;Hi|=2;var S=ad(),A=nh();(Vi!==i||Ei!==s)&&(id=null,Jc(i,s)),s=!1;var Z=Pr;e:do try{if(Xi!==0&&gi!==null){var K=gi,me=Ua;switch(Xi){case 8:nd(),Z=6;break e;case 3:case 2:case 9:case 6:Gn.current===null&&(s=!0);var Be=Xi;if(Xi=0,Ua=null,sh(i,K,me,Be),c&&rh){Z=0;break e}break;default:Be=Xi,Xi=0,Ua=null,sh(i,K,me,Be)}}uf(),Z=Pr;break}catch(tt){_l(i,tt)}while(!0);return s&&i.shellSuspendCounter++,Ra=Da=null,Hi=p,we.H=S,we.A=A,gi===null&&(Vi=null,Ei=0,Ko()),Z}function uf(){for(;gi!==null;)xp(gi)}function _g(i,s){var c=Hi;Hi|=2;var p=ad(),S=nh();Vi!==i||Ei!==s?(id=null,af=Rr()+500,Jc(i,s)):rh=Y(i,s);e:do try{if(Xi!==0&&gi!==null){s=gi;var A=Ua;t:switch(Xi){case 1:Xi=0,Ua=null,sh(i,s,A,1);break;case 2:case 9:if(sl(A)){Xi=0,Ua=null,wp(s);break}s=function(){Xi!==2&&Xi!==9||Vi!==i||(Xi=7),ps(i)},A.then(s,s);break e;case 3:Xi=7;break e;case 4:Xi=5;break e;case 7:sl(A)?(Xi=0,Ua=null,wp(s)):(Xi=0,Ua=null,sh(i,s,A,7));break;case 5:var Z=null;switch(gi.tag){case 26:Z=gi.memoizedState;case 5:case 27:var K=gi;if(!Z||D(Z)){Xi=0,Ua=null;var me=K.sibling;if(me!==null)gi=me;else{var Be=K.return;Be!==null?(gi=Be,sd(Be)):gi=null}break t}}Xi=0,Ua=null,sh(i,s,A,5);break;case 6:Xi=0,Ua=null,sh(i,s,A,6);break;case 8:nd(),Pr=6;break e;default:throw Error(T(462))}}yg();break}catch(tt){_l(i,tt)}while(!0);return Ra=Da=null,we.H=p,we.A=S,Hi=c,gi!==null?0:(Vi=null,Ei=0,Ko(),Pr)}function yg(){for(;gi!==null&&!qa();)xp(gi)}function xp(i){var s=ym(i.alternate,i,Mo);i.memoizedProps=i.pendingProps,s===null?sd(i):gi=s}function wp(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=$d(c,s,s.pendingProps,s.type,void 0,Ei);break;case 11:s=$d(c,s,s.pendingProps,s.type.render,s.ref,Ei);break;case 5:Gc(s);default:bm(c,s),s=gi=Bd(s,Mo),s=ym(c,s,Mo)}i.memoizedProps=i.pendingProps,s===null?sd(i):gi=s}function sh(i,s,c,p){Ra=Da=null,Gc(s),tc=null,ul=0;var S=s.return;try{if(Zd(i,S,s,c,Ei)){Pr=1,Xh(i,In(c,i.current)),gi=null;return}}catch(A){if(S!==null)throw gi=S,A;Pr=1,Xh(i,In(c,i.current)),gi=null;return}s.flags&32768?(bi||p===1?i=!0:rh||(Ei&536870912)!==0?i=!1:(oc=i=!0,(p===2||p===9||p===3||p===6)&&(p=Gn.current,p!==null&&p.tag===13&&(p.flags|=16384))),Tp(s,i)):sd(s)}function sd(i){var s=i;do{if((s.flags&32768)!==0){Tp(s,oc);return}i=s.return;var c=fg(s.alternate,s,Mo);if(c!==null){gi=c;return}if(s=s.sibling,s!==null){gi=s;return}gi=s=i}while(s!==null);Pr===0&&(Pr=5)}function Tp(i,s){do{var c=hp(i.alternate,i);if(c!==null){c.flags&=32767,gi=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){gi=i;return}gi=i=c}while(i!==null);Pr=6,gi=null}function hf(i,s,c,p,S,A,Z,K,me){i.cancelPendingCommit=null;do ff();while(Ln!==0);if((Hi&6)!==0)throw Error(T(327));if(s!==null){if(s===i.current)throw Error(T(177));if(A=s.lanes|s.childLanes,A|=ql,Se(i,c,A,Z,K,me),i===Vi&&(gi=Vi=null,Ei=0),Wc=s,fs=i,uc=c,sf=A,jr=S,of=p,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,km(Qn,function(){return Im(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||p){p=we.T,we.T=null,S=We.p,We.p=2,Z=Hi,Hi|=4;try{wm(i,s,c)}finally{Hi=Z,We.p=S,we.T=p}}Ln=1,df(),zm(),Sp()}}function df(){if(Ln===1){Ln=0;var i=fs,s=Wc,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=we.T,we.T=null;var p=We.p;We.p=2;var S=Hi;Hi|=4;try{Sm(s,i);var A=wf,Z=Pu(i.containerInfo),K=A.focusedElem,me=A.selectionRange;if(Z!==K&&K&&K.ownerDocument&&zu(K.ownerDocument.documentElement,K)){if(me!==null&&Iu(K)){var Be=me.start,tt=me.end;if(tt===void 0&&(tt=Be),"selectionStart"in K)K.selectionStart=Be,K.selectionEnd=Math.min(tt,K.value.length);else{var nt=K.ownerDocument||document,Ve=nt&&nt.defaultView||window;if(Ve.getSelection){var He=Ve.getSelection(),Kt=K.textContent.length,Xt=Math.min(me.start,Kt),Ji=me.end===void 0?Xt:Math.min(me.end,Kt);!He.extend&&Xt>Ji&&(Z=Ji,Ji=Xt,Xt=Z);var Ie=Au(K,Xt),Me=Au(K,Ji);if(Ie&&Me&&(He.rangeCount!==1||He.anchorNode!==Ie.node||He.anchorOffset!==Ie.offset||He.focusNode!==Me.node||He.focusOffset!==Me.offset)){var Oe=nt.createRange();Oe.setStart(Ie.node,Ie.offset),He.removeAllRanges(),Xt>Ji?(He.addRange(Oe),He.extend(Me.node,Me.offset)):(Oe.setEnd(Me.node,Me.offset),He.addRange(Oe))}}}}for(nt=[],He=K;He=He.parentNode;)He.nodeType===1&&nt.push({element:He,left:He.scrollLeft,top:He.scrollTop});for(typeof K.focus=="function"&&K.focus(),K=0;K<nt.length;K++){var st=nt[K];st.element.scrollLeft=st.left,st.element.scrollTop=st.top}}ot=!!kp,wf=kp=null}finally{Hi=S,We.p=p,we.T=c}}i.current=s,Ln=2}}function zm(){if(Ln===2){Ln=0;var i=fs,s=Wc,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=we.T,we.T=null;var p=We.p;We.p=2;var S=Hi;Hi|=4;try{ac(i,s.alternate,s)}finally{Hi=S,We.p=p,we.T=c}}Ln=3}}function Sp(){if(Ln===4||Ln===3){Ln=0,Ks();var i=fs,s=Wc,c=uc,p=of;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Ln=5:(Ln=0,Wc=fs=null,Pm(i,i.pendingLanes));var S=i.pendingLanes;if(S===0&&(cc=null),et(c),s=s.stateNode,Wr&&typeof Wr.onCommitFiberRoot=="function")try{Wr.onCommitFiberRoot($a,s,void 0,(s.current.flags&128)===128)}catch{}if(p!==null){s=we.T,S=We.p,We.p=2,we.T=null;try{for(var A=i.onRecoverableError,Z=0;Z<p.length;Z++){var K=p[Z];A(K.value,{componentStack:K.stack})}}finally{we.T=s,We.p=S}}(uc&3)!==0&&ff(),ps(i),S=i.pendingLanes,(c&4194090)!==0&&(S&42)!==0?i===lf?rd++:(rd=0,lf=i):rd=0,iu(0)}}function Pm(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Yl(s)))}function ff(i){return df(),zm(),Sp(),Im()}function Im(){if(Ln!==5)return!1;var i=fs,s=sf;sf=0;var c=et(uc),p=we.T,S=We.p;try{We.p=32>c?32:c,we.T=null,c=jr,jr=null;var A=fs,Z=uc;if(Ln=0,Wc=fs=null,uc=0,(Hi&6)!==0)throw Error(T(331));var K=Hi;if(Hi|=4,Mm(A.current),gp(A,A.current,Z,c),Hi=K,iu(0,!1),Wr&&typeof Wr.onPostCommitFiberRoot=="function")try{Wr.onPostCommitFiberRoot($a,A)}catch{}return!0}finally{We.p=S,we.T=p,Pm(i,s)}}function Dm(i,s,c){s=In(c,s),s=ip(i.stateNode,s,2),i=Oa(i,s,2),i!==null&&(Re(i,2),ps(i))}function or(i,s,c){if(i.tag===3)Dm(i,i,c);else for(;s!==null;){if(s.tag===3){Dm(s,i,c);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(cc===null||!cc.has(p))){i=In(c,i),c=Hu(2),p=Oa(s,c,2),p!==null&&(Yh(c,p,s,i),Re(p,2),ps(p));break}}s=s.return}}function pf(i,s,c){var p=i.pingCache;if(p===null){p=i.pingCache=new mg;var S=new Set;p.set(s,S)}else S=p.get(s),S===void 0&&(S=new Set,p.set(s,S));S.has(c)||(yp=!0,S.add(c),i=Rm.bind(null,i,s,c),s.then(i,i))}function Rm(i,s,c){var p=i.pingCache;p!==null&&p.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Vi===i&&(Ei&c)===c&&(Pr===4||Pr===3&&(Ei&62914560)===Ei&&300>Rr()-bp?(Hi&2)===0&&Jc(i,0):nf|=c,ml===Ei&&(ml=0)),ps(i)}function oh(i,s){s===0&&(s=be()),i=Wo(i,s),i!==null&&(Re(i,s),ps(i))}function Eo(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),oh(i,c)}function dc(i,s){var c=0;switch(i.tag){case 13:var p=i.stateNode,S=i.memoizedState;S!==null&&(c=S.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(T(314))}p!==null&&p.delete(s),oh(i,c)}function km(i,s){return tr(i,s)}var lh=null,ch=null,Mp=!1,eu=!1,od=!1,tu=0;function ps(i){i!==ch&&i.next===null&&(ch===null?lh=ch=i:ch=ch.next=i),eu=!0,Mp||(Mp=!0,gf())}function iu(i,s){if(!od&&eu){od=!0;do for(var c=!1,p=lh;p!==null;){if(i!==0){var S=p.pendingLanes;if(S===0)var A=0;else{var Z=p.suspendedLanes,K=p.pingedLanes;A=(1<<31-kr(42|i)+1)-1,A&=S&~(Z&~K),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(c=!0,Ap(p,A))}else A=Ei,A=X(p,p===Vi?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(A&3)===0||Y(p,A)||(c=!0,Ap(p,A));p=p.next}while(c);od=!1}}function uh(){Ep()}function Ep(){eu=Mp=!1;var i=0;tu!==0&&(xg()&&(i=tu),tu=0);for(var s=Rr(),c=null,p=lh;p!==null;){var S=p.next,A=Cp(p,s);A===0?(p.next=null,c===null?lh=S:c.next=S,S===null&&(ch=c)):(c=p,(i!==0||(A&3)!==0)&&(eu=!0)),p=S}iu(i)}function Cp(i,s){for(var c=i.suspendedLanes,p=i.pingedLanes,S=i.expirationTimes,A=i.pendingLanes&-62914561;0<A;){var Z=31-kr(A),K=1<<Z,me=S[Z];me===-1?((K&c)===0||(K&p)!==0)&&(S[Z]=te(K,s)):me<=s&&(i.expiredLanes|=K),A&=~K}if(s=Vi,c=Ei,c=X(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,c===0||i===s&&(Xi===2||Xi===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Ri(p),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Y(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(p!==null&&Ri(p),et(c)){case 2:case 8:c=Fn;break;case 32:c=Qn;break;case 268435456:c=Ws;break;default:c=Qn}return p=mf.bind(null,i),c=tr(c,p),i.callbackPriority=s,i.callbackNode=c,s}return p!==null&&p!==null&&Ri(p),i.callbackPriority=2,i.callbackNode=null,2}function mf(i,s){if(Ln!==0&&Ln!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(ff()&&i.callbackNode!==c)return null;var p=Ei;return p=X(i,i===Vi?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Cm(i,p,s),Cp(i,Rr()),i.callbackNode!=null&&i.callbackNode===c?mf.bind(null,i):null)}function Ap(i,s){if(ff())return null;Cm(i,s,!0)}function gf(){Vm(function(){(Hi&6)!==0?tr(Ml,uh):Ep()})}function _f(){return tu===0&&(tu=he()),tu}function Lm(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ao(""+i)}function Om(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function Bm(i,s,c,p,S){if(s==="submit"&&c&&c.stateNode===S){var A=Lm((S[zt]||null).action),Z=p.submitter;Z&&(s=(s=Z[zt]||null)?Lm(s.formAction):Z.getAttribute("formAction"),s!==null&&(A=s,Z=null));var K=new Rl("action","action",null,p,S);i.push({event:K,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(tu!==0){var me=Z?Om(S,Z):new FormData(S);ls(c,{pending:!0,data:me,method:S.method,action:A},null,me)}}else typeof A=="function"&&(K.preventDefault(),me=Z?Om(S,Z):new FormData(S),ls(c,{pending:!0,data:me,method:S.method,action:A},A,me))},currentTarget:S}]})}}for(var zp=0;zp<ku.length;zp++){var Pp=ku[zp],vg=Pp.toLowerCase(),bg=Pp[0].toUpperCase()+Pp.slice(1);ia(vg,"on"+bg)}ia(Dc,"onAnimationEnd"),ia(Rc,"onAnimationIteration"),ia(Du,"onAnimationStart"),ia("dblclick","onDoubleClick"),ia("focusin","onFocus"),ia("focusout","onBlur"),ia(Qo,"onTransitionRun"),ia(Ru,"onTransitionStart"),ia(Zl,"onTransitionCancel"),ia(ta,"onTransitionEnd"),Ga("onMouseEnter",["mouseout","mouseover"]),Ga("onMouseLeave",["mouseout","mouseover"]),Ga("onPointerEnter",["pointerout","pointerover"]),Ga("onPointerLeave",["pointerout","pointerover"]),Wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ip=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ld));function yl(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],S=p.event;p=p.listeners;e:{var A=void 0;if(s)for(var Z=p.length-1;0<=Z;Z--){var K=p[Z],me=K.instance,Be=K.currentTarget;if(K=K.listener,me!==A&&S.isPropagationStopped())break e;A=K,S.currentTarget=Be;try{A(S)}catch(tt){Gu(tt)}S.currentTarget=null,A=me}else for(Z=0;Z<p.length;Z++){if(K=p[Z],me=K.instance,Be=K.currentTarget,K=K.listener,me!==A&&S.isPropagationStopped())break e;A=K,S.currentTarget=Be;try{A(S)}catch(tt){Gu(tt)}S.currentTarget=null,A=me}}}}function _i(i,s){var c=s[yi];c===void 0&&(c=s[yi]=new Set);var p=i+"__bubble";c.has(p)||(Dp(s,i,2,!1),c.add(p))}function yf(i,s,c){var p=0;s&&(p|=4),Dp(c,i,p,s)}var cd="_reactListening"+Math.random().toString(36).slice(2);function vf(i){if(!i[cd]){i[cd]=!0,Do.forEach(function(c){c!=="selectionchange"&&(Ip.has(c)||yf(c,!1,i),yf(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[cd]||(s[cd]=!0,yf("selectionchange",!1,s))}}function Dp(i,s,c,p){switch(Mt(s)){case 2:var S=at;break;case 8:S=ct;break;default:S=Qe}c=S.bind(null,s,c,i),S=void 0,!Pn||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(S=!0),p?S!==void 0?i.addEventListener(s,c,{capture:!0,passive:S}):i.addEventListener(s,c,!0):S!==void 0?i.addEventListener(s,c,{passive:S}):i.addEventListener(s,c,!1)}function ud(i,s,c,p,S){var A=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var Z=p.tag;if(Z===3||Z===4){var K=p.stateNode.containerInfo;if(K===S)break;if(Z===4)for(Z=p.return;Z!==null;){var me=Z.tag;if((me===3||me===4)&&Z.stateNode.containerInfo===S)return;Z=Z.return}for(;K!==null;){if(Z=Gt(K),Z===null)return;if(me=Z.tag,me===5||me===6||me===26||me===27){p=A=Z;continue e}K=K.parentNode}}p=p.return}$i(function(){var Be=A,tt=so(c),nt=[];e:{var Ve=Uh.get(i);if(Ve!==void 0){var He=Rl,Kt=i;switch(i){case"keypress":if(Ht(c)===0)break e;case"keydown":case"keyup":He=Ho;break;case"focusin":Kt="focus",He=qo;break;case"focusout":Kt="blur",He=qo;break;case"beforeblur":case"afterblur":He=qo;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=en;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=Hf;break;case Dc:case Rc:case Du:He=tn;break;case ta:He=Yf;break;case"scroll":case"scrollend":He=Ec;break;case"wheel":He=Ll;break;case"copy":case"cut":case"paste":He=xu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=Ad;break;case"toggle":case"beforetoggle":He=Mu}var Xt=(s&4)!==0,Ji=!Xt&&(i==="scroll"||i==="scrollend"),Ie=Xt?Ve!==null?Ve+"Capture":null:Ve;Xt=[];for(var Me=Be,Oe;Me!==null;){var st=Me;if(Oe=st.stateNode,st=st.tag,st!==5&&st!==26&&st!==27||Oe===null||Ie===null||(st=Ha(Me,Ie),st!=null&&Xt.push(hh(Me,st,Oe))),Ji)break;Me=Me.return}0<Xt.length&&(Ve=new He(Ve,Kt,null,c,tt),nt.push({event:Ve,listeners:Xt}))}}if((s&7)===0){e:{if(Ve=i==="mouseover"||i==="pointerover",He=i==="mouseout"||i==="pointerout",Ve&&c!==Bo&&(Kt=c.relatedTarget||c.fromElement)&&(Gt(Kt)||Kt[qe]))break e;if((He||Ve)&&(Ve=tt.window===tt?tt:(Ve=tt.ownerDocument)?Ve.defaultView||Ve.parentWindow:window,He?(Kt=c.relatedTarget||c.toElement,He=Be,Kt=Kt?Gt(Kt):null,Kt!==null&&(Ji=F(Kt),Xt=Kt.tag,Kt!==Ji||Xt!==5&&Xt!==27&&Xt!==6)&&(Kt=null)):(He=null,Kt=Be),He!==Kt)){if(Xt=kl,st="onMouseLeave",Ie="onMouseEnter",Me="mouse",(i==="pointerout"||i==="pointerover")&&(Xt=Ad,st="onPointerLeave",Ie="onPointerEnter",Me="pointer"),Ji=He==null?Ve:qi(He),Oe=Kt==null?Ve:qi(Kt),Ve=new Xt(st,Me+"leave",He,c,tt),Ve.target=Ji,Ve.relatedTarget=Oe,st=null,Gt(tt)===Be&&(Xt=new Xt(Ie,Me+"enter",Kt,c,tt),Xt.target=Oe,Xt.relatedTarget=Ji,st=Xt),Ji=st,He&&Kt)t:{for(Xt=He,Ie=Kt,Me=0,Oe=Xt;Oe;Oe=ru(Oe))Me++;for(Oe=0,st=Ie;st;st=ru(st))Oe++;for(;0<Me-Oe;)Xt=ru(Xt),Me--;for(;0<Oe-Me;)Ie=ru(Ie),Oe--;for(;Me--;){if(Xt===Ie||Ie!==null&&Xt===Ie.alternate)break t;Xt=ru(Xt),Ie=ru(Ie)}Xt=null}else Xt=null;He!==null&&bf(nt,Ve,He,Xt,!1),Kt!==null&&Ji!==null&&bf(nt,Ji,Kt,Xt,!0)}}e:{if(Ve=Be?qi(Be):window,He=Ve.nodeName&&Ve.nodeName.toLowerCase(),He==="select"||He==="input"&&Ve.type==="file")var Rt=Ts;else if(Ih(Ve))if(Dh)Rt=Ld;else{Rt=kh;var Wt=Kf}else He=Ve.nodeName,!He||He.toLowerCase()!=="input"||Ve.type!=="checkbox"&&Ve.type!=="radio"?Be&&un(Be.elementType)&&(Rt=Ts):Rt=kd;if(Rt&&(Rt=Rt(i,Be))){Fl(nt,Rt,c,tt);break e}Wt&&Wt(i,Ve,Be),i==="focusout"&&Be&&Ve.type==="number"&&Be.memoizedProps.value!=null&&Mc(Ve,"number",Ve.value)}switch(Wt=Be?qi(Be):window,i){case"focusin":(Ih(Wt)||Wt.contentEditable==="true")&&(va=Wt,Pc=Be,Ic=null);break;case"focusout":Ic=Pc=va=null;break;case"mousedown":Bh=!0;break;case"contextmenu":case"mouseup":case"dragend":Bh=!1,Od(nt,c,tt);break;case"selectionchange":if(Oh)break;case"keydown":case"keyup":Od(nt,c,tt)}var Nt;if(_a)e:{switch(i){case"compositionstart":var Yt="onCompositionStart";break e;case"compositionend":Yt="onCompositionEnd";break e;case"compositionupdate":Yt="onCompositionUpdate";break e}Yt=void 0}else ya?Ac(i,c)&&(Yt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Yt="onCompositionStart");Yt&&(Bl&&c.locale!=="ko"&&(ya||Yt!=="onCompositionStart"?Yt==="onCompositionEnd"&&ya&&(Nt=ai()):(ma=tt,Ai="value"in ma?ma.value:ma.textContent,ya=!0)),Wt=fc(Be,Yt),0<Wt.length&&(Yt=new Cd(Yt,i,null,c,tt),nt.push({event:Yt,listeners:Wt}),Nt?Yt.data=Nt:(Nt=Ph(c),Nt!==null&&(Yt.data=Nt)))),(Nt=zh?Pd(i,c):Id(i,c))&&(Yt=fc(Be,"onBeforeInput"),0<Yt.length&&(Wt=new Cd("onBeforeInput","beforeinput",null,c,tt),nt.push({event:Wt,listeners:Yt}),Wt.data=Nt)),Bm(nt,i,Be,c,tt)}yl(nt,s)})}function hh(i,s,c){return{instance:i,listener:s,currentTarget:c}}function fc(i,s){for(var c=s+"Capture",p=[];i!==null;){var S=i,A=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||A===null||(S=Ha(i,c),S!=null&&p.unshift(hh(i,S,A)),S=Ha(i,s),S!=null&&p.push(hh(i,S,A))),i.tag===3)return p;i=i.return}return[]}function ru(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function bf(i,s,c,p,S){for(var A=s._reactName,Z=[];c!==null&&c!==p;){var K=c,me=K.alternate,Be=K.stateNode;if(K=K.tag,me!==null&&me===p)break;K!==5&&K!==26&&K!==27||Be===null||(me=Be,S?(Be=Ha(c,A),Be!=null&&Z.unshift(hh(c,Be,me))):S||(Be=Ha(c,A),Be!=null&&Z.push(hh(c,Be,me)))),c=c.return}Z.length!==0&&i.push({event:s,listeners:Z})}var jm=/\r\n?/g,Va=/\u0000|\uFFFD/g;function nu(i){return(typeof i=="string"?i:""+i).replace(jm,`
`).replace(Va,"")}function Rp(i,s){return s=nu(s),nu(i)===s}function hd(){}function Yi(i,s,c,p,S,A){switch(c){case"children":typeof p=="string"?s==="body"||s==="textarea"&&p===""||no(i,p):(typeof p=="number"||typeof p=="bigint")&&s!=="body"&&no(i,""+p);break;case"className":to(i,"class",p);break;case"tabIndex":to(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":to(i,c,p);break;case"style":Lo(i,p,A);break;case"data":if(s!=="object"){to(i,"data",p);break}case"src":case"href":if(p===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=ao(""+p),i.setAttribute(c,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(c==="formAction"?(s!=="input"&&Yi(i,s,"name",S.name,S,null),Yi(i,s,"formEncType",S.formEncType,S,null),Yi(i,s,"formMethod",S.formMethod,S,null),Yi(i,s,"formTarget",S.formTarget,S,null)):(Yi(i,s,"encType",S.encType,S,null),Yi(i,s,"method",S.method,S,null),Yi(i,s,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=ao(""+p),i.setAttribute(c,p);break;case"onClick":p!=null&&(i.onclick=hd);break;case"onScroll":p!=null&&_i("scroll",i);break;case"onScrollEnd":p!=null&&_i("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(T(61));if(c=p.__html,c!=null){if(S.children!=null)throw Error(T(60));i.innerHTML=c}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}c=ao(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""+p):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":p===!0?i.setAttribute(c,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,p):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(c,p):i.removeAttribute(c);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(c):i.setAttribute(c,p);break;case"popover":_i("beforetoggle",i),_i("toggle",i),Fi(i,"popover",p);break;case"xlinkActuate":Un(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Un(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Un(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Un(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Un(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Un(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Un(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Un(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Un(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Fi(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Oo.get(c)||c,Fi(i,c,p))}}function xf(i,s,c,p,S,A){switch(c){case"style":Lo(i,p,A);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(T(61));if(c=p.__html,c!=null){if(S.children!=null)throw Error(T(60));i.innerHTML=c}}break;case"children":typeof p=="string"?no(i,p):(typeof p=="number"||typeof p=="bigint")&&no(i,""+p);break;case"onScroll":p!=null&&_i("scroll",i);break;case"onScrollEnd":p!=null&&_i("scrollend",i);break;case"onClick":p!=null&&(i.onclick=hd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Al.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(S=c.endsWith("Capture"),s=c.slice(2,S?c.length-7:void 0),A=i[zt]||null,A=A!=null?A[c]:null,typeof A=="function"&&i.removeEventListener(s,A,S),typeof p=="function")){typeof A!="function"&&A!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,p,S);break e}c in i?i[c]=p:p===!0?i.setAttribute(c,""):Fi(i,c,p)}}}function Cn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_i("error",i),_i("load",i);var p=!1,S=!1,A;for(A in c)if(c.hasOwnProperty(A)){var Z=c[A];if(Z!=null)switch(A){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(T(137,s));default:Yi(i,s,A,Z,c,null)}}S&&Yi(i,s,"srcSet",c.srcSet,c,null),p&&Yi(i,s,"src",c.src,c,null);return;case"input":_i("invalid",i);var K=A=Z=S=null,me=null,Be=null;for(p in c)if(c.hasOwnProperty(p)){var tt=c[p];if(tt!=null)switch(p){case"name":S=tt;break;case"type":Z=tt;break;case"checked":me=tt;break;case"defaultChecked":Be=tt;break;case"value":A=tt;break;case"defaultValue":K=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(T(137,s));break;default:Yi(i,s,p,tt,c,null)}}ro(i,A,K,me,Be,Z,S,!1),yu(i);return;case"select":_i("invalid",i),p=Z=A=null;for(S in c)if(c.hasOwnProperty(S)&&(K=c[S],K!=null))switch(S){case"value":A=K;break;case"defaultValue":Z=K;break;case"multiple":p=K;default:Yi(i,s,S,K,c,null)}s=A,c=Z,i.multiple=!!p,s!=null?Pl(i,!!p,s,!1):c!=null&&Pl(i,!!p,c,!0);return;case"textarea":_i("invalid",i),A=S=p=null;for(Z in c)if(c.hasOwnProperty(Z)&&(K=c[Z],K!=null))switch(Z){case"value":p=K;break;case"defaultValue":S=K;break;case"children":A=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(T(91));break;default:Yi(i,s,Z,K,c,null)}Dl(i,p,S,A),yu(i);return;case"option":for(me in c)if(c.hasOwnProperty(me)&&(p=c[me],p!=null))switch(me){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Yi(i,s,me,p,c,null)}return;case"dialog":_i("beforetoggle",i),_i("toggle",i),_i("cancel",i),_i("close",i);break;case"iframe":case"object":_i("load",i);break;case"video":case"audio":for(p=0;p<ld.length;p++)_i(ld[p],i);break;case"image":_i("error",i),_i("load",i);break;case"details":_i("toggle",i);break;case"embed":case"source":case"link":_i("error",i),_i("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Be in c)if(c.hasOwnProperty(Be)&&(p=c[Be],p!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":throw Error(T(137,s));default:Yi(i,s,Be,p,c,null)}return;default:if(un(s)){for(tt in c)c.hasOwnProperty(tt)&&(p=c[tt],p!==void 0&&xf(i,s,tt,p,c,void 0));return}}for(K in c)c.hasOwnProperty(K)&&(p=c[K],p!=null&&Yi(i,s,K,p,c,null))}function Fm(i,s,c,p){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,A=null,Z=null,K=null,me=null,Be=null,tt=null;for(He in c){var nt=c[He];if(c.hasOwnProperty(He)&&nt!=null)switch(He){case"checked":break;case"value":break;case"defaultValue":me=nt;default:p.hasOwnProperty(He)||Yi(i,s,He,null,p,nt)}}for(var Ve in p){var He=p[Ve];if(nt=c[Ve],p.hasOwnProperty(Ve)&&(He!=null||nt!=null))switch(Ve){case"type":A=He;break;case"name":S=He;break;case"checked":Be=He;break;case"defaultChecked":tt=He;break;case"value":Z=He;break;case"defaultValue":K=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(T(137,s));break;default:He!==nt&&Yi(i,s,Ve,He,p,nt)}}vu(i,Z,K,me,Be,tt,A,S);return;case"select":He=Z=K=Ve=null;for(A in c)if(me=c[A],c.hasOwnProperty(A)&&me!=null)switch(A){case"value":break;case"multiple":He=me;default:p.hasOwnProperty(A)||Yi(i,s,A,null,p,me)}for(S in p)if(A=p[S],me=c[S],p.hasOwnProperty(S)&&(A!=null||me!=null))switch(S){case"value":Ve=A;break;case"defaultValue":K=A;break;case"multiple":Z=A;default:A!==me&&Yi(i,s,S,A,p,me)}s=K,c=Z,p=He,Ve!=null?Pl(i,!!c,Ve,!1):!!p!=!!c&&(s!=null?Pl(i,!!c,s,!0):Pl(i,!!c,c?[]:"",!1));return;case"textarea":He=Ve=null;for(K in c)if(S=c[K],c.hasOwnProperty(K)&&S!=null&&!p.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:Yi(i,s,K,null,p,S)}for(Z in p)if(S=p[Z],A=c[Z],p.hasOwnProperty(Z)&&(S!=null||A!=null))switch(Z){case"value":Ve=S;break;case"defaultValue":He=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(T(91));break;default:S!==A&&Yi(i,s,Z,S,p,A)}Il(i,Ve,He);return;case"option":for(var Kt in c)if(Ve=c[Kt],c.hasOwnProperty(Kt)&&Ve!=null&&!p.hasOwnProperty(Kt))switch(Kt){case"selected":i.selected=!1;break;default:Yi(i,s,Kt,null,p,Ve)}for(me in p)if(Ve=p[me],He=c[me],p.hasOwnProperty(me)&&Ve!==He&&(Ve!=null||He!=null))switch(me){case"selected":i.selected=Ve&&typeof Ve!="function"&&typeof Ve!="symbol";break;default:Yi(i,s,me,Ve,p,He)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xt in c)Ve=c[Xt],c.hasOwnProperty(Xt)&&Ve!=null&&!p.hasOwnProperty(Xt)&&Yi(i,s,Xt,null,p,Ve);for(Be in p)if(Ve=p[Be],He=c[Be],p.hasOwnProperty(Be)&&Ve!==He&&(Ve!=null||He!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":if(Ve!=null)throw Error(T(137,s));break;default:Yi(i,s,Be,Ve,p,He)}return;default:if(un(s)){for(var Ji in c)Ve=c[Ji],c.hasOwnProperty(Ji)&&Ve!==void 0&&!p.hasOwnProperty(Ji)&&xf(i,s,Ji,void 0,p,Ve);for(tt in p)Ve=p[tt],He=c[tt],!p.hasOwnProperty(tt)||Ve===He||Ve===void 0&&He===void 0||xf(i,s,tt,Ve,p,He);return}}for(var Ie in c)Ve=c[Ie],c.hasOwnProperty(Ie)&&Ve!=null&&!p.hasOwnProperty(Ie)&&Yi(i,s,Ie,null,p,Ve);for(nt in p)Ve=p[nt],He=c[nt],!p.hasOwnProperty(nt)||Ve===He||Ve==null&&He==null||Yi(i,s,nt,Ve,p,He)}var kp=null,wf=null;function Gs(i){return i.nodeType===9?i:i.ownerDocument}function Lp(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Op(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Tf(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Sf=null;function xg(){var i=window.event;return i&&i.type==="popstate"?i===Sf?!1:(Sf=i,!0):(Sf=null,!1)}var Um=typeof setTimeout=="function"?setTimeout:void 0,Nm=typeof clearTimeout=="function"?clearTimeout:void 0,dh=typeof Promise=="function"?Promise:void 0,Vm=typeof queueMicrotask=="function"?queueMicrotask:typeof dh<"u"?function(i){return dh.resolve(null).then(i).catch(Mf)}:Um;function Mf(i){setTimeout(function(){throw i})}function vl(i){return i==="head"}function dd(i,s){var c=s,p=0,S=0;do{var A=c.nextSibling;if(i.removeChild(c),A&&A.nodeType===8)if(c=A.data,c==="/$"){if(0<p&&8>p){c=p;var Z=i.ownerDocument;if(c&1&&ph(Z.documentElement),c&2&&ph(Z.body),c&4)for(c=Z.head,ph(c),Z=c.firstChild;Z;){var K=Z.nextSibling,me=Z.nodeName;Z[Je]||me==="SCRIPT"||me==="STYLE"||me==="LINK"&&Z.rel.toLowerCase()==="stylesheet"||c.removeChild(Z),Z=K}}if(S===0){i.removeChild(A),fr(s);return}S--}else c==="$"||c==="$?"||c==="$!"?S++:p=c.charCodeAt(0)-48;else p=0;c=A}while(c);fr(s)}function fh(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":fh(c),Ft(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function Ef(i,s,c,p){for(;i.nodeType===1;){var S=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Je])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(A=i.getAttribute("rel"),A==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(A!==S.rel||i.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||i.getAttribute("title")!==(S.title==null?null:S.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(A=i.getAttribute("src"),(A!==(S.src==null?null:S.src)||i.getAttribute("type")!==(S.type==null?null:S.type)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&A&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var A=S.name==null?null:""+S.name;if(S.type==="hidden"&&i.getAttribute("name")===A)return i}else return i;if(i=Hn(i.nextSibling),i===null)break}return null}function wg(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Hn(i.nextSibling),i===null))return null;return i}function Bp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function Tg(i,s){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")s();else{var p=function(){s(),c.removeEventListener("DOMContentLoaded",p)};c.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Hn(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var sn=null;function bl(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function Cf(i,s,c){switch(s=Gs(c),i){case"html":if(i=s.documentElement,!i)throw Error(T(452));return i;case"head":if(i=s.head,!i)throw Error(T(453));return i;case"body":if(i=s.body,!i)throw Error(T(454));return i;default:throw Error(T(451))}}function ph(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Ft(i)}var Za=new Map,Af=new Set;function zf(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Co=We.d;We.d={f:Zm,r:Sg,D:jp,C:qm,L:fd,m:Fp,X:Up,S:$m,M:If};function Zm(){var i=Co.f(),s=En();return i||s}function Sg(i){var s=ji(i);s!==null&&s.tag===5&&s.type==="form"?Os(s):Co.r(i)}var au=typeof document>"u"?null:document;function Pf(i,s,c){var p=au;if(p&&typeof s=="string"&&s){var S=Vn(s);S='link[rel="'+i+'"][href="'+S+'"]',typeof c=="string"&&(S+='[crossorigin="'+c+'"]'),Af.has(S)||(Af.add(S),i={rel:i,crossOrigin:c,href:s},p.querySelector(S)===null&&(s=p.createElement("link"),Cn(s,"link",i),Lt(s),p.head.appendChild(s)))}}function jp(i){Co.D(i),Pf("dns-prefetch",i,null)}function qm(i,s){Co.C(i,s),Pf("preconnect",i,s)}function fd(i,s,c){Co.L(i,s,c);var p=au;if(p&&i&&s){var S='link[rel="preload"][as="'+Vn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(S+='[imagesrcset="'+Vn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(S+='[imagesizes="'+Vn(c.imageSizes)+'"]')):S+='[href="'+Vn(i)+'"]';var A=S;switch(s){case"style":A=pc(i);break;case"script":A=a(i)}Za.has(A)||(i=ve({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Za.set(A,i),p.querySelector(S)!==null||s==="style"&&p.querySelector(su(A))||s==="script"&&p.querySelector(t(A))||(s=p.createElement("link"),Cn(s,"link",i),Lt(s),p.head.appendChild(s)))}}function Fp(i,s){Co.m(i,s);var c=au;if(c&&i){var p=s&&typeof s.as=="string"?s.as:"script",S='link[rel="modulepreload"][as="'+Vn(p)+'"][href="'+Vn(i)+'"]',A=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=a(i)}if(!Za.has(A)&&(i=ve({rel:"modulepreload",href:i},s),Za.set(A,i),c.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(t(A)))return}p=c.createElement("link"),Cn(p,"link",i),Lt(p),c.head.appendChild(p)}}}function $m(i,s,c){Co.S(i,s,c);var p=au;if(p&&i){var S=$r(p).hoistableStyles,A=pc(i);s=s||"default";var Z=S.get(A);if(!Z){var K={loading:0,preload:null};if(Z=p.querySelector(su(A)))K.loading=5;else{i=ve({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Za.get(A))&&d(i,c);var me=Z=p.createElement("link");Lt(me),Cn(me,"link",i),me._p=new Promise(function(Be,tt){me.onload=Be,me.onerror=tt}),me.addEventListener("load",function(){K.loading|=1}),me.addEventListener("error",function(){K.loading|=2}),K.loading|=4,o(Z,s,p)}Z={type:"stylesheet",instance:Z,count:1,state:K},S.set(A,Z)}}}function Up(i,s){Co.X(i,s);var c=au;if(c&&i){var p=$r(c).hoistableScripts,S=a(i),A=p.get(S);A||(A=c.querySelector(t(S)),A||(i=ve({src:i,async:!0},s),(s=Za.get(S))&&g(i,s),A=c.createElement("script"),Lt(A),Cn(A,"link",i),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(S,A))}}function If(i,s){Co.M(i,s);var c=au;if(c&&i){var p=$r(c).hoistableScripts,S=a(i),A=p.get(S);A||(A=c.querySelector(t(S)),A||(i=ve({src:i,async:!0,type:"module"},s),(s=Za.get(S))&&g(i,s),A=c.createElement("script"),Lt(A),Cn(A,"link",i),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(S,A))}}function mh(i,s,c,p){var S=(S=It.current)?zf(S):null;if(!S)throw Error(T(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=pc(c.href),c=$r(S).hoistableStyles,p=c.get(s),p||(p={type:"style",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=pc(c.href);var A=$r(S).hoistableStyles,Z=A.get(i);if(Z||(S=S.ownerDocument||S,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(i,Z),(A=S.querySelector(su(i)))&&!A._p&&(Z.instance=A,Z.state.loading=5),Za.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Za.set(i,c),A||Mg(S,i,c,Z.state))),s&&p===null)throw Error(T(528,""));return Z}if(s&&p!==null)throw Error(T(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=a(c),c=$r(S).hoistableScripts,p=c.get(s),p||(p={type:"script",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(T(444,i))}}function pc(i){return'href="'+Vn(i)+'"'}function su(i){return'link[rel="stylesheet"]['+i+"]"}function Df(i){return ve({},i,{"data-precedence":i.precedence,precedence:null})}function Mg(i,s,c,p){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?p.loading=1:(s=i.createElement("link"),p.preload=s,s.addEventListener("load",function(){return p.loading|=1}),s.addEventListener("error",function(){return p.loading|=2}),Cn(s,"link",c),Lt(s),i.head.appendChild(s))}function a(i){return'[src="'+Vn(i)+'"]'}function t(i){return"script[async]"+i}function n(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var p=i.querySelector('style[data-href~="'+Vn(c.href)+'"]');if(p)return s.instance=p,Lt(p),p;var S=ve({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Lt(p),Cn(p,"style",S),o(p,c.precedence,i),s.instance=p;case"stylesheet":S=pc(c.href);var A=i.querySelector(su(S));if(A)return s.state.loading|=4,s.instance=A,Lt(A),A;p=Df(c),(S=Za.get(S))&&d(p,S),A=(i.ownerDocument||i).createElement("link"),Lt(A);var Z=A;return Z._p=new Promise(function(K,me){Z.onload=K,Z.onerror=me}),Cn(A,"link",p),s.state.loading|=4,o(A,c.precedence,i),s.instance=A;case"script":return A=a(c.src),(S=i.querySelector(t(A)))?(s.instance=S,Lt(S),S):(p=c,(S=Za.get(A))&&(p=ve({},c),g(p,S)),i=i.ownerDocument||i,S=i.createElement("script"),Lt(S),Cn(S,"link",p),i.head.appendChild(S),s.instance=S);case"void":return null;default:throw Error(T(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(p=s.instance,s.state.loading|=4,o(p,c.precedence,i));return s.instance}function o(i,s,c){for(var p=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,A=S,Z=0;Z<p.length;Z++){var K=p[Z];if(K.dataset.precedence===s)A=K;else if(A!==S)break}A?A.parentNode.insertBefore(i,A.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function d(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function g(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var _=null;function w(i,s,c){if(_===null){var p=new Map,S=_=new Map;S.set(c,p)}else S=_,p=S.get(c),p||(p=new Map,S.set(c,p));if(p.has(i))return p;for(p.set(i,null),c=c.getElementsByTagName(i),S=0;S<c.length;S++){var A=c[S];if(!(A[Je]||A[kt]||i==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=A.getAttribute(s)||"";Z=i+Z;var K=p.get(Z);K?K.push(A):p.set(Z,[A])}}return p}function E(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function P(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function D(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var O=null;function U(){}function V(i,s,c){if(O===null)throw Error(T(475));var p=O;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var S=pc(c.href),A=i.querySelector(su(S));if(A){i=A._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=H.bind(p),i.then(p,p)),s.state.loading|=4,s.instance=A,Lt(A);return}A=i.ownerDocument||i,c=Df(c),(S=Za.get(S))&&d(c,S),A=A.createElement("link"),Lt(A);var Z=A;Z._p=new Promise(function(K,me){Z.onload=K,Z.onerror=me}),Cn(A,"link",c),s.instance=A}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(p.count++,s=H.bind(p),i.addEventListener("load",s),i.addEventListener("error",s))}}function q(){if(O===null)throw Error(T(475));var i=O;return i.stylesheets&&i.count===0&&se(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&se(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function H(){if(this.count--,this.count===0){if(this.stylesheets)se(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var J=null;function se(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,J=new Map,s.forEach(ye,i),J=null,H.call(i))}function ye(i,s){if(!(s.state.loading&4)){var c=J.get(i);if(c)var p=c.get(null);else{c=new Map,J.set(i,c);for(var S=i.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<S.length;A++){var Z=S[A];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(c.set(Z.dataset.precedence,Z),p=Z)}p&&c.set(null,p)}S=s.instance,Z=S.getAttribute("data-precedence"),A=c.get(Z)||p,A===p&&c.set(null,S),c.set(Z,S),this.count++,p=H.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),A?A.parentNode.insertBefore(S,A.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(S,i.firstChild)),s.state.loading|=4}}var le={$$typeof:Tt,Provider:null,Consumer:null,_currentValue:Ge,_currentValue2:Ge,_threadCount:0};function N(i,s,c,p,S,A,Z,K){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ee(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ee(0),this.hiddenUpdates=ee(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=A,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function W(i,s,c,p,S,A,Z,K,me,Be,tt,nt){return i=new N(i,s,c,Z,K,me,Be,nt),s=1,A===!0&&(s|=24),A=Rn(3,null,null,s),i.current=A,A.stateNode=i,s=mo(),s.refCount++,i.pooledCache=s,s.refCount++,A.memoizedState={element:p,isDehydrated:c,cache:s},Vu(A),i}function de(i){return i?(i=Ms,i):Ms}function Le(i,s,c,p,S,A){S=de(S),p.context===null?p.context=S:p.pendingContext=S,p=ns(s),p.payload={element:c},A=A===void 0?null:A,A!==null&&(p.callback=A),c=Oa(i,p,s),c!==null&&(Na(c,i,s),Ds(c,i,s))}function rt(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Fe(i,s){rt(i,s),(i=i.alternate)&&rt(i,s)}function Xe(i){if(i.tag===13){var s=Wo(i,67108864);s!==null&&Na(s,i,67108864),Fe(i,67108864)}}var ot=!0;function at(i,s,c,p){var S=we.T;we.T=null;var A=We.p;try{We.p=2,Qe(i,s,c,p)}finally{We.p=A,we.T=S}}function ct(i,s,c,p){var S=we.T;we.T=null;var A=We.p;try{We.p=8,Qe(i,s,c,p)}finally{We.p=A,we.T=S}}function Qe(i,s,c,p){if(ot){var S=wt(p);if(S===null)ud(i,s,p,Dt,c),Yr(i,p);else if(pn(S,i,s,c,p))p.stopPropagation();else if(Yr(i,p),s&4&&-1<dr.indexOf(i)){for(;S!==null;){var A=ji(S);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var Z=Ce(A.pendingLanes);if(Z!==0){var K=A;for(K.pendingLanes|=2,K.entangledLanes|=2;Z;){var me=1<<31-kr(Z);K.entanglements[1]|=me,Z&=~me}ps(A),(Hi&6)===0&&(af=Rr()+500,iu(0))}}break;case 13:K=Wo(A,2),K!==null&&Na(K,A,2),En(),Fe(A,2)}if(A=wt(p),A===null&&ud(i,s,p,Dt,c),A===S)break;S=A}S!==null&&p.stopPropagation()}else ud(i,s,p,null,c)}}function wt(i){return i=so(i),Pt(i)}var Dt=null;function Pt(i){if(Dt=null,i=Gt(i),i!==null){var s=F(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=z(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Dt=i,null}function Mt(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wc()){case Ml:return 2;case Fn:return 8;case Qn:case Io:return 32;case Ws:return 268435456;default:return 32}default:return 32}}var ni=!1,Ii=null,Wi=null,vr=null,On=new Map,fn=new Map,hr=[],dr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Yr(i,s){switch(i){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":vr=null;break;case"pointerover":case"pointerout":On.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":fn.delete(s.pointerId)}}function Fr(i,s,c,p,S,A){return i===null||i.nativeEvent!==A?(i={blockedOn:s,domEventName:c,eventSystemFlags:p,nativeEvent:A,targetContainers:[S]},s!==null&&(s=ji(s),s!==null&&Xe(s)),i):(i.eventSystemFlags|=p,s=i.targetContainers,S!==null&&s.indexOf(S)===-1&&s.push(S),i)}function pn(i,s,c,p,S){switch(s){case"focusin":return Ii=Fr(Ii,i,s,c,p,S),!0;case"dragenter":return Wi=Fr(Wi,i,s,c,p,S),!0;case"mouseover":return vr=Fr(vr,i,s,c,p,S),!0;case"pointerover":var A=S.pointerId;return On.set(A,Fr(On.get(A)||null,i,s,c,p,S)),!0;case"gotpointercapture":return A=S.pointerId,fn.set(A,Fr(fn.get(A)||null,i,s,c,p,S)),!0}return!1}function Bn(i){var s=Gt(i.target);if(s!==null){var c=F(s);if(c!==null){if(s=c.tag,s===13){if(s=z(c),s!==null){i.blockedOn=s,_t(i.priority,function(){if(c.tag===13){var p=da();p=Ae(p);var S=Wo(c,p);S!==null&&Na(S,c,p),Fe(c,p)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Xn(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=wt(i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);Bo=p,c.target.dispatchEvent(p),Bo=null}else return s=ji(c),s!==null&&Xe(s),i.blockedOn=c,!1;s.shift()}return!0}function Qr(i,s,c){Xn(i)&&c.delete(s)}function fa(){ni=!1,Ii!==null&&Xn(Ii)&&(Ii=null),Wi!==null&&Xn(Wi)&&(Wi=null),vr!==null&&Xn(vr)&&(vr=null),On.forEach(Qr),fn.forEach(Qr)}function Ir(i,s){i.blockedOn===s&&(i.blockedOn=null,ni||(ni=!0,v.unstable_scheduleCallback(v.unstable_NormalPriority,fa)))}var Ur=null;function Kr(i){Ur!==i&&(Ur=i,v.unstable_scheduleCallback(v.unstable_NormalPriority,function(){Ur===i&&(Ur=null);for(var s=0;s<i.length;s+=3){var c=i[s],p=i[s+1],S=i[s+2];if(typeof p!="function"){if(Pt(p||c)===null)continue;break}var A=ji(c);A!==null&&(i.splice(s,3),s-=3,ls(A,{pending:!0,data:S,method:c.method,action:p},p,S))}}))}function fr(i){function s(me){return Ir(me,i)}Ii!==null&&Ir(Ii,i),Wi!==null&&Ir(Wi,i),vr!==null&&Ir(vr,i),On.forEach(s),fn.forEach(s);for(var c=0;c<hr.length;c++){var p=hr[c];p.blockedOn===i&&(p.blockedOn=null)}for(;0<hr.length&&(c=hr[0],c.blockedOn===null);)Bn(c),c.blockedOn===null&&hr.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(p=0;p<c.length;p+=3){var S=c[p],A=c[p+1],Z=S[zt]||null;if(typeof A=="function")Z||Kr(c);else if(Z){var K=null;if(A&&A.hasAttribute("formAction")){if(S=A,Z=A[zt]||null)K=Z.formAction;else if(Pt(S)!==null)continue}else K=Z.action;typeof K=="function"?c[p+1]=K:(c.splice(p,3),p-=3),Kr(c)}}}function Zi(i){this._internalRoot=i}Ma.prototype.render=Zi.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(T(409));var c=s.current,p=da();Le(c,p,i,s,null,null)},Ma.prototype.unmount=Zi.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Le(i.current,2,null,i,null,null),En(),s[qe]=null}};function Ma(i){this._internalRoot=i}Ma.prototype.unstable_scheduleHydration=function(i){if(i){var s=ft();i={blockedOn:null,target:i,priority:s};for(var c=0;c<hr.length&&s!==0&&s<hr[c].priority;c++);hr.splice(c,0,i),c===0&&Bn(i)}};var ou=y.version;if(ou!=="19.1.0")throw Error(T(527,ou,"19.1.0"));We.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(T(188)):(i=Object.keys(i).join(","),Error(T(268,i)));return i=oe(s),i=i!==null?Q(i):null,i=i===null?null:i.stateNode,i};var Hs={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:we,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rf.isDisabled&&Rf.supportsFiber)try{$a=Rf.inject(Hs),Wr=Rf}catch{}}return Vp.createRoot=function(i,s){if(!R(i))throw Error(T(299));var c=!1,p="",S=pm,A=Vd,Z=tp,K=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onUncaughtError!==void 0&&(S=s.onUncaughtError),s.onCaughtError!==void 0&&(A=s.onCaughtError),s.onRecoverableError!==void 0&&(Z=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(K=s.unstable_transitionCallbacks)),s=W(i,1,!1,null,null,c,p,S,A,Z,K,null),i[qe]=s.current,vf(i),new Zi(s)},Vp.hydrateRoot=function(i,s,c){if(!R(i))throw Error(T(299));var p=!1,S="",A=pm,Z=Vd,K=tp,me=null,Be=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(S=c.identifierPrefix),c.onUncaughtError!==void 0&&(A=c.onUncaughtError),c.onCaughtError!==void 0&&(Z=c.onCaughtError),c.onRecoverableError!==void 0&&(K=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(me=c.unstable_transitionCallbacks),c.formState!==void 0&&(Be=c.formState)),s=W(i,1,!0,s,c??null,p,S,A,Z,K,me,Be),s.context=de(null),c=s.current,p=da(),p=Ae(p),S=ns(p),S.callback=null,Oa(c,S,p),c=p,s.current.lanes=c,Re(s,c),ps(s),i[qe]=s.current,vf(i),new Ma(s)},Vp.version="19.1.0",Vp}var z_;function u0(){if(z_)return Ag.exports;z_=1;function v(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v)}catch(y){console.error(y)}}return v(),Ag.exports=c0(),Ag.exports}var h0=u0(),Hm={exports:{}},d0=Hm.exports,P_;function f0(){return P_||(P_=1,function(v,y){(function(b,T){v.exports=T()})(d0,function(){var b=1e3,T=6e4,R=36e5,F="millisecond",z="second",u="minute",oe="hour",Q="day",ve="week",Te="month",Ee="quarter",ne="year",Pe="date",Ze="Invalid Date",bt=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Vt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Ot={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Et){var pt=["th","st","nd","rd"],we=Et%100;return"["+Et+(pt[(we-20)%10]||pt[we]||pt[0])+"]"}},Tt=function(Et,pt,we){var We=String(Et);return!We||We.length>=pt?Et:""+Array(pt+1-We.length).join(we)+Et},qt={s:Tt,z:function(Et){var pt=-Et.utcOffset(),we=Math.abs(pt),We=Math.floor(we/60),Ge=we%60;return(pt<=0?"+":"-")+Tt(We,2,"0")+":"+Tt(Ge,2,"0")},m:function Et(pt,we){if(pt.date()<we.date())return-Et(we,pt);var We=12*(we.year()-pt.year())+(we.month()-pt.month()),Ge=pt.clone().add(We,Te),gt=we-Ge<0,ue=pt.clone().add(We+(gt?-1:1),Te);return+(-(We+(we-Ge)/(gt?Ge-ue:ue-Ge))||0)},a:function(Et){return Et<0?Math.ceil(Et)||0:Math.floor(Et)},p:function(Et){return{M:Te,y:ne,w:ve,d:Q,D:Pe,h:oe,m:u,s:z,ms:F,Q:Ee}[Et]||String(Et||"").toLowerCase().replace(/s$/,"")},u:function(Et){return Et===void 0}},xt="en",Bt={};Bt[xt]=Ot;var Pi="$isDayjsObject",ti=function(Et){return Et instanceof wi||!(!Et||!Et[Pi])},Oi=function Et(pt,we,We){var Ge;if(!pt)return xt;if(typeof pt=="string"){var gt=pt.toLowerCase();Bt[gt]&&(Ge=gt),we&&(Bt[gt]=we,Ge=gt);var ue=pt.split("-");if(!Ge&&ue.length>1)return Et(ue[0])}else{var Ke=pt.name;Bt[Ke]=pt,Ge=Ke}return!We&&Ge&&(xt=Ge),Ge||!We&&xt},Mi=function(Et,pt){if(ti(Et))return Et.clone();var we=typeof pt=="object"?pt:{};return we.date=Et,we.args=arguments,new wi(we)},Ut=qt;Ut.l=Oi,Ut.i=ti,Ut.w=function(Et,pt){return Mi(Et,{locale:pt.$L,utc:pt.$u,x:pt.$x,$offset:pt.$offset})};var wi=function(){function Et(we){this.$L=Oi(we.locale,null,!0),this.parse(we),this.$x=this.$x||we.x||{},this[Pi]=!0}var pt=Et.prototype;return pt.parse=function(we){this.$d=function(We){var Ge=We.date,gt=We.utc;if(Ge===null)return new Date(NaN);if(Ut.u(Ge))return new Date;if(Ge instanceof Date)return new Date(Ge);if(typeof Ge=="string"&&!/Z$/i.test(Ge)){var ue=Ge.match(bt);if(ue){var Ke=ue[2]-1||0,lt=(ue[7]||"0").substring(0,3);return gt?new Date(Date.UTC(ue[1],Ke,ue[3]||1,ue[4]||0,ue[5]||0,ue[6]||0,lt)):new Date(ue[1],Ke,ue[3]||1,ue[4]||0,ue[5]||0,ue[6]||0,lt)}}return new Date(Ge)}(we),this.init()},pt.init=function(){var we=this.$d;this.$y=we.getFullYear(),this.$M=we.getMonth(),this.$D=we.getDate(),this.$W=we.getDay(),this.$H=we.getHours(),this.$m=we.getMinutes(),this.$s=we.getSeconds(),this.$ms=we.getMilliseconds()},pt.$utils=function(){return Ut},pt.isValid=function(){return this.$d.toString()!==Ze},pt.isSame=function(we,We){var Ge=Mi(we);return this.startOf(We)<=Ge&&Ge<=this.endOf(We)},pt.isAfter=function(we,We){return Mi(we)<this.startOf(We)},pt.isBefore=function(we,We){return this.endOf(We)<Mi(we)},pt.$g=function(we,We,Ge){return Ut.u(we)?this[We]:this.set(Ge,we)},pt.unix=function(){return Math.floor(this.valueOf()/1e3)},pt.valueOf=function(){return this.$d.getTime()},pt.startOf=function(we,We){var Ge=this,gt=!!Ut.u(We)||We,ue=Ut.p(we),Ke=function(er,lr){var Bi=Ut.w(Ge.$u?Date.UTC(Ge.$y,lr,er):new Date(Ge.$y,lr,er),Ge);return gt?Bi:Bi.endOf(Q)},lt=function(er,lr){return Ut.w(Ge.toDate()[er].apply(Ge.toDate("s"),(gt?[0,0,0,0]:[23,59,59,999]).slice(lr)),Ge)},ut=this.$W,vt=this.$M,Ct=this.$D,It="set"+(this.$u?"UTC":"");switch(ue){case ne:return gt?Ke(1,0):Ke(31,11);case Te:return gt?Ke(1,vt):Ke(0,vt+1);case ve:var di=this.$locale().weekStart||0,li=(ut<di?ut+7:ut)-di;return Ke(gt?Ct-li:Ct+(6-li),vt);case Q:case Pe:return lt(It+"Hours",0);case oe:return lt(It+"Minutes",1);case u:return lt(It+"Seconds",2);case z:return lt(It+"Milliseconds",3);default:return this.clone()}},pt.endOf=function(we){return this.startOf(we,!1)},pt.$set=function(we,We){var Ge,gt=Ut.p(we),ue="set"+(this.$u?"UTC":""),Ke=(Ge={},Ge[Q]=ue+"Date",Ge[Pe]=ue+"Date",Ge[Te]=ue+"Month",Ge[ne]=ue+"FullYear",Ge[oe]=ue+"Hours",Ge[u]=ue+"Minutes",Ge[z]=ue+"Seconds",Ge[F]=ue+"Milliseconds",Ge)[gt],lt=gt===Q?this.$D+(We-this.$W):We;if(gt===Te||gt===ne){var ut=this.clone().set(Pe,1);ut.$d[Ke](lt),ut.init(),this.$d=ut.set(Pe,Math.min(this.$D,ut.daysInMonth())).$d}else Ke&&this.$d[Ke](lt);return this.init(),this},pt.set=function(we,We){return this.clone().$set(we,We)},pt.get=function(we){return this[Ut.p(we)]()},pt.add=function(we,We){var Ge,gt=this;we=Number(we);var ue=Ut.p(We),Ke=function(vt){var Ct=Mi(gt);return Ut.w(Ct.date(Ct.date()+Math.round(vt*we)),gt)};if(ue===Te)return this.set(Te,this.$M+we);if(ue===ne)return this.set(ne,this.$y+we);if(ue===Q)return Ke(1);if(ue===ve)return Ke(7);var lt=(Ge={},Ge[u]=T,Ge[oe]=R,Ge[z]=b,Ge)[ue]||1,ut=this.$d.getTime()+we*lt;return Ut.w(ut,this)},pt.subtract=function(we,We){return this.add(-1*we,We)},pt.format=function(we){var We=this,Ge=this.$locale();if(!this.isValid())return Ge.invalidDate||Ze;var gt=we||"YYYY-MM-DDTHH:mm:ssZ",ue=Ut.z(this),Ke=this.$H,lt=this.$m,ut=this.$M,vt=Ge.weekdays,Ct=Ge.months,It=Ge.meridiem,di=function(lr,Bi,cr,tr){return lr&&(lr[Bi]||lr(We,gt))||cr[Bi].slice(0,tr)},li=function(lr){return Ut.s(Ke%12||12,lr,"0")},er=It||function(lr,Bi,cr){var tr=lr<12?"AM":"PM";return cr?tr.toLowerCase():tr};return gt.replace(Vt,function(lr,Bi){return Bi||function(cr){switch(cr){case"YY":return String(We.$y).slice(-2);case"YYYY":return Ut.s(We.$y,4,"0");case"M":return ut+1;case"MM":return Ut.s(ut+1,2,"0");case"MMM":return di(Ge.monthsShort,ut,Ct,3);case"MMMM":return di(Ct,ut);case"D":return We.$D;case"DD":return Ut.s(We.$D,2,"0");case"d":return String(We.$W);case"dd":return di(Ge.weekdaysMin,We.$W,vt,2);case"ddd":return di(Ge.weekdaysShort,We.$W,vt,3);case"dddd":return vt[We.$W];case"H":return String(Ke);case"HH":return Ut.s(Ke,2,"0");case"h":return li(1);case"hh":return li(2);case"a":return er(Ke,lt,!0);case"A":return er(Ke,lt,!1);case"m":return String(lt);case"mm":return Ut.s(lt,2,"0");case"s":return String(We.$s);case"ss":return Ut.s(We.$s,2,"0");case"SSS":return Ut.s(We.$ms,3,"0");case"Z":return ue}return null}(lr)||ue.replace(":","")})},pt.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},pt.diff=function(we,We,Ge){var gt,ue=this,Ke=Ut.p(We),lt=Mi(we),ut=(lt.utcOffset()-this.utcOffset())*T,vt=this-lt,Ct=function(){return Ut.m(ue,lt)};switch(Ke){case ne:gt=Ct()/12;break;case Te:gt=Ct();break;case Ee:gt=Ct()/3;break;case ve:gt=(vt-ut)/6048e5;break;case Q:gt=(vt-ut)/864e5;break;case oe:gt=vt/R;break;case u:gt=vt/T;break;case z:gt=vt/b;break;default:gt=vt}return Ge?gt:Ut.a(gt)},pt.daysInMonth=function(){return this.endOf(Te).$D},pt.$locale=function(){return Bt[this.$L]},pt.locale=function(we,We){if(!we)return this.$L;var Ge=this.clone(),gt=Oi(we,We,!0);return gt&&(Ge.$L=gt),Ge},pt.clone=function(){return Ut.w(this.$d,this)},pt.toDate=function(){return new Date(this.valueOf())},pt.toJSON=function(){return this.isValid()?this.toISOString():null},pt.toISOString=function(){return this.$d.toISOString()},pt.toString=function(){return this.$d.toUTCString()},Et}(),xr=wi.prototype;return Mi.prototype=xr,[["$ms",F],["$s",z],["$m",u],["$H",oe],["$W",Q],["$M",Te],["$y",ne],["$D",Pe]].forEach(function(Et){xr[Et[1]]=function(pt){return this.$g(pt,Et[0],Et[1])}}),Mi.extend=function(Et,pt){return Et.$i||(Et(pt,wi,Mi),Et.$i=!0),Mi},Mi.locale=Oi,Mi.isDayjs=ti,Mi.unix=function(Et){return Mi(1e3*Et)},Mi.en=Bt[xt],Mi.Ls=Bt,Mi.p={},Mi})}(Hm)),Hm.exports}var p0=f0();const m0=t0(p0),I_=[{name:"Sonic Drive-In",location:"https://maps.app.goo.gl/o9RWvygRVQxyBPJp7",durability:2,absorbency:1,texture:3,size:1,effectiveness:2,appearance:2,notes:"These napkins are not good!",date:"2025-05-12"},{name:"SECOND example",location:"https://maps.app.goo.gl/o9RWvygRVQxyBPJp7",durability:4,absorbency:4,texture:2,size:3,effectiveness:4,appearance:3,notes:"These napkins are not good!",date:"2025-05-12"},{name:"JM's Example 3",location:"https://maps.app.goo.gl/o9RWvygRVQxyBPJp7",durability:2,absorbency:3,texture:1,size:2,effectiveness:1,appearance:3,notes:"These napkins are just 'meh'",date:"2025-05-14"}],g0="modulepreload",_0=function(v){return"/"+v},D_={},uy=function(y,b,T){let R=Promise.resolve();if(b&&b.length>0){let z=function(Q){return Promise.all(Q.map(ve=>Promise.resolve(ve).then(Te=>({status:"fulfilled",value:Te}),Te=>({status:"rejected",reason:Te}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),oe=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));R=z(b.map(Q=>{if(Q=_0(Q),Q in D_)return;D_[Q]=!0;const ve=Q.endsWith(".css"),Te=ve?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Q}"]${Te}`))return;const Ee=document.createElement("link");if(Ee.rel=ve?"stylesheet":g0,ve||(Ee.as="script"),Ee.crossOrigin="",Ee.href=Q,oe&&Ee.setAttribute("nonce",oe),document.head.appendChild(Ee),ve)return new Promise((ne,Pe)=>{Ee.addEventListener("load",ne),Ee.addEventListener("error",()=>Pe(new Error(`Unable to preload CSS for ${Q}`)))})}))}function F(z){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=z,window.dispatchEvent(u),!u.defaultPrevented)throw z}return R.then(z=>{for(const u of z||[])u.status==="rejected"&&F(u.reason);return y().catch(F)})},hy=!(typeof navigator>"u")&&navigator.product==="ReactNative",dy={timeout:hy?6e4:12e4},y0=function(v){const y={...dy,...typeof v=="string"?{url:v}:v};if(y.timeout=fy(y.timeout),y.query){const{url:b,searchParams:T}=function(R){const F=R.indexOf("?");if(F===-1)return{url:R,searchParams:new URLSearchParams};const z=R.slice(0,F),u=R.slice(F+1);if(!hy)return{url:z,searchParams:new URLSearchParams(u)};if(typeof decodeURIComponent!="function")throw new Error("Broken `URLSearchParams` implementation, and `decodeURIComponent` is not defined");const oe=new URLSearchParams;for(const Q of u.split("&")){const[ve,Te]=Q.split("=");ve&&oe.append(R_(ve),R_(Te||""))}return{url:z,searchParams:oe}}(y.url);for(const[R,F]of Object.entries(y.query)){if(F!==void 0)if(Array.isArray(F))for(const u of F)T.append(R,u);else T.append(R,F);const z=T.toString();z&&(y.url=`${b}?${z}`)}}return y.method=y.body&&!y.method?"POST":(y.method||"GET").toUpperCase(),y};function R_(v){return decodeURIComponent(v.replace(/\+/g," "))}function fy(v){if(v===!1||v===0)return!1;if(v.connect||v.socket)return v;const y=Number(v);return isNaN(y)?fy(dy.timeout):{connect:y,socket:y}}const v0=/^https?:\/\//i,b0=function(v){if(!v0.test(v.url))throw new Error(`"${v.url}" is not a valid URL`)};function py(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}const x0=["request","response","progress","error","abort"],k_=["processOptions","validateOptions","interceptRequest","finalizeOptions","onRequest","onResponse","onError","onReturn","onHeaders"];function my(v,y){const b=[],T=k_.reduce((F,z)=>(F[z]=F[z]||[],F),{processOptions:[y0],validateOptions:[b0]});function R(F){const z=x0.reduce((ne,Pe)=>(ne[Pe]=function(){const Ze=Object.create(null);let bt=0;return{publish:function(Vt){for(const Ot in Ze)Ze[Ot](Vt)},subscribe:function(Vt){const Ot=bt++;return Ze[Ot]=Vt,function(){delete Ze[Ot]}}}}(),ne),{}),u=(ne=>function(Pe,Ze,...bt){const Vt=Pe==="onError";let Ot=Ze;for(let Tt=0;Tt<ne[Pe].length&&(Ot=(0,ne[Pe][Tt])(Ot,...bt),!Vt||Ot);Tt++);return Ot})(T),oe=u("processOptions",F);u("validateOptions",oe);const Q={options:oe,channels:z,applyMiddleware:u};let ve;const Te=z.request.subscribe(ne=>{ve=y(ne,(Pe,Ze)=>((bt,Vt,Ot)=>{let Tt=bt,qt=Vt;if(!Tt)try{qt=u("onResponse",Vt,Ot)}catch(xt){qt=null,Tt=xt}Tt=Tt&&u("onError",Tt,Ot),Tt?z.error.publish(Tt):qt&&z.response.publish(qt)})(Pe,Ze,ne))});z.abort.subscribe(()=>{Te(),ve&&ve.abort()});const Ee=u("onReturn",z,Q);return Ee===z&&z.request.publish(Q),Ee}return R.use=function(F){if(!F)throw new Error("Tried to add middleware that resolved to falsey value");if(typeof F=="function")throw new Error("Tried to add middleware that was a function. It probably expects you to pass options to it.");if(F.onReturn&&T.onReturn.length>0)throw new Error("Tried to add new middleware with `onReturn` handler, but another handler has already been registered for this event");return k_.forEach(z=>{F[z]&&T[z].push(F[z])}),b.push(F),R},R.clone=()=>my(b,y),v.forEach(R.use),R}var L_,O_,w0=py(function(){if(O_)return L_;O_=1;var v=function(y){return y.replace(/^\s+|\s+$/g,"")};return L_=function(y){if(!y)return{};for(var b={},T=v(y).split(`
`),R=0;R<T.length;R++){var F=T[R],z=F.indexOf(":"),u=v(F.slice(0,z)).toLowerCase(),oe=v(F.slice(z+1));typeof b[u]>"u"?b[u]=oe:(Q=b[u],Object.prototype.toString.call(Q)==="[object Array]"?b[u].push(oe):b[u]=[b[u],oe])}var Q;return b}}()),Xp,Yp,jf,Qp,lu,Kp,Wp,cy;let Ng=(cy=class{constructor(){Qt(this,"onabort");Qt(this,"onerror");Qt(this,"onreadystatechange");Qt(this,"ontimeout");Qt(this,"readyState",0);Qt(this,"response");Qt(this,"responseText","");Qt(this,"responseType","");Qt(this,"status");Qt(this,"statusText");Qt(this,"withCredentials");pi(this,Xp);pi(this,Yp);pi(this,jf);pi(this,Qp,{});pi(this,lu);pi(this,Kp,{});pi(this,Wp)}open(y,b,T){var R;hi(this,Xp,y),hi(this,Yp,b),hi(this,jf,""),this.readyState=1,(R=this.onreadystatechange)==null||R.call(this),hi(this,lu,void 0)}abort(){ze(this,lu)&&ze(this,lu).abort()}getAllResponseHeaders(){return ze(this,jf)}setRequestHeader(y,b){ze(this,Qp)[y]=b}setInit(y,b=!0){hi(this,Kp,y),hi(this,Wp,b)}send(y){const b=this.responseType!=="arraybuffer",T={...ze(this,Kp),method:ze(this,Xp),headers:ze(this,Qp),body:y};typeof AbortController=="function"&&ze(this,Wp)&&(hi(this,lu,new AbortController),typeof EventTarget<"u"&&ze(this,lu).signal instanceof EventTarget&&(T.signal=ze(this,lu).signal)),typeof document<"u"&&(T.credentials=this.withCredentials?"include":"omit"),fetch(ze(this,Yp),T).then(R=>{var F;return R.headers.forEach((z,u)=>{hi(this,jf,ze(this,jf)+`${u}: ${z}\r
`)}),this.status=R.status,this.statusText=R.statusText,this.readyState=3,(F=this.onreadystatechange)==null||F.call(this),b?R.text():R.arrayBuffer()}).then(R=>{var F;typeof R=="string"?this.responseText=R:this.response=R,this.readyState=4,(F=this.onreadystatechange)==null||F.call(this)}).catch(R=>{var F,z;R.name!=="AbortError"?(F=this.onerror)==null||F.call(this,R):(z=this.onabort)==null||z.call(this)})}},Xp=new WeakMap,Yp=new WeakMap,jf=new WeakMap,Qp=new WeakMap,lu=new WeakMap,Kp=new WeakMap,Wp=new WeakMap,cy);const Vg=typeof XMLHttpRequest=="function"?"xhr":"fetch",T0=Vg==="xhr"?XMLHttpRequest:Ng,S0=(v,y)=>{const b=v.options,T=v.applyMiddleware("finalizeOptions",b),R={},F=v.applyMiddleware("interceptRequest",void 0,{adapter:Vg,context:v});if(F){const Ze=setTimeout(y,0,null,F);return{abort:()=>clearTimeout(Ze)}}let z=new T0;z instanceof Ng&&typeof T.fetch=="object"&&z.setInit(T.fetch,T.useAbortSignal??!0);const u=T.headers,oe=T.timeout;let Q=!1,ve=!1,Te=!1;if(z.onerror=Ze=>{Pe(z instanceof Ng?Ze instanceof Error?Ze:new Error(`Request error while attempting to reach is ${T.url}`,{cause:Ze}):new Error(`Request error while attempting to reach is ${T.url}${Ze.lengthComputable?`(${Ze.loaded} of ${Ze.total} bytes transferred)`:""}`))},z.ontimeout=Ze=>{Pe(new Error(`Request timeout while attempting to reach ${T.url}${Ze.lengthComputable?`(${Ze.loaded} of ${Ze.total} bytes transferred)`:""}`))},z.onabort=()=>{ne(!0),Q=!0},z.onreadystatechange=function(){oe&&(ne(),R.socket=setTimeout(()=>Ee("ESOCKETTIMEDOUT"),oe.socket)),!Q&&z&&z.readyState===4&&z.status!==0&&function(){if(!(Q||ve||Te)){if(z.status===0)return void Pe(new Error("Unknown XHR error"));ne(),ve=!0,y(null,{body:z.response||(z.responseType===""||z.responseType==="text"?z.responseText:""),url:T.url,method:T.method,headers:w0(z.getAllResponseHeaders()),statusCode:z.status,statusMessage:z.statusText})}}()},z.open(T.method,T.url,!0),z.withCredentials=!!T.withCredentials,u&&z.setRequestHeader)for(const Ze in u)u.hasOwnProperty(Ze)&&z.setRequestHeader(Ze,u[Ze]);return T.rawBody&&(z.responseType="arraybuffer"),v.applyMiddleware("onRequest",{options:T,adapter:Vg,request:z,context:v}),z.send(T.body||null),oe&&(R.connect=setTimeout(()=>Ee("ETIMEDOUT"),oe.connect)),{abort:function(){Q=!0,z&&z.abort()}};function Ee(Ze){Te=!0,z.abort();const bt=new Error(Ze==="ESOCKETTIMEDOUT"?`Socket timed out on request to ${T.url}`:`Connection timed out on request to ${T.url}`);bt.code=Ze,v.channels.error.publish(bt)}function ne(Ze){(Ze||Q||z&&z.readyState>=2&&R.connect)&&clearTimeout(R.connect),R.socket&&clearTimeout(R.socket)}function Pe(Ze){if(ve)return;ne(!0),ve=!0,z=null;const bt=Ze||new Error(`Network error while attempting to reach ${T.url}`);bt.isNetworkError=!0,bt.request=T,y(bt)}},M0=(v=[],y=S0)=>my(v,y);var E0={},B_,j_,F_,U_,N_,Dg={exports:{}};N_||(N_=1,function(v,y){y.formatArgs=function(T){if(T[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+T[0]+(this.useColors?"%c ":" ")+"+"+v.exports.humanize(this.diff),!this.useColors)return;const R="color: "+this.color;T.splice(1,0,R,"color: inherit");let F=0,z=0;T[0].replace(/%[a-zA-Z%]/g,u=>{u!=="%%"&&(F++,u==="%c"&&(z=F))}),T.splice(z,0,R)},y.save=function(T){try{T?y.storage.setItem("debug",T):y.storage.removeItem("debug")}catch{}},y.load=function(){let T;try{T=y.storage.getItem("debug")}catch{}return!T&&typeof process<"u"&&"env"in process&&(T=E0.DEBUG),T},y.useColors=function(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let T;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(T=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(T[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},y.storage=function(){try{return localStorage}catch{}}(),y.destroy=(()=>{let T=!1;return()=>{T||(T=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),y.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],y.log=console.debug||console.log||(()=>{}),v.exports=(U_?F_:(U_=1,F_=function(T){function R(u){let oe,Q,ve,Te=null;function Ee(...ne){if(!Ee.enabled)return;const Pe=Ee,Ze=Number(new Date),bt=Ze-(oe||Ze);Pe.diff=bt,Pe.prev=oe,Pe.curr=Ze,oe=Ze,ne[0]=R.coerce(ne[0]),typeof ne[0]!="string"&&ne.unshift("%O");let Vt=0;ne[0]=ne[0].replace(/%([a-zA-Z%])/g,(Ot,Tt)=>{if(Ot==="%%")return"%";Vt++;const qt=R.formatters[Tt];if(typeof qt=="function"){const xt=ne[Vt];Ot=qt.call(Pe,xt),ne.splice(Vt,1),Vt--}return Ot}),R.formatArgs.call(Pe,ne),(Pe.log||R.log).apply(Pe,ne)}return Ee.namespace=u,Ee.useColors=R.useColors(),Ee.color=R.selectColor(u),Ee.extend=F,Ee.destroy=R.destroy,Object.defineProperty(Ee,"enabled",{enumerable:!0,configurable:!1,get:()=>Te!==null?Te:(Q!==R.namespaces&&(Q=R.namespaces,ve=R.enabled(u)),ve),set:ne=>{Te=ne}}),typeof R.init=="function"&&R.init(Ee),Ee}function F(u,oe){const Q=R(this.namespace+(typeof oe>"u"?":":oe)+u);return Q.log=this.log,Q}function z(u,oe){let Q=0,ve=0,Te=-1,Ee=0;for(;Q<u.length;)if(ve<oe.length&&(oe[ve]===u[Q]||oe[ve]==="*"))oe[ve]==="*"?(Te=ve,Ee=Q,ve++):(Q++,ve++);else{if(Te===-1)return!1;ve=Te+1,Ee++,Q=Ee}for(;ve<oe.length&&oe[ve]==="*";)ve++;return ve===oe.length}return R.debug=R,R.default=R,R.coerce=function(u){return u instanceof Error?u.stack||u.message:u},R.disable=function(){const u=[...R.names,...R.skips.map(oe=>"-"+oe)].join(",");return R.enable(""),u},R.enable=function(u){R.save(u),R.namespaces=u,R.names=[],R.skips=[];const oe=(typeof u=="string"?u:"").trim().replace(" ",",").split(",").filter(Boolean);for(const Q of oe)Q[0]==="-"?R.skips.push(Q.slice(1)):R.names.push(Q)},R.enabled=function(u){for(const oe of R.skips)if(z(u,oe))return!1;for(const oe of R.names)if(z(u,oe))return!0;return!1},R.humanize=function(){if(j_)return B_;j_=1;var u=1e3,oe=60*u,Q=60*oe,ve=24*Q,Te=7*ve;function Ee(ne,Pe,Ze,bt){var Vt=Pe>=1.5*Ze;return Math.round(ne/Ze)+" "+bt+(Vt?"s":"")}return B_=function(ne,Pe){Pe=Pe||{};var Ze,bt,Vt=typeof ne;if(Vt==="string"&&ne.length>0)return function(Ot){if(!((Ot=String(Ot)).length>100)){var Tt=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Ot);if(Tt){var qt=parseFloat(Tt[1]);switch((Tt[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*qt;case"weeks":case"week":case"w":return qt*Te;case"days":case"day":case"d":return qt*ve;case"hours":case"hour":case"hrs":case"hr":case"h":return qt*Q;case"minutes":case"minute":case"mins":case"min":case"m":return qt*oe;case"seconds":case"second":case"secs":case"sec":case"s":return qt*u;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return qt;default:return}}}}(ne);if(Vt==="number"&&isFinite(ne))return Pe.long?(Ze=ne,(bt=Math.abs(Ze))>=ve?Ee(Ze,bt,ve,"day"):bt>=Q?Ee(Ze,bt,Q,"hour"):bt>=oe?Ee(Ze,bt,oe,"minute"):bt>=u?Ee(Ze,bt,u,"second"):Ze+" ms"):function(Ot){var Tt=Math.abs(Ot);return Tt>=ve?Math.round(Ot/ve)+"d":Tt>=Q?Math.round(Ot/Q)+"h":Tt>=oe?Math.round(Ot/oe)+"m":Tt>=u?Math.round(Ot/u)+"s":Ot+"ms"}(ne);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ne))}}(),R.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(T).forEach(u=>{R[u]=T[u]}),R.names=[],R.skips=[],R.formatters={},R.selectColor=function(u){let oe=0;for(let Q=0;Q<u.length;Q++)oe=(oe<<5)-oe+u.charCodeAt(Q),oe|=0;return R.colors[Math.abs(oe)%R.colors.length]},R.enable(R.load()),R}))(y);const{formatters:b}=v.exports;b.j=function(T){try{return JSON.stringify(T)}catch(R){return"[UnexpectedJSONParseError]: "+R.message}}}(Dg,Dg.exports)),Dg.exports;const C0=typeof Buffer>"u"?()=>!1:v=>Buffer.isBuffer(v);function V_(v){return Object.prototype.toString.call(v)==="[object Object]"}function A0(v){if(V_(v)===!1)return!1;const y=v.constructor;if(y===void 0)return!0;const b=y.prototype;return!(V_(b)===!1||b.hasOwnProperty("isPrototypeOf")===!1)}const z0=["boolean","string","number"];function P0(){return{processOptions:v=>{const y=v.body;return!y||typeof y.pipe=="function"||C0(y)||z0.indexOf(typeof y)===-1&&!Array.isArray(y)&&!A0(y)?v:Object.assign({},v,{body:JSON.stringify(v.body),headers:Object.assign({},v.headers,{"Content-Type":"application/json"})})}}}function I0(v){return{onResponse:b=>{const T=b.headers["content-type"]||"",R=v&&v.force||T.indexOf("application/json")!==-1;return b.body&&T&&R?Object.assign({},b,{body:y(b.body)}):b},processOptions:b=>Object.assign({},b,{headers:Object.assign({Accept:"application/json"},b.headers)})};function y(b){try{return JSON.parse(b)}catch(T){throw T.message=`Failed to parsed response body as JSON: ${T.message}`,T}}}let Zp={};typeof globalThis<"u"?Zp=globalThis:typeof window<"u"?Zp=window:typeof global<"u"?Zp=global:typeof self<"u"&&(Zp=self);var D0=Zp;function R0(v={}){const y=v.implementation||D0.Observable;if(!y)throw new Error("`Observable` is not available in global scope, and no implementation was passed");return{onReturn:(b,T)=>new y(R=>(b.error.subscribe(F=>R.error(F)),b.progress.subscribe(F=>R.next(Object.assign({type:"progress"},F))),b.response.subscribe(F=>{R.next(Object.assign({type:"response"},F)),R.complete()}),b.request.publish(T),()=>b.abort.publish()))}}function k0(){return{onRequest:v=>{if(v.adapter!=="xhr")return;const y=v.request,b=v.context;function T(R){return F=>{const z=F.lengthComputable?F.loaded/F.total*100:-1;b.channels.progress.publish({stage:R,percent:z,total:F.total,loaded:F.loaded,lengthComputable:F.lengthComputable})}}"upload"in y&&"onprogress"in y.upload&&(y.upload.onprogress=T("upload")),"onprogress"in y&&(y.onprogress=T("download"))}}}var gy=(v,y,b)=>(b.method==="GET"||b.method==="HEAD")&&(v.isNetworkError||!1);function L0(v){return 100*Math.pow(2,v)+100*Math.random()}const Yg=(v={})=>(y=>{const b=y.maxRetries||5,T=y.retryDelay||L0,R=y.shouldRetry;return{onError:(F,z)=>{const u=z.options,oe=u.maxRetries||b,Q=u.retryDelay||T,ve=u.shouldRetry||R,Te=u.attemptNumber||0;if((Ee=u.body)!==null&&typeof Ee=="object"&&typeof Ee.pipe=="function"||!ve(F,Te,u)||Te>=oe)return F;var Ee;const ne=Object.assign({},z,{options:Object.assign({},u,{attemptNumber:Te+1})});return setTimeout(()=>z.channels.request.publish(ne),Q(Te)),null}}})({shouldRetry:gy,...v});Yg.shouldRetry=gy;var Zg=function(v,y){return Zg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,T){b.__proto__=T}||function(b,T){for(var R in T)Object.prototype.hasOwnProperty.call(T,R)&&(b[R]=T[R])},Zg(v,y)};function gu(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");Zg(v,y);function b(){this.constructor=v}v.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}function O0(v,y,b,T){function R(F){return F instanceof b?F:new b(function(z){z(F)})}return new(b||(b=Promise))(function(F,z){function u(ve){try{Q(T.next(ve))}catch(Te){z(Te)}}function oe(ve){try{Q(T.throw(ve))}catch(Te){z(Te)}}function Q(ve){ve.done?F(ve.value):R(ve.value).then(u,oe)}Q((T=T.apply(v,y||[])).next())})}function _y(v,y){var b={label:0,sent:function(){if(F[0]&1)throw F[1];return F[1]},trys:[],ops:[]},T,R,F,z=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return z.next=u(0),z.throw=u(1),z.return=u(2),typeof Symbol=="function"&&(z[Symbol.iterator]=function(){return this}),z;function u(Q){return function(ve){return oe([Q,ve])}}function oe(Q){if(T)throw new TypeError("Generator is already executing.");for(;z&&(z=0,Q[0]&&(b=0)),b;)try{if(T=1,R&&(F=Q[0]&2?R.return:Q[0]?R.throw||((F=R.return)&&F.call(R),0):R.next)&&!(F=F.call(R,Q[1])).done)return F;switch(R=0,F&&(Q=[Q[0]&2,F.value]),Q[0]){case 0:case 1:F=Q;break;case 4:return b.label++,{value:Q[1],done:!1};case 5:b.label++,R=Q[1],Q=[0];continue;case 7:Q=b.ops.pop(),b.trys.pop();continue;default:if(F=b.trys,!(F=F.length>0&&F[F.length-1])&&(Q[0]===6||Q[0]===2)){b=0;continue}if(Q[0]===3&&(!F||Q[1]>F[0]&&Q[1]<F[3])){b.label=Q[1];break}if(Q[0]===6&&b.label<F[1]){b.label=F[1],F=Q;break}if(F&&b.label<F[2]){b.label=F[2],b.ops.push(Q);break}F[2]&&b.ops.pop(),b.trys.pop();continue}Q=y.call(v,b)}catch(ve){Q=[6,ve],R=0}finally{T=F=0}if(Q[0]&5)throw Q[1];return{value:Q[0]?Q[1]:void 0,done:!0}}}function Nf(v){var y=typeof Symbol=="function"&&Symbol.iterator,b=y&&v[y],T=0;if(b)return b.call(v);if(v&&typeof v.length=="number")return{next:function(){return v&&T>=v.length&&(v=void 0),{value:v&&v[T++],done:!v}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")}function pu(v,y){var b=typeof Symbol=="function"&&v[Symbol.iterator];if(!b)return v;var T=b.call(v),R,F=[],z;try{for(;(y===void 0||y-- >0)&&!(R=T.next()).done;)F.push(R.value)}catch(u){z={error:u}}finally{try{R&&!R.done&&(b=T.return)&&b.call(T)}finally{if(z)throw z.error}}return F}function mu(v,y,b){if(b||arguments.length===2)for(var T=0,R=y.length,F;T<R;T++)(F||!(T in y))&&(F||(F=Array.prototype.slice.call(y,0,T)),F[T]=y[T]);return v.concat(F||Array.prototype.slice.call(y))}function Of(v){return this instanceof Of?(this.v=v,this):new Of(v)}function B0(v,y,b){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var T=b.apply(v,y||[]),R,F=[];return R=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",z),R[Symbol.asyncIterator]=function(){return this},R;function z(ne){return function(Pe){return Promise.resolve(Pe).then(ne,Te)}}function u(ne,Pe){T[ne]&&(R[ne]=function(Ze){return new Promise(function(bt,Vt){F.push([ne,Ze,bt,Vt])>1||oe(ne,Ze)})},Pe&&(R[ne]=Pe(R[ne])))}function oe(ne,Pe){try{Q(T[ne](Pe))}catch(Ze){Ee(F[0][3],Ze)}}function Q(ne){ne.value instanceof Of?Promise.resolve(ne.value.v).then(ve,Te):Ee(F[0][2],ne)}function ve(ne){oe("next",ne)}function Te(ne){oe("throw",ne)}function Ee(ne,Pe){ne(Pe),F.shift(),F.length&&oe(F[0][0],F[0][1])}}function j0(v){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var y=v[Symbol.asyncIterator],b;return y?y.call(v):(v=typeof Nf=="function"?Nf(v):v[Symbol.iterator](),b={},T("next"),T("throw"),T("return"),b[Symbol.asyncIterator]=function(){return this},b);function T(F){b[F]=v[F]&&function(z){return new Promise(function(u,oe){z=v[F](z),R(u,oe,z.done,z.value)})}}function R(F,z,u,oe){Promise.resolve(oe).then(function(Q){F({value:Q,done:u})},z)}}function qr(v){return typeof v=="function"}function Qg(v){var y=function(T){Error.call(T),T.stack=new Error().stack},b=v(y);return b.prototype=Object.create(Error.prototype),b.prototype.constructor=b,b}var Rg=Qg(function(v){return function(b){v(this),this.message=b?b.length+` errors occurred during unsubscription:
`+b.map(function(T,R){return R+1+") "+T.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=b}});function Qm(v,y){if(v){var b=v.indexOf(y);0<=b&&v.splice(b,1)}}var om=function(){function v(y){this.initialTeardown=y,this.closed=!1,this._parentage=null,this._finalizers=null}return v.prototype.unsubscribe=function(){var y,b,T,R,F;if(!this.closed){this.closed=!0;var z=this._parentage;if(z)if(this._parentage=null,Array.isArray(z))try{for(var u=Nf(z),oe=u.next();!oe.done;oe=u.next()){var Q=oe.value;Q.remove(this)}}catch(Ze){y={error:Ze}}finally{try{oe&&!oe.done&&(b=u.return)&&b.call(u)}finally{if(y)throw y.error}}else z.remove(this);var ve=this.initialTeardown;if(qr(ve))try{ve()}catch(Ze){F=Ze instanceof Rg?Ze.errors:[Ze]}var Te=this._finalizers;if(Te){this._finalizers=null;try{for(var Ee=Nf(Te),ne=Ee.next();!ne.done;ne=Ee.next()){var Pe=ne.value;try{Z_(Pe)}catch(Ze){F=F??[],Ze instanceof Rg?F=mu(mu([],pu(F)),pu(Ze.errors)):F.push(Ze)}}}catch(Ze){T={error:Ze}}finally{try{ne&&!ne.done&&(R=Ee.return)&&R.call(Ee)}finally{if(T)throw T.error}}}if(F)throw new Rg(F)}},v.prototype.add=function(y){var b;if(y&&y!==this)if(this.closed)Z_(y);else{if(y instanceof v){if(y.closed||y._hasParent(this))return;y._addParent(this)}(this._finalizers=(b=this._finalizers)!==null&&b!==void 0?b:[]).push(y)}},v.prototype._hasParent=function(y){var b=this._parentage;return b===y||Array.isArray(b)&&b.includes(y)},v.prototype._addParent=function(y){var b=this._parentage;this._parentage=Array.isArray(b)?(b.push(y),b):b?[b,y]:y},v.prototype._removeParent=function(y){var b=this._parentage;b===y?this._parentage=null:Array.isArray(b)&&Qm(b,y)},v.prototype.remove=function(y){var b=this._finalizers;b&&Qm(b,y),y instanceof v&&y._removeParent(this)},v.EMPTY=function(){var y=new v;return y.closed=!0,y}(),v}(),yy=om.EMPTY;function vy(v){return v instanceof om||v&&"closed"in v&&qr(v.remove)&&qr(v.add)&&qr(v.unsubscribe)}function Z_(v){qr(v)?v():v.unsubscribe()}var F0={Promise:void 0},U0={setTimeout:function(v,y){for(var b=[],T=2;T<arguments.length;T++)b[T-2]=arguments[T];return setTimeout.apply(void 0,mu([v,y],pu(b)))},clearTimeout:function(v){return clearTimeout(v)},delegate:void 0};function by(v){U0.setTimeout(function(){throw v})}function q_(){}function Xm(v){v()}var Kg=function(v){gu(y,v);function y(b){var T=v.call(this)||this;return T.isStopped=!1,b?(T.destination=b,vy(b)&&b.add(T)):T.destination=Z0,T}return y.create=function(b,T,R){return new Vf(b,T,R)},y.prototype.next=function(b){this.isStopped||this._next(b)},y.prototype.error=function(b){this.isStopped||(this.isStopped=!0,this._error(b))},y.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},y.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,v.prototype.unsubscribe.call(this),this.destination=null)},y.prototype._next=function(b){this.destination.next(b)},y.prototype._error=function(b){try{this.destination.error(b)}finally{this.unsubscribe()}},y.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},y}(om),N0=function(){function v(y){this.partialObserver=y}return v.prototype.next=function(y){var b=this.partialObserver;if(b.next)try{b.next(y)}catch(T){Gm(T)}},v.prototype.error=function(y){var b=this.partialObserver;if(b.error)try{b.error(y)}catch(T){Gm(T)}else Gm(y)},v.prototype.complete=function(){var y=this.partialObserver;if(y.complete)try{y.complete()}catch(b){Gm(b)}},v}(),Vf=function(v){gu(y,v);function y(b,T,R){var F=v.call(this)||this,z;return qr(b)||!b?z={next:b??void 0,error:T??void 0,complete:R??void 0}:z=b,F.destination=new N0(z),F}return y}(Kg);function Gm(v){by(v)}function V0(v){throw v}var Z0={closed:!0,next:q_,error:V0,complete:q_},Wg=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ng(v){return v}function q0(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];return xy(v)}function xy(v){return v.length===0?ng:v.length===1?v[0]:function(b){return v.reduce(function(T,R){return R(T)},b)}}var ln=function(){function v(y){y&&(this._subscribe=y)}return v.prototype.lift=function(y){var b=new v;return b.source=this,b.operator=y,b},v.prototype.subscribe=function(y,b,T){var R=this,F=G0(y)?y:new Vf(y,b,T);return Xm(function(){var z=R,u=z.operator,oe=z.source;F.add(u?u.call(F,oe):oe?R._subscribe(F):R._trySubscribe(F))}),F},v.prototype._trySubscribe=function(y){try{return this._subscribe(y)}catch(b){y.error(b)}},v.prototype.forEach=function(y,b){var T=this;return b=$_(b),new b(function(R,F){var z=new Vf({next:function(u){try{y(u)}catch(oe){F(oe),z.unsubscribe()}},error:F,complete:R});T.subscribe(z)})},v.prototype._subscribe=function(y){var b;return(b=this.source)===null||b===void 0?void 0:b.subscribe(y)},v.prototype[Wg]=function(){return this},v.prototype.pipe=function(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return xy(y)(this)},v.prototype.toPromise=function(y){var b=this;return y=$_(y),new y(function(T,R){var F;b.subscribe(function(z){return F=z},function(z){return R(z)},function(){return T(F)})})},v.create=function(y){return new v(y)},v}();function $_(v){var y;return(y=v??F0.Promise)!==null&&y!==void 0?y:Promise}function $0(v){return v&&qr(v.next)&&qr(v.error)&&qr(v.complete)}function G0(v){return v&&v instanceof Kg||$0(v)&&vy(v)}function H0(v){return qr(v==null?void 0:v.lift)}function vc(v){return function(y){if(H0(y))return y.lift(function(b){try{return v(b,this)}catch(T){this.error(T)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mh(v,y,b,T,R){return new X0(v,y,b,T,R)}var X0=function(v){gu(y,v);function y(b,T,R,F,z,u){var oe=v.call(this,b)||this;return oe.onFinalize=z,oe.shouldUnsubscribe=u,oe._next=T?function(Q){try{T(Q)}catch(ve){b.error(ve)}}:v.prototype._next,oe._error=F?function(Q){try{F(Q)}catch(ve){b.error(ve)}finally{this.unsubscribe()}}:v.prototype._error,oe._complete=R?function(){try{R()}catch(Q){b.error(Q)}finally{this.unsubscribe()}}:v.prototype._complete,oe}return y.prototype.unsubscribe=function(){var b;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var T=this.closed;v.prototype.unsubscribe.call(this),!T&&((b=this.onFinalize)===null||b===void 0||b.call(this))}},y}(Kg),Y0=Qg(function(v){return function(){v(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Jg=function(v){gu(y,v);function y(){var b=v.call(this)||this;return b.closed=!1,b.currentObservers=null,b.observers=[],b.isStopped=!1,b.hasError=!1,b.thrownError=null,b}return y.prototype.lift=function(b){var T=new G_(this,this);return T.operator=b,T},y.prototype._throwIfClosed=function(){if(this.closed)throw new Y0},y.prototype.next=function(b){var T=this;Xm(function(){var R,F;if(T._throwIfClosed(),!T.isStopped){T.currentObservers||(T.currentObservers=Array.from(T.observers));try{for(var z=Nf(T.currentObservers),u=z.next();!u.done;u=z.next()){var oe=u.value;oe.next(b)}}catch(Q){R={error:Q}}finally{try{u&&!u.done&&(F=z.return)&&F.call(z)}finally{if(R)throw R.error}}}})},y.prototype.error=function(b){var T=this;Xm(function(){if(T._throwIfClosed(),!T.isStopped){T.hasError=T.isStopped=!0,T.thrownError=b;for(var R=T.observers;R.length;)R.shift().error(b)}})},y.prototype.complete=function(){var b=this;Xm(function(){if(b._throwIfClosed(),!b.isStopped){b.isStopped=!0;for(var T=b.observers;T.length;)T.shift().complete()}})},y.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(y.prototype,"observed",{get:function(){var b;return((b=this.observers)===null||b===void 0?void 0:b.length)>0},enumerable:!1,configurable:!0}),y.prototype._trySubscribe=function(b){return this._throwIfClosed(),v.prototype._trySubscribe.call(this,b)},y.prototype._subscribe=function(b){return this._throwIfClosed(),this._checkFinalizedStatuses(b),this._innerSubscribe(b)},y.prototype._innerSubscribe=function(b){var T=this,R=this,F=R.hasError,z=R.isStopped,u=R.observers;return F||z?yy:(this.currentObservers=null,u.push(b),new om(function(){T.currentObservers=null,Qm(u,b)}))},y.prototype._checkFinalizedStatuses=function(b){var T=this,R=T.hasError,F=T.thrownError,z=T.isStopped;R?b.error(F):z&&b.complete()},y.prototype.asObservable=function(){var b=new ln;return b.source=this,b},y.create=function(b,T){return new G_(b,T)},y}(ln),G_=function(v){gu(y,v);function y(b,T){var R=v.call(this)||this;return R.destination=b,R.source=T,R}return y.prototype.next=function(b){var T,R;(R=(T=this.destination)===null||T===void 0?void 0:T.next)===null||R===void 0||R.call(T,b)},y.prototype.error=function(b){var T,R;(R=(T=this.destination)===null||T===void 0?void 0:T.error)===null||R===void 0||R.call(T,b)},y.prototype.complete=function(){var b,T;(T=(b=this.destination)===null||b===void 0?void 0:b.complete)===null||T===void 0||T.call(b)},y.prototype._subscribe=function(b){var T,R;return(R=(T=this.source)===null||T===void 0?void 0:T.subscribe(b))!==null&&R!==void 0?R:yy},y}(Jg),e_={now:function(){return(e_.delegate||Date).now()},delegate:void 0},Q0=function(v){gu(y,v);function y(b,T,R){b===void 0&&(b=1/0),T===void 0&&(T=1/0),R===void 0&&(R=e_);var F=v.call(this)||this;return F._bufferSize=b,F._windowTime=T,F._timestampProvider=R,F._buffer=[],F._infiniteTimeWindow=!0,F._infiniteTimeWindow=T===1/0,F._bufferSize=Math.max(1,b),F._windowTime=Math.max(1,T),F}return y.prototype.next=function(b){var T=this,R=T.isStopped,F=T._buffer,z=T._infiniteTimeWindow,u=T._timestampProvider,oe=T._windowTime;R||(F.push(b),!z&&F.push(u.now()+oe)),this._trimBuffer(),v.prototype.next.call(this,b)},y.prototype._subscribe=function(b){this._throwIfClosed(),this._trimBuffer();for(var T=this._innerSubscribe(b),R=this,F=R._infiniteTimeWindow,z=R._buffer,u=z.slice(),oe=0;oe<u.length&&!b.closed;oe+=F?1:2)b.next(u[oe]);return this._checkFinalizedStatuses(b),T},y.prototype._trimBuffer=function(){var b=this,T=b._bufferSize,R=b._timestampProvider,F=b._buffer,z=b._infiniteTimeWindow,u=(z?1:2)*T;if(T<1/0&&u<F.length&&F.splice(0,F.length-u),!z){for(var oe=R.now(),Q=0,ve=1;ve<F.length&&F[ve]<=oe;ve+=2)Q=ve;Q&&F.splice(0,Q+1)}},y}(Jg),K0=function(v){gu(y,v);function y(b,T){return v.call(this)||this}return y.prototype.schedule=function(b,T){return this},y}(om),H_={setInterval:function(v,y){for(var b=[],T=2;T<arguments.length;T++)b[T-2]=arguments[T];return setInterval.apply(void 0,mu([v,y],pu(b)))},clearInterval:function(v){return clearInterval(v)},delegate:void 0},W0=function(v){gu(y,v);function y(b,T){var R=v.call(this,b,T)||this;return R.scheduler=b,R.work=T,R.pending=!1,R}return y.prototype.schedule=function(b,T){var R;if(T===void 0&&(T=0),this.closed)return this;this.state=b;var F=this.id,z=this.scheduler;return F!=null&&(this.id=this.recycleAsyncId(z,F,T)),this.pending=!0,this.delay=T,this.id=(R=this.id)!==null&&R!==void 0?R:this.requestAsyncId(z,this.id,T),this},y.prototype.requestAsyncId=function(b,T,R){return R===void 0&&(R=0),H_.setInterval(b.flush.bind(b,this),R)},y.prototype.recycleAsyncId=function(b,T,R){if(R===void 0&&(R=0),R!=null&&this.delay===R&&this.pending===!1)return T;T!=null&&H_.clearInterval(T)},y.prototype.execute=function(b,T){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var R=this._execute(b,T);if(R)return R;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},y.prototype._execute=function(b,T){var R=!1,F;try{this.work(b)}catch(z){R=!0,F=z||new Error("Scheduled action threw falsy error")}if(R)return this.unsubscribe(),F},y.prototype.unsubscribe=function(){if(!this.closed){var b=this,T=b.id,R=b.scheduler,F=R.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Qm(F,this),T!=null&&(this.id=this.recycleAsyncId(R,T,null)),this.delay=null,v.prototype.unsubscribe.call(this)}},y}(K0),X_=function(){function v(y,b){b===void 0&&(b=v.now),this.schedulerActionCtor=y,this.now=b}return v.prototype.schedule=function(y,b,T){return b===void 0&&(b=0),new this.schedulerActionCtor(this,y).schedule(T,b)},v.now=e_.now,v}(),J0=function(v){gu(y,v);function y(b,T){T===void 0&&(T=X_.now);var R=v.call(this,b,T)||this;return R.actions=[],R._active=!1,R}return y.prototype.flush=function(b){var T=this.actions;if(this._active){T.push(b);return}var R;this._active=!0;do if(R=b.execute(b.state,b.delay))break;while(b=T.shift());if(this._active=!1,R){for(;b=T.shift();)b.unsubscribe();throw R}},y}(X_),eb=new J0(W0),tb=eb,wy=new ln(function(v){return v.complete()});function ib(v){return v&&qr(v.schedule)}function t_(v){return v[v.length-1]}function rb(v){return qr(t_(v))?v.pop():void 0}function i_(v){return ib(t_(v))?v.pop():void 0}function nb(v,y){return typeof t_(v)=="number"?v.pop():y}var Ty=function(v){return v&&typeof v.length=="number"&&typeof v!="function"};function Sy(v){return qr(v==null?void 0:v.then)}function My(v){return qr(v[Wg])}function Ey(v){return Symbol.asyncIterator&&qr(v==null?void 0:v[Symbol.asyncIterator])}function Cy(v){return new TypeError("You provided "+(v!==null&&typeof v=="object"?"an invalid object":"'"+v+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function ab(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ay=ab();function zy(v){return qr(v==null?void 0:v[Ay])}function Py(v){return B0(this,arguments,function(){var b,T,R,F;return _y(this,function(z){switch(z.label){case 0:b=v.getReader(),z.label=1;case 1:z.trys.push([1,,9,10]),z.label=2;case 2:return[4,Of(b.read())];case 3:return T=z.sent(),R=T.value,F=T.done,F?[4,Of(void 0)]:[3,5];case 4:return[2,z.sent()];case 5:return[4,Of(R)];case 6:return[4,z.sent()];case 7:return z.sent(),[3,2];case 8:return[3,10];case 9:return b.releaseLock(),[7];case 10:return[2]}})})}function Iy(v){return qr(v==null?void 0:v.getReader)}function bc(v){if(v instanceof ln)return v;if(v!=null){if(My(v))return sb(v);if(Ty(v))return ob(v);if(Sy(v))return lb(v);if(Ey(v))return Dy(v);if(zy(v))return cb(v);if(Iy(v))return ub(v)}throw Cy(v)}function sb(v){return new ln(function(y){var b=v[Wg]();if(qr(b.subscribe))return b.subscribe(y);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ob(v){return new ln(function(y){for(var b=0;b<v.length&&!y.closed;b++)y.next(v[b]);y.complete()})}function lb(v){return new ln(function(y){v.then(function(b){y.closed||(y.next(b),y.complete())},function(b){return y.error(b)}).then(null,by)})}function cb(v){return new ln(function(y){var b,T;try{for(var R=Nf(v),F=R.next();!F.done;F=R.next()){var z=F.value;if(y.next(z),y.closed)return}}catch(u){b={error:u}}finally{try{F&&!F.done&&(T=R.return)&&T.call(R)}finally{if(b)throw b.error}}y.complete()})}function Dy(v){return new ln(function(y){hb(v,y).catch(function(b){return y.error(b)})})}function ub(v){return Dy(Py(v))}function hb(v,y){var b,T,R,F;return O0(this,void 0,void 0,function(){var z,u;return _y(this,function(oe){switch(oe.label){case 0:oe.trys.push([0,5,6,11]),b=j0(v),oe.label=1;case 1:return[4,b.next()];case 2:if(T=oe.sent(),!!T.done)return[3,4];if(z=T.value,y.next(z),y.closed)return[2];oe.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=oe.sent(),R={error:u},[3,11];case 6:return oe.trys.push([6,,9,10]),T&&!T.done&&(F=b.return)?[4,F.call(b)]:[3,8];case 7:oe.sent(),oe.label=8;case 8:return[3,10];case 9:if(R)throw R.error;return[7];case 10:return[7];case 11:return y.complete(),[2]}})})}function bd(v,y,b,T,R){T===void 0&&(T=0),R===void 0&&(R=!1);var F=y.schedule(function(){b(),R?v.add(this.schedule(null,T)):this.unsubscribe()},T);if(v.add(F),!R)return F}function Ry(v,y){return y===void 0&&(y=0),vc(function(b,T){b.subscribe(Mh(T,function(R){return bd(T,v,function(){return T.next(R)},y)},function(){return bd(T,v,function(){return T.complete()},y)},function(R){return bd(T,v,function(){return T.error(R)},y)}))})}function ky(v,y){return y===void 0&&(y=0),vc(function(b,T){T.add(v.schedule(function(){return b.subscribe(T)},y))})}function db(v,y){return bc(v).pipe(ky(y),Ry(y))}function fb(v,y){return bc(v).pipe(ky(y),Ry(y))}function pb(v,y){return new ln(function(b){var T=0;return y.schedule(function(){T===v.length?b.complete():(b.next(v[T++]),b.closed||this.schedule())})})}function mb(v,y){return new ln(function(b){var T;return bd(b,y,function(){T=v[Ay](),bd(b,y,function(){var R,F,z;try{R=T.next(),F=R.value,z=R.done}catch(u){b.error(u);return}z?b.complete():b.next(F)},0,!0)}),function(){return qr(T==null?void 0:T.return)&&T.return()}})}function Ly(v,y){if(!v)throw new Error("Iterable cannot be null");return new ln(function(b){bd(b,y,function(){var T=v[Symbol.asyncIterator]();bd(b,y,function(){T.next().then(function(R){R.done?b.complete():b.next(R.value)})},0,!0)})})}function gb(v,y){return Ly(Py(v),y)}function _b(v,y){if(v!=null){if(My(v))return db(v,y);if(Ty(v))return pb(v,y);if(Sy(v))return fb(v,y);if(Ey(v))return Ly(v,y);if(zy(v))return mb(v,y);if(Iy(v))return gb(v,y)}throw Cy(v)}function lm(v,y){return y?_b(v,y):bc(v)}function ag(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];var b=i_(v);return lm(v,b)}function Oy(v,y){var b=qr(v)?v:function(){return v},T=function(R){return R.error(b())};return new ln(T)}function yb(v){return!!v&&(v instanceof ln||qr(v.lift)&&qr(v.subscribe))}var By=Qg(function(v){return function(){v(this),this.name="EmptyError",this.message="no elements in sequence"}});function Ci(v,y){return new Promise(function(b,T){var R=!1,F;v.subscribe({next:function(z){F=z,R=!0},error:T,complete:function(){R?b(F):T(new By)}})})}function Y_(v,y){return new Promise(function(b,T){var R=new Vf({next:function(F){b(F),R.unsubscribe()},error:T,complete:function(){T(new By)}});v.subscribe(R)})}function vb(v){return v instanceof Date&&!isNaN(v)}function Ca(v,y){return vc(function(b,T){var R=0;b.subscribe(Mh(T,function(F){T.next(v.call(y,F,R++))}))})}var bb=Array.isArray;function xb(v,y){return bb(y)?v.apply(void 0,mu([],pu(y))):v(y)}function wb(v){return Ca(function(y){return xb(v,y)})}function Tb(v,y,b){return b===void 0&&(b=ng),function(T){Q_(y,function(){for(var R=v.length,F=new Array(R),z=R,u=R,oe=function(ve){Q_(y,function(){var Te=lm(v[ve],y),Ee=!1;Te.subscribe(Mh(T,function(ne){F[ve]=ne,Ee||(Ee=!0,u--),u||T.next(b(F.slice()))},function(){--z||T.complete()}))},T)},Q=0;Q<R;Q++)oe(Q)})}}function Q_(v,y,b){y()}function Sb(v,y,b,T,R,F,z,u){var oe=[],Q=0,ve=0,Te=!1,Ee=function(){Te&&!oe.length&&!Q&&y.complete()},ne=function(Ze){return Q<T?Pe(Ze):oe.push(Ze)},Pe=function(Ze){Q++;var bt=!1;bc(b(Ze,ve++)).subscribe(Mh(y,function(Vt){y.next(Vt)},function(){bt=!0},void 0,function(){if(bt)try{Q--;for(var Vt=function(){var Ot=oe.shift();z||Pe(Ot)};oe.length&&Q<T;)Vt();Ee()}catch(Ot){y.error(Ot)}}))};return v.subscribe(Mh(y,ne,function(){Te=!0,Ee()})),function(){}}function cm(v,y,b){return b===void 0&&(b=1/0),qr(y)?cm(function(T,R){return Ca(function(F,z){return y(T,F,R,z)})(bc(v(T,R)))},b):(typeof y=="number"&&(b=y),vc(function(T,R){return Sb(T,R,v,b)}))}function jy(v){return v===void 0&&(v=1/0),cm(ng,v)}function Mb(){return jy(1)}function Fy(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];return Mb()(lm(v,i_(v)))}function Uy(v){return new ln(function(y){bc(v()).subscribe(y)})}function Eb(v,y,b){return b===void 0&&(b=tb),new ln(function(T){var R=vb(v)?1e3-b.now():v;R<0&&(R=0);var F=0;return b.schedule(function(){T.closed||(T.next(F++),T.complete())},R)})}function Cb(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];var b=i_(v),T=nb(v,1/0),R=v;return R.length?R.length===1?bc(R[0]):jy(T)(lm(R,b)):wy}var Ab=Array.isArray;function zb(v){return v.length===1&&Ab(v[0])?v[0]:v}function $f(v,y){return vc(function(b,T){var R=0;b.subscribe(Mh(T,function(F){return v.call(y,F,R++)&&T.next(F)}))})}function r_(v){return vc(function(y,b){var T=null,R=!1,F;T=y.subscribe(Mh(b,void 0,void 0,function(z){F=bc(v(z,r_(v)(y))),T?(T.unsubscribe(),T=null,F.subscribe(b)):R=!0})),R&&(T.unsubscribe(),T=null,F.subscribe(b))})}function Ny(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];var b=rb(v);return b?q0(Ny.apply(void 0,mu([],pu(v))),wb(b)):vc(function(T,R){Tb(mu([T],pu(zb(v))))(R)})}function Pb(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];return Ny.apply(void 0,mu([],pu(v)))}function Vy(v){return vc(function(y,b){try{y.subscribe(b)}finally{b.add(v)}})}function Zy(v){v===void 0&&(v={});var y=v.connector,b=y===void 0?function(){return new Jg}:y,T=v.resetOnError,R=T===void 0?!0:T,F=v.resetOnComplete,z=F===void 0?!0:F,u=v.resetOnRefCountZero,oe=u===void 0?!0:u;return function(Q){var ve,Te,Ee,ne=0,Pe=!1,Ze=!1,bt=function(){Te==null||Te.unsubscribe(),Te=void 0},Vt=function(){bt(),ve=Ee=void 0,Pe=Ze=!1},Ot=function(){var Tt=ve;Vt(),Tt==null||Tt.unsubscribe()};return vc(function(Tt,qt){ne++,!Ze&&!Pe&&bt();var xt=Ee=Ee??b();qt.add(function(){ne--,ne===0&&!Ze&&!Pe&&(Te=kg(Ot,oe))}),xt.subscribe(qt),!ve&&ne>0&&(ve=new Vf({next:function(Bt){return xt.next(Bt)},error:function(Bt){Ze=!0,bt(),Te=kg(Vt,R,Bt),xt.error(Bt)},complete:function(){Pe=!0,bt(),Te=kg(Vt,z),xt.complete()}}),bc(Tt).subscribe(ve))})(Q)}}function kg(v,y){for(var b=[],T=2;T<arguments.length;T++)b[T-2]=arguments[T];if(y===!0){v();return}if(y!==!1){var R=new Vf({next:function(){R.unsubscribe(),v()}});return bc(y.apply(void 0,mu([],pu(b)))).subscribe(R)}}function Ib(v,y,b){var T,R=!1;return T=v,Zy({connector:function(){return new Q0(T,y,b)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:R})}function Db(v,y,b){var T=qr(v)||y||b?{next:v,error:y,complete:b}:v;return T?vc(function(R,F){var z;(z=T.subscribe)===null||z===void 0||z.call(T);var u=!0;R.subscribe(Mh(F,function(oe){var Q;(Q=T.next)===null||Q===void 0||Q.call(T,oe),F.next(oe)},function(){var oe;u=!1,(oe=T.complete)===null||oe===void 0||oe.call(T),F.complete()},function(oe){var Q;u=!1,(Q=T.error)===null||Q===void 0||Q.call(T,oe),F.error(oe)},function(){var oe,Q;u&&((oe=T.unsubscribe)===null||oe===void 0||oe.call(T)),(Q=T.finalize)===null||Q===void 0||Q.call(T)}))}):ng}function qy(v){return typeof v=="object"&&v!==null&&!Array.isArray(v)}var $y={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},n_={0:8203,1:8204,2:8205,3:65279},Rb=new Array(4).fill(String.fromCodePoint(n_[0])).join("");function kb(v){let y=JSON.stringify(v);return`${Rb}${Array.from(y).map(b=>{let T=b.charCodeAt(0);if(T>255)throw new Error(`Only ASCII edit info can be encoded. Error attempting to encode ${y} on character ${b} (${T})`);return Array.from(T.toString(4).padStart(4,"0")).map(R=>String.fromCodePoint(n_[R])).join("")}).join("")}`}function Lb(v){return!Number.isNaN(Number(v))||/[a-z]/i.test(v)&&!/\d+(?:[-:\/]\d+){2}(?:T\d+(?:[-:\/]\d+){1,2}(\.\d+)?Z?)?/.test(v)?!1:!!Date.parse(v)}function Ob(v){try{new URL(v,v.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}function _w(v,y,b="auto"){return b===!0||b==="auto"&&(Lb(v)||Ob(v))?v:`${v}${kb(y)}`}Object.fromEntries(Object.entries(n_).map(v=>v.reverse()));Object.fromEntries(Object.entries($y).map(v=>v.reverse()));var Bb=`${Object.values($y).map(v=>`\\u{${v.toString(16)}}`).join("")}`,K_=new RegExp(`[${Bb}]{4,}`,"gu");function jb(v){var y;return{cleaned:v.replace(K_,""),encoded:((y=v.match(K_))==null?void 0:y[0])||""}}function Fb(v){return v&&JSON.parse(jb(JSON.stringify(v)).cleaned)}function Ub(v){return Fb(v)}const Nb="drafts",Vb="versions",Zf=".",Km=`${Nb}${Zf}`,Gy=`${Vb}${Zf}`;function sg(v){return v.startsWith(Km)}function og(v){return v.startsWith(Gy)}function Zb(v){if(og(v)){const y=cg(v);return Km+y}return sg(v)?v:Km+v}function lg(v,y){if(y==="drafts"||y==="published")throw new Error('Version can not be "published" or "drafts"');return`${Gy}${y}${Zf}${cg(v)}`}function Hy(v){if(!og(v))return;const[y,b,...T]=v.split(Zf);return b}function cg(v){return og(v)?v.split(Zf).slice(2).join(Zf):sg(v)?v.slice(Km.length):v}let qb=v=>crypto.getRandomValues(new Uint8Array(v)),$b=(v,y,b)=>{let T=(2<<Math.log(v.length-1)/Math.LN2)-1,R=-~(1.6*T*y/v.length);return(F=y)=>{let z="";for(;;){let u=b(R),oe=R|0;for(;oe--;)if(z+=v[u[oe]&T]||"",z.length===F)return z}}},Gb=(v,y=21)=>$b(v,y,qb);const W_=/\r\n|[\n\r\u2028\u2029]/;function Hb(v,y,b){const T=v.split(W_),R={start:J_(y.start,T),end:y.end?J_(y.end,T):void 0},{start:F,end:z,markerLines:u}=Xb(R,T),oe=`${z}`.length;return v.split(W_,z).slice(F,z).map((Q,ve)=>{const Te=F+1+ve,Ee=` ${` ${Te}`.slice(-oe)} |`,ne=u[Te],Pe=!u[Te+1];if(!ne)return` ${Ee}${Q.length>0?` ${Q}`:""}`;let Ze="";if(Array.isArray(ne)){const bt=Q.slice(0,Math.max(ne[0]-1,0)).replace(/[^\t]/g," "),Vt=ne[1]||1;Ze=[`
 `,Ee.replace(/\d/g," ")," ",bt,"^".repeat(Vt)].join(""),Pe&&b&&(Ze+=" "+b)}return[">",Ee,Q.length>0?` ${Q}`:"",Ze].join("")}).join(`
`)}function Xb(v,y){const b={...v.start},T={...b,...v.end},R=2,F=3,z=b.line??-1,u=b.column??0,oe=T.line,Q=T.column;let ve=Math.max(z-(R+1),0),Te=Math.min(y.length,oe+F);z===-1&&(ve=0),oe===-1&&(Te=y.length);const Ee=oe-z,ne={};if(Ee)for(let Pe=0;Pe<=Ee;Pe++){const Ze=Pe+z;if(!u)ne[Ze]=!0;else if(Pe===0){const bt=y[Ze-1].length;ne[Ze]=[u,bt-u+1]}else if(Pe===Ee)ne[Ze]=[0,Q];else{const bt=y[Ze-Pe].length;ne[Ze]=[0,bt]}}else u===Q?u?ne[z]=[u,0]:ne[z]=!0:ne[z]=[u,Q-u];return{start:ve,end:Te,markerLines:ne}}function J_(v,y){var T;let b=0;for(let R=0;R<y.length;R++){const F=y[R].length+1;if(b+F>v)return{line:R+1,column:v-b};b+=F}return{line:y.length,column:((T=y[y.length-1])==null?void 0:T.length)??0}}const Lg=5;class Yb extends Error{constructor(b,T){const R=Xy(b,T);super(R.message);Qt(this,"response");Qt(this,"statusCode",400);Qt(this,"responseBody");Qt(this,"details");Object.assign(this,R)}}class Qb extends Error{constructor(b){const T=Xy(b);super(T.message);Qt(this,"response");Qt(this,"statusCode",500);Qt(this,"responseBody");Qt(this,"details");Object.assign(this,T)}}function Xy(v,y){var F,z;const b=v.body,T={response:v,statusCode:v.statusCode,responseBody:Jb(b,v),message:"",details:void 0};if(!qy(b))return T.message=Og(v,b),T;const R=b.error;if(typeof R=="string"&&typeof b.message=="string")return T.message=`${R} - ${b.message}`,T;if(typeof R!="object"||R===null)return typeof R=="string"?T.message=R:typeof b.message=="string"?T.message=b.message:T.message=Og(v,b),T;if(Kb(R)||Wb(R)){const u=R.items||[],oe=u.slice(0,Lg).map(ve=>{var Te;return(Te=ve.error)==null?void 0:Te.description}).filter(Boolean);let Q=oe.length?`:
- ${oe.join(`
- `)}`:"";return u.length>Lg&&(Q+=`
...and ${u.length-Lg} more`),T.message=`${R.description}${Q}`,T.details=b.error,T}if(Yy(R)){const u=(z=(F=y==null?void 0:y.options)==null?void 0:F.query)==null?void 0:z.tag;return T.message=Qy(R,u),T.details=b.error,T}return"description"in R&&typeof R.description=="string"?(T.message=R.description,T.details=R,T):(T.message=Og(v,b),T)}function Kb(v){return"type"in v&&v.type==="mutationError"&&"description"in v&&typeof v.description=="string"}function Wb(v){return"type"in v&&v.type==="actionError"&&"description"in v&&typeof v.description=="string"}function Yy(v){return qy(v)&&v.type==="queryParseError"&&typeof v.query=="string"&&typeof v.start=="number"&&typeof v.end=="number"}function Qy(v,y){const{query:b,start:T,end:R,description:F}=v;if(!b||typeof T>"u")return`GROQ query parse error: ${F}`;const z=y?`

Tag: ${y}`:"";return`GROQ query parse error:
${Hb(b,{start:T,end:R},F)}${z}`}function Og(v,y){const b=typeof y=="string"?` (${ex(y,100)})`:"",T=v.statusMessage?` ${v.statusMessage}`:"";return`${v.method}-request to ${v.url} resulted in HTTP ${v.statusCode}${T}${b}`}function Jb(v,y){return(y.headers["content-type"]||"").toLowerCase().indexOf("application/json")!==-1?JSON.stringify(v,null,2):v}function ex(v,y){return v.length>y?`${v.slice(0,y)}`:v}class tx extends Error{constructor({projectId:b}){super("CorsOriginError");Qt(this,"projectId");Qt(this,"addOriginUrl");this.name="CorsOriginError",this.projectId=b;const T=new URL(`https://sanity.io/manage/project/${b}/api`);if(typeof location<"u"){const{origin:R}=location;T.searchParams.set("cors","add"),T.searchParams.set("origin",R),this.addOriginUrl=T,this.message=`The current origin is not allowed to connect to the Live Content API. Add it here: ${T}`}else this.message=`The current origin is not allowed to connect to the Live Content API. Change your configuration here: ${T}`}}const ix={onResponse:(v,y)=>{if(v.statusCode>=500)throw new Qb(v);if(v.statusCode>=400)throw new Yb(v,y);return v}};function rx(){const v={};return{onResponse:y=>{const b=y.headers["x-sanity-warning"],T=Array.isArray(b)?b:[b];for(const R of T)!R||v[R]||(v[R]=!0,console.warn(R));return y}}}function ey(v){return M0([Yg({shouldRetry:nx}),...v,rx(),P0(),I0(),k0(),ix,R0({implementation:ln})])}function nx(v,y,b){if(b.maxRetries===0)return!1;const T=b.method==="GET"||b.method==="HEAD",R=(b.uri||b.url).startsWith("/data/query"),F=v.response&&(v.response.statusCode===429||v.response.statusCode===502||v.response.statusCode===503);return(T||R)&&F?!0:Yg.shouldRetry(v,y,b)}const ax="https://www.sanity.io/help/";function a_(v){return ax+v}const ty=["image","file"],iy=["before","after","replace"],Ky=v=>{if(!/^(~[a-z0-9]{1}[-\w]{0,63}|[a-z0-9]{1}[-\w]{0,63})$/.test(v))throw new Error("Datasets can only contain lowercase characters, numbers, underscores and dashes, and start with tilde, and be maximum 64 characters")},sx=v=>{if(!/^[-a-z0-9]+$/i.test(v))throw new Error("`projectId` can only contain only a-z, 0-9 and dashes")},ox=v=>{if(ty.indexOf(v)===-1)throw new Error(`Invalid asset type: ${v}. Must be one of ${ty.join(", ")}`)},qp=(v,y)=>{if(y===null||typeof y!="object"||Array.isArray(y))throw new Error(`${v}() takes an object of properties`)},Wy=(v,y)=>{if(typeof y!="string"||!/^[a-z0-9_][a-z0-9_.-]{0,127}$/i.test(y)||y.includes(".."))throw new Error(`${v}(): "${y}" is not a valid document ID`)},qf=(v,y)=>{if(!y._id)throw new Error(`${v}() requires that the document contains an ID ("_id" property)`);Wy(v,y._id)},lx=(v,y)=>{if(typeof y!="string")throw new Error(`\`${v}()\`: \`${y}\` is not a valid document type`)},Jy=(v,y)=>{if(!y._type)throw new Error(`\`${v}()\` requires that the document contains a type (\`_type\` property)`);lx(v,y._type)},cx=(v,y)=>{if(y._id&&y._id!==v)throw new Error(`The provided document ID (\`${y._id}\`) does not match the generated version ID (\`${v}\`)`)},ux=(v,y,b)=>{const T="insert(at, selector, items)";if(iy.indexOf(v)===-1){const R=iy.map(F=>`"${F}"`).join(", ");throw new Error(`${T} takes an "at"-argument which is one of: ${R}`)}if(typeof y!="string")throw new Error(`${T} takes a "selector"-argument which must be a string`);if(!Array.isArray(b))throw new Error(`${T} takes an "items"-argument which must be an array`)},wd=v=>{if(!v.dataset)throw new Error("`dataset` must be provided to perform queries");return v.dataset||""},ev=v=>{if(typeof v!="string"||!/^[a-z0-9._-]{1,75}$/i.test(v))throw new Error("Tag can only contain alphanumeric characters, underscores, dashes and dots, and be between one and 75 characters long.");return v},tv=v=>{if(!v["~experimental_resource"])throw new Error("`resource` must be provided to perform resource queries");const{type:y,id:b}=v["~experimental_resource"];switch(y){case"dataset":{if(b.split(".").length!==2)throw new Error('Dataset resource ID must be in the format "project.dataset"');return}case"dashboard":case"media-library":case"canvas":return;default:throw new Error(`Unsupported resource type: ${y.toString()}`)}},yc=(v,y)=>{if(y["~experimental_resource"])throw new Error(`\`${v}\` does not support resource-based operations`)};function hx(v){let y=!1,b;return(...T)=>(y||(b=v(...T),y=!0),b)}const Eh=v=>hx((...y)=>console.warn(v.join(" "),...y)),dx=Eh(["Because you set `withCredentials` to true, we will override your `useCdn`","setting to be false since (cookie-based) credentials are never set on the CDN"]),fx=Eh(["Since you haven't set a value for `useCdn`, we will deliver content using our","global, edge-cached API-CDN. If you wish to have content delivered faster, set","`useCdn: false` to use the Live API. Note: You may incur higher costs using the live API."]),px=Eh(["The Sanity client is configured with the `perspective` set to `drafts` or `previewDrafts`, which doesn't support the API-CDN.","The Live API will be used instead. Set `useCdn: false` in your configuration to hide this warning."]),mx=Eh(["The `previewDrafts` perspective has been renamed to  `drafts` and will be removed in a future API version"]),gx=Eh(["You have configured Sanity client to use a token in the browser. This may cause unintentional security issues.",`See ${a_("js-client-browser-token")} for more information and how to hide this warning.`]),_x=Eh(["You have configured Sanity client to use a token, but also provided `withCredentials: true`.","This is no longer supported - only token will be used - remove `withCredentials: true`."]),yx=Eh(["Using the Sanity client without specifying an API version is deprecated.",`See ${a_("js-client-api-version")}`]),vx=Eh(["The default export of @sanity/client has been deprecated. Use the named export `createClient` instead."]),bx="apicdn.sanity.io",$p={apiHost:"https://api.sanity.io",apiVersion:"1",useProjectHostname:!0,stega:{enabled:!1}},xx=["localhost","127.0.0.1","0.0.0.0"],wx=v=>xx.indexOf(v)!==-1;function Tx(v){if(v==="1"||v==="X")return;const y=new Date(v);if(!(/^\d{4}-\d{2}-\d{2}$/.test(v)&&y instanceof Date&&y.getTime()>0))throw new Error("Invalid API version string, expected `1` or date in format `YYYY-MM-DD`")}function iv(v){if(Array.isArray(v)&&v.length>1&&v.includes("raw"))throw new TypeError('Invalid API perspective value: "raw". The raw-perspective can not be combined with other perspectives')}const rv=(v,y)=>{const b={...y,...v,stega:{...typeof y.stega=="boolean"?{enabled:y.stega}:y.stega||$p.stega,...typeof v.stega=="boolean"?{enabled:v.stega}:v.stega||{}}};b.apiVersion||yx();const T={...$p,...b},R=T.useProjectHostname&&!T["~experimental_resource"];if(typeof Promise>"u"){const Ee=a_("js-client-promise-polyfill");throw new Error(`No native Promise-implementation found, polyfill needed - see ${Ee}`)}if(R&&!T.projectId)throw new Error("Configuration must contain `projectId`");if(T["~experimental_resource"]&&tv(T),typeof T.perspective<"u"&&iv(T.perspective),"encodeSourceMap"in T)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMap' is not supported in '@sanity/client'. Did you mean 'stega.enabled'?");if("encodeSourceMapAtPath"in T)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMapAtPath' is not supported in '@sanity/client'. Did you mean 'stega.filter'?");if(typeof T.stega.enabled!="boolean")throw new Error(`stega.enabled must be a boolean, received ${T.stega.enabled}`);if(T.stega.enabled&&T.stega.studioUrl===void 0)throw new Error("stega.studioUrl must be defined when stega.enabled is true");if(T.stega.enabled&&typeof T.stega.studioUrl!="string"&&typeof T.stega.studioUrl!="function")throw new Error(`stega.studioUrl must be a string or a function, received ${T.stega.studioUrl}`);const F=typeof window<"u"&&window.location&&window.location.hostname,z=F&&wx(window.location.hostname),u=!!T.token;T.withCredentials&&u&&(_x(),T.withCredentials=!1),F&&z&&u&&T.ignoreBrowserTokenWarning!==!0?gx():typeof T.useCdn>"u"&&fx(),R&&sx(T.projectId),T.dataset&&Ky(T.dataset),"requestTagPrefix"in T&&(T.requestTagPrefix=T.requestTagPrefix?ev(T.requestTagPrefix).replace(/\.+$/,""):void 0),T.apiVersion=`${T.apiVersion}`.replace(/^v/,""),T.isDefaultApi=T.apiHost===$p.apiHost,T.useCdn===!0&&T.withCredentials&&dx(),T.useCdn=T.useCdn!==!1&&!T.withCredentials,Tx(T.apiVersion);const oe=T.apiHost.split("://",2),Q=oe[0],ve=oe[1],Te=T.isDefaultApi?bx:ve;return R?(T.url=`${Q}://${T.projectId}.${ve}/v${T.apiVersion}`,T.cdnUrl=`${Q}://${T.projectId}.${Te}/v${T.apiVersion}`):(T.url=`${T.apiHost}/v${T.apiVersion}`,T.cdnUrl=T.url),T};class nv extends Error{constructor(){super(...arguments);Qt(this,"name","ConnectionFailedError")}}class Sx extends Error{constructor(b,T,R={}){super(b,R);Qt(this,"name","DisconnectError");Qt(this,"reason");this.reason=T}}class Mx extends Error{constructor(b,T){super(b);Qt(this,"name","ChannelError");Qt(this,"data");this.data=T}}class Ex extends Error{constructor(b,T,R={}){super(b,R);Qt(this,"name","MessageError");Qt(this,"data");this.data=T}}class ry extends Error{constructor(){super(...arguments);Qt(this,"name","MessageParseError")}}const Cx=["channelError","disconnect"];function av(v,y){return Uy(()=>{const b=v();return yb(b)?b:ag(b)}).pipe(cm(b=>Ax(b,y)))}function Ax(v,y){return new ln(b=>{const T=y.includes("open"),R=y.includes("reconnect");function F(Q){if("data"in Q){const[ve,Te]=ny(Q);b.error(ve?new ry("Unable to parse EventSource error message",{cause:Te}):new Ex((Te==null?void 0:Te.data).message,Te));return}v.readyState===v.CLOSED?b.error(new nv("EventSource connection failed")):R&&b.next({type:"reconnect"})}function z(){b.next({type:"open"})}function u(Q){var Ee;const[ve,Te]=ny(Q);if(ve){b.error(new ry("Unable to parse EventSource message",{cause:ve}));return}if(Q.type==="channelError"){const ne=new URL(v.url).searchParams.get("tag");b.error(new Mx(zx(Te==null?void 0:Te.data,ne),Te.data));return}if(Q.type==="disconnect"){b.error(new Sx(`Server disconnected client: ${((Ee=Te.data)==null?void 0:Ee.reason)||"unknown error"}`));return}b.next({type:Q.type,id:Q.lastEventId,...Te.data?{data:Te.data}:{}})}v.addEventListener("error",F),T&&v.addEventListener("open",z);const oe=[...new Set([...Cx,...y])].filter(Q=>Q!=="error"&&Q!=="open"&&Q!=="reconnect");return oe.forEach(Q=>v.addEventListener(Q,u)),()=>{v.removeEventListener("error",F),T&&v.removeEventListener("open",z),oe.forEach(Q=>v.removeEventListener(Q,u)),v.close()}})}function ny(v){try{const y=typeof v.data=="string"&&JSON.parse(v.data);return[null,{type:v.type,id:v.lastEventId,...Px(y)?{}:{data:y}}]}catch(y){return[y,null]}}function zx(v,y){const b=v.error;return b?Yy(b)?Qy(b,y):b.description?b.description:typeof b=="string"?b:JSON.stringify(b,null,2):v.message||"Unknown listener error"}function Px(v){for(const y in v)return!1;return!0}function sv(v){if(typeof v=="string")return{id:v};if(Array.isArray(v))return{query:"*[_id in $ids]",params:{ids:v}};if(typeof v=="object"&&v!==null&&"query"in v&&typeof v.query=="string")return"params"in v&&typeof v.params=="object"&&v.params!==null?{query:v.query,params:v.params}:{query:v.query};const y=["* Document ID (<docId>)","* Array of document IDs","* Object containing `query`"].join(`
`);throw new Error(`Unknown selection - must be one of:

${y}`)}class ov{constructor(y,b={}){Qt(this,"selection");Qt(this,"operations");this.selection=y,this.operations=b}set(y){return this._assign("set",y)}setIfMissing(y){return this._assign("setIfMissing",y)}diffMatchPatch(y){return qp("diffMatchPatch",y),this._assign("diffMatchPatch",y)}unset(y){if(!Array.isArray(y))throw new Error("unset(attrs) takes an array of attributes to unset, non-array given");return this.operations=Object.assign({},this.operations,{unset:y}),this}inc(y){return this._assign("inc",y)}dec(y){return this._assign("dec",y)}insert(y,b,T){return ux(y,b,T),this._assign("insert",{[y]:b,items:T})}append(y,b){return this.insert("after",`${y}[-1]`,b)}prepend(y,b){return this.insert("before",`${y}[0]`,b)}splice(y,b,T,R){const F=typeof T>"u"||T===-1,z=b<0?b-1:b,u=F?-1:Math.max(0,b+T),oe=z<0&&u>=0?"":u,Q=`${y}[${z}:${oe}]`;return this.insert("replace",Q,R||[])}ifRevisionId(y){return this.operations.ifRevisionID=y,this}serialize(){return{...sv(this.selection),...this.operations}}toJSON(){return this.serialize()}reset(){return this.operations={},this}_assign(y,b,T=!0){return qp(y,b),this.operations=Object.assign({},this.operations,{[y]:Object.assign({},T&&this.operations[y]||{},b)}),this}_set(y,b){return this._assign(y,b,!1)}}var gd;const p_=class p_ extends ov{constructor(b,T,R){super(b,T);pi(this,gd);hi(this,gd,R)}clone(){return new p_(this.selection,{...this.operations},ze(this,gd))}commit(b){if(!ze(this,gd))throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const T=typeof this.selection=="string",R=Object.assign({returnFirst:T,returnDocuments:!0},b);return ze(this,gd).mutate({patch:this.serialize()},R)}};gd=new WeakMap;let xd=p_;var _d;const m_=class m_ extends ov{constructor(b,T,R){super(b,T);pi(this,_d);hi(this,_d,R)}clone(){return new m_(this.selection,{...this.operations},ze(this,_d))}commit(b){if(!ze(this,_d))throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const T=typeof this.selection=="string",R=Object.assign({returnFirst:T,returnDocuments:!0},b);return ze(this,_d).mutate({patch:this.serialize()},R)}};_d=new WeakMap;let Sh=m_;const lv={returnDocuments:!1};class cv{constructor(y=[],b){Qt(this,"operations");Qt(this,"trxId");this.operations=y,this.trxId=b}create(y){return qp("create",y),this._add({create:y})}createIfNotExists(y){const b="createIfNotExists";return qp(b,y),qf(b,y),this._add({[b]:y})}createOrReplace(y){const b="createOrReplace";return qp(b,y),qf(b,y),this._add({[b]:y})}delete(y){return Wy("delete",y),this._add({delete:{id:y}})}transactionId(y){return y?(this.trxId=y,this):this.trxId}serialize(){return[...this.operations]}toJSON(){return this.serialize()}reset(){return this.operations=[],this}_add(y){return this.operations.push(y),this}}var cu;const g_=class g_ extends cv{constructor(b,T,R){super(b,R);pi(this,cu);hi(this,cu,T)}clone(){return new g_([...this.operations],ze(this,cu),this.trxId)}commit(b){if(!ze(this,cu))throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return ze(this,cu).mutate(this.serialize(),Object.assign({transactionId:this.trxId},lv,b||{}))}patch(b,T){const R=typeof T=="function",F=typeof b!="string"&&b instanceof Sh,z=typeof b=="object"&&("query"in b||"id"in b);if(F)return this._add({patch:b.serialize()});if(R){const u=T(new Sh(b,{},ze(this,cu)));if(!(u instanceof Sh))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:u.serialize()})}if(z){const u=new Sh(b,T||{},ze(this,cu));return this._add({patch:u.serialize()})}return this._add({patch:{id:b,...T}})}};cu=new WeakMap;let Wm=g_;var _h;const __=class __ extends cv{constructor(b,T,R){super(b,R);pi(this,_h);hi(this,_h,T)}clone(){return new __([...this.operations],ze(this,_h),this.trxId)}commit(b){if(!ze(this,_h))throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return ze(this,_h).mutate(this.serialize(),Object.assign({transactionId:this.trxId},lv,b||{}))}patch(b,T){const R=typeof T=="function";if(typeof b!="string"&&b instanceof xd)return this._add({patch:b.serialize()});if(R){const F=T(new xd(b,{},ze(this,_h)));if(!(F instanceof xd))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:F.serialize()})}return this._add({patch:{id:b,...T}})}};_h=new WeakMap;let Jm=__;const Ix="X-Sanity-Project-ID";function Dx(v,y={}){const b={};v.headers&&Object.assign(b,v.headers);const T=y.token||v.token;T&&(b.Authorization=`Bearer ${T}`),!y.useGlobalApi&&!v.useProjectHostname&&v.projectId&&(b[Ix]=v.projectId);const R=!!(typeof y.withCredentials>"u"?v.withCredentials:y.withCredentials),F=typeof y.timeout>"u"?v.timeout:y.timeout;return Object.assign({},y,{headers:Object.assign({},b,y.headers||{}),timeout:typeof F>"u"?5*60*1e3:F,proxy:y.proxy||v.proxy,json:!0,withCredentials:R,fetch:typeof y.fetch=="object"&&typeof v.fetch=="object"?{...v.fetch,...y.fetch}:y.fetch||v.fetch})}const uv=({query:v,params:y={},options:b={}})=>{const T=new URLSearchParams,{tag:R,includeMutations:F,returnQuery:z,...u}=b;R&&T.append("tag",R),T.append("query",v);for(const[oe,Q]of Object.entries(y))Q!==void 0&&T.append(`$${oe}`,JSON.stringify(Q));for(const[oe,Q]of Object.entries(u))Q&&T.append(oe,`${Q}`);return z===!1&&T.append("returnQuery","false"),F===!1&&T.append("includeMutations","false"),`?${T}`},Rx=(v,y)=>v===!1?void 0:typeof v>"u"?y:v,kx=(v={})=>({dryRun:v.dryRun,returnIds:!0,returnDocuments:Rx(v.returnDocuments,!0),visibility:v.visibility||"sync",autoGenerateArrayKeys:v.autoGenerateArrayKeys,skipCrossDatasetReferenceValidation:v.skipCrossDatasetReferenceValidation}),s_=v=>v.type==="response",Lx=v=>v.body,Ox=(v,y)=>v.reduce((b,T)=>(b[y(T)]=T,b),Object.create(null)),Bx=11264;function hv(v,y,b,T,R={},F={}){const z="stega"in F?{...b||{},...typeof F.stega=="boolean"?{enabled:F.stega}:F.stega||{}}:b,u=z.enabled?Ub(R):R,oe=F.filterResponse===!1?Pe=>Pe:Pe=>Pe.result,{cache:Q,next:ve,...Te}={useAbortSignal:typeof F.signal<"u",resultSourceMap:z.enabled?"withKeyArraySelector":F.resultSourceMap,...F,returnQuery:F.filterResponse===!1&&F.returnQuery!==!1},Ee=typeof Q<"u"||typeof ve<"u"?{...Te,fetch:{cache:Q,next:ve}}:Te,ne=Td(v,y,"query",{query:T,params:u},Ee);return z.enabled?ne.pipe(Pb(lm(uy(()=>import("./stegaEncodeSourceMap-D3_FC887.js"),[]).then(function(Pe){return Pe.stegaEncodeSourceMap$1}).then(({stegaEncodeSourceMap:Pe})=>Pe))),Ca(([Pe,Ze])=>{const bt=Ze(Pe.result,Pe.resultSourceMap,z);return oe({...Pe,result:bt})})):ne.pipe(Ca(oe))}function ug(v,y,b,T={}){const R=(()=>{if(!T.releaseId)return b;const z=Hy(b);if(!z){if(sg(b))throw new Error(`The document ID (\`${b}\`) is a draft, but \`options.releaseId\` is set as \`${T.releaseId}\``);return lg(b,T.releaseId)}if(z!==T.releaseId)throw new Error(`The document ID (\`${b}\`) is already a version of \`${z}\` release, but this does not match the provided \`options.releaseId\` (\`${T.releaseId}\`)`);return b})(),F={uri:Po(v,"doc",R),json:!0,tag:T.tag,signal:T.signal};return hm(v,y,F).pipe($f(s_),Ca(z=>z.body.documents&&z.body.documents[0]))}function dv(v,y,b,T={}){const R={uri:Po(v,"doc",b.join(",")),json:!0,tag:T.tag,signal:T.signal};return hm(v,y,R).pipe($f(s_),Ca(F=>{const z=Ox(F.body.documents||[],u=>u._id);return b.map(u=>z[u]||null)}))}function fv(v,y,b,T={}){return Td(v,y,"query",{query:"*[sanity::partOfRelease($releaseId)]",params:{releaseId:b}},T)}function pv(v,y,b,T){return qf("createIfNotExists",b),hg(v,y,b,"createIfNotExists",T)}function mv(v,y,b,T){return qf("createOrReplace",b),hg(v,y,b,"createOrReplace",T)}function gv(v,y,b,T,R){return qf("createVersion",b),Jy("createVersion",b),on(v,y,{actionType:"sanity.action.document.version.create",publishedId:T,document:b},R)}function _v(v,y,b,T){return Td(v,y,"mutate",{mutations:[{delete:sv(b)}]},T)}function yv(v,y,b,T=!1,R){return on(v,y,{actionType:"sanity.action.document.version.discard",versionId:b,purge:T},R)}function vv(v,y,b,T){return qf("replaceVersion",b),Jy("replaceVersion",b),on(v,y,{actionType:"sanity.action.document.version.replace",document:b},T)}function bv(v,y,b,T,R){return on(v,y,{actionType:"sanity.action.document.version.unpublish",versionId:b,publishedId:T},R)}function xv(v,y,b,T){let R;b instanceof Sh||b instanceof xd?R={patch:b.serialize()}:b instanceof Wm||b instanceof Jm?R=b.serialize():R=b;const F=Array.isArray(R)?R:[R],z=T&&T.transactionId||void 0;return Td(v,y,"mutate",{mutations:F,transactionId:z},T)}function on(v,y,b,T){const R=Array.isArray(b)?b:[b],F=T&&T.transactionId||void 0,z=T&&T.skipCrossDatasetReferenceValidation||void 0,u=T&&T.dryRun||void 0;return Td(v,y,"actions",{actions:R,transactionId:F,skipCrossDatasetReferenceValidation:z,dryRun:u},T)}function Td(v,y,b,T,R={}){const F=b==="mutate",z=b==="actions",u=b==="query",oe=F||z?"":uv(T),Q=!F&&!z&&oe.length<Bx,ve=Q?oe:"",Te=R.returnFirst,{timeout:Ee,token:ne,tag:Pe,headers:Ze,returnQuery:bt,lastLiveEventId:Vt,cacheMode:Ot}=R,Tt=Po(v,b,ve),qt={method:Q?"GET":"POST",uri:Tt,json:!0,body:Q?void 0:T,query:F&&kx(R),timeout:Ee,headers:Ze,token:ne,tag:Pe,returnQuery:bt,perspective:R.perspective,resultSourceMap:R.resultSourceMap,lastLiveEventId:Array.isArray(Vt)?Vt[0]:Vt,cacheMode:Ot,canUseCdn:u,signal:R.signal,fetch:R.fetch,useAbortSignal:R.useAbortSignal,useCdn:R.useCdn};return hm(v,y,qt).pipe($f(s_),Ca(Lx),Ca(xt=>{if(!F)return xt;const Bt=xt.results||[];if(R.returnDocuments)return Te?Bt[0]&&Bt[0].document:Bt.map(Oi=>Oi.document);const Pi=Te?"documentId":"documentIds",ti=Te?Bt[0]&&Bt[0].id:Bt.map(Oi=>Oi.id);return{transactionId:xt.transactionId,results:Bt,[Pi]:ti}}))}function hg(v,y,b,T,R={}){const F={[T]:b},z=Object.assign({returnFirst:!0,returnDocuments:!0},R);return Td(v,y,"mutate",{mutations:[F]},z)}const um=v=>v.config().dataset!==void 0&&v.config().projectId!==void 0||v.config()["~experimental_resource"]!==void 0,wv=(v,y)=>um(v)&&y.startsWith(Po(v,"query")),jx=(v,y)=>um(v)&&y.startsWith(Po(v,"mutate")),Fx=(v,y)=>um(v)&&y.startsWith(Po(v,"doc","")),Ux=(v,y)=>um(v)&&y.startsWith(Po(v,"listen")),Nx=(v,y)=>um(v)&&y.startsWith(Po(v,"history","")),Vx=(v,y)=>y.startsWith("/data/")||wv(v,y)||jx(v,y)||Fx(v,y)||Ux(v,y)||Nx(v,y);function hm(v,y,b){const T=b.url||b.uri,R=v.config(),F=typeof b.canUseCdn>"u"?["GET","HEAD"].indexOf(b.method||"GET")>=0&&Vx(v,T):b.canUseCdn;let z=(b.useCdn??R.useCdn)&&F;const u=b.tag&&R.requestTagPrefix?[R.requestTagPrefix,b.tag].join("."):b.tag||R.requestTagPrefix;if(u&&b.tag!==null&&(b.query={tag:ev(u),...b.query}),["GET","HEAD","POST"].indexOf(b.method||"GET")>=0&&wv(v,T)){const ve=b.resultSourceMap??R.resultSourceMap;ve!==void 0&&ve!==!1&&(b.query={resultSourceMap:ve,...b.query});const Te=b.perspective||R.perspective;typeof Te<"u"&&(Te==="previewDrafts"&&mx(),iv(Te),b.query={perspective:Array.isArray(Te)?Te.join(","):Te,...b.query},(Array.isArray(Te)&&Te.length>0||Te==="previewDrafts"||Te==="drafts")&&z&&(z=!1,px())),b.lastLiveEventId&&(b.query={...b.query,lastLiveEventId:b.lastLiveEventId}),b.returnQuery===!1&&(b.query={returnQuery:"false",...b.query}),z&&b.cacheMode=="noStale"&&(b.query={cacheMode:"noStale",...b.query})}const oe=Dx(R,Object.assign({},b,{url:o_(v,T,z)})),Q=new ln(ve=>y(oe,R.requester).subscribe(ve));return b.signal?Q.pipe(Zx(b.signal)):Q}function Aa(v,y,b){return hm(v,y,b).pipe($f(T=>T.type==="response"),Ca(T=>T.body))}function Po(v,y,b){const T=v.config();if(T["~experimental_resource"]){tv(T);const z=Gx(T),u=b!==void 0?`${y}/${b}`:y;return`${z}/${u}`.replace(/\/($|\?)/,"$1")}const R=wd(T),F=`/${y}/${R}`;return`/data${b!==void 0?`${F}/${b}`:F}`.replace(/\/($|\?)/,"$1")}function o_(v,y,b=!1){const{url:T,cdnUrl:R}=v.config();return`${b?R:T}/${y.replace(/^\//,"")}`}function Zx(v){return y=>new ln(b=>{const T=()=>b.error($x(v));if(v&&v.aborted){T();return}const R=y.subscribe(b);return v.addEventListener("abort",T),()=>{v.removeEventListener("abort",T),R.unsubscribe()}})}const qx=!!globalThis.DOMException;function $x(v){if(qx)return new DOMException((v==null?void 0:v.reason)??"The operation was aborted.","AbortError");const y=new Error((v==null?void 0:v.reason)??"The operation was aborted.");return y.name="AbortError",y}const Gx=v=>{if(!v["~experimental_resource"])throw new Error("`resource` must be provided to perform resource queries");const{type:y,id:b}=v["~experimental_resource"];switch(y){case"dataset":{const T=b.split(".");if(T.length!==2)throw new Error('Dataset ID must be in the format "project.dataset"');return`/projects/${T[0]}/datasets/${T[1]}`}case"canvas":return`/canvases/${b}`;case"media-library":return`/media-libraries/${b}`;case"dashboard":return`/dashboards/${b}`;default:throw new Error(`Unsupported resource type: ${y.toString()}`)}};function Tv(v,y,b){const T=wd(v.config());return Aa(v,y,{method:"POST",uri:`/agent/action/generate/${T}`,body:b})}function Hx(v,y,b){const T=wd(v.config());return Aa(v,y,{method:"POST",uri:`/agent/action/patch/${T}`,body:b})}function Xx(v,y,b){const T=wd(v.config());return Aa(v,y,{method:"POST",uri:`/agent/action/prompt/${T}`,body:b})}function Sv(v,y,b){const T=wd(v.config());return Aa(v,y,{method:"POST",uri:`/agent/action/transform/${T}`,body:b})}function Mv(v,y,b){const T=wd(v.config());return Aa(v,y,{method:"POST",uri:`/agent/action/translate/${T}`,body:b})}var yd,vd;class Yx{constructor(y,b){pi(this,yd);pi(this,vd);hi(this,yd,y),hi(this,vd,b)}generate(y){return Tv(ze(this,yd),ze(this,vd),y)}transform(y){return Sv(ze(this,yd),ze(this,vd),y)}translate(y){return Mv(ze(this,yd),ze(this,vd),y)}}yd=new WeakMap,vd=new WeakMap;var uu,hu;class Qx{constructor(y,b){pi(this,uu);pi(this,hu);hi(this,uu,y),hi(this,hu,b)}generate(y){return Ci(Tv(ze(this,uu),ze(this,hu),y))}transform(y){return Ci(Sv(ze(this,uu),ze(this,hu),y))}translate(y){return Ci(Mv(ze(this,uu),ze(this,hu),y))}prompt(y){return Ci(Xx(ze(this,uu),ze(this,hu),y))}patch(y){return Ci(Hx(ze(this,uu),ze(this,hu),y))}}uu=new WeakMap,hu=new WeakMap;var Jp,em;class Kx{constructor(y,b){pi(this,Jp);pi(this,em);hi(this,Jp,y),hi(this,em,b)}upload(y,b,T){return Ev(ze(this,Jp),ze(this,em),y,b,T)}}Jp=new WeakMap,em=new WeakMap;var tm,im;class Wx{constructor(y,b){pi(this,tm);pi(this,im);hi(this,tm,y),hi(this,im,b)}upload(y,b,T){const R=Ev(ze(this,tm),ze(this,im),y,b,T);return Ci(R.pipe($f(F=>F.type==="response"),Ca(F=>F.body.document)))}}tm=new WeakMap,im=new WeakMap;function Ev(v,y,b,T,R={}){ox(b);let F=R.extract||void 0;F&&!F.length&&(F=["none"]);const z=v.config(),u=e1(R,T),{tag:oe,label:Q,title:ve,description:Te,creditLine:Ee,filename:ne,source:Pe}=u,Ze={label:Q,title:ve,description:Te,filename:ne,meta:F,creditLine:Ee};return Pe&&(Ze.sourceId=Pe.id,Ze.sourceName=Pe.name,Ze.sourceUrl=Pe.url),hm(v,y,{tag:oe,method:"POST",timeout:u.timeout||0,uri:Jx(z,b),headers:u.contentType?{"Content-Type":u.contentType}:{},query:Ze,body:T})}function Jx(v,y){const b=y==="image"?"images":"files";if(v["~experimental_resource"]){const{type:R,id:F}=v["~experimental_resource"];switch(R){case"dataset":throw new Error("Assets are not supported for dataset resources, yet. Configure the client with `{projectId: <projectId>, dataset: <datasetId>}` instead.");case"canvas":return`/canvases/${F}/assets/${b}`;case"media-library":return`/media-libraries/${F}/upload`;case"dashboard":return`/dashboards/${F}/assets/${b}`;default:throw new Error(`Unsupported resource type: ${R.toString()}`)}}const T=wd(v);return`assets/${b}/${T}`}function e1(v,y){return typeof File>"u"||!(y instanceof File)?v:Object.assign({filename:v.preserveFilename===!1?void 0:y.name,contentType:y.type},v)}var t1=(v,y)=>Object.keys(y).concat(Object.keys(v)).reduce((b,T)=>(b[T]=typeof v[T]>"u"?y[T]:v[T],b),{});const i1=(v,y)=>y.reduce((b,T)=>(typeof v[T]>"u"||(b[T]=v[T]),b),{}),Cv=Uy(()=>uy(()=>import("./browser-D95_TK9Y.js").then(v=>v.b),[])).pipe(Ca(({default:v})=>v),Ib(1));function Av(){return function(v){return v.pipe(r_((y,b)=>y instanceof nv?Fy(ag({type:"reconnect"}),Eb(1e3).pipe(cm(()=>b))):Oy(()=>y)))}}const r1=14800,n1=["includePreviousRevision","includeResult","includeMutations","includeAllVersions","visibility","effectFormat","tag"],a1={includeResult:!0};function zv(v,y,b={}){const{url:T,token:R,withCredentials:F,requestTagPrefix:z,headers:u}=this.config(),oe=b.tag&&z?[z,b.tag].join("."):b.tag,Q={...t1(b,a1),tag:oe},ve=i1(Q,n1),Te=uv({query:v,params:y,options:{tag:oe,...ve}}),Ee=`${T}${Po(this,"listen",Te)}`;if(Ee.length>r1)return Oy(()=>new Error("Query too large for listener"));const ne=Q.events?Q.events:["mutation"],Pe={};return F&&(Pe.withCredentials=!0),(R||u)&&(Pe.headers={},R&&(Pe.headers.Authorization=`Bearer ${R}`),u&&Object.assign(Pe.headers,u)),av(()=>(typeof EventSource>"u"||Pe.headers?Cv:ag(EventSource)).pipe(Ca(Ze=>new Ze(Ee,Pe))),ne).pipe(Av(),$f(Ze=>ne.includes(Ze.type)),Ca(Ze=>({type:Ze.type,..."data"in Ze?Ze.data:{}})))}function s1(v,y){return o1(typeof v=="function"?{predicate:v,...y}:v)}function o1(v){return y=>{let b,T=!1;const{predicate:R,...F}=v,z=y.pipe(Db(oe=>{v.predicate(oe)&&(T=!0,b=oe)}),Vy(()=>{T=!1,b=void 0}),Zy(F)),u=new ln(oe=>{T&&oe.next(b),oe.complete()});return Cb(z,u)}}const ay="2021-03-25";var yh;class Pv{constructor(y){pi(this,yh);hi(this,yh,y)}events({includeDrafts:y=!1,tag:b}={}){yc("live",ze(this,yh).config());const{projectId:T,apiVersion:R,token:F,withCredentials:z,requestTagPrefix:u,headers:oe}=ze(this,yh).config(),Q=R.replace(/^v/,"");if(Q!=="X"&&Q<ay)throw new Error(`The live events API requires API version ${ay} or later. The current API version is ${Q}. Please update your API version to use this feature.`);if(y&&!F&&!z)throw new Error("The live events API requires a token or withCredentials when 'includeDrafts: true'. Please update your client configuration. The token should have the lowest possible access role.");const ve=Po(ze(this,yh),"live/events"),Te=new URL(ze(this,yh).getUrl(ve,!1)),Ee=b&&u?[u,b].join("."):b;Ee&&Te.searchParams.set("tag",Ee),y&&Te.searchParams.set("includeDrafts","true");const ne={};y&&z&&(ne.withCredentials=!0),(y&&F||oe)&&(ne.headers={},y&&F&&(ne.headers.Authorization=`Bearer ${F}`),oe&&Object.assign(ne.headers,oe));const Pe=`${Te.href}::${JSON.stringify(ne)}`,Ze=Bg.get(Pe);if(Ze)return Ze;const bt=av(()=>(typeof EventSource>"u"||ne.headers?Cv:ag(EventSource)).pipe(Ca(Tt=>new Tt(Te.href,ne))),["message","restart","welcome","reconnect","goaway"]).pipe(Av(),Ca(Tt=>{if(Tt.type==="message"){const{data:qt,...xt}=Tt;return{...xt,tags:qt.tags}}return Tt})),Vt=l1(Te,{method:"OPTIONS",mode:"cors",credentials:ne.withCredentials?"include":"omit",headers:ne.headers}).pipe(cm(()=>wy),r_(()=>{throw new tx({projectId:T})})),Ot=Fy(Vt,bt).pipe(Vy(()=>Bg.delete(Pe)),s1({predicate:Tt=>Tt.type==="welcome"}));return Bg.set(Pe,Ot),Ot}}yh=new WeakMap;function l1(v,y){return new ln(b=>{const T=new AbortController,R=T.signal;return fetch(v,{...y,signal:T.signal}).then(F=>{b.next(F),b.complete()},F=>{R.aborted||b.error(F)}),()=>T.abort()})}const Bg=new Map;var vh,bh;class c1{constructor(y,b){pi(this,vh);pi(this,bh);hi(this,vh,y),hi(this,bh,b)}create(y,b){return Bf(ze(this,vh),ze(this,bh),"PUT",y,b)}edit(y,b){return Bf(ze(this,vh),ze(this,bh),"PATCH",y,b)}delete(y){return Bf(ze(this,vh),ze(this,bh),"DELETE",y)}list(){return Aa(ze(this,vh),ze(this,bh),{uri:"/datasets",tag:null})}}vh=new WeakMap,bh=new WeakMap;var zo,xh;class u1{constructor(y,b){pi(this,zo);pi(this,xh);hi(this,zo,y),hi(this,xh,b)}create(y,b){return yc("dataset",ze(this,zo).config()),Ci(Bf(ze(this,zo),ze(this,xh),"PUT",y,b))}edit(y,b){return yc("dataset",ze(this,zo).config()),Ci(Bf(ze(this,zo),ze(this,xh),"PATCH",y,b))}delete(y){return yc("dataset",ze(this,zo).config()),Ci(Bf(ze(this,zo),ze(this,xh),"DELETE",y))}list(){return yc("dataset",ze(this,zo).config()),Ci(Aa(ze(this,zo),ze(this,xh),{uri:"/datasets",tag:null}))}}zo=new WeakMap,xh=new WeakMap;function Bf(v,y,b,T,R){return yc("dataset",v.config()),Ky(T),Aa(v,y,{method:b,uri:`/datasets/${T}`,body:R,tag:null})}var wh,Ff;class h1{constructor(y,b){pi(this,wh);pi(this,Ff);hi(this,wh,y),hi(this,Ff,b)}list(y){yc("projects",ze(this,wh).config());const b=(y==null?void 0:y.includeMembers)===!1?"/projects?includeMembers=false":"/projects";return Aa(ze(this,wh),ze(this,Ff),{uri:b})}getById(y){return yc("projects",ze(this,wh).config()),Aa(ze(this,wh),ze(this,Ff),{uri:`/projects/${y}`})}}wh=new WeakMap,Ff=new WeakMap;var Th,Uf;class d1{constructor(y,b){pi(this,Th);pi(this,Uf);hi(this,Th,y),hi(this,Uf,b)}list(y){yc("projects",ze(this,Th).config());const b=(y==null?void 0:y.includeMembers)===!1?"/projects?includeMembers=false":"/projects";return Ci(Aa(ze(this,Th),ze(this,Uf),{uri:b}))}getById(y){return yc("projects",ze(this,Th).config()),Ci(Aa(ze(this,Th),ze(this,Uf),{uri:`/projects/${y}`}))}}Th=new WeakMap,Uf=new WeakMap;const sy=Gb("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",8),eg=(v,y)=>y?lg(v,y):Zb(v);function tg(v,{releaseId:y,publishedId:b,document:T}){if(b&&T._id){const R=eg(b,y);return cx(R,T),R}if(T._id){const R=sg(T._id),F=og(T._id);if(!R&&!F)throw new Error(`\`${v}()\` requires a document with an \`_id\` that is a version or draft ID`);if(y){if(R)throw new Error(`\`${v}()\` was called with a document ID (\`${T._id}\`) that is a draft ID, but a release ID (\`${y}\`) was also provided.`);const z=Hy(T._id);if(z!==y)throw new Error(`\`${v}()\` was called with a document ID (\`${T._id}\`) that is a version ID, but the release ID (\`${y}\`) does not match the document's version ID (\`${z}\`).`)}return T._id}if(b)return eg(b,y);throw new Error(`\`${v}()\` requires either a publishedId or a document with an \`_id\``)}const f1=(v,y)=>{if(typeof v=="object"&&v!==null&&("releaseId"in v||"metadata"in v)){const{releaseId:b=sy(),metadata:T={}}=v;return[b,T,y]}return[sy(),{},v]},Iv=(v,y)=>{const[b,T,R]=f1(v,y),F={...T,releaseType:T.releaseType||"undecided"};return{action:{actionType:"sanity.action.release.create",releaseId:b,metadata:F},options:R}};var gs,_s;class p1{constructor(y,b){pi(this,gs);pi(this,_s);hi(this,gs,y),hi(this,_s,b)}get({releaseId:y},b){return ug(ze(this,gs),ze(this,_s),`_.releases.${y}`,b)}create(y,b){const{action:T,options:R}=Iv(y,b),{releaseId:F,metadata:z}=T;return on(ze(this,gs),ze(this,_s),T,R).pipe(Ca(u=>({...u,releaseId:F,metadata:z})))}edit({releaseId:y,patch:b},T){const R={actionType:"sanity.action.release.edit",releaseId:y,patch:b};return on(ze(this,gs),ze(this,_s),R,T)}publish({releaseId:y},b){const T={actionType:"sanity.action.release.publish",releaseId:y};return on(ze(this,gs),ze(this,_s),T,b)}archive({releaseId:y},b){const T={actionType:"sanity.action.release.archive",releaseId:y};return on(ze(this,gs),ze(this,_s),T,b)}unarchive({releaseId:y},b){const T={actionType:"sanity.action.release.unarchive",releaseId:y};return on(ze(this,gs),ze(this,_s),T,b)}schedule({releaseId:y,publishAt:b},T){const R={actionType:"sanity.action.release.schedule",releaseId:y,publishAt:b};return on(ze(this,gs),ze(this,_s),R,T)}unschedule({releaseId:y},b){const T={actionType:"sanity.action.release.unschedule",releaseId:y};return on(ze(this,gs),ze(this,_s),T,b)}delete({releaseId:y},b){const T={actionType:"sanity.action.release.delete",releaseId:y};return on(ze(this,gs),ze(this,_s),T,b)}fetchDocuments({releaseId:y},b){return fv(ze(this,gs),ze(this,_s),y,b)}}gs=new WeakMap,_s=new WeakMap;var ys,vs;class m1{constructor(y,b){pi(this,ys);pi(this,vs);hi(this,ys,y),hi(this,vs,b)}get({releaseId:y},b){return Ci(ug(ze(this,ys),ze(this,vs),`_.releases.${y}`,b))}async create(y,b){const{action:T,options:R}=Iv(y,b),{releaseId:F,metadata:z}=T;return{...await Ci(on(ze(this,ys),ze(this,vs),T,R)),releaseId:F,metadata:z}}edit({releaseId:y,patch:b},T){const R={actionType:"sanity.action.release.edit",releaseId:y,patch:b};return Ci(on(ze(this,ys),ze(this,vs),R,T))}publish({releaseId:y},b){const T={actionType:"sanity.action.release.publish",releaseId:y};return Ci(on(ze(this,ys),ze(this,vs),T,b))}archive({releaseId:y},b){const T={actionType:"sanity.action.release.archive",releaseId:y};return Ci(on(ze(this,ys),ze(this,vs),T,b))}unarchive({releaseId:y},b){const T={actionType:"sanity.action.release.unarchive",releaseId:y};return Ci(on(ze(this,ys),ze(this,vs),T,b))}schedule({releaseId:y,publishAt:b},T){const R={actionType:"sanity.action.release.schedule",releaseId:y,publishAt:b};return Ci(on(ze(this,ys),ze(this,vs),R,T))}unschedule({releaseId:y},b){const T={actionType:"sanity.action.release.unschedule",releaseId:y};return Ci(on(ze(this,ys),ze(this,vs),T,b))}delete({releaseId:y},b){const T={actionType:"sanity.action.release.delete",releaseId:y};return Ci(on(ze(this,ys),ze(this,vs),T,b))}fetchDocuments({releaseId:y},b){return Ci(fv(ze(this,ys),ze(this,vs),y,b))}}ys=new WeakMap,vs=new WeakMap;var rm,nm;class g1{constructor(y,b){pi(this,rm);pi(this,nm);hi(this,rm,y),hi(this,nm,b)}getById(y){return Aa(ze(this,rm),ze(this,nm),{uri:`/users/${y}`})}}rm=new WeakMap,nm=new WeakMap;var am,sm;class _1{constructor(y,b){pi(this,am);pi(this,sm);hi(this,am,y),hi(this,sm,b)}getById(y){return Ci(Aa(ze(this,am),ze(this,sm),{uri:`/users/${y}`}))}}am=new WeakMap,sm=new WeakMap;var du,Dr;const ig=class ig{constructor(y,b=$p){Qt(this,"assets");Qt(this,"datasets");Qt(this,"live");Qt(this,"projects");Qt(this,"users");Qt(this,"agent");Qt(this,"releases");pi(this,du);pi(this,Dr);Qt(this,"listen",zv);this.config(b),hi(this,Dr,y),this.assets=new Kx(this,ze(this,Dr)),this.datasets=new c1(this,ze(this,Dr)),this.live=new Pv(this),this.projects=new h1(this,ze(this,Dr)),this.users=new g1(this,ze(this,Dr)),this.agent={action:new Yx(this,ze(this,Dr))},this.releases=new p1(this,ze(this,Dr))}clone(){return new ig(ze(this,Dr),this.config())}config(y){if(y===void 0)return{...ze(this,du)};if(ze(this,du)&&ze(this,du).allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return hi(this,du,rv(y,ze(this,du)||{})),this}withConfig(y){const b=this.config();return new ig(ze(this,Dr),{...b,...y,stega:{...b.stega||{},...typeof(y==null?void 0:y.stega)=="boolean"?{enabled:y.stega}:(y==null?void 0:y.stega)||{}}})}fetch(y,b,T){return hv(this,ze(this,Dr),ze(this,du).stega,y,b,T)}getDocument(y,b){return ug(this,ze(this,Dr),y,b)}getDocuments(y,b){return dv(this,ze(this,Dr),y,b)}create(y,b){return hg(this,ze(this,Dr),y,"create",b)}createIfNotExists(y,b){return pv(this,ze(this,Dr),y,b)}createOrReplace(y,b){return mv(this,ze(this,Dr),y,b)}createVersion({document:y,publishedId:b,releaseId:T},R){const F=tg("createVersion",{document:y,publishedId:b,releaseId:T}),z={...y,_id:F},u=b||cg(y._id);return gv(this,ze(this,Dr),z,u,R)}delete(y,b){return _v(this,ze(this,Dr),y,b)}discardVersion({releaseId:y,publishedId:b},T,R){const F=eg(b,y);return yv(this,ze(this,Dr),F,T,R)}replaceVersion({document:y,publishedId:b,releaseId:T},R){const F=tg("replaceVersion",{document:y,publishedId:b,releaseId:T}),z={...y,_id:F};return vv(this,ze(this,Dr),z,R)}unpublishVersion({releaseId:y,publishedId:b},T){const R=lg(b,y);return bv(this,ze(this,Dr),R,b,T)}mutate(y,b){return xv(this,ze(this,Dr),y,b)}patch(y,b){return new xd(y,b,this)}transaction(y){return new Jm(y,this)}action(y,b){return on(this,ze(this,Dr),y,b)}request(y){return Aa(this,ze(this,Dr),y)}getUrl(y,b){return o_(this,y,b)}getDataUrl(y,b){return Po(this,y,b)}};du=new WeakMap,Dr=new WeakMap;let qg=ig;var fu,br;const rg=class rg{constructor(y,b=$p){Qt(this,"assets");Qt(this,"datasets");Qt(this,"live");Qt(this,"projects");Qt(this,"users");Qt(this,"agent");Qt(this,"releases");Qt(this,"observable");pi(this,fu);pi(this,br);Qt(this,"listen",zv);this.config(b),hi(this,br,y),this.assets=new Wx(this,ze(this,br)),this.datasets=new u1(this,ze(this,br)),this.live=new Pv(this),this.projects=new d1(this,ze(this,br)),this.users=new _1(this,ze(this,br)),this.agent={action:new Qx(this,ze(this,br))},this.releases=new m1(this,ze(this,br)),this.observable=new qg(y,b)}clone(){return new rg(ze(this,br),this.config())}config(y){if(y===void 0)return{...ze(this,fu)};if(ze(this,fu)&&ze(this,fu).allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.observable&&this.observable.config(y),hi(this,fu,rv(y,ze(this,fu)||{})),this}withConfig(y){const b=this.config();return new rg(ze(this,br),{...b,...y,stega:{...b.stega||{},...typeof(y==null?void 0:y.stega)=="boolean"?{enabled:y.stega}:(y==null?void 0:y.stega)||{}}})}fetch(y,b,T){return Ci(hv(this,ze(this,br),ze(this,fu).stega,y,b,T))}getDocument(y,b){return Ci(ug(this,ze(this,br),y,b))}getDocuments(y,b){return Ci(dv(this,ze(this,br),y,b))}create(y,b){return Ci(hg(this,ze(this,br),y,"create",b))}createIfNotExists(y,b){return Ci(pv(this,ze(this,br),y,b))}createOrReplace(y,b){return Ci(mv(this,ze(this,br),y,b))}createVersion({document:y,publishedId:b,releaseId:T},R){const F=tg("createVersion",{document:y,publishedId:b,releaseId:T}),z={...y,_id:F},u=b||cg(y._id);return Y_(gv(this,ze(this,br),z,u,R))}delete(y,b){return Ci(_v(this,ze(this,br),y,b))}discardVersion({releaseId:y,publishedId:b},T,R){const F=eg(b,y);return Ci(yv(this,ze(this,br),F,T,R))}replaceVersion({document:y,publishedId:b,releaseId:T},R){const F=tg("replaceVersion",{document:y,publishedId:b,releaseId:T}),z={...y,_id:F};return Y_(vv(this,ze(this,br),z,R))}unpublishVersion({releaseId:y,publishedId:b},T){const R=lg(b,y);return Ci(bv(this,ze(this,br),R,b,T))}mutate(y,b){return Ci(xv(this,ze(this,br),y,b))}patch(y,b){return new Sh(y,b,this)}transaction(y){return new Wm(y,this)}action(y,b){return Ci(on(this,ze(this,br),y,b))}request(y){return Ci(Aa(this,ze(this,br),y))}dataRequest(y,b,T){return Ci(Td(this,ze(this,br),y,b,T))}getUrl(y,b){return o_(this,y,b)}getDataUrl(y,b){return Po(this,y,b)}};fu=new WeakMap,br=new WeakMap;let $g=rg;function y1(v,y){return{requester:ey(v),createClient:b=>{const T=ey(v);return new y((R,F)=>(F||T)({maxRedirects:0,maxRetries:b.maxRetries,retryDelay:b.retryDelay,...R}),b)}}}function v1(v){return function(y){return vx(),v(y)}}var b1=[];const x1=y1(b1,$g),w1=x1.createClient,T1=v1(w1),S1=T1({projectId:"c1ywbxqh",dataset:"production",apiVersion:"2023-01-01",useCdn:!0});function M1(){const[v,y]=Ug.useState([]);Ug.useEffect(()=>{S1.fetch(`*[_type == "rating"]{
            name,
            location,
            description,
            durability,
            absorbency,
            texture,
            size,
            effectiveness,
            appearance,
            notes,
            date,
            "imageUrl": image.asset->url
          }`).then(F=>y(F))},[]);const b=["durability","absorbency","texture","size","effectiveness","appearance"],T=({item:F})=>{let z=0;return b.forEach(u=>{z+=F[u]}),Si.jsxs("p",{children:["(",(z/b.length).toFixed(2),")",Array.from({length:5}).map((u,oe)=>Si.jsx("span",{children:oe<Math.round(z/b.length)?"":""},oe))]})},R=({item:F})=>Si.jsx("div",{children:b.map(z=>Si.jsxs("div",{className:"sublist",children:[Si.jsxs("div",{children:[z.charAt(0).toUpperCase()+z.slice(1),": "]}),Si.jsx("div",{children:Array.from({length:5}).map((u,oe)=>Si.jsx("span",{children:oe<F[z]?"":""},oe))})]},z))});return I_.sort(function(F,z){return new Date(z.date)-new Date(F.date)}),Si.jsxs(Si.Fragment,{children:[v.map((F,z)=>Si.jsxs("div",{children:[Si.jsx("h2",{children:F.name}),Si.jsx("p",{children:F.description}),Si.jsx("img",{src:F.imageUrl,alt:F.name,width:200}),Si.jsxs("ul",{children:[Si.jsxs("li",{children:["Durability: ",F.durability]}),Si.jsxs("li",{children:["Absorbency: ",F.absorbency]}),Si.jsxs("li",{children:["Texture: ",F.texture]}),Si.jsxs("li",{children:["Size: ",F.size]}),Si.jsxs("li",{children:["Effectiveness: ",F.effectiveness]}),Si.jsxs("li",{children:["Appearance: ",F.appearance]})]}),Si.jsxs("p",{children:[Si.jsx("strong",{children:"Notes:"})," ",F.notes]}),Si.jsxs("p",{children:[Si.jsx("strong",{children:"Date:"})," ",F.date]}),Si.jsx("a",{href:F.location,target:"_blank",rel:"noopener noreferrer",children:"View Location"})]},z)),Si.jsx("h3",{children:"Latest"}),Si.jsx("div",{className:"list",children:I_.map((F,z)=>Si.jsxs("div",{className:"card",children:[Si.jsx("p",{children:Si.jsx("a",{href:F.location,children:F.name})}),Si.jsx("p",{children:m0(F.date).format("MMMM D, YYYY")}),Si.jsx(T,{item:F}),Si.jsx("hr",{}),Si.jsx(R,{item:F})]},z))})]})}var Ym={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.5.0/LICENSE.txt
 */var E1=Ym.exports,oy;function C1(){return oy||(oy=1,function(v,y){(function(b,T){v.exports=T()})(E1,function(){var b={},T={};function R(z,u,oe){if(T[z]=oe,z==="index"){var Q="var sharedModule = {}; ("+T.shared+")(sharedModule); ("+T.worker+")(sharedModule);",ve={};return T.shared(ve),T.index(b,ve),typeof window<"u"&&b.setWorkerUrl(window.URL.createObjectURL(new Blob([Q],{type:"text/javascript"}))),b}}R("shared",["exports"],function(z){function u(a,t,n,o){return new(n||(n=Promise))(function(d,g){function _(P){try{E(o.next(P))}catch(D){g(D)}}function w(P){try{E(o.throw(P))}catch(D){g(D)}}function E(P){var D;P.done?d(P.value):(D=P.value,D instanceof n?D:new n(function(O){O(D)})).then(_,w)}E((o=o.apply(a,t||[])).next())})}function oe(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Q,ve;function Te(){if(ve)return Q;function a(t,n){this.x=t,this.y=n}return ve=1,Q=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,o=t.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),o=Math.sin(t),d=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=d,this},_rotateAround:function(t,n){var o=Math.cos(t),d=Math.sin(t),g=n.y+d*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-d*(this.y-n.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},Q}typeof SuppressedError=="function"&&SuppressedError;var Ee,ne,Pe=oe(Te()),Ze=function(){if(ne)return Ee;function a(t,n,o,d){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=o,this.p2y=d}return ne=1,Ee=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,d=0;d<8;d++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<n)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var w=0,E=1;for(o=t,d=0;d<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<n));d++)t>g?w=o:E=o,o=.5*(E-w)+w;return o},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},Ee}(),bt=oe(Ze);let Vt,Ot;function Tt(){return Vt==null&&(Vt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Vt}function qt(){if(Ot==null&&(Ot=!1,Tt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let o=0;o<5*5;o++){const d=4*o;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(o%5,Math.floor(o/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let o=0;o<5*5*4;o++)if(o%4!=3&&n[o]!==o){Ot=!0;break}}}return Ot||!1}var xt=1e-6,Bt=typeof Float32Array<"u"?Float32Array:Array;function Pi(){var a=new Bt(9);return Bt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function ti(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Oi(){var a=new Bt(3);return Bt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Mi(a){return Math.hypot(a[0],a[1],a[2])}function Ut(a,t,n){var o=new Bt(3);return o[0]=a,o[1]=t,o[2]=n,o}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});var wi,xr=Mi;function Et(a,t,n){var o=t[0],d=t[1],g=t[2],_=t[3];return a[0]=n[0]*o+n[4]*d+n[8]*g+n[12]*_,a[1]=n[1]*o+n[5]*d+n[9]*g+n[13]*_,a[2]=n[2]*o+n[6]*d+n[10]*g+n[14]*_,a[3]=n[3]*o+n[7]*d+n[11]*g+n[15]*_,a}function pt(){var a=new Bt(4);return Bt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function we(){var a=new Bt(2);return Bt!=Float32Array&&(a[0]=0,a[1]=0),a}function We(a,t){var n=new Bt(2);return n[0]=a,n[1]=t,n}Oi(),wi=new Bt(4),Bt!=Float32Array&&(wi[0]=0,wi[1]=0,wi[2]=0,wi[3]=0),Oi(),Ut(1,0,0),Ut(0,1,0),pt(),pt(),Pi(),we();const Ge=8192;function gt(a,t,n){return t*(Ge/(a.tileSize*Math.pow(2,n-a.tileID.overscaledZ)))}function ue(a,t){return(a%t+t)%t}function Ke(a,t,n){return a*(1-n)+t*n}function lt(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,n=t*a;return 4*(a<.5?n:3*(a-t)+n-.75)}function ut(a,t,n,o){const d=new bt(a,t,n,o);return g=>d.solve(g)}const vt=ut(.25,.1,.25,1);function Ct(a,t,n){return Math.min(n,Math.max(t,a))}function It(a,t,n){const o=n-t,d=((a-t)%o+o)%o+t;return d===t?n:d}function di(a,...t){for(const n of t)for(const o in n)a[o]=n[o];return a}let li=1;function er(a,t,n){const o={};for(const d in a)o[d]=t.call(this,a[d],d,a);return o}function lr(a,t,n){const o={};for(const d in a)t.call(this,a[d],d,a)&&(o[d]=a[d]);return o}function Bi(a){return Array.isArray(a)?a.map(Bi):typeof a=="object"&&a?er(a,Bi):a}const cr={};function tr(a){cr[a]||(typeof console<"u"&&console.warn(a),cr[a]=!0)}function Ri(a,t,n){return(n.y-a.y)*(t.x-a.x)>(t.y-a.y)*(n.x-a.x)}function qa(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Ks=null;function Rr(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const wc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ml(a,t,n,o,d){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(a,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const w=_.startsWith("BGR"),E=new Uint8ClampedArray(o*d*4);if(yield g.copyTo(E,function(P,D,O,U,V){const q=4*Math.max(1,0),H=(Math.max(0,O)-O)*U*4+q,J=4*U,se=Math.max(0,D),ye=Math.max(0,O);return{rect:{x:se,y:ye,width:Math.min(P.width,D+U)-se,height:Math.min(P.height,O+V)-ye},layout:[{offset:H,stride:J}]}}(a,t,n,o,d)),w)for(let P=0;P<E.length;P+=4){const D=E[P];E[P]=E[P+2],E[P+2]=D}return E}finally{g.close()}})}let Fn,Qn;function Io(a,t,n,o){return a.addEventListener(t,n,o),{unsubscribe:()=>{a.removeEventListener(t,n,o)}}}function Ws(a){return a*Math.PI/180}function bs(a){return a/Math.PI*180}const El={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},$a={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Wr="AbortError";function mn(){return new Error(Wr)}const kr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Js(a){return kr.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Cl="global-dispatcher";class pa extends Error{constructor(t,n,o,d){super(`AJAXError: ${n} (${t}): ${o}`),this.status=t,this.statusText=n,this.url=o,this.body=d}}const cn=()=>qa(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Kn=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const o=Js(a.url);if(o)return o(a,t);if(qa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Cl},t)}if(!(/^file:/.test(n=a.url)||/^file:/.test(cn())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(o,d){return u(this,void 0,void 0,function*(){const g=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:cn(),signal:d.signal});let _,w;o.type!=="json"||g.headers.has("Accept")||g.headers.set("Accept","application/json");try{_=yield fetch(g)}catch(P){throw new pa(0,P.message,o.url,new Blob)}if(!_.ok){const P=yield _.blob();throw new pa(_.status,_.statusText,o.url,P)}w=o.type==="arrayBuffer"||o.type==="image"?_.arrayBuffer():o.type==="json"?_.json():_.text();const E=yield w;if(d.signal.aborted)throw mn();return{data:E,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(a,t);if(qa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Cl},t)}var n;return function(o,d){return new Promise((g,_)=>{var w;const E=new XMLHttpRequest;E.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(E.responseType="arraybuffer");for(const P in o.headers)E.setRequestHeader(P,o.headers[P]);o.type==="json"&&(E.responseType="text",!((w=o.headers)===null||w===void 0)&&w.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=o.credentials==="include",E.onerror=()=>{_(new Error(E.statusText))},E.onload=()=>{if(!d.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let P=E.response;if(o.type==="json")try{P=JSON.parse(E.response)}catch(D){return void _(D)}g({data:P,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const P=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});_(new pa(E.status,E.statusText,o.url,P))}},d.signal.addEventListener("abort",()=>{E.abort(),_(mn())}),E.send(o.body)})}(a,t)};function Ce(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function X(a,t,n){n[a]&&n[a].indexOf(t)!==-1||(n[a]=n[a]||[],n[a].push(t))}function Y(a,t,n){if(n&&n[a]){const o=n[a].indexOf(t);o!==-1&&n[a].splice(o,1)}}class te{constructor(t,n={}){di(this,n),this.type=t}}class he extends te{constructor(t,n={}){super("error",di({error:t},n))}}class be{on(t,n){return this._listeners=this._listeners||{},X(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return Y(t,n,this._listeners),Y(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},X(t,n,this._oneTimeListeners),this):new Promise(o=>this.once(t,o))}fire(t,n){typeof t=="string"&&(t=new te(t,n||{}));const o=t.type;if(this.listens(o)){t.target=this;const d=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const w of d)w.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const w of g)Y(o,w,this._oneTimeListeners),w.call(this,t);const _=this._eventedParent;_&&(di(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof he&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var ee={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Re=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Se(a,t){const n={};for(const o in a)o!=="ref"&&(n[o]=a[o]);return Re.forEach(o=>{o in t&&(n[o]=t[o])}),n}function De(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let n=0;n<a.length;n++)if(!De(a[n],t[n]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const n in a)if(!De(a[n],t[n]))return!1;return!0}return a===t}function je(a,t){a.push(t)}function Ae(a,t,n){je(n,{command:"addSource",args:[a,t[a]]})}function et(a,t,n){je(t,{command:"removeSource",args:[a]}),n[a]=!0}function ft(a,t,n,o){et(a,n,o),Ae(a,t,n)}function _t(a,t,n){let o;for(o in a[n])if(Object.prototype.hasOwnProperty.call(a[n],o)&&o!=="data"&&!De(a[n][o],t[n][o]))return!1;for(o in t[n])if(Object.prototype.hasOwnProperty.call(t[n],o)&&o!=="data"&&!De(a[n][o],t[n][o]))return!1;return!0}function At(a,t,n,o,d,g){a=a||{},t=t||{};for(const _ in a)Object.prototype.hasOwnProperty.call(a,_)&&(De(a[_],t[_])||n.push({command:g,args:[o,_,t[_],d]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(a,_)&&(De(a[_],t[_])||n.push({command:g,args:[o,_,t[_],d]}))}function kt(a){return a.id}function zt(a,t){return a[t.id]=t,a}class qe{constructor(t,n,o,d){this.message=(t?`${t}: `:"")+o,d&&(this.identifier=d),n!=null&&n.__line__&&(this.line=n.__line__)}}function yi(a,...t){for(const n of t)for(const o in n)a[o]=n[o];return a}class ci extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class vi{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[o,d]of n)this.bindings[o]=d}concat(t){return new vi(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Zt={kind:"null"},Je={kind:"number"},Ft={kind:"string"},Gt={kind:"boolean"},ji={kind:"color"},qi={kind:"projectionDefinition"},$r={kind:"object"},Lt={kind:"value"},Do={kind:"collator"},Al={kind:"formatted"},Wn={kind:"padding"},Ga={kind:"colorArray"},xs={kind:"numberArray"},eo={kind:"resolvedImage"},wr={kind:"variableAnchorOffsetCollection"};function Jn(a,t){return{kind:"array",itemType:a,N:t}}function Fi(a){if(a.kind==="array"){const t=Fi(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const to=[Zt,Je,Ft,Gt,ji,qi,Al,$r,Jn(Lt),Wn,xs,Ga,eo,wr];function Un(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Un(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const n of to)if(!Un(n,t))return null}}return`Expected ${Fi(a)} but found ${Fi(t)} instead.`}function Tc(a,t){return t.some(n=>n.kind===a.kind)}function io(a,t){return t.some(n=>n==="null"?a===null:n==="array"?Array.isArray(a):n==="object"?a&&!Array.isArray(a)&&typeof a=="object":n===typeof a)}function Nn(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const _u=.96422,Sc=.82521,Sd=4/29,Ro=6/29,ea=3*Ro*Ro,Md=Ro*Ro*Ro,Gf=Math.PI/180,yu=180/Math.PI;function Ch(a){return(a%=360)<0&&(a+=360),a}function zl([a,t,n,o]){let d,g;const _=Vn((.2225045*(a=ko(a))+.7168786*(t=ko(t))+.0606169*(n=ko(n)))/1);a===t&&t===n?d=g=_:(d=Vn((.4360747*a+.3850649*t+.1430804*n)/_u),g=Vn((.0139322*a+.0971045*t+.7141733*n)/Sc));const w=116*_-16;return[w<0?0:w,500*(d-_),200*(_-g),o]}function ko(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Vn(a){return a>Md?Math.pow(a,1/3):a/ea+Sd}function vu([a,t,n,o]){let d=(a+16)/116,g=isNaN(t)?d:d+t/500,_=isNaN(n)?d:d-n/200;return d=1*Mc(d),g=_u*Mc(g),_=Sc*Mc(_),[ro(3.1338561*g-1.6168667*d-.4906146*_),ro(-.9787684*g+1.9161415*d+.033454*_),ro(.0719453*g-.2289914*d+1.4052427*_),o]}function ro(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Mc(a){return a>Ro?a*a*a:ea*(a-Sd)}const Pl=Object.hasOwn||function(a,t){return Object.prototype.hasOwnProperty.call(a,t)};function Il(a,t){return Pl(a,t)?a[t]:void 0}function Dl(a){return parseInt(a.padEnd(2,a),16)/255}function no(a,t){return zn(t?a/100:a,0,1)}function zn(a,t,n){return Math.min(Math.max(t,a),n)}function fi(a){return!a.some(Number.isNaN)}const Lo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function un(a,t,n){return a+n*(t-a)}function Oo(a,t,n){return a.map((o,d)=>un(o,t[d],n))}class ui{constructor(t,n,o,d=1,g=!0){this.r=t,this.g=n,this.b=o,this.a=d,g||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,n,o,d]))}static parse(t){if(t instanceof ui)return t;if(typeof t!="string")return;const n=function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Il(Lo,o);if(d){const[_,w,E]=d;return[_/255,w/255,E/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const _=o.length<6?1:2;let w=1;return[Dl(o.slice(w,w+=_)),Dl(o.slice(w,w+=_)),Dl(o.slice(w,w+=_)),Dl(o.slice(w,w+_)||"ff")]}if(o.startsWith("rgb")){const _=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[w,E,P,D,O,U,V,q,H,J,se,ye]=_,le=[D||" ",V||" ",J].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const N=[P,U,H].join(""),W=N==="%%%"?100:N===""?255:0;if(W){const de=[zn(+E/W,0,1),zn(+O/W,0,1),zn(+q/W,0,1),se?no(+se,ye):1];if(fi(de))return de}}return}}const g=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,w,E,P,D,O,U,V,q]=g,H=[E||" ",D||" ",U].join("");if(H==="  "||H==="  /"||H===",,"||H===",,,"){const J=[+w,zn(+P,0,100),zn(+O,0,100),V?no(+V,q):1];if(fi(J))return function([se,ye,le,N]){function W(de){const Le=(de+se/30)%12,rt=ye*Math.min(le,1-le);return le-rt*Math.max(-1,Math.min(Le-3,9-Le,1))}return se=Ch(se),ye/=100,le/=100,[W(0),W(8),W(4),N]}(J)}}}(t);return n?new ui(...n,!1):void 0}get rgb(){const{r:t,g:n,b:o,a:d}=this,g=d||1/0;return this.overwriteGetter("rgb",[t/g,n/g,o/g,d])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,o,d,g]=zl(t),_=Math.sqrt(o*o+d*d);return[Math.round(1e4*_)?Ch(Math.atan2(d,o)*yu):NaN,_,n,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",zl(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,o,d]=this.rgb;return`rgba(${[t,n,o].map(g=>Math.round(255*g)).join(",")},${d})`}static interpolate(t,n,o,d="rgb"){switch(d){case"rgb":{const[g,_,w,E]=Oo(t.rgb,n.rgb,o);return new ui(g,_,w,E,!1)}case"hcl":{const[g,_,w,E]=t.hcl,[P,D,O,U]=n.hcl;let V,q;if(isNaN(g)||isNaN(P))isNaN(g)?isNaN(P)?V=NaN:(V=P,w!==1&&w!==0||(q=D)):(V=g,O!==1&&O!==0||(q=_));else{let le=P-g;P>g&&le>180?le-=360:P<g&&g-P>180&&(le+=360),V=g+o*le}const[H,J,se,ye]=function([le,N,W,de]){return le=isNaN(le)?0:le*Gf,vu([W,Math.cos(le)*N,Math.sin(le)*N,de])}([V,q??un(_,D,o),un(w,O,o),un(E,U,o)]);return new ui(H,J,se,ye,!1)}case"lab":{const[g,_,w,E]=vu(Oo(t.lab,n.lab,o));return new ui(g,_,w,E,!1)}}}}ui.black=new ui(0,0,0,1),ui.white=new ui(1,1,1,1),ui.transparent=new ui(0,0,0,0),ui.red=new ui(1,0,0,1);class ao{constructor(t,n,o){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Bo=["bottom","center","top"];class so{constructor(t,n,o,d,g,_){this.text=t,this.image=n,this.scale=o,this.fontStack=d,this.textColor=g,this.verticalAlign=_}}class Gr{constructor(t){this.sections=t}static fromString(t){return new Gr([new so(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Gr?t:Gr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Tr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Tr)return t;if(typeof t=="number")return new Tr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Tr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){return new Tr(Oo(t.values,n.values,o))}}class Sr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Sr)return t;if(typeof t=="number")return new Sr([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new Sr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){return new Sr(Oo(t.values,n.values,o))}}class Hr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Hr)return t;if(typeof t=="string"){const o=ui.parse(t);return o?new Hr([o]):void 0}if(!Array.isArray(t))return;const n=[];for(const o of t){if(typeof o!="string")return;const d=ui.parse(o);if(!d)return;n.push(d)}return new Hr(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o,d="rgb"){const g=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let _=0;_<t.values.length;_++)g.push(ui.interpolate(t.values[_],n.values[_],o,d));return new Hr(g)}}class $i extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Ha=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class mr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof mr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const o=t[n],d=t[n+1];if(typeof o!="string"||!Ha.has(o)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new mr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){const d=t.values,g=n.values;if(d.length!==g.length)throw new $i(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const _=[];for(let w=0;w<d.length;w+=2){if(d[w]!==g[w])throw new $i(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${d[w]}, to[${w}]: ${g[w]}`);_.push(d[w]);const[E,P]=d[w+1],[D,O]=g[w+1];_.push([un(E,D,o),un(P,O,o)])}return new mr(_)}}class Pn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Pn({name:t,available:!1}):null}}class Jr{constructor(t,n,o){this.from=t,this.to=n,this.transition=o}static interpolate(t,n,o){return new Jr(t,n,o)}static parse(t){return t instanceof Jr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Jr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Jr(t.from,t.to,t.transition):typeof t=="string"?new Jr(t,t,1):void 0}}function ma(a,t,n,o){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[a,t,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[a,t,n,o]:[a,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ai(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Jr||a instanceof ui||a instanceof ao||a instanceof Gr||a instanceof Tr||a instanceof Sr||a instanceof Hr||a instanceof mr||a instanceof Pn)return!0;if(Array.isArray(a)){for(const t of a)if(!Ai(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!Ai(a[t]))return!1;return!0}return!1}function Qi(a){if(a===null)return Zt;if(typeof a=="string")return Ft;if(typeof a=="boolean")return Gt;if(typeof a=="number")return Je;if(a instanceof ui)return ji;if(a instanceof Jr)return qi;if(a instanceof ao)return Do;if(a instanceof Gr)return Al;if(a instanceof Tr)return Wn;if(a instanceof Sr)return xs;if(a instanceof Hr)return Ga;if(a instanceof mr)return wr;if(a instanceof Pn)return eo;if(Array.isArray(a)){const t=a.length;let n;for(const o of a){const d=Qi(o);if(n){if(n===d)continue;n=Lt;break}n=d}return Jn(n||Lt,t)}return $r}function ai(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof ui||a instanceof Jr||a instanceof Gr||a instanceof Tr||a instanceof Sr||a instanceof Hr||a instanceof mr||a instanceof Pn?a.toString():JSON.stringify(a)}class Ht{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ai(t[1]))return n.error("invalid value");const o=t[1];let d=Qi(o);const g=n.expectedType;return d.kind!=="array"||d.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(d=g),new Ht(d,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ws={string:Ft,number:Je,boolean:Gt,object:$r};class Jt{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let o,d=1;const g=t[0];if(g==="array"){let w,E;if(t.length>2){const P=t[1];if(typeof P!="string"||!(P in ws)||P==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);w=ws[P],d++}else w=Lt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);E=t[2],d++}o=Jn(w,E)}else{if(!ws[g])throw new Error(`Types doesn't contain name = ${g}`);o=ws[g]}const _=[];for(;d<t.length;d++){const w=n.parse(t[d],d,Lt);if(!w)return null;_.push(w)}return new Jt(o,_)}evaluate(t){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(t);if(!Un(this.type,Qi(o)))return o;if(n===this.args.length-1)throw new $i(`Expected value to be of type ${Fi(this.type)}, but found ${Fi(Qi(o))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const hn={"to-boolean":Gt,"to-color":ji,"to-number":Je,"to-string":Ft};class Mr{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const o=t[0];if(!hn[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return n.error("Expected one argument.");const d=hn[o],g=[];for(let _=1;_<t.length;_++){const w=n.parse(t[_],_,Lt);if(!w)return null;g.push(w)}return new Mr(d,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,o;for(const d of this.args){if(n=d.evaluate(t),o=null,n instanceof ui)return n;if(typeof n=="string"){const g=t.parseColor(n);if(g)return g}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:ma(n[0],n[1],n[2],n[3]),!o))return new ui(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new $i(o||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const o of this.args){n=o.evaluate(t);const d=Tr.parse(n);if(d)return d}throw new $i(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const o of this.args){n=o.evaluate(t);const d=Sr.parse(n);if(d)return d}throw new $i(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const o of this.args){n=o.evaluate(t);const d=Hr.parse(n);if(d)return d}throw new $i(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const o of this.args){n=o.evaluate(t);const d=mr.parse(n);if(d)return d}throw new $i(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const o of this.args){if(n=o.evaluate(t),n===null)return 0;const d=Number(n);if(!isNaN(d))return d}throw new $i(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Gr.fromString(ai(this.args[0].evaluate(t)));case"resolvedImage":return Pn.fromString(ai(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ai(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Rl=["Unknown","Point","LineString","Polygon"];class jo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Rl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=ui.parse(t),this._parseColorCache.set(t,n)),n}}class Ec{constructor(t,n,o=[],d,g=new vi,_=[]){this.registry=t,this.path=o,this.key=o.map(w=>`[${w}]`).join(""),this.scope=g,this.errors=_,this.expectedType=d,this._isConstant=n}parse(t,n,o,d,g={}){return n?this.concat(n,o,d)._parse(t,g):this._parse(t,g)}_parse(t,n){function o(d,g,_){return _==="assert"?new Jt(g,[d]):_==="coerce"?new Mr(g,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[d];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,E=_.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||E.kind!=="value"){if(w.kind==="projectionDefinition"&&["string","array"].includes(E.kind)||["color","formatted","resolvedImage"].includes(w.kind)&&["value","string"].includes(E.kind)||["padding","numberArray"].includes(w.kind)&&["value","number","array"].includes(E.kind)||w.kind==="colorArray"&&["value","string","array"].includes(E.kind)||w.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(E.kind))_=o(_,w,n.typeAnnotation||"coerce");else if(this.checkSubtype(w,E))return null}else _=o(_,w,n.typeAnnotation||"assert")}if(!(_ instanceof Ht)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const w=new jo;try{_=new Ht(_.type,_.evaluate(w))}catch(E){return this.error(E.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,o){const d=typeof t=="number"?this.path.concat(t):this.path,g=o?this.scope.concat(o):this.scope;return new Ec(this.registry,this._isConstant,d,n||null,g,this.errors)}error(t,...n){const o=`${this.key}${n.map(d=>`[${d}]`).join("")}`;this.errors.push(new ci(o,t))}checkSubtype(t,n){const o=Un(t,n);return o&&this.error(o),o}}class oo{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return n.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return n.error("Variable names must contain only alphanumeric characters or '_'.",g);const w=n.parse(t[g+1],g+1);if(!w)return null;o.push([_,w])}const d=n.parse(t[t.length-1],t.length-1,n.expectedType,o);return d?new oo(o,d):null}outputDefined(){return this.result.outputDefined()}}class Fo{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=t[1];return n.scope.has(o)?new Fo(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Uo{constructor(t,n,o){this.type=t,this.index=n,this.input=o}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Je),d=n.parse(t[2],2,Jn(n.expectedType||Lt));return o&&d?new Uo(d.type.itemType,o,d):null}evaluate(t){const n=this.index.evaluate(t),o=this.input.evaluate(t);if(n<0)throw new $i(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new $i(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new $i(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class No{constructor(t,n){this.type=Gt,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Lt),d=n.parse(t[2],2,Lt);return o&&d?Tc(o.type,[Gt,Ft,Je,Zt,Lt])?new No(o,d):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(o.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!io(n,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(Qi(n))} instead.`);if(!io(o,["string","array"]))throw new $i(`Expected second argument to be of type array or string, but found ${Fi(Qi(o))} instead.`);return o.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class kl{constructor(t,n,o){this.type=Je,this.needle=t,this.haystack=n,this.fromIndex=o}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Lt),d=n.parse(t[2],2,Lt);if(!o||!d)return null;if(!Tc(o.type,[Gt,Ft,Je,Zt,Lt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(o.type)} instead`);if(t.length===4){const g=n.parse(t[3],3,Je);return g?new kl(o,d,g):null}return new kl(o,d)}evaluate(t){const n=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!io(n,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(Qi(n))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),io(o,["string"])){const g=o.indexOf(n,d);return g===-1?-1:[...o.slice(0,g)].length}if(io(o,["array"]))return o.indexOf(n,d);throw new $i(`Expected second argument to be of type array or string, but found ${Fi(Qi(o))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Vo{constructor(t,n,o,d,g,_){this.inputType=t,this.type=n,this.input=o,this.cases=d,this.outputs=g,this.otherwise=_}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let o,d;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);const g={},_=[];for(let P=2;P<t.length-1;P+=2){let D=t[P];const O=t[P+1];Array.isArray(D)||(D=[D]);const U=n.concat(P);if(D.length===0)return U.error("Expected at least one branch label.");for(const q of D){if(typeof q!="number"&&typeof q!="string")return U.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return U.error("Numeric branch labels must be integer values.");if(o){if(U.checkSubtype(o,Qi(q)))return null}else o=Qi(q);if(g[String(q)]!==void 0)return U.error("Branch labels must be unique.");g[String(q)]=_.length}const V=n.parse(O,P,d);if(!V)return null;d=d||V.type,_.push(V)}const w=n.parse(t[1],1,Lt);if(!w)return null;const E=n.parse(t[t.length-1],t.length-1,d);return E?w.type.kind!=="value"&&n.concat(1).checkSubtype(o,w.type)?null:new Vo(o,d,w,g,_,E):null}evaluate(t){const n=this.input.evaluate(t);return(Qi(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class en{constructor(t,n,o){this.type=t,this.branches=n,this.otherwise=o}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const d=[];for(let _=1;_<t.length-1;_+=2){const w=n.parse(t[_],_,Gt);if(!w)return null;const E=n.parse(t[_+1],_+1,o);if(!E)return null;d.push([w,E]),o=o||E.type}const g=n.parse(t[t.length-1],t.length-1,o);if(!g)return null;if(!o)throw new Error("Can't infer output type");return new en(o,d,g)}evaluate(t){for(const[n,o]of this.branches)if(n.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,o]of this.branches)t(n),t(o);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Zo{constructor(t,n,o,d){this.type=t,this.input=n,this.beginIndex=o,this.endIndex=d}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Lt),d=n.parse(t[2],2,Je);if(!o||!d)return null;if(!Tc(o.type,[Jn(Lt),Ft,Lt]))return n.error(`Expected first argument to be of type array or string, but found ${Fi(o.type)} instead`);if(t.length===4){const g=n.parse(t[3],3,Je);return g?new Zo(o.type,o,d,g):null}return new Zo(o.type,o,d)}evaluate(t){const n=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),io(n,["string"]))return[...n].slice(o,d).join("");if(io(n,["array"]))return n.slice(o,d);throw new $i(`Expected first argument to be of type array or string, but found ${Fi(Qi(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function qo(a,t){const n=a.length-1;let o,d,g=0,_=n,w=0;for(;g<=_;)if(w=Math.floor((g+_)/2),o=a[w],d=a[w+1],o<=t){if(w===n||t<d)return w;g=w+1}else{if(!(o>t))throw new $i("Input is not a number.");_=w-1}return 0}class lo{constructor(t,n,o){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[d,g]of o)this.labels.push(d),this.outputs.push(g)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(t[1],1,Je);if(!o)return null;const d=[];let g=null;n.expectedType&&n.expectedType.kind!=="value"&&(g=n.expectedType);for(let _=1;_<t.length;_+=2){const w=_===1?-1/0:t[_],E=t[_+1],P=_,D=_+1;if(typeof w!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(d.length&&d[d.length-1][0]>=w)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const O=n.parse(E,D,g);if(!O)return null;g=g||O.type,d.push([w,O])}return new lo(g,o,d)}evaluate(t){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(t);const d=this.input.evaluate(t);if(d<=n[0])return o[0].evaluate(t);const g=n.length;return d>=n[g-1]?o[g-1].evaluate(t):o[qo(n,d)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function tn(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var bu,xu,Ed=function(){if(xu)return bu;function a(t,n,o,d){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=o,this.p2y=d}return xu=1,bu=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,d=0;d<8;d++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<n)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var w=0,E=1;for(o=t,d=0;d<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<n));d++)t>g?w=o:E=o,o=.5*(E-w)+w;return o},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},bu}(),Cd=tn(Ed);class gn{constructor(t,n,o,d,g){this.type=t,this.operator=n,this.interpolation=o,this.input=d,this.labels=[],this.outputs=[];for(const[_,w]of g)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(t,n,o,d){let g=0;if(t.name==="exponential")g=Cc(n,t.base,o,d);else if(t.name==="linear")g=Cc(n,1,o,d);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new Cd(_[0],_[1],_[2],_[3]).solve(Cc(n,1,o,d))}return g}static parse(t,n){let[o,d,g,..._]=t;if(!Array.isArray(d)||d.length===0)return n.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const P=d[1];if(typeof P!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:P}}else{if(d[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const P=d.slice(1);if(P.length!==4||P.some(D=>typeof D!="number"||D<0||D>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:P}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(g=n.parse(g,2,Je),!g)return null;const w=[];let E=null;o!=="interpolate-hcl"&&o!=="interpolate-lab"||n.expectedType==Ga?n.expectedType&&n.expectedType.kind!=="value"&&(E=n.expectedType):E=ji;for(let P=0;P<_.length;P+=2){const D=_[P],O=_[P+1],U=P+3,V=P+4;if(typeof D!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(w.length&&w[w.length-1][0]>=D)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const q=n.parse(O,V,E);if(!q)return null;E=E||q.type,w.push([D,q])}return Nn(E,Je)||Nn(E,qi)||Nn(E,ji)||Nn(E,Wn)||Nn(E,xs)||Nn(E,Ga)||Nn(E,wr)||Nn(E,Jn(Je))?new gn(E,o,d,g,w):n.error(`Type ${Fi(E)} is not interpolatable.`)}evaluate(t){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(t);const d=this.input.evaluate(t);if(d<=n[0])return o[0].evaluate(t);const g=n.length;if(d>=n[g-1])return o[g-1].evaluate(t);const _=qo(n,d),w=gn.interpolationFactor(this.interpolation,d,n[_],n[_+1]),E=o[_].evaluate(t),P=o[_+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return un(E,P,w);case"color":return ui.interpolate(E,P,w);case"padding":return Tr.interpolate(E,P,w);case"colorArray":return Hr.interpolate(E,P,w);case"numberArray":return Sr.interpolate(E,P,w);case"variableAnchorOffsetCollection":return mr.interpolate(E,P,w);case"array":return Oo(E,P,w);case"projectionDefinition":return Jr.interpolate(E,P,w)}case"interpolate-hcl":switch(this.type.kind){case"color":return ui.interpolate(E,P,w,"hcl");case"colorArray":return Hr.interpolate(E,P,w,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ui.interpolate(E,P,w,"lab");case"colorArray":return Hr.interpolate(E,P,w,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Cc(a,t,n,o){const d=o-n,g=a-n;return d===0?0:t===1?g/d:(Math.pow(t,g)-1)/(Math.pow(t,d)-1)}const Xa={color:ui.interpolate,number:un,padding:Tr.interpolate,numberArray:Sr.interpolate,colorArray:Hr.interpolate,variableAnchorOffsetCollection:mr.interpolate,array:Oo};class $o{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let o=null;const d=n.expectedType;d&&d.kind!=="value"&&(o=d);const g=[];for(const w of t.slice(1)){const E=n.parse(w,1+g.length,o,void 0,{typeAnnotation:"omit"});if(!E)return null;o=o||E.type,g.push(E)}if(!o)throw new Error("No output type");const _=d&&g.some(w=>Un(d,w.type));return new $o(_?Lt:o,g)}evaluate(t){let n,o=null,d=0;for(const g of this.args)if(d++,o=g.evaluate(t),o&&o instanceof Pn&&!o.available&&(n||(n=o.name),o=null,d===this.args.length&&(o=n)),o!==null)break;return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Go(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function ga(a,t,n,o){return o.compare(t,n)===0}function Ho(a,t,n){const o=a!=="=="&&a!=="!=";return class Dv{constructor(g,_,w){this.type=Gt,this.lhs=g,this.rhs=_,this.collator=w,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const w=g[0];let E=_.parse(g[1],1,Lt);if(!E)return null;if(!Go(w,E.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${Fi(E.type)}'.`);let P=_.parse(g[2],2,Lt);if(!P)return null;if(!Go(w,P.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${Fi(P.type)}'.`);if(E.type.kind!==P.type.kind&&E.type.kind!=="value"&&P.type.kind!=="value")return _.error(`Cannot compare types '${Fi(E.type)}' and '${Fi(P.type)}'.`);o&&(E.type.kind==="value"&&P.type.kind!=="value"?E=new Jt(P.type,[E]):E.type.kind!=="value"&&P.type.kind==="value"&&(P=new Jt(E.type,[P])));let D=null;if(g.length===4){if(E.type.kind!=="string"&&P.type.kind!=="string"&&E.type.kind!=="value"&&P.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(D=_.parse(g[3],3,Do),!D)return null}return new Dv(E,P,D)}evaluate(g){const _=this.lhs.evaluate(g),w=this.rhs.evaluate(g);if(o&&this.hasUntypedArgument){const E=Qi(_),P=Qi(w);if(E.kind!==P.kind||E.kind!=="string"&&E.kind!=="number")throw new $i(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${E.kind}, ${P.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const E=Qi(_),P=Qi(w);if(E.kind!=="string"||P.kind!=="string")return t(g,_,w)}return this.collator?n(g,_,w,this.collator.evaluate(g)):t(g,_,w)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const wu=Ho("==",function(a,t,n){return t===n},ga),Ad=Ho("!=",function(a,t,n){return t!==n},function(a,t,n,o){return!ga(0,t,n,o)}),Ah=Ho("<",function(a,t,n){return t<n},function(a,t,n,o){return o.compare(t,n)<0}),Hf=Ho(">",function(a,t,n){return t>n},function(a,t,n,o){return o.compare(t,n)>0}),Xf=Ho("<=",function(a,t,n){return t<=n},function(a,t,n,o){return o.compare(t,n)<=0}),Yf=Ho(">=",function(a,t,n){return t>=n},function(a,t,n,o){return o.compare(t,n)>=0});class Tu{constructor(t,n,o){this.type=Do,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const d=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,Gt);if(!d)return null;const g=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,Gt);if(!g)return null;let _=null;return o.locale&&(_=n.parse(o.locale,1,Ft),!_)?null:new Tu(d,g,_)}evaluate(t){return new ao(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Ll{constructor(t,n,o,d,g){this.type=Ft,this.number=t,this.locale=n,this.currency=o,this.minFractionDigits=d,this.maxFractionDigits=g}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const o=n.parse(t[1],1,Je);if(!o)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return n.error("NumberFormat options argument must be an object.");let g=null;if(d.locale&&(g=n.parse(d.locale,1,Ft),!g))return null;let _=null;if(d.currency&&(_=n.parse(d.currency,1,Ft),!_))return null;let w=null;if(d["min-fraction-digits"]&&(w=n.parse(d["min-fraction-digits"],1,Je),!w))return null;let E=null;return d["max-fraction-digits"]&&(E=n.parse(d["max-fraction-digits"],1,Je),!E)?null:new Ll(o,g,_,w,E)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Su{constructor(t){this.type=Al,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const d=[];let g=!1;for(let _=1;_<=t.length-1;++_){const w=t[_];if(g&&typeof w=="object"&&!Array.isArray(w)){g=!1;let E=null;if(w["font-scale"]&&(E=n.parse(w["font-scale"],1,Je),!E))return null;let P=null;if(w["text-font"]&&(P=n.parse(w["text-font"],1,Jn(Ft)),!P))return null;let D=null;if(w["text-color"]&&(D=n.parse(w["text-color"],1,ji),!D))return null;let O=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!Bo.includes(w["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(O=n.parse(w["vertical-align"],1,Ft),!O)return null}const U=d[d.length-1];U.scale=E,U.font=P,U.textColor=D,U.verticalAlign=O}else{const E=n.parse(t[_],1,Lt);if(!E)return null;const P=E.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,d.push({content:E,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Su(d)}evaluate(t){return new Gr(this.sections.map(n=>{const o=n.content.evaluate(t);return Qi(o)===eo?new so("",o,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new so(ai(o),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class Mu{constructor(t){this.type=eo,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const o=n.parse(t[1],1,Ft);return o?new Mu(o):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),o=Pn.fromString(n);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(n)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class Eu{constructor(t){this.type=Je,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=n.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Fi(o.type)} instead.`):new Eu(o):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new $i(`Expected value to be of type string or array, but found ${Fi(Qi(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const _a=8192;function Ol(a,t){const n=(180+a[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(n*d*_a),Math.round(o*d*_a)]}function zh(a,t){const n=Math.pow(2,t.z);return[(d=(a[0]/_a+t.x)/n,360*d-180),(o=(a[1]/_a+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,d}function Bl(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function jl(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function zd(a,t,n){const o=a[0]-t[0],d=a[1]-t[1],g=a[0]-n[0],_=a[1]-n[1];return o*_-g*d==0&&o*g<=0&&d*_<=0}function Ac(a,t,n,o){return(d=[o[0]-n[0],o[1]-n[1]])[0]*(g=[t[0]-a[0],t[1]-a[1]])[1]-d[1]*g[0]!=0&&!(!Ih(a,t,n,o)||!Ih(n,o,a,t));var d,g}function Ph(a,t,n){for(const o of n)for(let d=0;d<o.length-1;++d)if(Ac(a,t,o[d],o[d+1]))return!0;return!1}function ya(a,t,n=!1){let o=!1;for(const w of t)for(let E=0;E<w.length-1;E++){if(zd(a,w[E],w[E+1]))return n;(g=w[E])[1]>(d=a)[1]!=(_=w[E+1])[1]>d[1]&&d[0]<(_[0]-g[0])*(d[1]-g[1])/(_[1]-g[1])+g[0]&&(o=!o)}var d,g,_;return o}function Pd(a,t){for(const n of t)if(ya(a,n))return!0;return!1}function Id(a,t){for(const n of a)if(!ya(n,t))return!1;for(let n=0;n<a.length-1;++n)if(Ph(a[n],a[n+1],t))return!1;return!0}function Qf(a,t){for(const n of t)if(Id(a,n))return!0;return!1}function Ih(a,t,n,o){const d=o[0]-n[0],g=o[1]-n[1],_=(a[0]-n[0])*g-d*(a[1]-n[1]),w=(t[0]-n[0])*g-d*(t[1]-n[1]);return _>0&&w<0||_<0&&w>0}function Fl(a,t,n){const o=[];for(let d=0;d<a.length;d++){const g=[];for(let _=0;_<a[d].length;_++){const w=Ol(a[d][_],n);Bl(t,w),g.push(w)}o.push(g)}return o}function Ul(a,t,n){const o=[];for(let d=0;d<a.length;d++){const g=Fl(a[d],t,n);o.push(g)}return o}function Nl(a,t,n,o){if(a[0]<n[0]||a[0]>n[2]){const d=.5*o;let g=a[0]-n[0]>d?-o:n[0]-a[0]>d?o:0;g===0&&(g=a[0]-n[2]>d?-o:n[2]-a[0]>d?o:0),a[0]+=g}Bl(t,a)}function Dd(a,t,n,o){const d=Math.pow(2,o.z)*_a,g=[o.x*_a,o.y*_a],_=[];for(const w of a)for(const E of w){const P=[E.x+g[0],E.y+g[1]];Nl(P,t,n,d),_.push(P)}return _}function Vl(a,t,n,o){const d=Math.pow(2,o.z)*_a,g=[o.x*_a,o.y*_a],_=[];for(const E of a){const P=[];for(const D of E){const O=[D.x+g[0],D.y+g[1]];Bl(t,O),P.push(O)}_.push(P)}if(t[2]-t[0]<=d/2){(w=t)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const E of _)for(const P of E)Nl(P,t,n,d)}var w;return _}class Ts{constructor(t,n){this.type=Gt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ai(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const d=[];for(const g of o.features){const{type:_,coordinates:w}=g.geometry;_==="Polygon"&&d.push(w),_==="MultiPolygon"&&d.push(...w)}if(d.length)return new Ts(o,{type:"MultiPolygon",coordinates:d})}else if(o.type==="Feature"){const d=o.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Ts(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Ts(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,o){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(o.type==="Polygon"){const w=Fl(o.coordinates,g,_),E=Dd(n.geometry(),d,g,_);if(!jl(d,g))return!1;for(const P of E)if(!ya(P,w))return!1}if(o.type==="MultiPolygon"){const w=Ul(o.coordinates,g,_),E=Dd(n.geometry(),d,g,_);if(!jl(d,g))return!1;for(const P of E)if(!Pd(P,w))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,o){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(o.type==="Polygon"){const w=Fl(o.coordinates,g,_),E=Vl(n.geometry(),d,g,_);if(!jl(d,g))return!1;for(const P of E)if(!Id(P,w))return!1}if(o.type==="MultiPolygon"){const w=Ul(o.coordinates,g,_),E=Vl(n.geometry(),d,g,_);if(!jl(d,g))return!1;for(const P of E)if(!Qf(P,w))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Dh=class{constructor(a=[],t=(n,o)=>n<o?-1:n>o?1:0){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:n}=this,o=t[a];for(;a>0;){const d=a-1>>1,g=t[d];if(n(o,g)>=0)break;t[a]=g,a=d}t[a]=o}_down(a){const{data:t,compare:n}=this,o=this.length>>1,d=t[a];for(;a<o;){let g=1+(a<<1);const _=g+1;if(_<this.length&&n(t[_],t[g])<0&&(g=_),n(t[g],d)>=0)break;t[a]=t[g],a=g}t[a]=d}};function Cu(a,t,n=0,o=a.length-1,d=Rh){for(;o>n;){if(o-n>600){const E=o-n+1,P=t-n+1,D=Math.log(E),O=.5*Math.exp(2*D/3),U=.5*Math.sqrt(D*O*(E-O)/E)*(P-E/2<0?-1:1);Cu(a,t,Math.max(n,Math.floor(t-P*O/E+U)),Math.min(o,Math.floor(t+(E-P)*O/E+U)),d)}const g=a[t];let _=n,w=o;for(co(a,n,t),d(a[o],g)>0&&co(a,n,o);_<w;){for(co(a,_,w),_++,w--;d(a[_],g)<0;)_++;for(;d(a[w],g)>0;)w--}d(a[n],g)===0?co(a,n,w):(w++,co(a,w,o)),w<=t&&(n=w+1),t<=w&&(o=w-1)}}function co(a,t,n){const o=a[t];a[t]=a[n],a[n]=o}function Rh(a,t){return a<t?-1:a>t?1:0}function zc(a,t){if(a.length<=1)return[a];const n=[];let o,d;for(const g of a){const _=Kf(g);_!==0&&(g.area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(o&&n.push(o),o=[g]):o.push(g))}if(o&&n.push(o),t>1)for(let g=0;g<n.length;g++)n[g].length<=t||(Cu(n[g],t,1,n[g].length-1,Rd),n[g]=n[g].slice(0,t));return n}function Rd(a,t){return t.area-a.area}function Kf(a){let t=0;for(let n,o,d=0,g=a.length,_=g-1;d<g;_=d++)n=a[d],o=a[_],t+=(o.x-n.x)*(n.y+o.y);return t}const kh=1/298.257223563,kd=kh*(2-kh),Ld=Math.PI/180;class Lh{constructor(t){const n=6378.137*Ld*1e3,o=Math.cos(t*Ld),d=1/(1-kd*(1-o*o)),g=Math.sqrt(d);this.kx=n*g*o,this.ky=n*g*d*(1-kd)}distance(t,n){const o=this.wrap(t[0]-n[0])*this.kx,d=(t[1]-n[1])*this.ky;return Math.sqrt(o*o+d*d)}pointOnLine(t,n){let o,d,g,_,w=1/0;for(let E=0;E<t.length-1;E++){let P=t[E][0],D=t[E][1],O=this.wrap(t[E+1][0]-P)*this.kx,U=(t[E+1][1]-D)*this.ky,V=0;O===0&&U===0||(V=(this.wrap(n[0]-P)*this.kx*O+(n[1]-D)*this.ky*U)/(O*O+U*U),V>1?(P=t[E+1][0],D=t[E+1][1]):V>0&&(P+=O/this.kx*V,D+=U/this.ky*V)),O=this.wrap(n[0]-P)*this.kx,U=(n[1]-D)*this.ky;const q=O*O+U*U;q<w&&(w=q,o=P,d=D,g=E,_=V)}return{point:[o,d],index:g,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Zn(a,t){return t[0]-a[0]}function si(a){return a[1]-a[0]+1}function Ya(a,t){return a[1]>=a[0]&&a[1]<t}function Au(a,t){if(a[0]>a[1])return[null,null];const n=si(a);if(t){if(n===2)return[a,null];const d=Math.floor(n/2);return[[a[0],a[0]+d],[a[0]+d,a[1]]]}if(n===1)return[a,null];const o=Math.floor(n/2)-1;return[[a[0],a[0]+o],[a[0]+o+1,a[1]]]}function zu(a,t){if(!Ya(t,a.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)Bl(n,a[o]);return n}function Pu(a){const t=[1/0,1/0,-1/0,-1/0];for(const n of a)for(const o of n)Bl(t,o);return t}function Iu(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Oh(a,t,n){if(!Iu(a)||!Iu(t))return NaN;let o=0,d=0;return a[2]<t[0]&&(o=t[0]-a[2]),a[0]>t[2]&&(o=a[0]-t[2]),a[1]>t[3]&&(d=a[1]-t[3]),a[3]<t[1]&&(d=t[1]-a[3]),n.distance([0,0],[o,d])}function va(a,t,n){const o=n.pointOnLine(t,a);return n.distance(a,o.point)}function Pc(a,t,n,o,d){const g=Math.min(va(a,[n,o],d),va(t,[n,o],d)),_=Math.min(va(n,[a,t],d),va(o,[a,t],d));return Math.min(g,_)}function Ic(a,t,n,o,d){if(!Ya(t,a.length)||!Ya(o,n.length))return 1/0;let g=1/0;for(let _=t[0];_<t[1];++_){const w=a[_],E=a[_+1];for(let P=o[0];P<o[1];++P){const D=n[P],O=n[P+1];if(Ac(w,E,D,O))return 0;g=Math.min(g,Pc(w,E,D,O,d))}}return g}function Bh(a,t,n,o,d){if(!Ya(t,a.length)||!Ya(o,n.length))return NaN;let g=1/0;for(let _=t[0];_<=t[1];++_)for(let w=o[0];w<=o[1];++w)if(g=Math.min(g,d.distance(a[_],n[w])),g===0)return g;return g}function Od(a,t,n){if(ya(a,t,!0))return 0;let o=1/0;for(const d of t){const g=d[0],_=d[d.length-1];if(g!==_&&(o=Math.min(o,va(a,[_,g],n)),o===0))return o;const w=n.pointOnLine(d,a);if(o=Math.min(o,n.distance(a,w.point)),o===0)return o}return o}function Xo(a,t,n,o){if(!Ya(t,a.length))return NaN;for(let g=t[0];g<=t[1];++g)if(ya(a[g],n,!0))return 0;let d=1/0;for(let g=t[0];g<t[1];++g){const _=a[g],w=a[g+1];for(const E of n)for(let P=0,D=E.length,O=D-1;P<D;O=P++){const U=E[O],V=E[P];if(Ac(_,w,U,V))return 0;d=Math.min(d,Pc(_,w,U,V,o))}}return d}function Yo(a,t){for(const n of a)for(const o of n)if(ya(o,t,!0))return!0;return!1}function jh(a,t,n,o=1/0){const d=Pu(a),g=Pu(t);if(o!==1/0&&Oh(d,g,n)>=o)return o;if(jl(d,g)){if(Yo(a,t))return 0}else if(Yo(t,a))return 0;let _=1/0;for(const w of a)for(let E=0,P=w.length,D=P-1;E<P;D=E++){const O=w[D],U=w[E];for(const V of t)for(let q=0,H=V.length,J=H-1;q<H;J=q++){const se=V[J],ye=V[q];if(Ac(O,U,se,ye))return 0;_=Math.min(_,Pc(O,U,se,ye,n))}}return _}function Fh(a,t,n,o,d,g){if(!g)return;const _=Oh(zu(o,g),d,n);_<t&&a.push([_,g,[0,0]])}function Qa(a,t,n,o,d,g,_){if(!g||!_)return;const w=Oh(zu(o,g),zu(d,_),n);w<t&&a.push([w,g,_])}function Dc(a,t,n,o,d=1/0){let g=Math.min(o.distance(a[0],n[0][0]),d);if(g===0)return g;const _=new Dh([[0,[0,a.length-1],[0,0]]],Zn),w=Pu(n);for(;_.length>0;){const E=_.pop();if(E[0]>=g)continue;const P=E[1],D=t?50:100;if(si(P)<=D){if(!Ya(P,a.length))return NaN;if(t){const O=Xo(a,P,n,o);if(isNaN(O)||O===0)return O;g=Math.min(g,O)}else for(let O=P[0];O<=P[1];++O){const U=Od(a[O],n,o);if(g=Math.min(g,U),g===0)return 0}}else{const O=Au(P,t);Fh(_,g,o,a,w,O[0]),Fh(_,g,o,a,w,O[1])}}return g}function Rc(a,t,n,o,d,g=1/0){let _=Math.min(g,d.distance(a[0],n[0]));if(_===0)return _;const w=new Dh([[0,[0,a.length-1],[0,n.length-1]]],Zn);for(;w.length>0;){const E=w.pop();if(E[0]>=_)continue;const P=E[1],D=E[2],O=t?50:100,U=o?50:100;if(si(P)<=O&&si(D)<=U){if(!Ya(P,a.length)&&Ya(D,n.length))return NaN;let V;if(t&&o)V=Ic(a,P,n,D,d),_=Math.min(_,V);else if(t&&!o){const q=a.slice(P[0],P[1]+1);for(let H=D[0];H<=D[1];++H)if(V=va(n[H],q,d),_=Math.min(_,V),_===0)return _}else if(!t&&o){const q=n.slice(D[0],D[1]+1);for(let H=P[0];H<=P[1];++H)if(V=va(a[H],q,d),_=Math.min(_,V),_===0)return _}else V=Bh(a,P,n,D,d),_=Math.min(_,V)}else{const V=Au(P,t),q=Au(D,o);Qa(w,_,d,a,n,V[0],q[0]),Qa(w,_,d,a,n,V[0],q[1]),Qa(w,_,d,a,n,V[1],q[0]),Qa(w,_,d,a,n,V[1],q[1])}}return _}function Du(a){return a.type==="MultiPolygon"?a.coordinates.map(t=>({type:"Polygon",coordinates:t})):a.type==="MultiLineString"?a.coordinates.map(t=>({type:"LineString",coordinates:t})):a.type==="MultiPoint"?a.coordinates.map(t=>({type:"Point",coordinates:t})):[a]}class Qo{constructor(t,n){this.type=Je,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ai(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new Qo(o,o.features.map(d=>Du(d.geometry)).flat());if(o.type==="Feature")return new Qo(o,Du(o.geometry));if("type"in o&&"coordinates"in o)return new Qo(o,Du(o))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,o){const d=n.geometry(),g=d.flat().map(E=>zh([E.x,E.y],n.canonical));if(d.length===0)return NaN;const _=new Lh(g[0][1]);let w=1/0;for(const E of o){switch(E.type){case"Point":w=Math.min(w,Rc(g,!1,[E.coordinates],!1,_,w));break;case"LineString":w=Math.min(w,Rc(g,!1,E.coordinates,!0,_,w));break;case"Polygon":w=Math.min(w,Dc(g,!1,E.coordinates,_,w))}if(w===0)return w}return w}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,o){const d=n.geometry(),g=d.flat().map(E=>zh([E.x,E.y],n.canonical));if(d.length===0)return NaN;const _=new Lh(g[0][1]);let w=1/0;for(const E of o){switch(E.type){case"Point":w=Math.min(w,Rc(g,!0,[E.coordinates],!1,_,w));break;case"LineString":w=Math.min(w,Rc(g,!0,E.coordinates,!0,_,w));break;case"Polygon":w=Math.min(w,Dc(g,!0,E.coordinates,_,w))}if(w===0)return w}return w}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,o){const d=n.geometry();if(d.length===0||d[0].length===0)return NaN;const g=zc(d,0).map(E=>E.map(P=>P.map(D=>zh([D.x,D.y],n.canonical)))),_=new Lh(g[0][0][0][1]);let w=1/0;for(const E of o)for(const P of g){switch(E.type){case"Point":w=Math.min(w,Dc([E.coordinates],!1,P,_,w));break;case"LineString":w=Math.min(w,Dc(E.coordinates,!0,P,_,w));break;case"Polygon":w=Math.min(w,jh(P,E.coordinates,_,w))}if(w===0)return w}return w}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ru{constructor(t){this.type=Lt,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=t[1];return o==null?n.error("Global state property must be defined."):typeof o!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Ru(o)}evaluate(t){var n;const o=(n=t.globals)===null||n===void 0?void 0:n.globalState;return o&&Object.keys(o).length!==0?Il(o,this.key):null}eachChild(){}outputDefined(){return!1}}const Zl={"==":wu,"!=":Ad,">":Hf,"<":Ah,">=":Yf,"<=":Xf,array:Jt,at:Uo,boolean:Jt,case:en,coalesce:$o,collator:Tu,format:Su,image:Mu,in:No,"index-of":kl,interpolate:gn,"interpolate-hcl":gn,"interpolate-lab":gn,length:Eu,let:oo,literal:Ht,match:Vo,number:Jt,"number-format":Ll,object:Jt,slice:Zo,step:lo,string:Jt,"to-boolean":Mr,"to-color":Mr,"to-number":Mr,"to-string":Mr,var:Fo,within:Ts,distance:Qo,"global-state":Ru};class ta{constructor(t,n,o,d){this.name=t,this.type=n,this._evaluate=o,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const o=t[0],d=ta.definitions[o];if(!d)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,w=_.filter(([P])=>!Array.isArray(P)||P.length===t.length-1);let E=null;for(const[P,D]of w){E=new Ec(n.registry,In,n.path,null,n.scope);const O=[];let U=!1;for(let V=1;V<t.length;V++){const q=t[V],H=Array.isArray(P)?P[V-1]:P.type,J=E.parse(q,1+O.length,H);if(!J){U=!0;break}O.push(J)}if(!U)if(Array.isArray(P)&&P.length!==O.length)E.error(`Expected ${P.length} arguments, but found ${O.length} instead.`);else{for(let V=0;V<O.length;V++){const q=Array.isArray(P)?P[V]:P.type,H=O[V];E.concat(V+1).checkSubtype(q,H.type)}if(E.errors.length===0)return new ta(o,g,D,O)}}if(w.length===1)n.errors.push(...E.errors);else{const P=(w.length?w:_).map(([O])=>{return U=O,Array.isArray(U)?`(${U.map(Fi).join(", ")})`:`(${Fi(U.type)}...)`;var U}).join(" | "),D=[];for(let O=1;O<t.length;O++){const U=n.parse(t[O],1+D.length);if(!U)return null;D.push(Fi(U.type))}n.error(`Expected arguments of type ${P}, but found (${D.join(", ")}) instead.`)}return null}static register(t,n){ta.definitions=n;for(const o in n)t[o]=ta}}function Uh(a,[t,n,o,d]){t=t.evaluate(a),n=n.evaluate(a),o=o.evaluate(a);const g=d?d.evaluate(a):1,_=ma(t,n,o,g);if(_)throw new $i(_);return new ui(t/255,n/255,o/255,g,!1)}function ku(a,t){return a in t}function ia(a,t){const n=t[a];return n===void 0?null:n}function uo(a){return{type:a}}function In(a){if(a instanceof Fo)return In(a.boundExpression);if(a instanceof ta&&a.name==="error"||a instanceof Tu||a instanceof Ts||a instanceof Qo||a instanceof Ru)return!1;const t=a instanceof Mr||a instanceof Jt;let n=!0;return a.eachChild(o=>{n=t?n&&In(o):n&&o instanceof Ht}),!!n&&Dn(a)&&ql(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Dn(a){if(a instanceof ta&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Ts||a instanceof Qo)return!1;let t=!0;return a.eachChild(n=>{t&&!Dn(n)&&(t=!1)}),t}function Ka(a){if(a instanceof ta&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(n=>{t&&!Ka(n)&&(t=!1)}),t}function ql(a,t){if(a instanceof ta&&t.indexOf(a.name)>=0)return!1;let n=!0;return a.eachChild(o=>{n&&!ql(o,t)&&(n=!1)}),n}function Ko(a){return{result:"success",value:a}}function Ss(a){return{result:"error",value:a}}function ho(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Wo(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function kc(a){return!!a.expression&&a.expression.interpolated}function ri(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Ms(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)&&Qi(a)===$r}function Lu(a){return a}function Rn(a,t){const n=a.stops&&typeof a.stops[0][0]=="object",o=n||!(n||a.property!==void 0),d=a.type||(kc(t)?"exponential":"interval"),g=function(D){switch(D.type){case"color":return ui.parse;case"padding":return Tr.parse;case"numberArray":return Sr.parse;case"colorArray":return Hr.parse;default:return null}}(t);if(g&&((a=yi({},a)).stops&&(a.stops=a.stops.map(D=>[D[0],g(D[1])])),a.default=g(a.default?a.default:t.default)),a.colorSpace&&(_=a.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var _;const w=function(D){switch(D){case"exponential":return Lc;case"interval":return Bd;case"categorical":return Es;case"identity":return el;default:throw new Error(`Unknown function type "${D}"`)}}(d);let E,P;if(d==="categorical"){E=Object.create(null);for(const D of a.stops)E[D[0]]=D[1];P=typeof a.stops[0][0]}if(n){const D={},O=[];for(let q=0;q<a.stops.length;q++){const H=a.stops[q],J=H[0].zoom;D[J]===void 0&&(D[J]={zoom:J,type:a.type,property:a.property,default:a.default,stops:[]},O.push(J)),D[J].stops.push([H[0].value,H[1]])}const U=[];for(const q of O)U.push([D[q].zoom,Rn(D[q],t)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:gn.interpolationFactor.bind(void 0,V),zoomStops:U.map(q=>q[0]),evaluate:({zoom:q},H)=>Lc({stops:U,base:a.base},t,q).evaluate(q,H)}}if(o){const D=d==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:gn.interpolationFactor.bind(void 0,D),zoomStops:a.stops.map(O=>O[0]),evaluate:({zoom:O})=>w(a,t,O,E,P)}}return{kind:"source",evaluate(D,O){const U=O&&O.properties?O.properties[a.property]:void 0;return U===void 0?Jo(a.default,t.default):w(a,t,U,E,P)}}}function Jo(a,t,n){return a!==void 0?a:t!==void 0?t:n!==void 0?n:void 0}function Es(a,t,n,o,d){return Jo(typeof n===d?o[n]:void 0,a.default,t.default)}function Bd(a,t,n){if(ri(n)!=="number")return Jo(a.default,t.default);const o=a.stops.length;if(o===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[o-1][0])return a.stops[o-1][1];const d=qo(a.stops.map(g=>g[0]),n);return a.stops[d][1]}function Lc(a,t,n){const o=a.base!==void 0?a.base:1;if(ri(n)!=="number")return Jo(a.default,t.default);const d=a.stops.length;if(d===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[d-1][0])return a.stops[d-1][1];const g=qo(a.stops.map(D=>D[0]),n),_=function(D,O,U,V){const q=V-U,H=D-U;return q===0?0:O===1?H/q:(Math.pow(O,H)-1)/(Math.pow(O,q)-1)}(n,o,a.stops[g][0],a.stops[g+1][0]),w=a.stops[g][1],E=a.stops[g+1][1],P=Xa[t.type]||Lu;return typeof w.evaluate=="function"?{evaluate(...D){const O=w.evaluate.apply(void 0,D),U=E.evaluate.apply(void 0,D);if(O!==void 0&&U!==void 0)return P(O,U,_,a.colorSpace)}}:P(w,E,_,a.colorSpace)}function el(a,t,n){switch(t.type){case"color":n=ui.parse(n);break;case"formatted":n=Gr.fromString(n.toString());break;case"resolvedImage":n=Pn.fromString(n.toString());break;case"padding":n=Tr.parse(n);break;case"colorArray":n=Hr.parse(n);break;case"numberArray":n=Sr.parse(n);break;default:ri(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return Jo(n,a.default,t.default)}ta.register(Zl,{error:[{kind:"error"},[Ft],(a,[t])=>{throw new $i(t.evaluate(a))}],typeof:[Ft,[Lt],(a,[t])=>Fi(Qi(t.evaluate(a)))],"to-rgba":[Jn(Je,4),[ji],(a,[t])=>{const[n,o,d,g]=t.evaluate(a).rgb;return[255*n,255*o,255*d,g]}],rgb:[ji,[Je,Je,Je],Uh],rgba:[ji,[Je,Je,Je,Je],Uh],has:{type:Gt,overloads:[[[Ft],(a,[t])=>ku(t.evaluate(a),a.properties())],[[Ft,$r],(a,[t,n])=>ku(t.evaluate(a),n.evaluate(a))]]},get:{type:Lt,overloads:[[[Ft],(a,[t])=>ia(t.evaluate(a),a.properties())],[[Ft,$r],(a,[t,n])=>ia(t.evaluate(a),n.evaluate(a))]]},"feature-state":[Lt,[Ft],(a,[t])=>ia(t.evaluate(a),a.featureState||{})],properties:[$r,[],a=>a.properties()],"geometry-type":[Ft,[],a=>a.geometryType()],id:[Lt,[],a=>a.id()],zoom:[Je,[],a=>a.globals.zoom],"heatmap-density":[Je,[],a=>a.globals.heatmapDensity||0],"line-progress":[Je,[],a=>a.globals.lineProgress||0],accumulated:[Lt,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Je,uo(Je),(a,t)=>{let n=0;for(const o of t)n+=o.evaluate(a);return n}],"*":[Je,uo(Je),(a,t)=>{let n=1;for(const o of t)n*=o.evaluate(a);return n}],"-":{type:Je,overloads:[[[Je,Je],(a,[t,n])=>t.evaluate(a)-n.evaluate(a)],[[Je],(a,[t])=>-t.evaluate(a)]]},"/":[Je,[Je,Je],(a,[t,n])=>t.evaluate(a)/n.evaluate(a)],"%":[Je,[Je,Je],(a,[t,n])=>t.evaluate(a)%n.evaluate(a)],ln2:[Je,[],()=>Math.LN2],pi:[Je,[],()=>Math.PI],e:[Je,[],()=>Math.E],"^":[Je,[Je,Je],(a,[t,n])=>Math.pow(t.evaluate(a),n.evaluate(a))],sqrt:[Je,[Je],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[Je,[Je],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[Je,[Je],(a,[t])=>Math.log(t.evaluate(a))],log2:[Je,[Je],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[Je,[Je],(a,[t])=>Math.sin(t.evaluate(a))],cos:[Je,[Je],(a,[t])=>Math.cos(t.evaluate(a))],tan:[Je,[Je],(a,[t])=>Math.tan(t.evaluate(a))],asin:[Je,[Je],(a,[t])=>Math.asin(t.evaluate(a))],acos:[Je,[Je],(a,[t])=>Math.acos(t.evaluate(a))],atan:[Je,[Je],(a,[t])=>Math.atan(t.evaluate(a))],min:[Je,uo(Je),(a,t)=>Math.min(...t.map(n=>n.evaluate(a)))],max:[Je,uo(Je),(a,t)=>Math.max(...t.map(n=>n.evaluate(a)))],abs:[Je,[Je],(a,[t])=>Math.abs(t.evaluate(a))],round:[Je,[Je],(a,[t])=>{const n=t.evaluate(a);return n<0?-Math.round(-n):Math.round(n)}],floor:[Je,[Je],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[Je,[Je],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[Gt,[Ft,Lt],(a,[t,n])=>a.properties()[t.value]===n.value],"filter-id-==":[Gt,[Lt],(a,[t])=>a.id()===t.value],"filter-type-==":[Gt,[Ft],(a,[t])=>a.geometryType()===t.value],"filter-<":[Gt,[Ft,Lt],(a,[t,n])=>{const o=a.properties()[t.value],d=n.value;return typeof o==typeof d&&o<d}],"filter-id-<":[Gt,[Lt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n<o}],"filter->":[Gt,[Ft,Lt],(a,[t,n])=>{const o=a.properties()[t.value],d=n.value;return typeof o==typeof d&&o>d}],"filter-id->":[Gt,[Lt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n>o}],"filter-<=":[Gt,[Ft,Lt],(a,[t,n])=>{const o=a.properties()[t.value],d=n.value;return typeof o==typeof d&&o<=d}],"filter-id-<=":[Gt,[Lt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n<=o}],"filter->=":[Gt,[Ft,Lt],(a,[t,n])=>{const o=a.properties()[t.value],d=n.value;return typeof o==typeof d&&o>=d}],"filter-id->=":[Gt,[Lt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n>=o}],"filter-has":[Gt,[Lt],(a,[t])=>t.value in a.properties()],"filter-has-id":[Gt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Gt,[Jn(Ft)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[Gt,[Jn(Lt)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[Gt,[Ft,Jn(Lt)],(a,[t,n])=>n.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[Gt,[Ft,Jn(Lt)],(a,[t,n])=>function(o,d,g,_){for(;g<=_;){const w=g+_>>1;if(d[w]===o)return!0;d[w]>o?_=w-1:g=w+1}return!1}(a.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Gt,overloads:[[[Gt,Gt],(a,[t,n])=>t.evaluate(a)&&n.evaluate(a)],[uo(Gt),(a,t)=>{for(const n of t)if(!n.evaluate(a))return!1;return!0}]]},any:{type:Gt,overloads:[[[Gt,Gt],(a,[t,n])=>t.evaluate(a)||n.evaluate(a)],[uo(Gt),(a,t)=>{for(const n of t)if(n.evaluate(a))return!0;return!1}]]},"!":[Gt,[Gt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[Gt,[Ft],(a,[t])=>{const n=a.globals&&a.globals.isSupportedScript;return!n||n(t.evaluate(a))}],upcase:[Ft,[Ft],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[Ft,[Ft],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[Ft,uo(Lt),(a,t)=>t.map(n=>ai(n.evaluate(a))).join("")],"resolved-locale":[Ft,[Do],(a,[t])=>t.evaluate(a).resolvedLocale()]});class $l{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new jo,this._defaultValue=n?function(o){if(o.type==="color"&&Ms(o.default))return new ui(0,0,0,0);switch(o.type){case"color":return ui.parse(o.default)||null;case"padding":return Tr.parse(o.default)||null;case"numberArray":return Sr.parse(o.default)||null;case"colorArray":return Hr.parse(o.default)||null;case"variableAnchorOffsetCollection":return mr.parse(o.default)||null;case"projectionDefinition":return Jr.parse(o.default)||null;default:return o.default===void 0?null:o.default}}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,o,d,g,_){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,n,o,d,g,_){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new $i(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function tl(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Zl}function Cs(a,t){const n=new Ec(Zl,In,[],t?function(d){const g={color:ji,string:Ft,number:Je,enum:Ft,boolean:Gt,formatted:Al,padding:Wn,numberArray:xs,colorArray:Ga,projectionDefinition:qi,resolvedImage:eo,variableAnchorOffsetCollection:wr};return d.type==="array"?Jn(g[d.value]||Lt,d.length):g[d.type]}(t):void 0),o=n.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?Ko(new $l(o,t)):Ss(n.errors)}class fo{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!Ka(n.expression)}evaluateWithoutErrorHandling(t,n,o,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,o,d,g,_)}evaluate(t,n,o,d,g,_){return this._styleExpression.evaluate(t,n,o,d,g,_)}}class il{constructor(t,n,o,d){this.kind=t,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Ka(n.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,n,o,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,o,d,g,_)}evaluate(t,n,o,d,g,_){return this._styleExpression.evaluate(t,n,o,d,g,_)}interpolationFactor(t,n,o){return this.interpolationType?gn.interpolationFactor(this.interpolationType,t,n,o):0}}function Gl(a,t){const n=Cs(a,t);if(n.result==="error")return n;const o=n.value.expression,d=Dn(o);if(!d&&!ho(t))return Ss([new ci("","data expressions not supported")]);const g=ql(o,["zoom"]);if(!g&&!Wo(t))return Ss([new ci("","zoom expressions not supported")]);const _=yn(o);return _||g?_ instanceof ci?Ss([_]):_ instanceof gn&&!kc(t)?Ss([new ci("",'"interpolate" expressions cannot be used with this property')]):Ko(_?new il(d?"camera":"composite",n.value,_.labels,_ instanceof gn?_.interpolation:void 0):new fo(d?"constant":"source",n.value)):Ss([new ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _n{constructor(t,n){this._parameters=t,this._specification=n,yi(this,Rn(this._parameters,this._specification))}static deserialize(t){return new _n(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function yn(a){let t=null;if(a instanceof oo)t=yn(a.result);else if(a instanceof $o){for(const n of a.args)if(t=yn(n),t)break}else(a instanceof lo||a instanceof gn)&&a.input instanceof ta&&a.input.name==="zoom"&&(t=a);return t instanceof ci||a.eachChild(n=>{const o=yn(n);o instanceof ci?t=o:!t&&o?t=new ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new ci("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function za(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!za(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Pa={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ra(a){if(a==null)return{filter:()=>!0,needGeometry:!1};za(a)||(a=Hl(a));const t=Cs(a,Pa);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,o,d)=>t.value.evaluate(n,o,{},d),needGeometry:Nh(a)}}function Wa(a,t){return a<t?-1:a>t?1:0}function Nh(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(Nh(a[t]))return!0;return!1}function Hl(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?Oc(a[1],a[2],"=="):t==="!="?bi(Oc(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Oc(a[1],a[2],t):t==="any"?(n=a.slice(1),["any"].concat(n.map(Hl))):t==="all"?["all"].concat(a.slice(1).map(Hl)):t==="none"?["all"].concat(a.slice(1).map(Hl).map(bi)):t==="in"?vn(a[1],a.slice(2)):t==="!in"?bi(vn(a[1],a.slice(2))):t==="has"?gr(a[1]):t!=="!has"||bi(gr(a[1]));var n}function Oc(a,t,n){switch(a){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,a,t]}}function vn(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Wa)]]:["filter-in-small",a,["literal",t]]}}function gr(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function bi(a){return["!",a]}function Ja(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let d="[";for(const g of a)d+=`${Ja(g)},`;return`${d}]`}const n=Object.keys(a).sort();let o="{";for(let d=0;d<n.length;d++)o+=`${JSON.stringify(n[d])}:${Ja(a[n[d]])},`;return`${o}}`}function Ia(a){let t="";for(const n of Re)t+=`/${Ja(a[n])}`;return t}function rl(a){const t=a.value;return t?[new qe(a.key,t,"constants have been deprecated as of v8")]:[]}function Ui(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function As(a){if(Array.isArray(a))return a.map(As);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const n in a)t[n]=As(a[n]);return t}return Ui(a)}function qn(a){const t=a.key,n=a.value,o=a.valueSpec||{},d=a.objectElementValidators||{},g=a.style,_=a.styleSpec,w=a.validateSpec;let E=[];const P=ri(n);if(P!=="object")return[new qe(t,n,`object expected, ${P} found`)];for(const D in n){const O=D.split(".")[0],U=Il(o,O)||o["*"];let V;if(Il(d,O))V=d[O];else if(Il(o,O))V=w;else if(d["*"])V=d["*"];else{if(!o["*"]){E.push(new qe(t,n[D],`unknown property "${D}"`));continue}V=w}E=E.concat(V({key:(t&&`${t}.`)+D,value:n[D],valueSpec:U,style:g,styleSpec:_,object:n,objectKey:D,validateSpec:w},n))}for(const D in o)d[D]||o[D].required&&o[D].default===void 0&&n[D]===void 0&&E.push(new qe(t,n,`missing required property "${D}"`));return E}function nl(a){const t=a.value,n=a.valueSpec,o=a.style,d=a.styleSpec,g=a.key,_=a.arrayElementValidator||a.validateSpec;if(ri(t)!=="array")return[new qe(g,t,`array expected, ${ri(t)} found`)];if(n.length&&t.length!==n.length)return[new qe(g,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new qe(g,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let w={type:n.value,values:n.values};d.$version<7&&(w.function=n.function),ri(n.value)==="object"&&(w=n.value);let E=[];for(let P=0;P<t.length;P++)E=E.concat(_({array:t,arrayIndex:P,value:t[P],valueSpec:w,validateSpec:a.validateSpec,style:o,styleSpec:d,key:`${g}[${P}]`}));return E}function zs(a){const t=a.key,n=a.value,o=a.valueSpec;let d=ri(n);return d==="number"&&n!=n&&(d="NaN"),d!=="number"?[new qe(t,n,`number expected, ${d} found`)]:"minimum"in o&&n<o.minimum?[new qe(t,n,`${n} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&n>o.maximum?[new qe(t,n,`${n} is greater than the maximum value ${o.maximum}`)]:[]}function Ou(a){const t=a.valueSpec,n=Ui(a.value.type);let o,d,g,_={};const w=n!=="categorical"&&a.value.property===void 0,E=!w,P=ri(a.value.stops)==="array"&&ri(a.value.stops[0])==="array"&&ri(a.value.stops[0][0])==="object",D=qn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(V){if(n==="identity")return[new qe(V.key,V.value,'identity function may not have a "stops" property')];let q=[];const H=V.value;return q=q.concat(nl({key:V.key,value:H,valueSpec:V.valueSpec,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:O})),ri(H)==="array"&&H.length===0&&q.push(new qe(V.key,H,"array must have at least one stop")),q},default:function(V){return V.validateSpec({key:V.key,value:V.value,valueSpec:t,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec})}}});return n==="identity"&&w&&D.push(new qe(a.key,a.value,'missing required property "property"')),n==="identity"||a.value.stops||D.push(new qe(a.key,a.value,'missing required property "stops"')),n==="exponential"&&a.valueSpec.expression&&!kc(a.valueSpec)&&D.push(new qe(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(E&&!ho(a.valueSpec)?D.push(new qe(a.key,a.value,"property functions not supported")):w&&!Wo(a.valueSpec)&&D.push(new qe(a.key,a.value,"zoom functions not supported"))),n!=="categorical"&&!P||a.value.property!==void 0||D.push(new qe(a.key,a.value,'"property" property is required')),D;function O(V){let q=[];const H=V.value,J=V.key;if(ri(H)!=="array")return[new qe(J,H,`array expected, ${ri(H)} found`)];if(H.length!==2)return[new qe(J,H,`array length 2 expected, length ${H.length} found`)];if(P){if(ri(H[0])!=="object")return[new qe(J,H,`object expected, ${ri(H[0])} found`)];if(H[0].zoom===void 0)return[new qe(J,H,"object stop key must have zoom")];if(H[0].value===void 0)return[new qe(J,H,"object stop key must have value")];if(g&&g>Ui(H[0].zoom))return[new qe(J,H[0].zoom,"stop zoom values must appear in ascending order")];Ui(H[0].zoom)!==g&&(g=Ui(H[0].zoom),d=void 0,_={}),q=q.concat(qn({key:`${J}[0]`,value:H[0],valueSpec:{zoom:{}},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:zs,value:U}}))}else q=q.concat(U({key:`${J}[0]`,value:H[0],validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec},H));return tl(As(H[1]))?q.concat([new qe(`${J}[1]`,H[1],"expressions are not allowed in function stops.")]):q.concat(V.validateSpec({key:`${J}[1]`,value:H[1],valueSpec:t,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec}))}function U(V,q){const H=ri(V.value),J=Ui(V.value),se=V.value!==null?V.value:q;if(o){if(H!==o)return[new qe(V.key,se,`${H} stop domain type must match previous stop domain type ${o}`)]}else o=H;if(H!=="number"&&H!=="string"&&H!=="boolean")return[new qe(V.key,se,"stop domain value must be a number, string, or boolean")];if(H!=="number"&&n!=="categorical"){let ye=`number expected, ${H} found`;return ho(t)&&n===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new qe(V.key,se,ye)]}return n!=="categorical"||H!=="number"||isFinite(J)&&Math.floor(J)===J?n!=="categorical"&&H==="number"&&d!==void 0&&J<d?[new qe(V.key,se,"stop domain values must appear in ascending order")]:(d=J,n==="categorical"&&J in _?[new qe(V.key,se,"stop domain values must be unique")]:(_[J]=!0,[])):[new qe(V.key,se,`integer expected, found ${J}`)]}}function $n(a){const t=(a.expressionContext==="property"?Gl:Cs)(As(a.value),a.valueSpec);if(t.result==="error")return t.value.map(o=>new qe(`${a.key}${o.key}`,a.value,o.message));const n=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!n.outputDefined())return[new qe(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Ka(n))return[new qe(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Ka(n))return[new qe(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!ql(n,["zoom","feature-state"]))return[new qe(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Dn(n))return[new qe(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bc(a){const t=a.key,n=a.value,o=ri(n);return o!=="string"?[new qe(t,n,`color expected, ${o} found`)]:ui.parse(String(n))?[]:[new qe(t,n,`color expected, "${n}" found`)]}function Da(a){const t=a.key,n=a.value,o=a.valueSpec,d=[];return Array.isArray(o.values)?o.values.indexOf(Ui(n))===-1&&d.push(new qe(t,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(o.values).indexOf(Ui(n))===-1&&d.push(new qe(t,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),d}function Ra(a){return za(As(a.value))?$n(yi({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ps(a)}function Ps(a){const t=a.value,n=a.key;if(ri(t)!=="array")return[new qe(n,t,`array expected, ${ri(t)} found`)];const o=a.styleSpec;let d,g=[];if(t.length<1)return[new qe(n,t,"filter array must have at least 1 element")];switch(g=g.concat(Da({key:`${n}[0]`,value:t[0],valueSpec:o.filter_operator,style:a.style,styleSpec:a.styleSpec})),Ui(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Ui(t[1])==="$type"&&g.push(new qe(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new qe(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=ri(t[1]),d!=="string"&&g.push(new qe(`${n}[1]`,t[1],`string expected, ${d} found`)));for(let _=2;_<t.length;_++)d=ri(t[_]),Ui(t[1])==="$type"?g=g.concat(Da({key:`${n}[${_}]`,value:t[_],valueSpec:o.geometry_type,style:a.style,styleSpec:a.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&g.push(new qe(`${n}[${_}]`,t[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(Ps({key:`${n}[${_}]`,value:t[_],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":d=ri(t[1]),t.length!==2?g.push(new qe(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&g.push(new qe(`${n}[1]`,t[1],`string expected, ${d} found`))}return g}function es(a,t){const n=a.key,o=a.validateSpec,d=a.style,g=a.styleSpec,_=a.value,w=a.objectKey,E=g[`${t}_${a.layerType}`];if(!E)return[];const P=w.match(/^(.*)-transition$/);if(t==="paint"&&P&&E[P[1]]&&E[P[1]].transition)return o({key:n,value:_,valueSpec:g.transition,style:d,styleSpec:g});const D=a.valueSpec||E[w];if(!D)return[new qe(n,_,`unknown property "${w}"`)];let O;if(ri(_)==="string"&&ho(D)&&!D.tokens&&(O=/^{([^}]+)}$/.exec(_)))return[new qe(n,_,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const U=[];return a.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&U.push(new qe(n,_,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Ms(As(_))&&Ui(_.type)==="identity"&&U.push(new qe(n,_,'"text-font" does not support identity functions'))),U.concat(o({key:a.key,value:_,valueSpec:D,style:d,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:w}))}function Bu(a){return es(a,"paint")}function po(a){return es(a,"layout")}function ts(a){let t=[];const n=a.value,o=a.key,d=a.style,g=a.styleSpec;if(ri(n)!=="object")return[new qe(o,n,`object expected, ${ri(n)} found`)];n.type||n.ref||t.push(new qe(o,n,'either "type" or "ref" is required'));let _=Ui(n.type);const w=Ui(n.ref);if(n.id){const E=Ui(n.id);for(let P=0;P<a.arrayIndex;P++){const D=d.layers[P];Ui(D.id)===E&&t.push(new qe(o,n.id,`duplicate layer id "${n.id}", previously used at line ${D.id.__line__}`))}}if("ref"in n){let E;["type","source","source-layer","filter","layout"].forEach(P=>{P in n&&t.push(new qe(o,n[P],`"${P}" is prohibited for ref layers`))}),d.layers.forEach(P=>{Ui(P.id)===w&&(E=P)}),E?E.ref?t.push(new qe(o,n.ref,"ref cannot reference another ref layer")):_=Ui(E.type):t.push(new qe(o,n.ref,`ref layer "${w}" not found`))}else if(_!=="background")if(n.source){const E=d.sources&&d.sources[n.source],P=E&&Ui(E.type);E?P==="vector"&&_==="raster"?t.push(new qe(o,n.source,`layer "${n.id}" requires a raster source`)):P!=="raster-dem"&&_==="hillshade"?t.push(new qe(o,n.source,`layer "${n.id}" requires a raster-dem source`)):P==="raster"&&_!=="raster"?t.push(new qe(o,n.source,`layer "${n.id}" requires a vector source`)):P!=="vector"||n["source-layer"]?P==="raster-dem"&&_!=="hillshade"?t.push(new qe(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!n.paint||!n.paint["line-gradient"]||P==="geojson"&&E.lineMetrics||t.push(new qe(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new qe(o,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new qe(o,n.source,`source "${n.source}" not found`))}else t.push(new qe(o,n,'missing required property "source"'));return t=t.concat(qn({key:o,value:n,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${o}.type`,value:n.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:n,objectKey:"type"}),filter:Ra,layout:E=>qn({layer:n,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":P=>po(yi({layerType:_},P))}}),paint:E=>qn({layer:n,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":P=>Bu(yi({layerType:_},P))}})}})),t}function Er(a){const t=a.value,n=a.key,o=ri(t);return o!=="string"?[new qe(n,t,`string expected, ${o} found`)]:[]}const ba={promoteId:function({key:a,value:t}){if(ri(t)==="string")return Er({key:a,value:t});{const n=[];for(const o in t)n.push(...Er({key:`${a}.${o}`,value:t[o]}));return n}}};function rn(a){const t=a.value,n=a.key,o=a.styleSpec,d=a.style,g=a.validateSpec;if(!t.type)return[new qe(n,t,'"type" is required')];const _=Ui(t.type);let w;switch(_){case"vector":case"raster":return w=qn({key:n,value:t,valueSpec:o[`source_${_.replace("-","_")}`],style:a.style,styleSpec:o,objectElementValidators:ba,validateSpec:g}),w;case"raster-dem":return w=function(E){var P;const D=(P=E.sourceName)!==null&&P!==void 0?P:"",O=E.value,U=E.styleSpec,V=U.source_raster_dem,q=E.style;let H=[];const J=ri(O);if(O===void 0)return H;if(J!=="object")return H.push(new qe("source_raster_dem",O,`object expected, ${J} found`)),H;const se=Ui(O.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],le=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const N in O)!se&&ye.includes(N)?H.push(new qe(N,O[N],`In "${D}": "${N}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):V[N]?H=H.concat(E.validateSpec({key:N,value:O[N],valueSpec:V[N],validateSpec:E.validateSpec,style:q,styleSpec:U})):H.push(new qe(N,O[N],`unknown property "${N}"`));return H}({sourceName:n,value:t,style:a.style,styleSpec:o,validateSpec:g}),w;case"geojson":if(w=qn({key:n,value:t,valueSpec:o.source_geojson,style:d,styleSpec:o,validateSpec:g,objectElementValidators:ba}),t.cluster)for(const E in t.clusterProperties){const[P,D]=t.clusterProperties[E],O=typeof P=="string"?[P,["accumulated"],["get",E]]:P;w.push(...$n({key:`${n}.${E}.map`,value:D,expressionContext:"cluster-map"})),w.push(...$n({key:`${n}.${E}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return w;case"video":return qn({key:n,value:t,valueSpec:o.source_video,style:d,validateSpec:g,styleSpec:o});case"image":return qn({key:n,value:t,valueSpec:o.source_image,style:d,validateSpec:g,styleSpec:o});case"canvas":return[new qe(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Da({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function jc(a){const t=a.value,n=a.styleSpec,o=n.light,d=a.style;let g=[];const _=ri(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new qe("light",t,`object expected, ${_} found`)]),g;for(const w in t){const E=w.match(/^(.*)-transition$/);g=g.concat(E&&o[E[1]]&&o[E[1]].transition?a.validateSpec({key:w,value:t[w],valueSpec:n.transition,validateSpec:a.validateSpec,style:d,styleSpec:n}):o[w]?a.validateSpec({key:w,value:t[w],valueSpec:o[w],validateSpec:a.validateSpec,style:d,styleSpec:n}):[new qe(w,t[w],`unknown property "${w}"`)])}return g}function Vh(a){const t=a.value,n=a.styleSpec,o=n.sky,d=a.style,g=ri(t);if(t===void 0)return[];if(g!=="object")return[new qe("sky",t,`object expected, ${g} found`)];let _=[];for(const w in t)_=_.concat(o[w]?a.validateSpec({key:w,value:t[w],valueSpec:o[w],style:d,styleSpec:n}):[new qe(w,t[w],`unknown property "${w}"`)]);return _}function Xl(a){const t=a.value,n=a.styleSpec,o=n.terrain,d=a.style;let g=[];const _=ri(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new qe("terrain",t,`object expected, ${_} found`)]),g;for(const w in t)g=g.concat(o[w]?a.validateSpec({key:w,value:t[w],valueSpec:o[w],validateSpec:a.validateSpec,style:d,styleSpec:n}):[new qe(w,t[w],`unknown property "${w}"`)]);return g}function Zh(a){let t=[];const n=a.value,o=a.key;if(Array.isArray(n)){const d=[],g=[];for(const _ in n)n[_].id&&d.includes(n[_].id)&&t.push(new qe(o,n,`all the sprites' ids must be unique, but ${n[_].id} is duplicated`)),d.push(n[_].id),n[_].url&&g.includes(n[_].url)&&t.push(new qe(o,n,`all the sprites' URLs must be unique, but ${n[_].url} is duplicated`)),g.push(n[_].url),t=t.concat(qn({key:`${o}[${_}]`,value:n[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return Er({key:o,value:n})}function ju(a){return t=a.value,t&&t.constructor===Object?[]:[new qe(a.key,a.value,`object expected, ${ri(a.value)} found`)];var t}const Vr={"*":()=>[],array:nl,boolean:function(a){const t=a.value,n=a.key,o=ri(t);return o!=="boolean"?[new qe(n,t,`boolean expected, ${o} found`)]:[]},number:zs,color:Bc,constants:rl,enum:Da,filter:Ra,function:Ou,layer:ts,object:qn,source:rn,light:jc,sky:Vh,terrain:Xl,projection:function(a){const t=a.value,n=a.styleSpec,o=n.projection,d=a.style,g=ri(t);if(t===void 0)return[];if(g!=="object")return[new qe("projection",t,`object expected, ${g} found`)];let _=[];for(const w in t)_=_.concat(o[w]?a.validateSpec({key:w,value:t[w],valueSpec:o[w],style:d,styleSpec:n}):[new qe(w,t[w],`unknown property "${w}"`)]);return _},projectionDefinition:function(a){const t=a.key;let n=a.value;n=n instanceof String?n.valueOf():n;const o=ri(n);return o!=="array"||function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}(n)||function(d){return!!["interpolate","step","literal"].includes(d[0])}(n)?["array","string"].includes(o)?[]:[new qe(t,n,`projection expected, invalid type "${o}" found`)]:[new qe(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:Er,formatted:function(a){return Er(a).length===0?[]:$n(a)},resolvedImage:function(a){return Er(a).length===0?[]:$n(a)},padding:function(a){const t=a.key,n=a.value;if(ri(n)==="array"){if(n.length<1||n.length>4)return[new qe(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const o={type:"number"};let d=[];for(let g=0;g<n.length;g++)d=d.concat(a.validateSpec({key:`${t}[${g}]`,value:n[g],validateSpec:a.validateSpec,valueSpec:o}));return d}return zs({key:t,value:n,valueSpec:{}})},numberArray:function(a){const t=a.key,n=a.value;if(ri(n)==="array"){const o={type:"number"};if(n.length<1)return[new qe(t,n,"array length at least 1 expected, length 0 found")];let d=[];for(let g=0;g<n.length;g++)d=d.concat(a.validateSpec({key:`${t}[${g}]`,value:n[g],validateSpec:a.validateSpec,valueSpec:o}));return d}return zs({key:t,value:n,valueSpec:{}})},colorArray:function(a){const t=a.key,n=a.value;if(ri(n)==="array"){if(n.length<1)return[new qe(t,n,"array length at least 1 expected, length 0 found")];let o=[];for(let d=0;d<n.length;d++)o=o.concat(Bc({key:`${t}[${d}]`,value:n[d]}));return o}return Bc({key:t,value:n})},variableAnchorOffsetCollection:function(a){const t=a.key,n=a.value,o=ri(n),d=a.styleSpec;if(o!=="array"||n.length<1||n.length%2!=0)return[new qe(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<n.length;_+=2)g=g.concat(Da({key:`${t}[${_}]`,value:n[_],valueSpec:d.layout_symbol["text-anchor"]})),g=g.concat(nl({key:`${t}[${_+1}]`,value:n[_+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:d}));return g},sprite:Zh,state:ju};function mo(a){const t=a.value,n=a.valueSpec,o=a.styleSpec;return a.validateSpec=mo,n.expression&&Ms(Ui(t))?Ou(a):n.expression&&tl(As(t))?$n(a):n.type&&Vr[n.type]?Vr[n.type](a):qn(yi({},a,{valueSpec:n.type?o[n.type]:n}))}function Yl(a){const t=a.value,n=a.key,o=Er(a);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new qe(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new qe(n,t,'"glyphs" url must include a "{range}" token'))),o}function Zr(a,t=ee){let n=[];return n=n.concat(mo({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:mo,objectElementValidators:{glyphs:Yl,"*":()=>[]}})),a.constants&&(n=n.concat(rl({key:"constants",value:a.constants}))),ka(n)}function na(a){return function(t){return a({...t,validateSpec:mo})}}function ka(a){return[].concat(a).sort((t,n)=>t.line-n.line)}function bn(a){return function(...t){return ka(a.apply(this,t))}}Zr.source=bn(na(rn)),Zr.sprite=bn(na(Zh)),Zr.glyphs=bn(na(Yl)),Zr.light=bn(na(jc)),Zr.sky=bn(na(Vh)),Zr.terrain=bn(na(Xl)),Zr.state=bn(na(ju)),Zr.layer=bn(na(ts)),Zr.filter=bn(na(Ra)),Zr.paintProperty=bn(na(Bu)),Zr.layoutProperty=bn(na(po));const Ql=Zr,Fc=Ql.light,Wf=Ql.sky,Fu=Ql.paintProperty,is=Ql.layoutProperty;function Uc(a,t){let n=!1;if(t&&t.length)for(const o of t)a.fire(new he(new Error(o.message))),n=!0;return n}class Is{constructor(t,n,o){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(n=_[1])+2*(o=_[2]);for(let E=0;E<this.d*this.d;E++){const P=_[3+E],D=_[3+E+1];d.push(P===D?null:_.subarray(P,D))}const w=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],w),this.bboxes=_.subarray(w),this.insert=this._insertReadonly}else{this.d=n+2*o;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=o,this.scale=n/t,this.uid=0;const g=o/n*t;this.min=-g,this.max=t+g}insert(t,n,o,d,g){this._forEachCell(n,o,d,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(d),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,o,d,g,_){this.cells[g].push(_)}query(t,n,o,d,g){const _=this.min,w=this.max;if(t<=_&&n<=_&&w<=o&&w<=d&&!g)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(t,n,o,d,this._queryCell,E,{},g),E}}_queryCell(t,n,o,d,g,_,w,E){const P=this.cells[g];if(P!==null){const D=this.keys,O=this.bboxes;for(let U=0;U<P.length;U++){const V=P[U];if(w[V]===void 0){const q=4*V;(E?E(O[q+0],O[q+1],O[q+2],O[q+3]):t<=O[q+2]&&n<=O[q+3]&&o>=O[q+0]&&d>=O[q+1])?(w[V]=!0,_.push(D[V])):w[V]=!1}}}}_forEachCell(t,n,o,d,g,_,w,E){const P=this._convertToCellCoord(t),D=this._convertToCellCoord(n),O=this._convertToCellCoord(o),U=this._convertToCellCoord(d);for(let V=P;V<=O;V++)for(let q=D;q<=U;q++){const H=this.d*q+V;if((!E||E(this._convertFromCellCoord(V),this._convertFromCellCoord(q),this._convertFromCellCoord(V+1),this._convertFromCellCoord(q+1)))&&g.call(this,t,n,o,d,H,_,w,E))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let o=0;for(let _=0;_<this.cells.length;_++)o+=this.cells[_].length;const d=new Int32Array(n+o+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let g=n;for(let _=0;_<t.length;_++){const w=t[_];d[3+_]=g,d.set(w,g),g+=w.length}return d[3+t.length]=g,d.set(this.keys,g),g+=this.keys.length,d[3+t.length+1]=g,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer}static serialize(t,n){const o=t.toArrayBuffer();return n&&n.push(o),{buffer:o}}static deserialize(t){return new Is(t.buffer)}}const La={};function yt(a,t,n={}){if(La[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),La[a]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}yt("Object",Object),yt("TransferableGridIndex",Is),yt("Color",ui),yt("Error",Error),yt("AJAXError",pa),yt("ResolvedImage",Pn),yt("StylePropertyFunction",_n),yt("StyleExpression",$l,{omit:["_evaluator"]}),yt("ZoomDependentExpression",il),yt("ZoomConstantExpression",fo),yt("CompoundExpression",ta,{omit:["_evaluate"]});for(const a in Zl)Zl[a]._classRegistryKey||yt(`Expression_${a}`,Zl[a]);function Nc(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function al(a){return a.$name||a.constructor._classRegistryKey}function Uu(a){return!function(t){if(t===null||typeof t!="object")return!1;const n=al(t);return!(!n||n==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Nc(a)||Rr(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function sl(a,t){if(Uu(a))return(Nc(a)||Rr(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const g=[];for(const _ of a)g.push(sl(_,t));return g}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const n=al(a);if(!n)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!La[n])throw new Error(`${n} is not registered.`);const{klass:o}=La[n],d=o.serialize?o.serialize(a,t):{};if(o.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in a){if(!a.hasOwnProperty(g)||La[n].omit.indexOf(g)>=0)continue;const _=a[g];d[g]=La[n].shallow.indexOf(g)>=0?_:sl(_,t)}a instanceof Error&&(d.message=a.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(d.$name=n),d}function go(a){if(Uu(a))return a;if(Array.isArray(a))return a.map(go);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=al(a)||"Object";if(!La[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=La[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(a);const o=Object.create(n.prototype);for(const d of Object.keys(a)){if(d==="$name")continue;const g=a[d];o[d]=La[t].shallow.indexOf(d)>=0?g:go(g)}return o}class Nu{constructor(){this.first=!0}update(t,n){const o=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=o,!0))}}const ii={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Hangul Syllables":a=>a>=44032&&a<=55215,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Vc(a){for(const t of a)if(Oa(t.charCodeAt(0)))return!0;return!1}function jd(a){for(const t of a)if(!Zu(t.charCodeAt(0)))return!1;return!0}function rs(a){const t=a.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const Vu=rs(["Arab","Dupl","Mong","Ougr","Syrc"]);function Zu(a){return!Vu.test(String.fromCodePoint(a))}const ns=rs(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Oa(a){return!(a!==746&&a!==747&&(a<4352||!(ii["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||ii["CJK Compatibility"](a)||ii["CJK Strokes"](a)||!(!ii["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||ii["Enclosed CJK Letters and Months"](a)||ii["Ideographic Description Characters"](a)||ii.Kanbun(a)||ii.Katakana(a)&&a!==12540||!(!ii["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!ii["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||ii["Vertical Forms"](a)||ii["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||ns.test(String.fromCodePoint(a)))))}function Ds(a){return!(Oa(a)||function(t){return!!(ii["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ii["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ii["Letterlike Symbols"](t)||ii["Number Forms"](t)||ii["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ii["Control Pictures"](t)&&t!==9251||ii["Optical Character Recognition"](t)||ii["Enclosed Alphanumerics"](t)||ii["Geometric Shapes"](t)||ii["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ii["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ii["CJK Symbols and Punctuation"](t)||ii.Katakana(t)||ii["Private Use Area"](t)||ii["CJK Compatibility Forms"](t)||ii["Small Form Variants"](t)||ii["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}const qh=rs(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Kl(a){return qh.test(String.fromCodePoint(a))}function Zc(a,t){return!(!t&&Kl(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||ii.Khmer(a))}function qc(a){for(const t of a)if(Kl(t.charCodeAt(0)))return!0;return!1}const as=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(as.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,t){return u(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const n=a.pluginURL,o=new Promise(g=>{this.loadScriptResolve=g});t(n);const d=new Promise(g=>setTimeout(()=>g(),this.TIMEOUT));if(yield Promise.race([o,d]),this.isParsed()){const g={pluginStatus:"loaded",pluginURL:n};return this.setState(g),g}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class Gi{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Nu,this.transition={})}isSupportedScript(t){return function(n,o){for(const d of n)if(!Zc(d.charCodeAt(0),o))return!1;return!0}(t,as.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),o=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*n}}}class ss{constructor(t,n){this.property=t,this.value=n,this.expression=function(o,d){if(Ms(o))return new _n(o,d);if(tl(o)){const g=Gl(o,d);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=o;return d.type==="color"&&typeof o=="string"?g=ui.parse(o):d.type!=="padding"||typeof o!="number"&&!Array.isArray(o)?d.type!=="numberArray"||typeof o!="number"&&!Array.isArray(o)?d.type!=="colorArray"||typeof o!="string"&&!Array.isArray(o)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(o)?g=mr.parse(o):d.type==="projectionDefinition"&&typeof o=="string"&&(g=Jr.parse(o)):g=Hr.parse(o):g=Sr.parse(o):g=Tr.parse(o),{kind:"constant",evaluate:()=>g}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,o){return this.property.possiblyEvaluate(this,t,n,o)}}class Wl{constructor(t){this.property=t,this.value=new ss(t,void 0)}transitioned(t,n){return new qu(this.property,this.value,n,di({},t.transition,this.transition),t.now)}untransitioned(){return new qu(this.property,this.value,null,{},0)}}class $h{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Bi(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Wl(this._values[t].property)),this._values[t].value=new ss(this._values[t].property,n===null?void 0:Bi(n))}getTransition(t){return Bi(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Wl(this._values[t].property)),this._values[t].transition=Bi(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(t[n]=o);const d=this.getTransition(n);d!==void 0&&(t[`${n}-transition`]=d)}return t}transitioned(t,n){const o=new $u(this._properties);for(const d of Object.keys(this._values))o._values[d]=this._values[d].transitioned(t,n._values[d]);return o}untransitioned(){const t=new $u(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class qu{constructor(t,n,o,d,g){this.property=t,this.value=n,this.begin=g+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=o)}possiblyEvaluate(t,n,o){const d=t.now||0,g=this.value.possiblyEvaluate(t,n,o),_=this.prior;if(_){if(d>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(d<this.begin)return _.possiblyEvaluate(t,n,o);{const w=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,n,o),g,lt(w))}}return g}}class $u{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,o){const d=new zi(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,n,o);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class _o{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Bi(this._values[t].value)}setValue(t,n){this._values[t]=new ss(this._values[t].property,n===null?void 0:Bi(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(t[n]=o)}return t}possiblyEvaluate(t,n,o){const d=new zi(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,n,o);return d}}class $t{constructor(t,n,o){this.property=t,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,o,d){return this.property.evaluate(this.value,this.parameters,t,n,o,d)}}class zi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class mt{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,o){const d=Xa[this.specification.type];return d?d(t,n,o):t}}class jt{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,o,d){return new $t(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},o,d)}:t.expression,n)}interpolate(t,n,o){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new $t(this,{kind:"constant",value:void 0},t.parameters);const d=Xa[this.specification.type];if(d){const g=d(t.value.value,n.value.value,o);return new $t(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,n,o,d,g,_){return t.kind==="constant"?t.value:t.evaluate(n,o,d,g,_)}}class os extends jt{possiblyEvaluate(t,n,o,d){if(t.value===void 0)return new $t(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const g=t.expression.evaluate(n,null,{},o,d),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,w=this._calculate(_,_,_,n);return new $t(this,{kind:"constant",value:w},n)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new $t(this,{kind:"constant",value:g},n)}return new $t(this,t.expression,n)}evaluate(t,n,o,d,g,_){if(t.kind==="source"){const w=t.evaluate(n,o,d,g,_);return this._calculate(w,w,w,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},o,d),t.evaluate({zoom:Math.floor(n.zoom)},o,d),t.evaluate({zoom:Math.floor(n.zoom)+1},o,d),n):t.value}_calculate(t,n,o,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:o,to:n}}interpolate(t){return t}}class Rs{constructor(t){this.specification=t}possiblyEvaluate(t,n,o,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(n,null,{},o,d);return this._calculate(g,g,g,n)}return this._calculate(t.expression.evaluate(new Gi(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Gi(Math.floor(n.zoom),n)),t.expression.evaluate(new Gi(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,o,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:o,to:n}}interpolate(t){return t}}class Jl{constructor(t){this.specification=t}possiblyEvaluate(t,n,o,d){return!!t.expression.evaluate(n,null,{},o,d)}interpolate(){return!1}}class ur{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const o=t[n];o.specification.overridable&&this.overridableProperties.push(n);const d=this.defaultPropertyValues[n]=new ss(o,void 0),g=this.defaultTransitionablePropertyValues[n]=new Wl(o);this.defaultTransitioningPropertyValues[n]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=d.possiblyEvaluate({})}}}yt("DataDrivenProperty",jt),yt("DataConstantProperty",mt),yt("CrossFadedDataDrivenProperty",os),yt("CrossFadedProperty",Rs),yt("ColorRampProperty",Jl);const yo="-transition";class xa extends be{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new _o(n.layout)),n.paint)){this._transitionablePaint=new $h(n.paint);for(const o in t.paint)this.setPaintProperty(o,t.paint[o],{validate:!1});for(const o in t.layout)this.setLayoutProperty(o,t.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new zi(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,o={}){n!=null&&this._validate(is,`layers.${this.id}.layout.${t}`,t,n,o)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(yo)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,o={}){if(n!=null&&this._validate(Fu,`layers.${this.id}.paint.${t}`,t,n,o))return!1;if(t.endsWith(yo))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const d=this._transitionablePaint._values[t],g=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),w=d.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const E=this._transitionablePaint._values[t].value;return E.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,w,E)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,o){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),lr(t,(n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length))}_validate(t,n,o,d,g={}){return(!g||g.validate!==!1)&&Uc(this,t.call(Ql,{key:n,layerType:this.type,objectKey:o,value:d,styleSpec:ee,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof $t&&ho(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const Cr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ks{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ir{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function rr(a,t=1){let n=0,o=0;return{members:a.map(d=>{const g=Cr[d.type].BYTES_PER_ELEMENT,_=n=ol(n,Math.max(t,g)),w=d.components||1;return o=Math.max(o,g),n+=g*w,{name:d.name,type:d.type,components:w,offset:_}}),size:ol(n,Math.max(o,t)),alignment:t}}function ol(a,t){return Math.ceil(a/t)*t}class $c extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const d=2*t;return this.int16[d+0]=n,this.int16[d+1]=o,t}}$c.prototype.bytesPerElement=4,yt("StructArrayLayout2i4",$c);class ll extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const g=3*t;return this.int16[g+0]=n,this.int16[g+1]=o,this.int16[g+2]=d,t}}ll.prototype.bytesPerElement=6,yt("StructArrayLayout3i6",ll);class Ls extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,n,o,d)}emplace(t,n,o,d,g){const _=4*t;return this.int16[_+0]=n,this.int16[_+1]=o,this.int16[_+2]=d,this.int16[_+3]=g,t}}Ls.prototype.bytesPerElement=8,yt("StructArrayLayout4i8",Ls);class Gc extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,o,d,g,_)}emplace(t,n,o,d,g,_,w){const E=6*t;return this.int16[E+0]=n,this.int16[E+1]=o,this.int16[E+2]=d,this.int16[E+3]=g,this.int16[E+4]=_,this.int16[E+5]=w,t}}Gc.prototype.bytesPerElement=12,yt("StructArrayLayout2i4i12",Gc);class xn extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,o,d,g,_)}emplace(t,n,o,d,g,_,w){const E=4*t,P=8*t;return this.int16[E+0]=n,this.int16[E+1]=o,this.uint8[P+4]=d,this.uint8[P+5]=g,this.uint8[P+6]=_,this.uint8[P+7]=w,t}}xn.prototype.bytesPerElement=8,yt("StructArrayLayout2i4ub8",xn);class nr extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const d=2*t;return this.float32[d+0]=n,this.float32[d+1]=o,t}}nr.prototype.bytesPerElement=8,yt("StructArrayLayout2f8",nr);class Hc extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_,w,E,P,D){const O=this.length;return this.resize(O+1),this.emplace(O,t,n,o,d,g,_,w,E,P,D)}emplace(t,n,o,d,g,_,w,E,P,D,O){const U=10*t;return this.uint16[U+0]=n,this.uint16[U+1]=o,this.uint16[U+2]=d,this.uint16[U+3]=g,this.uint16[U+4]=_,this.uint16[U+5]=w,this.uint16[U+6]=E,this.uint16[U+7]=P,this.uint16[U+8]=D,this.uint16[U+9]=O,t}}Hc.prototype.bytesPerElement=20,yt("StructArrayLayout10ui20",Hc);class f extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_,w,E,P,D,O,U){const V=this.length;return this.resize(V+1),this.emplace(V,t,n,o,d,g,_,w,E,P,D,O,U)}emplace(t,n,o,d,g,_,w,E,P,D,O,U,V){const q=12*t;return this.int16[q+0]=n,this.int16[q+1]=o,this.int16[q+2]=d,this.int16[q+3]=g,this.uint16[q+4]=_,this.uint16[q+5]=w,this.uint16[q+6]=E,this.uint16[q+7]=P,this.int16[q+8]=D,this.int16[q+9]=O,this.int16[q+10]=U,this.int16[q+11]=V,t}}f.prototype.bytesPerElement=24,yt("StructArrayLayout4i4ui4i24",f);class e extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const g=3*t;return this.float32[g+0]=n,this.float32[g+1]=o,this.float32[g+2]=d,t}}e.prototype.bytesPerElement=12,yt("StructArrayLayout3f12",e);class r extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}r.prototype.bytesPerElement=4,yt("StructArrayLayout1ul4",r);class l extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_,w,E,P){const D=this.length;return this.resize(D+1),this.emplace(D,t,n,o,d,g,_,w,E,P)}emplace(t,n,o,d,g,_,w,E,P,D){const O=10*t,U=5*t;return this.int16[O+0]=n,this.int16[O+1]=o,this.int16[O+2]=d,this.int16[O+3]=g,this.int16[O+4]=_,this.int16[O+5]=w,this.uint32[U+3]=E,this.uint16[O+8]=P,this.uint16[O+9]=D,t}}l.prototype.bytesPerElement=20,yt("StructArrayLayout6i1ul2ui20",l);class h extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,o,d,g,_)}emplace(t,n,o,d,g,_,w){const E=6*t;return this.int16[E+0]=n,this.int16[E+1]=o,this.int16[E+2]=d,this.int16[E+3]=g,this.int16[E+4]=_,this.int16[E+5]=w,t}}h.prototype.bytesPerElement=12,yt("StructArrayLayout2i2i2i12",h);class m extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,o,d,g)}emplace(t,n,o,d,g,_){const w=4*t,E=8*t;return this.float32[w+0]=n,this.float32[w+1]=o,this.float32[w+2]=d,this.int16[E+6]=g,this.int16[E+7]=_,t}}m.prototype.bytesPerElement=16,yt("StructArrayLayout2f1f2i16",m);class x extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,o,d,g,_)}emplace(t,n,o,d,g,_,w){const E=16*t,P=4*t,D=8*t;return this.uint8[E+0]=n,this.uint8[E+1]=o,this.float32[P+1]=d,this.float32[P+2]=g,this.int16[D+6]=_,this.int16[D+7]=w,t}}x.prototype.bytesPerElement=16,yt("StructArrayLayout2ub2f2i16",x);class M extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const g=3*t;return this.uint16[g+0]=n,this.uint16[g+1]=o,this.uint16[g+2]=d,t}}M.prototype.bytesPerElement=6,yt("StructArrayLayout3ui6",M);class C extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se){const ye=this.length;return this.resize(ye+1),this.emplace(ye,t,n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se)}emplace(t,n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se,ye){const le=24*t,N=12*t,W=48*t;return this.int16[le+0]=n,this.int16[le+1]=o,this.uint16[le+2]=d,this.uint16[le+3]=g,this.uint32[N+2]=_,this.uint32[N+3]=w,this.uint32[N+4]=E,this.uint16[le+10]=P,this.uint16[le+11]=D,this.uint16[le+12]=O,this.float32[N+7]=U,this.float32[N+8]=V,this.uint8[W+36]=q,this.uint8[W+37]=H,this.uint8[W+38]=J,this.uint32[N+10]=se,this.int16[le+22]=ye,t}}C.prototype.bytesPerElement=48,yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",C);class I extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se,ye,le,N,W,de,Le,rt,Fe,Xe,ot,at){const ct=this.length;return this.resize(ct+1),this.emplace(ct,t,n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se,ye,le,N,W,de,Le,rt,Fe,Xe,ot,at)}emplace(t,n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se,ye,le,N,W,de,Le,rt,Fe,Xe,ot,at,ct){const Qe=32*t,wt=16*t;return this.int16[Qe+0]=n,this.int16[Qe+1]=o,this.int16[Qe+2]=d,this.int16[Qe+3]=g,this.int16[Qe+4]=_,this.int16[Qe+5]=w,this.int16[Qe+6]=E,this.int16[Qe+7]=P,this.uint16[Qe+8]=D,this.uint16[Qe+9]=O,this.uint16[Qe+10]=U,this.uint16[Qe+11]=V,this.uint16[Qe+12]=q,this.uint16[Qe+13]=H,this.uint16[Qe+14]=J,this.uint16[Qe+15]=se,this.uint16[Qe+16]=ye,this.uint16[Qe+17]=le,this.uint16[Qe+18]=N,this.uint16[Qe+19]=W,this.uint16[Qe+20]=de,this.uint16[Qe+21]=Le,this.uint16[Qe+22]=rt,this.uint32[wt+12]=Fe,this.float32[wt+13]=Xe,this.float32[wt+14]=ot,this.uint16[Qe+30]=at,this.uint16[Qe+31]=ct,t}}I.prototype.bytesPerElement=64,yt("StructArrayLayout8i15ui1ul2f2ui64",I);class k extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}k.prototype.bytesPerElement=4,yt("StructArrayLayout1f4",k);class j extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const g=3*t;return this.uint16[6*t+0]=n,this.float32[g+1]=o,this.float32[g+2]=d,t}}j.prototype.bytesPerElement=12,yt("StructArrayLayout1ui2f12",j);class B extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const g=4*t;return this.uint32[2*t+0]=n,this.uint16[g+2]=o,this.uint16[g+3]=d,t}}B.prototype.bytesPerElement=8,yt("StructArrayLayout1ul2ui8",B);class $ extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const d=2*t;return this.uint16[d+0]=n,this.uint16[d+1]=o,t}}$.prototype.bytesPerElement=4,yt("StructArrayLayout2ui4",$);class G extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}G.prototype.bytesPerElement=2,yt("StructArrayLayout1ui2",G);class re extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,n,o,d)}emplace(t,n,o,d,g){const _=4*t;return this.float32[_+0]=n,this.float32[_+1]=o,this.float32[_+2]=d,this.float32[_+3]=g,t}}re.prototype.bytesPerElement=16,yt("StructArrayLayout4f16",re);class ie extends ks{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Pe(this.anchorPointX,this.anchorPointY)}}ie.prototype.size=20;class ae extends l{get(t){return new ie(this,t)}}yt("CollisionBoxArray",ae);class ce extends ks{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ce.prototype.size=48;class pe extends C{get(t){return new ce(this,t)}}yt("PlacedSymbolArray",pe);class fe extends ks{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}fe.prototype.size=64;class ge extends I{get(t){return new fe(this,t)}}yt("SymbolInstanceArray",ge);class xe extends k{getoffsetX(t){return this.float32[1*t+0]}}yt("GlyphOffsetArray",xe);class _e extends ll{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}yt("SymbolLineVertexArray",_e);class ke extends ks{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ke.prototype.size=12;class Ye extends j{get(t){return new ke(this,t)}}yt("TextAnchorOffsetArray",Ye);class Ne extends ks{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ne.prototype.size=8;class Ue extends B{get(t){return new Ne(this,t)}}yt("FeatureIndexArray",Ue);class $e extends $c{}class dt extends $c{}class ht extends $c{}class it extends Gc{}class St extends xn{}class ei extends nr{}class oi extends Hc{}class ar extends f{}class ki extends e{}class sr extends r{}class Ki extends h{}class Ni extends x{}class xi extends M{}class Lr extends ${}const Xr=rr([{name:"a_pos",components:2,type:"Int16"}],4),{members:nn}=Xr;class Ti{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,o,d){const g=this.segments[this.segments.length-1];return t>Ti.MAX_VERTEX_ARRAY_LENGTH&&tr(`Max vertices per segment is ${Ti.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ti.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!g||g.vertexLength+t>Ti.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==d?this.createNewSegment(n,o,d):g}createNewSegment(t,n,o){const d={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(d.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(t,n,o){return this.prepareSegment(0,t,n,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,o,d){return new Ti([{vertexOffset:t,primitiveOffset:n,vertexLength:o,primitiveLength:d,vaos:{},sortKey:0}])}}function ls(a,t){return 256*(a=Ct(Math.floor(a),0,255))+Ct(Math.floor(t),0,255)}Ti.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,yt("SegmentVector",Ti);const Ba=rr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Os,Bs,ec,js={exports:{}},cl={exports:{}},aa={exports:{}},Fs=function(){if(ec)return js.exports;ec=1;var a=(Os||(Os=1,cl.exports=function(n,o){var d,g,_,w,E,P,D,O;for(g=n.length-(d=3&n.length),_=o,E=3432918353,P=461845907,O=0;O<g;)D=255&n.charCodeAt(O)|(255&n.charCodeAt(++O))<<8|(255&n.charCodeAt(++O))<<16|(255&n.charCodeAt(++O))<<24,++O,_=27492+(65535&(w=5*(65535&(_=(_^=D=(65535&(D=(D=(65535&D)*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*P+(((D>>>16)*P&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(D=0,d){case 3:D^=(255&n.charCodeAt(O+2))<<16;case 2:D^=(255&n.charCodeAt(O+1))<<8;case 1:_^=D=(65535&(D=(D=(65535&(D^=255&n.charCodeAt(O)))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*P+(((D>>>16)*P&65535)<<16)&4294967295}return _^=n.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),cl.exports),t=(Bs||(Bs=1,aa.exports=function(n,o){for(var d,g=n.length,_=o^g,w=0;g>=4;)d=1540483477*(65535&(d=255&n.charCodeAt(w)|(255&n.charCodeAt(++w))<<8|(255&n.charCodeAt(++w))<<16|(255&n.charCodeAt(++w))<<24))+((1540483477*(d>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),g-=4,++w;switch(g){case 3:_^=(255&n.charCodeAt(w+2))<<16;case 2:_^=(255&n.charCodeAt(w+1))<<8;case 1:_=1540483477*(65535&(_^=255&n.charCodeAt(w)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),aa.exports);return js.exports=a,js.exports.murmur3=a,js.exports.murmur2=t,js.exports}(),sa=oe(Fs);class cs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,o,d){this.ids.push(_r(t)),this.positions.push(n,o,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=_r(t);let o=0,d=this.ids.length-1;for(;o<d;){const _=o+d>>1;this.ids[_]>=n?d=_:o=_+1}const g=[];for(;this.ids[o]===n;)g.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return g}static serialize(t,n){const o=new Float64Array(t.ids),d=new Uint32Array(t.positions);return Or(o,d,0,o.length-1),n&&n.push(o.buffer,d.buffer),{ids:o,positions:d}}static deserialize(t){const n=new cs;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function _r(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:sa(String(a))}function Or(a,t,n,o){for(;n<o;){const d=a[n+o>>1];let g=n-1,_=o+1;for(;;){do g++;while(a[g]<d);do _--;while(a[_]>d);if(g>=_)break;wn(a,g,_),wn(t,3*g,3*_),wn(t,3*g+1,3*_+1),wn(t,3*g+2,3*_+2)}_-n<o-_?(Or(a,t,n,_),n=_+1):(Or(a,t,_+1,o),o=_)}}function wn(a,t,n){const o=a[t];a[t]=a[n],a[n]=o}yt("FeaturePositionMap",cs);class Li{constructor(t,n){this.gl=t.gl,this.location=n}}class Xc extends Li{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Gh extends Li{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Fd extends Li{constructor(t,n){super(t,n),this.current=ui.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const tc=new Float32Array(16);function ul(a){return[ls(255*a.r,255*a.g),ls(255*a.b,255*a.a)]}class vo{constructor(t,n,o){this.value=t,this.uniformNames=n.map(d=>`u_${d}`),this.type=o}setUniform(t,n,o){t.set(o.constantOr(this.value))}getBinding(t,n,o){return this.type==="color"?new Fd(t,n):new Xc(t,n)}}class Tn{constructor(t,n){this.uniformNames=n.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,o,d){const g=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,n,o){return o.substr(0,9)==="u_pattern"?new Gh(t,n):new Xc(t,n)}}class oa{constructor(t,n,o,d){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(g=>({name:`a_${g}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,n,o,d,g){const _=this.paintVertexArray.length,w=this.expression.evaluate(new Gi(0),n,{},d,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,w)}updatePaintArray(t,n,o,d){const g=this.expression.evaluate({zoom:0},o,d);this._setPaintValue(t,n,g)}_setPaintValue(t,n,o){if(this.type==="color"){const d=ul(o);for(let g=t;g<n;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=t;d<n;d++)this.paintVertexArray.emplace(d,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class la{constructor(t,n,o,d,g,_){this.expression=t,this.uniformNames=n.map(w=>`u_${w}_t`),this.type=o,this.useIntegerZoom=d,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=n.map(w=>({name:`a_${w}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,n,o,d,g){const _=this.expression.evaluate(new Gi(this.zoom),n,{},d,[],g),w=this.expression.evaluate(new Gi(this.zoom+1),n,{},d,[],g),E=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(E,t,_,w)}updatePaintArray(t,n,o,d){const g=this.expression.evaluate({zoom:this.zoom},o,d),_=this.expression.evaluate({zoom:this.zoom+1},o,d);this._setPaintValue(t,n,g,_)}_setPaintValue(t,n,o,d){if(this.type==="color"){const g=ul(o),_=ul(d);for(let w=t;w<n;w++)this.paintVertexArray.emplace(w,g[0],g[1],_[0],_[1])}else{for(let g=t;g<n;g++)this.paintVertexArray.emplace(g,o,d);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,d=Ct(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,n,o){return new Xc(t,n)}}class us{constructor(t,n,o,d,g,_){this.expression=t,this.type=n,this.useIntegerZoom=o,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,n,o){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(t,n,o,d,g){this._setPaintValues(t,n,o.patterns&&o.patterns[this.layerId],g)}_setPaintValues(t,n,o,d){if(!d||!o)return;const{min:g,mid:_,max:w}=o,E=d[g],P=d[_],D=d[w];if(E&&P&&D)for(let O=t;O<n;O++)this.zoomInPaintVertexArray.emplace(O,P.tl[0],P.tl[1],P.br[0],P.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],P.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(O,P.tl[0],P.tl[1],P.br[0],P.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],P.pixelRatio,D.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ba.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ba.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Us{constructor(t,n,o){this.binders={},this._buffers=[];const d=[];for(const g in t.paint._values){if(!o(g))continue;const _=t.paint.get(g);if(!(_ instanceof $t&&ho(_.property.specification)))continue;const w=Gn(g,t.type),E=_.value,P=_.property.specification.type,D=_.property.useIntegerZoom,O=_.property.specification["property-type"],U=O==="cross-faded"||O==="cross-faded-data-driven";if(E.kind==="constant")this.binders[g]=U?new Tn(E.value,w):new vo(E.value,w,P),d.push(`/u_${g}`);else if(E.kind==="source"||U){const V=Vs(g,P,"source");this.binders[g]=U?new us(E,P,D,n,V,t.id):new oa(E,w,P,V),d.push(`/a_${g}`)}else{const V=Vs(g,P,"composite");this.binders[g]=new la(E,w,P,D,n,V),d.push(`/z_${g}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof oa||n instanceof la?n.maxValue:0}populatePaintArrays(t,n,o,d,g){for(const _ in this.binders){const w=this.binders[_];(w instanceof oa||w instanceof la||w instanceof us)&&w.populatePaintArray(t,n,o,d,g)}}setConstantPatternPositions(t,n){for(const o in this.binders){const d=this.binders[o];d instanceof Tn&&d.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,o,d,g){let _=!1;for(const w in t){const E=n.getPositions(w);for(const P of E){const D=o.feature(P.index);for(const O in this.binders){const U=this.binders[O];if((U instanceof oa||U instanceof la||U instanceof us)&&U.expression.isStateDependent===!0){const V=d.paint.get(O);U.expression=V.value,U.updatePaintArray(P.start,P.end,D,t[w],g),_=!0}}}}return _}defines(){const t=[];for(const n in this.binders){const o=this.binders[n];(o instanceof vo||o instanceof Tn)&&t.push(...o.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof oa||o instanceof la)for(let d=0;d<o.paintVertexAttributes.length;d++)t.push(o.paintVertexAttributes[d].name);else if(o instanceof us)for(let d=0;d<Ba.members.length;d++)t.push(Ba.members[d].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof vo||o instanceof Tn||o instanceof la)for(const d of o.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const o=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof vo||g instanceof Tn||g instanceof la){for(const _ of g.uniformNames)if(n[_]){const w=g.getBinding(t,n[_],_);o.push({name:_,property:d,binding:w})}}}return o}setUniforms(t,n,o,d){for(const{name:g,property:_,binding:w}of n)this.binders[_].setUniform(w,d,o.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const o=this.binders[n];if(t&&o instanceof us){const d=t.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(o instanceof oa||o instanceof la)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const n in this.binders){const o=this.binders[n];(o instanceof oa||o instanceof la||o instanceof us)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof oa||n instanceof la||n instanceof us)&&n.destroy()}}}class Ns{constructor(t,n,o=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new Us(d,n,o);this.needsUpload=!1,this._featureMap=new cs,this._bufferOffset=0}populatePaintArrays(t,n,o,d,g,_){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(t,n,d,g,_);n.id!==void 0&&this._featureMap.add(n.id,o,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,o,d){for(const g of o)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,n,g,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Gn(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function Vs(a,t,n){const o={color:{source:nr,composite:re},number:{source:k,composite:nr}},d=function(g){return{"line-pattern":{source:oi,composite:oi},"fill-pattern":{source:oi,composite:oi},"fill-extrusion-pattern":{source:oi,composite:oi}}[g]}(a);return d&&d[n]||o[t][n]}yt("ConstantBinder",vo),yt("CrossFadedConstantBinder",Tn),yt("SourceExpressionBinder",oa),yt("CrossFadedCompositeBinder",us),yt("CompositeExpressionBinder",la),yt("ProgramConfiguration",Us,{omit:["_buffers"]}),yt("ProgramConfigurationSet",Ns);const bo=Math.pow(2,14)-1,Jf=-bo-1;function wa(a){const t=Ge/a.extent,n=a.loadGeometry();for(let o=0;o<n.length;o++){const d=n[o];for(let g=0;g<d.length;g++){const _=d[g],w=Math.round(_.x*t),E=Math.round(_.y*t);_.x=Ct(w,Jf,bo),_.y=Ct(E,Jf,bo),(w<_.x||w>_.x+1||E<_.y||E>_.y+1)&&tr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function ca(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?wa(a):[]}}const an=-32768;function Ud(a,t,n,o,d){a.emplaceBack(an+8*t+o,an+8*n+d)}class Hh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new dt,this.indexArray=new xi,this.segments=new Ti,this.programConfigurations=new Ns(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){const d=this.layers[0],g=[];let _=null,w=!1,E=d.type==="heatmap";if(d.type==="circle"){const D=d;_=D.layout.get("circle-sort-key"),w=!_.isConstant(),E=E||D.paint.get("circle-pitch-alignment")==="map"}const P=E?n.subdivisionGranularity.circle:1;for(const{feature:D,id:O,index:U,sourceLayerIndex:V}of t){const q=this.layers[0]._featureFilter.needGeometry,H=ca(D,q);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),H,o))continue;const J=w?_.evaluate(H,{},o):void 0,se={id:O,properties:D.properties,type:D.type,sourceLayerIndex:V,index:U,geometry:q?H.geometry:wa(D),patterns:{},sortKey:J};g.push(se)}w&&g.sort((D,O)=>D.sortKey-O.sortKey);for(const D of g){const{geometry:O,index:U,sourceLayerIndex:V}=D,q=t[U].feature;this.addFeature(D,O,U,o,P),n.featureIndex.insert(q,O,U,V,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,o,d,g=1){let _;switch(g){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${g}; valid values are 1, 3, 5, 7.`)}const w=_.length;for(const E of n)for(const P of E){const D=P.x,O=P.y;if(D<0||D>=Ge||O<0||O>=Ge)continue;const U=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,t.sortKey),V=U.vertexLength;for(let q=0;q<w;q++)for(let H=0;H<w;H++)Ud(this.layoutVertexArray,D,O,_[H],_[q]);for(let q=0;q<w-1;q++)for(let H=0;H<w-1;H++){const J=V+q*w+H,se=V+(q+1)*w+H;this.indexArray.emplaceBack(J,se+1,J+1),this.indexArray.emplaceBack(J,se,se+1)}U.vertexLength+=w*w,U.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{},d)}}function Nd(a,t){for(let n=0;n<a.length;n++)if(ic(t,a[n]))return!0;for(let n=0;n<t.length;n++)if(ic(a,t[n]))return!0;return!!Gu(a,t)}function fm(a,t,n){return!!ic(a,t)||!!Vd(t,a,n)}function ep(a,t){if(a.length===1)return Xh(t,a[0]);for(let n=0;n<t.length;n++){const o=t[n];for(let d=0;d<o.length;d++)if(ic(a,o[d]))return!0}for(let n=0;n<a.length;n++)if(Xh(t,a[n]))return!0;for(let n=0;n<t.length;n++)if(Gu(a,t[n]))return!0;return!1}function Yc(a,t,n){if(a.length>1){if(Gu(a,t))return!0;for(let o=0;o<t.length;o++)if(Vd(t[o],a,n))return!0}for(let o=0;o<a.length;o++)if(Vd(a[o],t,n))return!0;return!1}function Gu(a,t){if(a.length===0||t.length===0)return!1;for(let n=0;n<a.length-1;n++){const o=a[n],d=a[n+1];for(let g=0;g<t.length-1;g++)if(pm(o,d,t[g],t[g+1]))return!0}return!1}function pm(a,t,n,o){return Ri(a,n,o)!==Ri(t,n,o)&&Ri(a,t,n)!==Ri(a,t,o)}function Vd(a,t,n){const o=n*n;if(t.length===1)return a.distSqr(t[0])<o;for(let d=1;d<t.length;d++)if(tp(a,t[d-1],t[d])<o)return!0;return!1}function tp(a,t,n){const o=t.distSqr(n);if(o===0)return a.distSqr(t);const d=((a.x-t.x)*(n.x-t.x)+(a.y-t.y)*(n.y-t.y))/o;return a.distSqr(d<0?t:d>1?n:n.sub(t)._mult(d)._add(t))}function Xh(a,t){for(let n=0;n<a.length;n++)if(ic(a[n],t))return!0;return!1}function ic(a,t){let n=!1;for(let o=0,d=a.length-1;o<a.length;d=o++){const g=a[o],_=a[d];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(n=!n)}return n}function ip(a,t,n){const o=n[0],d=n[2];if(a.x<o.x&&t.x<o.x||a.x>d.x&&t.x>d.x||a.y<o.y&&t.y<o.y||a.y>d.y&&t.y>d.y)return!1;const g=Ri(a,t,n[0]);return g!==Ri(a,t,n[1])||g!==Ri(a,t,n[2])||g!==Ri(a,t,n[3])}function Hu(a,t,n){const o=t.paint.get(a).value;return o.kind==="constant"?o.value:n.programConfigurations.get(t.id).getMaxValue(a)}function Yh(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Zd(a,t,n,o,d){if(!t[0]&&!t[1])return a;const g=Pe.convert(t)._mult(d);n==="viewport"&&g._rotate(-o);const _=[];for(let w=0;w<a.length;w++)_.push(a[w].sub(g));return _}let rp,dn;yt("CircleBucket",Hh,{omit:["layers"]});var kn={get paint(){return dn=dn||new ur({"circle-radius":new jt(ee.paint_circle["circle-radius"]),"circle-color":new jt(ee.paint_circle["circle-color"]),"circle-blur":new jt(ee.paint_circle["circle-blur"]),"circle-opacity":new jt(ee.paint_circle["circle-opacity"]),"circle-translate":new mt(ee.paint_circle["circle-translate"]),"circle-translate-anchor":new mt(ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mt(ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mt(ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jt(ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jt(ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jt(ee.paint_circle["circle-stroke-opacity"])})},get layout(){return rp=rp||new ur({"circle-sort-key":new jt(ee.layout_circle["circle-sort-key"])})}};class mm extends xa{constructor(t){super(t,kn)}createBucket(t){return new Hh(t)}queryRadius(t){const n=t;return Hu("circle-radius",this,n)+Hu("circle-stroke-width",this,n)+Yh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:g,pixelsToTileUnits:_,unwrappedTileID:w,getElevation:E}){const P=Zd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-g.bearingInRadians,_),D=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o),O=this.paint.get("circle-pitch-alignment")==="map",U=O?P:function(q,H,J,se){return q.map(ye=>np(ye,H,J,se))}(P,g,w,E),V=O?D*_:D;for(const q of d)for(const H of q){const J=O?H:np(H,g,w,E);let se=V;const ye=g.projectTileCoordinates(H.x,H.y,w,E).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=ye/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=g.cameraToCenterDistance/ye),fm(U,J,se))return!0}return!1}}function np(a,t,n,o){const d=t.projectTileCoordinates(a.x,a.y,n,o).point;return new Pe((.5*d.x+.5)*t.width,(.5*-d.y+.5)*t.height)}class ap extends Hh{}let sp;yt("HeatmapBucket",ap,{omit:["layers"]});var gm={get paint(){return sp=sp||new ur({"heatmap-radius":new jt(ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jt(ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mt(ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Jl(ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mt(ee.paint_heatmap["heatmap-opacity"])})}};function Xu(a,{width:t,height:n},o,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*n*o)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*n*o}`)}else d=new Uint8Array(t*n*o);return a.width=t,a.height=n,a.data=d,a}function qd(a,{width:t,height:n},o){if(t===a.width&&n===a.height)return;const d=Xu({},{width:t,height:n},o);$d(a,d,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,n)},o),a.width=t,a.height=n,a.data=d.data}function $d(a,t,n,o,d,g){if(d.width===0||d.height===0)return t;if(d.width>a.width||d.height>a.height||n.x>a.width-d.width||n.y>a.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||o.x>t.width-d.width||o.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=a.data,w=t.data;if(_===w)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<d.height;E++){const P=((n.y+E)*a.width+n.x)*g,D=((o.y+E)*t.width+o.x)*g;for(let O=0;O<d.width*g;O++)w[D+O]=_[P+O]}return t}class Yu{constructor(t,n){Xu(this,t,1,n)}resize(t){qd(this,t,1)}clone(){return new Yu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,o,d,g){$d(t,n,o,d,g,1)}}class Ta{constructor(t,n){Xu(this,t,4,n)}resize(t){qd(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,o,d,g){$d(t,n,o,d,g,4)}}function Gd(a){const t={},n=a.resolution||256,o=a.clips?a.clips.length:1,d=a.image||new Ta({width:n,height:o});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const g=(_,w,E)=>{t[a.evaluationKey]=E;const P=a.expression.evaluate(t);d.data[_+w+0]=Math.floor(255*P.r/P.a),d.data[_+w+1]=Math.floor(255*P.g/P.a),d.data[_+w+2]=Math.floor(255*P.b/P.a),d.data[_+w+3]=Math.floor(255*P.a)};if(a.clips)for(let _=0,w=0;_<o;++_,w+=4*n)for(let E=0,P=0;E<n;E++,P+=4){const D=E/(n-1),{start:O,end:U}=a.clips[_];g(w,P,O*(1-D)+U*D)}else for(let _=0,w=0;_<n;_++,w+=4)g(0,w,_/(n-1));return d}yt("AlphaImage",Yu),yt("RGBAImage",Ta);const Qh="big-fb";class op extends xa{createBucket(t){return new ap(t)}constructor(t){super(t,gm),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Qh)&&this.heatmapFbos.delete(Qh)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let lp;var cp={get paint(){return lp=lp||new ur({"hillshade-illumination-direction":new mt(ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new mt(ee.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new mt(ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mt(ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mt(ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mt(ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mt(ee.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new mt(ee.paint_hillshade["hillshade-method"])})}};class Hd extends xa{constructor(t){super(t,cp),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,o=this.paint.get("hillshade-highlight-color").values,d=this.paint.get("hillshade-shadow-color").values;const g=Math.max(t.length,n.length,o.length,d.length);t=t.concat(Array(g-t.length).fill(t.at(-1))),n=n.concat(Array(g-n.length).fill(n.at(-1))),o=o.concat(Array(g-o.length).fill(o.at(-1))),d=d.concat(Array(g-d.length).fill(d.at(-1)));const _=n.map(Ws);return{directionRadians:t.map(Ws),altitudeRadians:_,shadowColor:d,highlightColor:o}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const up=rr([{name:"a_pos",components:2,type:"Int16"}],4),{members:_m}=up;function Kh(a,t,n){const o=n.patternDependencies;let d=!1;for(const g of t){const _=g.paint.get(`${a}-pattern`);_.isConstant()||(d=!0);const w=_.constantOr(null);w&&(d=!0,o[w.to]=!0,o[w.from]=!0)}return d}function Xd(a,t,n,o,d){const g=d.patternDependencies;for(const _ of t){const w=_.paint.get(`${a}-pattern`).value;if(w.kind!=="constant"){let E=w.evaluate({zoom:o-1},n,{},d.availableImages),P=w.evaluate({zoom:o},n,{},d.availableImages),D=w.evaluate({zoom:o+1},n,{},d.availableImages);E=E&&E.name?E.name:E,P=P&&P.name?P.name:P,D=D&&D.name?D.name:D,g[E]=!0,g[P]=!0,g[D]=!0,n.patterns[_.id]={min:E,mid:P,max:D}}}return n}function xo(a,t,n,o,d){let g;if(d===function(_,w,E,P){let D=0;for(let O=w,U=E-P;O<E;O+=P)D+=(_[U]-_[O])*(_[O+1]+_[U+1]),U=O;return D}(a,t,n,o)>0)for(let _=t;_<n;_+=o)g=Kd(_/o|0,a[_],a[_+1],g);else for(let _=n-o;_>=t;_-=o)g=Kd(_/o|0,a[_],a[_+1],g);return g&&wo(g,g.next)&&(rc(g),g=g.next),g}function hl(a,t){if(!a)return a;t||(t=a);let n,o=a;do if(n=!1,o.steiner||!wo(o,o.next)&&Ar(o.prev,o,o.next)!==0)o=o.next;else{if(rc(o),o=t=o.prev,o===o.next)break;n=!0}while(n||o!==t);return t}function Wh(a,t,n,o,d,g,_){if(!a)return;!_&&g&&function(E,P,D,O){let U=E;do U.z===0&&(U.z=hp(U.x,U.y,P,D,O)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==E);U.prevZ.nextZ=null,U.prevZ=null,function(V){let q,H=1;do{let J,se=V;V=null;let ye=null;for(q=0;se;){q++;let le=se,N=0;for(let de=0;de<H&&(N++,le=le.nextZ,le);de++);let W=H;for(;N>0||W>0&&le;)N!==0&&(W===0||!le||se.z<=le.z)?(J=se,se=se.nextZ,N--):(J=le,le=le.nextZ,W--),ye?ye.nextZ=J:V=J,J.prevZ=ye,ye=J;se=le}ye.nextZ=null,H*=2}while(q>1)}(U)}(a,o,d,g);let w=a;for(;a.prev!==a.next;){const E=a.prev,P=a.next;if(g?dl(a,o,d,g):ym(a))t.push(E.i,a.i,P.i),rc(a),a=P.next,w=P.next;else if((a=P)===w){_?_===1?Wh(a=vm(hl(a),t),t,n,o,d,g,2):_===2&&Yd(a,t,n,o,d,g):Wh(hl(a),t,n,o,d,g,1);break}}}function ym(a){const t=a.prev,n=a,o=a.next;if(Ar(t,n,o)>=0)return!1;const d=t.x,g=n.x,_=o.x,w=t.y,E=n.y,P=o.y,D=Math.min(d,g,_),O=Math.min(w,E,P),U=Math.max(d,g,_),V=Math.max(w,E,P);let q=o.next;for(;q!==t;){if(q.x>=D&&q.x<=U&&q.y>=O&&q.y<=V&&hs(d,w,g,E,_,P,q.x,q.y)&&Ar(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function dl(a,t,n,o){const d=a.prev,g=a,_=a.next;if(Ar(d,g,_)>=0)return!1;const w=d.x,E=g.x,P=_.x,D=d.y,O=g.y,U=_.y,V=Math.min(w,E,P),q=Math.min(D,O,U),H=Math.max(w,E,P),J=Math.max(D,O,U),se=hp(V,q,t,n,o),ye=hp(H,J,t,n,o);let le=a.prevZ,N=a.nextZ;for(;le&&le.z>=se&&N&&N.z<=ye;){if(le.x>=V&&le.x<=H&&le.y>=q&&le.y<=J&&le!==d&&le!==_&&hs(w,D,E,O,P,U,le.x,le.y)&&Ar(le.prev,le,le.next)>=0||(le=le.prevZ,N.x>=V&&N.x<=H&&N.y>=q&&N.y<=J&&N!==d&&N!==_&&hs(w,D,E,O,P,U,N.x,N.y)&&Ar(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;le&&le.z>=se;){if(le.x>=V&&le.x<=H&&le.y>=q&&le.y<=J&&le!==d&&le!==_&&hs(w,D,E,O,P,U,le.x,le.y)&&Ar(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;N&&N.z<=ye;){if(N.x>=V&&N.x<=H&&N.y>=q&&N.y<=J&&N!==d&&N!==_&&hs(w,D,E,O,P,U,N.x,N.y)&&Ar(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function vm(a,t){let n=a;do{const o=n.prev,d=n.next.next;!wo(o,d)&&Zs(o,n,n.next,d)&&Wu(o,d)&&Wu(d,o)&&(t.push(o.i,n.i,d.i),rc(n),rc(n.next),n=a=d),n=n.next}while(n!==a);return hl(n)}function Yd(a,t,n,o,d,g){let _=a;do{let w=_.next.next;for(;w!==_.prev;){if(_.i!==w.i&&xm(_,w)){let E=Qd(_,w);return _=hl(_,_.next),E=hl(E,E.next),Wh(_,t,n,o,d,g,0),void Wh(E,t,n,o,d,g,0)}w=w.next}_=_.next}while(_!==a)}function Jh(a,t){let n=a.x-t.x;return n===0&&(n=a.y-t.y,n===0)&&(n=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function Br(a,t){const n=function(d,g){let _=g;const w=d.x,E=d.y;let P,D=-1/0;if(wo(d,_))return _;do{if(wo(d,_.next))return _.next;if(E<=_.y&&E>=_.next.y&&_.next.y!==_.y){const H=_.x+(E-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(H<=w&&H>D&&(D=H,P=_.x<_.next.x?_:_.next,H===w))return P}_=_.next}while(_!==g);if(!P)return null;const O=P,U=P.x,V=P.y;let q=1/0;_=P;do{if(w>=_.x&&_.x>=U&&w!==_.x&&Qu(E<V?w:D,E,U,V,E<V?D:w,E,_.x,_.y)){const H=Math.abs(E-_.y)/(w-_.x);Wu(_,d)&&(H<q||H===q&&(_.x>P.x||_.x===P.x&&fg(P,_)))&&(P=_,q=H)}_=_.next}while(_!==O);return P}(a,t);if(!n)return t;const o=Qd(n,a);return hl(o,o.next),hl(n,n.next)}function fg(a,t){return Ar(a.prev,a,t.prev)<0&&Ar(t.next,a,a.next)<0}function hp(a,t,n,o,d){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-n)*d|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bm(a){let t=a,n=a;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==a);return n}function Qu(a,t,n,o,d,g,_,w){return(d-_)*(t-w)>=(a-_)*(g-w)&&(a-_)*(o-w)>=(n-_)*(t-w)&&(n-_)*(g-w)>=(d-_)*(o-w)}function hs(a,t,n,o,d,g,_,w){return!(a===_&&t===w)&&Qu(a,t,n,o,d,g,_,w)}function xm(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(n,o){let d=n;do{if(d.i!==n.i&&d.next.i!==n.i&&d.i!==o.i&&d.next.i!==o.i&&Zs(d,d.next,n,o))return!0;d=d.next}while(d!==n);return!1}(a,t)&&(Wu(a,t)&&Wu(t,a)&&function(n,o){let d=n,g=!1;const _=(n.x+o.x)/2,w=(n.y+o.y)/2;do d.y>w!=d.next.y>w&&d.next.y!==d.y&&_<(d.next.x-d.x)*(w-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next;while(d!==n);return g}(a,t)&&(Ar(a.prev,a,t.prev)||Ar(a,t.prev,t))||wo(a,t)&&Ar(a.prev,a,a.next)>0&&Ar(t.prev,t,t.next)>0)}function Ar(a,t,n){return(t.y-a.y)*(n.x-t.x)-(t.x-a.x)*(n.y-t.y)}function wo(a,t){return a.x===t.x&&a.y===t.y}function Zs(a,t,n,o){const d=Ku(Ar(a,t,n)),g=Ku(Ar(a,t,o)),_=Ku(Ar(n,o,a)),w=Ku(Ar(n,o,t));return d!==g&&_!==w||!(d!==0||!ed(a,n,t))||!(g!==0||!ed(a,o,t))||!(_!==0||!ed(n,a,o))||!(w!==0||!ed(n,t,o))}function ed(a,t,n){return t.x<=Math.max(a.x,n.x)&&t.x>=Math.min(a.x,n.x)&&t.y<=Math.max(a.y,n.y)&&t.y>=Math.min(a.y,n.y)}function Ku(a){return a>0?1:a<0?-1:0}function Wu(a,t){return Ar(a.prev,a,a.next)<0?Ar(a,t,a.next)>=0&&Ar(a,a.prev,t)>=0:Ar(a,t,a.prev)<0||Ar(a,a.next,t)<0}function Qd(a,t){const n=Wd(a.i,a.x,a.y),o=Wd(t.i,t.x,t.y),d=a.next,g=t.prev;return a.next=t,t.prev=a,n.next=d,d.prev=n,o.next=n,n.prev=o,g.next=o,o.prev=g,o}function Kd(a,t,n,o){const d=Wd(a,t,n);return o?(d.next=o.next,d.prev=o,o.next.prev=d,o.next=d):(d.prev=d,d.next=d),d}function rc(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Wd(a,t,n){return{i:a,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Sa{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class zr{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}zr.noSubdivision=new zr({fill:new Sa(0,0),line:new Sa(0,0),tile:new Sa(0,0),stencil:new Sa(0,0),circle:1}),yt("SubdivisionGranularityExpression",Sa),yt("SubdivisionGranularitySetting",zr);const nc=-32768,Ju=32767;class Sn{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ge/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|(n+=32768)<<0}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(t),d=0|Math.round(n),g=this._getKey(o,d);if(this._vertexDictionary.has(g))return this._vertexDictionary.get(g);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(g,_),this._vertexBuffer.push(o,d),_}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(d,g){const _=[];for(let w=0;w<g.length;w+=3){const E=g[w],P=g[w+1],D=g[w+2],O=d[2*E],U=d[2*E+1];(d[2*P]-O)*(d[2*D+1]-U)-(d[2*P+1]-U)*(d[2*D]-O)>0?(_.push(E),_.push(D),_.push(P)):(_.push(E),_.push(P),_.push(D))}return _}(this._vertexBuffer,t);const n=[],o=t.length;for(let d=0;d<o;d+=3){const g=[t[d+0],t[d+1],t[d+2]],_=[this._vertexBuffer[2*t[d+0]+0],this._vertexBuffer[2*t[d+0]+1],this._vertexBuffer[2*t[d+1]+0],this._vertexBuffer[2*t[d+1]+1],this._vertexBuffer[2*t[d+2]+0],this._vertexBuffer[2*t[d+2]+1]];let w=1/0,E=1/0,P=-1/0,D=-1/0;for(let H=0;H<3;H++){const J=_[2*H],se=_[2*H+1];w=Math.min(w,J),P=Math.max(P,J),E=Math.min(E,se),D=Math.max(D,se)}if(w===P||E===D)continue;const O=Math.floor(w/this._granularityCellSize),U=Math.ceil(P/this._granularityCellSize),V=Math.floor(E/this._granularityCellSize),q=Math.ceil(D/this._granularityCellSize);if(O!==U||V!==q)for(let H=V;H<q;H++){const J=this._scanlineGenerateVertexRingForCellRow(H,_,g);Tm(this._vertexBuffer,J,n)}else n.push(...g)}return n}_scanlineGenerateVertexRingForCellRow(t,n,o){const d=t*this._granularityCellSize,g=d+this._granularityCellSize,_=[];for(let w=0;w<3;w++){const E=n[2*w],P=n[2*w+1],D=n[2*(w+1)%6],O=n[(2*(w+1)+1)%6],U=n[2*(w+2)%6],V=n[(2*(w+2)+1)%6],q=D-E,H=O-P,J=q===0,se=H===0,ye=(d-P)/H,le=(g-P)/H,N=Math.min(ye,le),W=Math.max(ye,le);if(!se&&(N>=1||W<=0)||se&&(P<d||P>g)){O>=d&&O<=g&&_.push(o[(w+1)%3]);continue}!se&&N>0&&_.push(this._vertexToIndex(E+q*N,P+H*N));const de=E+q*Math.max(N,0),Le=E+q*Math.min(W,1);J||this._generateIntraEdgeVertices(_,E,P,D,O,de,Le),!se&&W<1&&_.push(this._vertexToIndex(E+q*W,P+H*W)),(se||O>=d&&O<=g)&&_.push(o[(w+1)%3]),!se&&(O<=d||O>=g)&&this._generateInterEdgeVertices(_,E,P,D,O,U,V,Le,d,g)}return _}_generateIntraEdgeVertices(t,n,o,d,g,_,w){const E=d-n,P=g-o,D=P===0,O=D?Math.min(n,d):Math.min(_,w),U=D?Math.max(n,d):Math.max(_,w),V=Math.floor(O/this._granularityCellSize)+1,q=Math.ceil(U/this._granularityCellSize)-1;if(D?n<d:_<w)for(let H=V;H<=q;H++){const J=H*this._granularityCellSize;t.push(this._vertexToIndex(J,o+P*(J-n)/E))}else for(let H=q;H>=V;H--){const J=H*this._granularityCellSize;t.push(this._vertexToIndex(J,o+P*(J-n)/E))}}_generateInterEdgeVertices(t,n,o,d,g,_,w,E,P,D){const O=g-o,U=_-d,V=w-g,q=(P-g)/V,H=(D-g)/V,J=Math.min(q,H),se=Math.max(q,H),ye=d+U*J;let le=Math.floor(Math.min(ye,E)/this._granularityCellSize)+1,N=Math.ceil(Math.max(ye,E)/this._granularityCellSize)-1,W=E<ye;const de=V===0;if(de&&(w===P||w===D))return;if(de||J>=1||se<=0){const rt=o-w,Fe=_+(n-_)*Math.min((P-w)/rt,(D-w)/rt);le=Math.floor(Math.min(Fe,E)/this._granularityCellSize)+1,N=Math.ceil(Math.max(Fe,E)/this._granularityCellSize)-1,W=E<Fe}const Le=O>0?D:P;if(W)for(let rt=le;rt<=N;rt++)t.push(this._vertexToIndex(rt*this._granularityCellSize,Le));else for(let rt=N;rt>=le;rt--)t.push(this._vertexToIndex(rt*this._granularityCellSize,Le))}_generateOutline(t){const n=[];for(const o of t){const d=ac(o,this._granularity,!0),g=this._pointArrayToIndices(d),_=[];for(let w=1;w<g.length;w++)_.push(g[w-1]),_.push(g[w]);n.push(_)}return n}_handlePoles(t){let n=!1,o=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(n||o)&&this._fillPoles(t,n,o)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const o=t[n+1];o===nc&&(t[n+1]=-32767),o===Ju&&(t[n+1]=32766)}}_generatePoleQuad(t,n,o,d,g,_){d>g!=(_===nc)?(t.push(n),t.push(o),t.push(this._vertexToIndex(d,_)),t.push(o),t.push(this._vertexToIndex(g,_)),t.push(this._vertexToIndex(d,_))):(t.push(o),t.push(n),t.push(this._vertexToIndex(d,_)),t.push(this._vertexToIndex(g,_)),t.push(o),t.push(this._vertexToIndex(d,_)))}_fillPoles(t,n,o){const d=this._vertexBuffer,g=Ge,_=t.length;for(let w=2;w<_;w+=3){const E=t[w-2],P=t[w-1],D=t[w],O=d[2*E],U=d[2*E+1],V=d[2*P],q=d[2*P+1],H=d[2*D],J=d[2*D+1];n&&(U===0&&q===0&&this._generatePoleQuad(t,E,P,O,V,nc),q===0&&J===0&&this._generatePoleQuad(t,P,D,V,H,nc),J===0&&U===0&&this._generatePoleQuad(t,D,E,H,O,nc)),o&&(U===g&&q===g&&this._generatePoleQuad(t,E,P,O,V,Ju),q===g&&J===g&&this._generatePoleQuad(t,P,D,V,H,Ju),J===g&&U===g&&this._generatePoleQuad(t,D,E,H,O,Ju))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:d}=function(w){const E=[],P=[];for(const D of w)if(D.length!==0){D!==w[0]&&E.push(P.length/2);for(let O=0;O<D.length;O++)P.push(D[O].x),P.push(D[O].y)}return{flattened:P,holeIndices:E}}(t);let g;this._initializeVertices(o);try{const w=function(P,D,O=2){const U=D&&D.length,V=U?D[0]*O:P.length;let q=xo(P,0,V,O,!0);const H=[];if(!q||q.next===q.prev)return H;let J,se,ye;if(U&&(q=function(le,N,W,de){const Le=[];for(let rt=0,Fe=N.length;rt<Fe;rt++){const Xe=xo(le,N[rt]*de,rt<Fe-1?N[rt+1]*de:le.length,de,!1);Xe===Xe.next&&(Xe.steiner=!0),Le.push(bm(Xe))}Le.sort(Jh);for(let rt=0;rt<Le.length;rt++)W=Br(Le[rt],W);return W}(P,D,q,O)),P.length>80*O){J=1/0,se=1/0;let le=-1/0,N=-1/0;for(let W=O;W<V;W+=O){const de=P[W],Le=P[W+1];de<J&&(J=de),Le<se&&(se=Le),de>le&&(le=de),Le>N&&(N=Le)}ye=Math.max(le-J,N-se),ye=ye!==0?32767/ye:0}return Wh(q,H,O,J,se,ye,0),H}(o,d),E=this._convertIndices(o,w);g=this._subdivideTrianglesScanline(E)}catch(w){console.error(w)}let _=[];return n&&(_=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(g),{verticesFlattened:this._vertexBuffer,indicesTriangles:g,indicesLineList:_}}_convertIndices(t,n){const o=[];for(let d=0;d<n.length;d++)o.push(this._vertexToIndex(t[2*n[d]],t[2*n[d]+1]));return o}_pointArrayToIndices(t){const n=[];for(let o=0;o<t.length;o++){const d=t[o];n.push(this._vertexToIndex(d.x,d.y))}return n}}function wm(a,t,n,o=!0){return new Sn(n,t).subdividePolygonInternal(a,o)}function ac(a,t,n=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const o=a[0],d=a[a.length-1],g=n&&(o.x!==d.x||o.y!==d.y);if(t<2)return g?[...a,a[0]]:[...a];const _=Math.floor(Ge/t),w=[];w.push(new Pe(a[0].x,a[0].y));const E=a.length,P=g?E:E-1;for(let D=0;D<P;D++){const O=a[D],U=D<E-1?a[D+1]:a[0],V=O.x,q=O.y,H=U.x,J=U.y,se=V!==H,ye=q!==J;if(!se&&!ye)continue;const le=H-V,N=J-q,W=Math.abs(le),de=Math.abs(N);let Le=V,rt=q;for(;;){const Xe=le>0?(Math.floor(Le/_)+1)*_:(Math.ceil(Le/_)-1)*_,ot=N>0?(Math.floor(rt/_)+1)*_:(Math.ceil(rt/_)-1)*_,at=Math.abs(Le-Xe),ct=Math.abs(rt-ot),Qe=Math.abs(Le-H),wt=Math.abs(rt-J),Dt=se?at/W:Number.POSITIVE_INFINITY,Pt=ye?ct/de:Number.POSITIVE_INFINITY;if((Qe<=at||!se)&&(wt<=ct||!ye))break;if(Dt<Pt&&se||!ye){Le=Xe,rt+=N*Dt;const Mt=new Pe(Le,Math.round(rt));w[w.length-1].x===Mt.x&&w[w.length-1].y===Mt.y||w.push(Mt)}else{Le+=le*Pt,rt=ot;const Mt=new Pe(Math.round(Le),rt);w[w.length-1].x===Mt.x&&w[w.length-1].y===Mt.y||w.push(Mt)}}const Fe=new Pe(H,J);w[w.length-1].x===Fe.x&&w[w.length-1].y===Fe.y||w.push(Fe)}return w}function Tm(a,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,d=a[2*t[0]];for(let E=1;E<t.length;E++){const P=a[2*t[E]];P<d&&(d=P,o=E)}const g=t.length;let _=o,w=(_+1)%g;for(;;){const E=_-1>=0?_-1:g-1,P=(w+1)%g,D=a[2*t[E]],O=a[2*t[P]],U=a[2*t[_]],V=a[2*t[_]+1],q=a[2*t[w]+1];let H=!1;if(D<O)H=!0;else if(D>O)H=!1;else{const J=q-V,se=-(a[2*t[w]]-U),ye=V<q?1:-1;((D-U)*J+(a[2*t[E]+1]-V)*se)*ye>((O-U)*J+(a[2*t[P]+1]-V)*se)*ye&&(H=!0)}if(H){const J=t[E],se=t[_],ye=t[w];J!==se&&J!==ye&&se!==ye&&n.push(ye,se,J),_--,_<0&&(_=g-1)}else{const J=t[P],se=t[_],ye=t[w];J!==se&&J!==ye&&se!==ye&&n.push(ye,se,J),w++,w>=g&&(w=0)}if(E===P)break}}function yr(a,t,n,o,d,g,_,w,E){const P=d.length/2,D=_&&w&&E;if(P<Ti.MAX_VERTEX_ARRAY_LENGTH){const O=t.prepareSegment(P,n,o),U=O.vertexLength;for(let H=0;H<g.length;H+=3)o.emplaceBack(U+g[H],U+g[H+1],U+g[H+2]);let V,q;O.vertexLength+=P,O.primitiveLength+=g.length/3,D&&(q=_.prepareSegment(P,n,w),V=q.vertexLength,q.vertexLength+=P);for(let H=0;H<d.length;H+=2)a(d[H],d[H+1]);if(D)for(let H=0;H<E.length;H++){const J=E[H];for(let se=1;se<J.length;se+=2)w.emplaceBack(V+J[se-1],V+J[se]);q.primitiveLength+=J.length/2}}else(function(O,U,V,q,H,J){const se=[];for(let de=0;de<q.length/2;de++)se.push(-1);const ye={count:0};let le=0,N=O.getOrCreateLatestSegment(U,V),W=N.vertexLength;for(let de=2;de<H.length;de+=3){const Le=H[de-2],rt=H[de-1],Fe=H[de];let Xe=se[Le]<le,ot=se[rt]<le,at=se[Fe]<le;N.vertexLength+((Xe?1:0)+(ot?1:0)+(at?1:0))>Ti.MAX_VERTEX_ARRAY_LENGTH&&(N=O.createNewSegment(U,V),le=ye.count,Xe=!0,ot=!0,at=!0,W=0);const ct=Mn(se,q,J,ye,Le,Xe,N),Qe=Mn(se,q,J,ye,rt,ot,N),wt=Mn(se,q,J,ye,Fe,at,N);V.emplaceBack(W+ct-le,W+Qe-le,W+wt-le),N.primitiveLength++}})(t,n,o,d,g,a),D&&function(O,U,V,q,H,J){const se=[];for(let de=0;de<q.length/2;de++)se.push(-1);const ye={count:0};let le=0,N=O.getOrCreateLatestSegment(U,V),W=N.vertexLength;for(let de=0;de<H.length;de++){const Le=H[de];for(let rt=1;rt<H[de].length;rt+=2){const Fe=Le[rt-1],Xe=Le[rt];let ot=se[Fe]<le,at=se[Xe]<le;N.vertexLength+((ot?1:0)+(at?1:0))>Ti.MAX_VERTEX_ARRAY_LENGTH&&(N=O.createNewSegment(U,V),le=ye.count,ot=!0,at=!0,W=0);const ct=Mn(se,q,J,ye,Fe,ot,N),Qe=Mn(se,q,J,ye,Xe,at,N);V.emplaceBack(W+ct-le,W+Qe-le),N.primitiveLength++}}}(_,n,w,d,E,a),t.forceNewSegmentOnNextPrepare(),_==null||_.forceNewSegmentOnNextPrepare()}function Mn(a,t,n,o,d,g,_){if(g){const w=o.count;return n(t[2*d],t[2*d+1]),a[d]=o.count,o.count++,_.vertexLength++,w}return a[d]}class qs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ht,this.indexArray=new xi,this.indexArray2=new Lr,this.programConfigurations=new Ns(t.layers,t.zoom),this.segments=new Ti,this.segments2=new Ti,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){this.hasPattern=Kh("fill",this.layers,n);const d=this.layers[0].layout.get("fill-sort-key"),g=!d.isConstant(),_=[];for(const{feature:w,id:E,index:P,sourceLayerIndex:D}of t){const O=this.layers[0]._featureFilter.needGeometry,U=ca(w,O);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),U,o))continue;const V=g?d.evaluate(U,{},o,n.availableImages):void 0,q={id:E,properties:w.properties,type:w.type,sourceLayerIndex:D,index:P,geometry:O?U.geometry:wa(w),patterns:{},sortKey:V};_.push(q)}g&&_.sort((w,E)=>w.sortKey-E.sortKey);for(const w of _){const{geometry:E,index:P,sourceLayerIndex:D}=w;if(this.hasPattern){const O=Xd("fill",this.layers,w,this.zoom,n);this.patternFeatures.push(O)}else this.addFeature(w,E,P,o,{},n.subdivisionGranularity);n.featureIndex.insert(t[P].feature,E,P,D,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}addFeatures(t,n,o){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_m),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,o,d,g,_){for(const w of zc(n,500)){const E=wm(w,d,_.fill.getGranularityForZoomLevel(d.z)),P=this.layoutVertexArray;yr((D,O)=>{P.emplaceBack(D,O)},this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles,this.segments2,this.indexArray2,E.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,d)}}let dp,fp;yt("FillBucket",qs,{omit:["layers","patternFeatures"]});var pg={get paint(){return fp=fp||new ur({"fill-antialias":new mt(ee.paint_fill["fill-antialias"]),"fill-opacity":new jt(ee.paint_fill["fill-opacity"]),"fill-color":new jt(ee.paint_fill["fill-color"]),"fill-outline-color":new jt(ee.paint_fill["fill-outline-color"]),"fill-translate":new mt(ee.paint_fill["fill-translate"]),"fill-translate-anchor":new mt(ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new os(ee.paint_fill["fill-pattern"])})},get layout(){return dp=dp||new ur({"fill-sort-key":new jt(ee.layout_fill["fill-sort-key"])})}};class pp extends xa{constructor(t){super(t,pg)}recalculate(t,n){super.recalculate(t,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new qs(t)}queryRadius(){return Yh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:o,pixelsToTileUnits:d}){return ep(Zd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,d),n)}isTileClipped(){return!0}}const ja=rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),$s=rr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Sm}=ja;var ua,mp,To,sc,So,Jd,ef,Fa={};function gp(){if(mp)return ua;mp=1;var a=Te();function t(d,g,_,w,E){this.properties={},this.extent=_,this.type=0,this._pbf=d,this._geometry=-1,this._keys=w,this._values=E,d.readFields(n,this,g)}function n(d,g,_){d==1?g.id=_.readVarint():d==2?function(w,E){for(var P=w.readVarint()+w.pos;w.pos<P;){var D=E._keys[w.readVarint()],O=E._values[w.readVarint()];E.properties[D]=O}}(_,g):d==3?g.type=_.readVarint():d==4&&(g._geometry=_.pos)}function o(d){for(var g,_,w=0,E=0,P=d.length,D=P-1;E<P;D=E++)w+=((_=d[D]).x-(g=d[E]).x)*(g.y+_.y);return w}return ua=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var g,_=d.readVarint()+d.pos,w=1,E=0,P=0,D=0,O=[];d.pos<_;){if(E<=0){var U=d.readVarint();w=7&U,E=U>>3}if(E--,w===1||w===2)P+=d.readSVarint(),D+=d.readSVarint(),w===1&&(g&&O.push(g),g=[]),g.push(new a(P,D));else{if(w!==7)throw new Error("unknown command "+w);g&&g.push(g[0].clone())}}return g&&O.push(g),O},t.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var g=d.readVarint()+d.pos,_=1,w=0,E=0,P=0,D=1/0,O=-1/0,U=1/0,V=-1/0;d.pos<g;){if(w<=0){var q=d.readVarint();_=7&q,w=q>>3}if(w--,_===1||_===2)(E+=d.readSVarint())<D&&(D=E),E>O&&(O=E),(P+=d.readSVarint())<U&&(U=P),P>V&&(V=P);else if(_!==7)throw new Error("unknown command "+_)}return[D,U,O,V]},t.prototype.toGeoJSON=function(d,g,_){var w,E,P=this.extent*Math.pow(2,_),D=this.extent*d,O=this.extent*g,U=this.loadGeometry(),V=t.types[this.type];function q(se){for(var ye=0;ye<se.length;ye++){var le=se[ye];se[ye]=[360*(le.x+D)/P-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+O)/P)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(w=0;w<U.length;w++)H[w]=U[w][0];q(U=H);break;case 2:for(w=0;w<U.length;w++)q(U[w]);break;case 3:for(U=function(se){var ye=se.length;if(ye<=1)return[se];for(var le,N,W=[],de=0;de<ye;de++){var Le=o(se[de]);Le!==0&&(N===void 0&&(N=Le<0),N===Le<0?(le&&W.push(le),le=[se[de]]):le.push(se[de]))}return le&&W.push(le),W}(U),w=0;w<U.length;w++)for(E=0;E<U[w].length;E++)q(U[w][E])}U.length===1?U=U[0]:V="Multi"+V;var J={type:"Feature",geometry:{type:V,coordinates:U},properties:this.properties};return"id"in this&&(J.id=this.id),J},ua}function Qc(){if(sc)return To;sc=1;var a=gp();function t(o,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,d),this.length=this._features.length}function n(o,d,g){o===15?d.version=g.readVarint():o===1?d.name=g.readString():o===5?d.extent=g.readVarint():o===2?d._features.push(g.pos):o===3?d._keys.push(g.readString()):o===4&&d._values.push(function(_){for(var w=null,E=_.readVarint()+_.pos;_.pos<E;){var P=_.readVarint()>>3;w=P===1?_.readString():P===2?_.readFloat():P===3?_.readDouble():P===4?_.readVarint64():P===5?_.readVarint():P===6?_.readSVarint():P===7?_.readBoolean():null}return w}(g))}return To=t,t.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var d=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,d,this.extent,this._keys,this._values)},To}function eh(){return ef||(ef=1,Fa.VectorTile=function(){if(Jd)return So;Jd=1;var a=Qc();function t(n,o,d){if(n===3){var g=new a(d,d.readVarint()+d.pos);g.length&&(o[g.name]=g)}}return So=function(n,o){this.layers=n.readFields(t,{},o)},So}(),Fa.VectorTileFeature=gp(),Fa.VectorTileLayer=Qc()),Fa}var fl=oe(eh());const th=fl.VectorTileFeature.types,tf=Math.pow(2,13);function ih(a,t,n,o,d,g,_,w){a.emplaceBack(t,n,2*Math.floor(o*tf)+_,d*tf*2,g*tf*2,Math.round(w))}class Kc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new it,this.centroidVertexArray=new $e,this.indexArray=new xi,this.programConfigurations=new Ns(t.layers,t.zoom),this.segments=new Ti,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){this.features=[],this.hasPattern=Kh("fill-extrusion",this.layers,n);for(const{feature:d,id:g,index:_,sourceLayerIndex:w}of t){const E=this.layers[0]._featureFilter.needGeometry,P=ca(d,E);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),P,o))continue;const D={id:g,sourceLayerIndex:w,index:_,geometry:E?P.geometry:wa(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Xd("fill-extrusion",this.layers,D,this.zoom,n)):this.addFeature(D,D.geometry,_,o,{},n.subdivisionGranularity),n.featureIndex.insert(d,D.geometry,_,w,this.index,!0)}}addFeatures(t,n,o){for(const d of this.features){const{geometry:g}=d;this.addFeature(d,g,d.index,n,o,t.subdivisionGranularity)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Sm),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,$s.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,o,d,g,_){for(const w of zc(n,500)){const E={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(E,d,t,w,_);const D=this.layoutVertexArray.length-P,O=Math.floor(E.x/E.sampleCount),U=Math.floor(E.y/E.sampleCount);for(let V=0;V<D;V++)this.centroidVertexArray.emplaceBack(O,U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,d)}processPolygon(t,n,o,d,g){if(d.length<1||_p(d[0]))return;for(const O of d)O.length!==0&&Mm(t,O);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=g.fill.getGranularityForZoomLevel(n.z),E=th[o.type]==="Polygon";for(const O of d){if(O.length===0||_p(O))continue;const U=ac(O,w,E);this._generateSideFaces(U,_)}if(!E)return;const P=wm(d,n,w,!1),D=this.layoutVertexArray;yr((O,U)=>{ih(D,O,U,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(t,n){let o=0;for(let d=1;d<t.length;d++){const g=t[d],_=t[d-1];if(rf(g,_))continue;n.segment.vertexLength+4>Ti.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=g.sub(_)._perp()._unit(),E=_.dist(g);o+E>32768&&(o=0),ih(this.layoutVertexArray,g.x,g.y,w.x,w.y,0,0,o),ih(this.layoutVertexArray,g.x,g.y,w.x,w.y,0,1,o),o+=E,ih(this.layoutVertexArray,_.x,_.y,w.x,w.y,0,0,o),ih(this.layoutVertexArray,_.x,_.y,w.x,w.y,0,1,o);const P=n.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function Mm(a,t){for(let n=0;n<t.length;n++){const o=t[n];n===t.length-1&&t[0].x===o.x&&t[0].y===o.y||(a.x+=o.x,a.y+=o.y,a.sampleCount++)}}function rf(a,t){return a.x===t.x&&(a.x<0||a.x>Ge)||a.y===t.y&&(a.y<0||a.y>Ge)}function _p(a){return a.every(t=>t.x<0)||a.every(t=>t.x>Ge)||a.every(t=>t.y<0)||a.every(t=>t.y>Ge)}let Em;yt("FillExtrusionBucket",Kc,{omit:["layers","features"]});var mg={get paint(){return Em=Em||new ur({"fill-extrusion-opacity":new mt(ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jt(ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mt(ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mt(ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new os(ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jt(ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jt(ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mt(ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Hi extends xa{constructor(t){super(t,mg)}createBucket(t){return new Kc(t)}queryRadius(){return Yh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:g,pixelsToTileUnits:_,pixelPosMatrix:w}){const E=Zd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-g.bearingInRadians,_),P=this.paint.get("fill-extrusion-height").evaluate(n,o),D=this.paint.get("fill-extrusion-base").evaluate(n,o),O=function(V,q,H){const J=[];for(const se of V){const ye=[se.x,se.y,0,1];Et(ye,ye,q),J.push(new Pe(ye[0]/ye[3],ye[1]/ye[3]))}return J}(E,w),U=function(V,q,H,J){const se=[],ye=[],le=J[8]*q,N=J[9]*q,W=J[10]*q,de=J[11]*q,Le=J[8]*H,rt=J[9]*H,Fe=J[10]*H,Xe=J[11]*H;for(const ot of V){const at=[],ct=[];for(const Qe of ot){const wt=Qe.x,Dt=Qe.y,Pt=J[0]*wt+J[4]*Dt+J[12],Mt=J[1]*wt+J[5]*Dt+J[13],ni=J[2]*wt+J[6]*Dt+J[14],Ii=J[3]*wt+J[7]*Dt+J[15],Wi=ni+W,vr=Ii+de,On=Pt+Le,fn=Mt+rt,hr=ni+Fe,dr=Ii+Xe,Yr=new Pe((Pt+le)/vr,(Mt+N)/vr);Yr.z=Wi/vr,at.push(Yr);const Fr=new Pe(On/dr,fn/dr);Fr.z=hr/dr,ct.push(Fr)}se.push(at),ye.push(ct)}return[se,ye]}(d,D,P,w);return function(V,q,H){let J=1/0;ep(H,q)&&(J=gi(H,q[0]));for(let se=0;se<q.length;se++){const ye=q[se],le=V[se];for(let N=0;N<ye.length-1;N++){const W=ye[N],de=[W,ye[N+1],le[N+1],le[N],W];Nd(H,de)&&(J=Math.min(J,gi(H,de)))}}return J!==1/0&&J}(U[0],U[1],O)}}function Vi(a,t){return a.x*t.x+a.y*t.y}function gi(a,t){if(a.length===1){let n=0;const o=t[n++];let d;for(;!d||o.equals(d);)if(d=t[n++],!d)return 1/0;for(;n<t.length;n++){const g=t[n],_=a[0],w=d.sub(o),E=g.sub(o),P=_.sub(o),D=Vi(w,w),O=Vi(w,E),U=Vi(E,E),V=Vi(P,w),q=Vi(P,E),H=D*U-O*O,J=(U*V-O*q)/H,se=(D*q-O*V)/H,ye=o.z*(1-J-se)+d.z*J+g.z*se;if(isFinite(ye))return ye}return 1/0}{let n=1/0;for(const o of t)n=Math.min(n,o.z);return n}}const Ei=rr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Xi}=Ei,Ua=rr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:oc}=Ua,rh=fl.VectorTileFeature.types,yp=Math.cos(Math.PI/180*37.5),Mo=Math.pow(2,14)/.5;class Pr{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new St,this.layoutVertexArray2=new ei,this.indexArray=new xi,this.programConfigurations=new Ns(t.layers,t.zoom),this.segments=new Ti,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){this.hasPattern=Kh("line",this.layers,n);const d=this.layers[0].layout.get("line-sort-key"),g=!d.isConstant(),_=[];for(const{feature:w,id:E,index:P,sourceLayerIndex:D}of t){const O=this.layers[0]._featureFilter.needGeometry,U=ca(w,O);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),U,o))continue;const V=g?d.evaluate(U,{},o):void 0,q={id:E,properties:w.properties,type:w.type,sourceLayerIndex:D,index:P,geometry:O?U.geometry:wa(w),patterns:{},sortKey:V};_.push(q)}g&&_.sort((w,E)=>w.sortKey-E.sortKey);for(const w of _){const{geometry:E,index:P,sourceLayerIndex:D}=w;if(this.hasPattern){const O=Xd("line",this.layers,w,this.zoom,n);this.patternFeatures.push(O)}else this.addFeature(w,E,P,o,{},n.subdivisionGranularity);n.featureIndex.insert(t[P].feature,E,P,D,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}addFeatures(t,n,o){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,oc)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,o,d,g,_){const w=this.layers[0].layout,E=w.get("line-join").evaluate(t,{}),P=w.get("line-cap"),D=w.get("line-miter-limit"),O=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const U of n)this.addLine(U,t,E,P,D,O,d,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,d)}addLine(t,n,o,d,g,_,w,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=ac(t,w?E.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=rh[n.type]==="Polygon";let D=t.length;for(;D>=2&&t[D-1].equals(t[D-2]);)D--;let O=0;for(;O<D-1&&t[O].equals(t[O+1]);)O++;if(D<(P?3:2))return;o==="bevel"&&(g=1.05);const U=this.overscaling<=16?15*Ge/(512*this.overscaling):0,V=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let q,H,J,se,ye;this.e1=this.e2=-1,P&&(q=t[D-2],ye=t[O].sub(q)._unit()._perp());for(let le=O;le<D;le++){if(J=le===D-1?P?t[O+1]:void 0:t[le+1],J&&t[le].equals(J))continue;ye&&(se=ye),q&&(H=q),q=t[le],ye=J?J.sub(q)._unit()._perp():se,se=se||ye;let N=se.add(ye);N.x===0&&N.y===0||N._unit();const W=se.x*ye.x+se.y*ye.y,de=N.x*ye.x+N.y*ye.y,Le=de!==0?1/de:1/0,rt=2*Math.sqrt(2-2*de),Fe=de<yp&&H&&J,Xe=se.x*ye.y-se.y*ye.x>0;if(Fe&&le>O){const ct=q.dist(H);if(ct>2*U){const Qe=q.sub(q.sub(H)._mult(U/ct)._round());this.updateDistance(H,Qe),this.addCurrentVertex(Qe,se,0,0,V),H=Qe}}const ot=H&&J;let at=ot?o:P?"butt":d;if(ot&&at==="round"&&(Le<_?at="miter":Le<=2&&(at="fakeround")),at==="miter"&&Le>g&&(at="bevel"),at==="bevel"&&(Le>2&&(at="flipbevel"),Le<g&&(at="miter")),H&&this.updateDistance(H,q),at==="miter")N._mult(Le),this.addCurrentVertex(q,N,0,0,V);else if(at==="flipbevel"){if(Le>100)N=ye.mult(-1);else{const ct=Le*se.add(ye).mag()/se.sub(ye).mag();N._perp()._mult(ct*(Xe?-1:1))}this.addCurrentVertex(q,N,0,0,V),this.addCurrentVertex(q,N.mult(-1),0,0,V)}else if(at==="bevel"||at==="fakeround"){const ct=-Math.sqrt(Le*Le-1),Qe=Xe?ct:0,wt=Xe?0:ct;if(H&&this.addCurrentVertex(q,se,Qe,wt,V),at==="fakeround"){const Dt=Math.round(180*rt/Math.PI/20);for(let Pt=1;Pt<Dt;Pt++){let Mt=Pt/Dt;if(Mt!==.5){const Ii=Mt-.5;Mt+=Mt*Ii*(Mt-1)*((1.0904+W*(W*(3.55645-1.43519*W)-3.2452))*Ii*Ii+(.848013+W*(.215638*W-1.06021)))}const ni=ye.sub(se)._mult(Mt)._add(se)._unit()._mult(Xe?-1:1);this.addHalfVertex(q,ni.x,ni.y,!1,Xe,0,V)}}J&&this.addCurrentVertex(q,ye,-Qe,-wt,V)}else if(at==="butt")this.addCurrentVertex(q,N,0,0,V);else if(at==="square"){const ct=H?1:-1;this.addCurrentVertex(q,N,ct,ct,V)}else at==="round"&&(H&&(this.addCurrentVertex(q,se,0,0,V),this.addCurrentVertex(q,se,1,1,V,!0)),J&&(this.addCurrentVertex(q,ye,-1,-1,V,!0),this.addCurrentVertex(q,ye,0,0,V)));if(Fe&&le<D-1){const ct=q.dist(J);if(ct>2*U){const Qe=q.add(J.sub(q)._mult(U/ct)._round());this.updateDistance(q,Qe),this.addCurrentVertex(Qe,ye,0,0,V),q=Qe}}}}addCurrentVertex(t,n,o,d,g,_=!1){const w=n.y*d-n.x,E=-n.y-n.x*d;this.addHalfVertex(t,n.x+n.y*o,n.y-n.x*o,_,!1,o,g),this.addHalfVertex(t,w,E,_,!0,-d,g),this.distance>Mo/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,o,d,g,_))}addHalfVertex({x:t,y:n},o,d,g,_,w,E){const P=.5*(this.lineClips?this.scaledDistance*(Mo-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(n<<1)+(_?1:0),Math.round(63*o)+128,Math.round(63*d)+128,1+(w===0?0:w<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),E.primitiveLength++),_?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let pl,lc;yt("LineBucket",Pr,{omit:["layers","patternFeatures"]});var nf={get paint(){return lc=lc||new ur({"line-opacity":new jt(ee.paint_line["line-opacity"]),"line-color":new jt(ee.paint_line["line-color"]),"line-translate":new mt(ee.paint_line["line-translate"]),"line-translate-anchor":new mt(ee.paint_line["line-translate-anchor"]),"line-width":new jt(ee.paint_line["line-width"]),"line-gap-width":new jt(ee.paint_line["line-gap-width"]),"line-offset":new jt(ee.paint_line["line-offset"]),"line-blur":new jt(ee.paint_line["line-blur"]),"line-dasharray":new Rs(ee.paint_line["line-dasharray"]),"line-pattern":new os(ee.paint_line["line-pattern"]),"line-gradient":new Jl(ee.paint_line["line-gradient"])})},get layout(){return pl=pl||new ur({"line-cap":new mt(ee.layout_line["line-cap"]),"line-join":new jt(ee.layout_line["line-join"]),"line-miter-limit":new mt(ee.layout_line["line-miter-limit"]),"line-round-limit":new mt(ee.layout_line["line-round-limit"]),"line-sort-key":new jt(ee.layout_line["line-sort-key"])})}};class ds extends jt{possiblyEvaluate(t,n){return n=new Gi(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,o,d){return n=di({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,o,d)}}let ml;class td extends xa{constructor(t){super(t,nf),this.gradientVersion=0,ml||(ml=new ds(nf.paint.properties["line-width"].specification),ml.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(o){return o._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof lo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=ml.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Pr(t)}queryRadius(t){const n=t,o=ha(Hu("line-width",this,n),Hu("line-gap-width",this,n)),d=Hu("line-offset",this,n);return o/2+Math.abs(d)+Yh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:g,pixelsToTileUnits:_}){const w=Zd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-g.bearingInRadians,_),E=_/2*ha(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),P=this.paint.get("line-offset").evaluate(n,o);return P&&(d=function(D,O){const U=[];for(let V=0;V<D.length;V++){const q=D[V],H=[];for(let J=0;J<q.length;J++){const se=q[J-1],ye=q[J],le=q[J+1],N=J===0?new Pe(0,0):ye.sub(se)._unit()._perp(),W=J===q.length-1?new Pe(0,0):le.sub(ye)._unit()._perp(),de=N._add(W)._unit(),Le=de.x*W.x+de.y*W.y;Le!==0&&de._mult(1/Le),H.push(de._mult(O)._add(ye))}U.push(H)}return U}(d,P*_)),function(D,O,U){for(let V=0;V<O.length;V++){const q=O[V];if(D.length>=3){for(let H=0;H<q.length;H++)if(ic(D,q[H]))return!0}if(Yc(D,q,U))return!0}return!1}(w,d,E)}isTileClipped(){return!0}}function ha(a,t){return t>0?t+2*a:a}const vp=rr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bp=rr([{name:"a_projected_pos",components:3,type:"Float32"}],4);rr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const af=rr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);rr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const id=rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cc=rr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ln(a,t,n){return a.sections.forEach(o=>{o.text=function(d,g,_){const w=g.layout.get("text-transform").evaluate(_,{});return w==="uppercase"?d=d.toLocaleUpperCase():w==="lowercase"&&(d=d.toLocaleLowerCase()),as.applyArabicShaping&&(d=as.applyArabicShaping(d)),d}(o.text,t,n)}),a}rr([{name:"triangle",components:3,type:"Uint16"}]),rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),rr([{type:"Float32",name:"offsetX"}]),rr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),rr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const fs={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Wc,uc,sf,jr=24,of={};function rd(){return Wc||(Wc=1,of.read=function(a,t,n,o,d){var g,_,w=8*d-o-1,E=(1<<w)-1,P=E>>1,D=-7,O=n?d-1:0,U=n?-1:1,V=a[t+O];for(O+=U,g=V&(1<<-D)-1,V>>=-D,D+=w;D>0;g=256*g+a[t+O],O+=U,D-=8);for(_=g&(1<<-D)-1,g>>=-D,D+=o;D>0;_=256*_+a[t+O],O+=U,D-=8);if(g===0)g=1-P;else{if(g===E)return _?NaN:1/0*(V?-1:1);_+=Math.pow(2,o),g-=P}return(V?-1:1)*_*Math.pow(2,g-o)},of.write=function(a,t,n,o,d,g){var _,w,E,P=8*g-d-1,D=(1<<P)-1,O=D>>1,U=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=o?0:g-1,q=o?1:-1,H=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(w=isNaN(t)?1:0,_=D):(_=Math.floor(Math.log(t)/Math.LN2),t*(E=Math.pow(2,-_))<1&&(_--,E*=2),(t+=_+O>=1?U/E:U*Math.pow(2,1-O))*E>=2&&(_++,E/=2),_+O>=D?(w=0,_=D):_+O>=1?(w=(t*E-1)*Math.pow(2,d),_+=O):(w=t*Math.pow(2,O-1)*Math.pow(2,d),_=0));d>=8;a[n+V]=255&w,V+=q,w/=256,d-=8);for(_=_<<d|w,P+=d;P>0;a[n+V]=255&_,V+=q,_/=256,P-=8);a[n+V-q]|=128*H}),of}function lf(){if(sf)return uc;sf=1,uc=t;var a=rd();function t(N){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(N)?N:new Uint8Array(N||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var n=4294967296,o=1/n,d=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function g(N){return N.type===t.Bytes?N.readVarint()+N.pos:N.pos+1}function _(N,W,de){return de?4294967296*W+(N>>>0):4294967296*(W>>>0)+(N>>>0)}function w(N,W,de){var Le=W<=16383?1:W<=2097151?2:W<=268435455?3:Math.floor(Math.log(W)/(7*Math.LN2));de.realloc(Le);for(var rt=de.pos-1;rt>=N;rt--)de.buf[rt+Le]=de.buf[rt]}function E(N,W){for(var de=0;de<N.length;de++)W.writeVarint(N[de])}function P(N,W){for(var de=0;de<N.length;de++)W.writeSVarint(N[de])}function D(N,W){for(var de=0;de<N.length;de++)W.writeFloat(N[de])}function O(N,W){for(var de=0;de<N.length;de++)W.writeDouble(N[de])}function U(N,W){for(var de=0;de<N.length;de++)W.writeBoolean(N[de])}function V(N,W){for(var de=0;de<N.length;de++)W.writeFixed32(N[de])}function q(N,W){for(var de=0;de<N.length;de++)W.writeSFixed32(N[de])}function H(N,W){for(var de=0;de<N.length;de++)W.writeFixed64(N[de])}function J(N,W){for(var de=0;de<N.length;de++)W.writeSFixed64(N[de])}function se(N,W){return(N[W]|N[W+1]<<8|N[W+2]<<16)+16777216*N[W+3]}function ye(N,W,de){N[de]=W,N[de+1]=W>>>8,N[de+2]=W>>>16,N[de+3]=W>>>24}function le(N,W){return(N[W]|N[W+1]<<8|N[W+2]<<16)+(N[W+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(N,W,de){for(de=de||this.length;this.pos<de;){var Le=this.readVarint(),rt=Le>>3,Fe=this.pos;this.type=7&Le,N(rt,W,this),this.pos===Fe&&this.skip(Le)}return W},readMessage:function(N,W){return this.readFields(N,W,this.readVarint()+this.pos)},readFixed32:function(){var N=se(this.buf,this.pos);return this.pos+=4,N},readSFixed32:function(){var N=le(this.buf,this.pos);return this.pos+=4,N},readFixed64:function(){var N=se(this.buf,this.pos)+se(this.buf,this.pos+4)*n;return this.pos+=8,N},readSFixed64:function(){var N=se(this.buf,this.pos)+le(this.buf,this.pos+4)*n;return this.pos+=8,N},readFloat:function(){var N=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,N},readDouble:function(){var N=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,N},readVarint:function(N){var W,de,Le=this.buf;return W=127&(de=Le[this.pos++]),de<128?W:(W|=(127&(de=Le[this.pos++]))<<7,de<128?W:(W|=(127&(de=Le[this.pos++]))<<14,de<128?W:(W|=(127&(de=Le[this.pos++]))<<21,de<128?W:function(rt,Fe,Xe){var ot,at,ct=Xe.buf;if(ot=(112&(at=ct[Xe.pos++]))>>4,at<128||(ot|=(127&(at=ct[Xe.pos++]))<<3,at<128)||(ot|=(127&(at=ct[Xe.pos++]))<<10,at<128)||(ot|=(127&(at=ct[Xe.pos++]))<<17,at<128)||(ot|=(127&(at=ct[Xe.pos++]))<<24,at<128)||(ot|=(1&(at=ct[Xe.pos++]))<<31,at<128))return _(rt,ot,Fe);throw new Error("Expected varint not more than 10 bytes")}(W|=(15&(de=Le[this.pos]))<<28,N,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var N=this.readVarint();return N%2==1?(N+1)/-2:N/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var N=this.readVarint()+this.pos,W=this.pos;return this.pos=N,N-W>=12&&d?function(de,Le,rt){return d.decode(de.subarray(Le,rt))}(this.buf,W,N):function(de,Le,rt){for(var Fe="",Xe=Le;Xe<rt;){var ot,at,ct,Qe=de[Xe],wt=null,Dt=Qe>239?4:Qe>223?3:Qe>191?2:1;if(Xe+Dt>rt)break;Dt===1?Qe<128&&(wt=Qe):Dt===2?(192&(ot=de[Xe+1]))==128&&(wt=(31&Qe)<<6|63&ot)<=127&&(wt=null):Dt===3?(at=de[Xe+2],(192&(ot=de[Xe+1]))==128&&(192&at)==128&&((wt=(15&Qe)<<12|(63&ot)<<6|63&at)<=2047||wt>=55296&&wt<=57343)&&(wt=null)):Dt===4&&(at=de[Xe+2],ct=de[Xe+3],(192&(ot=de[Xe+1]))==128&&(192&at)==128&&(192&ct)==128&&((wt=(15&Qe)<<18|(63&ot)<<12|(63&at)<<6|63&ct)<=65535||wt>=1114112)&&(wt=null)),wt===null?(wt=65533,Dt=1):wt>65535&&(wt-=65536,Fe+=String.fromCharCode(wt>>>10&1023|55296),wt=56320|1023&wt),Fe+=String.fromCharCode(wt),Xe+=Dt}return Fe}(this.buf,W,N)},readBytes:function(){var N=this.readVarint()+this.pos,W=this.buf.subarray(this.pos,N);return this.pos=N,W},readPackedVarint:function(N,W){if(this.type!==t.Bytes)return N.push(this.readVarint(W));var de=g(this);for(N=N||[];this.pos<de;)N.push(this.readVarint(W));return N},readPackedSVarint:function(N){if(this.type!==t.Bytes)return N.push(this.readSVarint());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readSVarint());return N},readPackedBoolean:function(N){if(this.type!==t.Bytes)return N.push(this.readBoolean());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readBoolean());return N},readPackedFloat:function(N){if(this.type!==t.Bytes)return N.push(this.readFloat());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readFloat());return N},readPackedDouble:function(N){if(this.type!==t.Bytes)return N.push(this.readDouble());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readDouble());return N},readPackedFixed32:function(N){if(this.type!==t.Bytes)return N.push(this.readFixed32());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readFixed32());return N},readPackedSFixed32:function(N){if(this.type!==t.Bytes)return N.push(this.readSFixed32());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readSFixed32());return N},readPackedFixed64:function(N){if(this.type!==t.Bytes)return N.push(this.readFixed64());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readFixed64());return N},readPackedSFixed64:function(N){if(this.type!==t.Bytes)return N.push(this.readSFixed64());var W=g(this);for(N=N||[];this.pos<W;)N.push(this.readSFixed64());return N},skip:function(N){var W=7&N;if(W===t.Varint)for(;this.buf[this.pos++]>127;);else if(W===t.Bytes)this.pos=this.readVarint()+this.pos;else if(W===t.Fixed32)this.pos+=4;else{if(W!==t.Fixed64)throw new Error("Unimplemented type: "+W);this.pos+=8}},writeTag:function(N,W){this.writeVarint(N<<3|W)},realloc:function(N){for(var W=this.length||16;W<this.pos+N;)W*=2;if(W!==this.length){var de=new Uint8Array(W);de.set(this.buf),this.buf=de,this.length=W}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(N){this.realloc(4),ye(this.buf,N,this.pos),this.pos+=4},writeSFixed32:function(N){this.realloc(4),ye(this.buf,N,this.pos),this.pos+=4},writeFixed64:function(N){this.realloc(8),ye(this.buf,-1&N,this.pos),ye(this.buf,Math.floor(N*o),this.pos+4),this.pos+=8},writeSFixed64:function(N){this.realloc(8),ye(this.buf,-1&N,this.pos),ye(this.buf,Math.floor(N*o),this.pos+4),this.pos+=8},writeVarint:function(N){(N=+N||0)>268435455||N<0?function(W,de){var Le,rt;if(W>=0?(Le=W%4294967296|0,rt=W/4294967296|0):(rt=~(-W/4294967296),4294967295^(Le=~(-W%4294967296))?Le=Le+1|0:(Le=0,rt=rt+1|0)),W>=18446744073709552e3||W<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");de.realloc(10),function(Fe,Xe,ot){ot.buf[ot.pos++]=127&Fe|128,Fe>>>=7,ot.buf[ot.pos++]=127&Fe|128,Fe>>>=7,ot.buf[ot.pos++]=127&Fe|128,Fe>>>=7,ot.buf[ot.pos++]=127&Fe|128,ot.buf[ot.pos]=127&(Fe>>>=7)}(Le,0,de),function(Fe,Xe){var ot=(7&Fe)<<4;Xe.buf[Xe.pos++]|=ot|((Fe>>>=3)?128:0),Fe&&(Xe.buf[Xe.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Xe.buf[Xe.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Xe.buf[Xe.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Xe.buf[Xe.pos++]=127&Fe|((Fe>>>=7)?128:0),Fe&&(Xe.buf[Xe.pos++]=127&Fe)))))}(rt,de)}(N,this):(this.realloc(4),this.buf[this.pos++]=127&N|(N>127?128:0),N<=127||(this.buf[this.pos++]=127&(N>>>=7)|(N>127?128:0),N<=127||(this.buf[this.pos++]=127&(N>>>=7)|(N>127?128:0),N<=127||(this.buf[this.pos++]=N>>>7&127))))},writeSVarint:function(N){this.writeVarint(N<0?2*-N-1:2*N)},writeBoolean:function(N){this.writeVarint(!!N)},writeString:function(N){N=String(N),this.realloc(4*N.length),this.pos++;var W=this.pos;this.pos=function(Le,rt,Fe){for(var Xe,ot,at=0;at<rt.length;at++){if((Xe=rt.charCodeAt(at))>55295&&Xe<57344){if(!ot){Xe>56319||at+1===rt.length?(Le[Fe++]=239,Le[Fe++]=191,Le[Fe++]=189):ot=Xe;continue}if(Xe<56320){Le[Fe++]=239,Le[Fe++]=191,Le[Fe++]=189,ot=Xe;continue}Xe=ot-55296<<10|Xe-56320|65536,ot=null}else ot&&(Le[Fe++]=239,Le[Fe++]=191,Le[Fe++]=189,ot=null);Xe<128?Le[Fe++]=Xe:(Xe<2048?Le[Fe++]=Xe>>6|192:(Xe<65536?Le[Fe++]=Xe>>12|224:(Le[Fe++]=Xe>>18|240,Le[Fe++]=Xe>>12&63|128),Le[Fe++]=Xe>>6&63|128),Le[Fe++]=63&Xe|128)}return Fe}(this.buf,N,this.pos);var de=this.pos-W;de>=128&&w(W,de,this),this.pos=W-1,this.writeVarint(de),this.pos+=de},writeFloat:function(N){this.realloc(4),a.write(this.buf,N,this.pos,!0,23,4),this.pos+=4},writeDouble:function(N){this.realloc(8),a.write(this.buf,N,this.pos,!0,52,8),this.pos+=8},writeBytes:function(N){var W=N.length;this.writeVarint(W),this.realloc(W);for(var de=0;de<W;de++)this.buf[this.pos++]=N[de]},writeRawMessage:function(N,W){this.pos++;var de=this.pos;N(W,this);var Le=this.pos-de;Le>=128&&w(de,Le,this),this.pos=de-1,this.writeVarint(Le),this.pos+=Le},writeMessage:function(N,W,de){this.writeTag(N,t.Bytes),this.writeRawMessage(W,de)},writePackedVarint:function(N,W){W.length&&this.writeMessage(N,E,W)},writePackedSVarint:function(N,W){W.length&&this.writeMessage(N,P,W)},writePackedBoolean:function(N,W){W.length&&this.writeMessage(N,U,W)},writePackedFloat:function(N,W){W.length&&this.writeMessage(N,D,W)},writePackedDouble:function(N,W){W.length&&this.writeMessage(N,O,W)},writePackedFixed32:function(N,W){W.length&&this.writeMessage(N,V,W)},writePackedSFixed32:function(N,W){W.length&&this.writeMessage(N,q,W)},writePackedFixed64:function(N,W){W.length&&this.writeMessage(N,H,W)},writePackedSFixed64:function(N,W){W.length&&this.writeMessage(N,J,W)},writeBytesField:function(N,W){this.writeTag(N,t.Bytes),this.writeBytes(W)},writeFixed32Field:function(N,W){this.writeTag(N,t.Fixed32),this.writeFixed32(W)},writeSFixed32Field:function(N,W){this.writeTag(N,t.Fixed32),this.writeSFixed32(W)},writeFixed64Field:function(N,W){this.writeTag(N,t.Fixed64),this.writeFixed64(W)},writeSFixed64Field:function(N,W){this.writeTag(N,t.Fixed64),this.writeSFixed64(W)},writeVarintField:function(N,W){this.writeTag(N,t.Varint),this.writeVarint(W)},writeSVarintField:function(N,W){this.writeTag(N,t.Varint),this.writeSVarint(W)},writeStringField:function(N,W){this.writeTag(N,t.Bytes),this.writeString(W)},writeFloatField:function(N,W){this.writeTag(N,t.Fixed32),this.writeFloat(W)},writeDoubleField:function(N,W){this.writeTag(N,t.Fixed64),this.writeDouble(W)},writeBooleanField:function(N,W){this.writeVarintField(N,!!W)}},uc}var da=oe(lf());const cf=3;function Na(a,t,n){a===1&&n.readMessage(Cm,t)}function Cm(a,t,n){if(a===3){const{id:o,bitmap:d,width:g,height:_,left:w,top:E,advance:P}=n.readMessage(Am,{});t.push({id:o,bitmap:new Yu({width:g+2*cf,height:_+2*cf},d),metrics:{width:g,height:_,left:w,top:E,advance:P}})}}function Am(a,t,n){a===1?t.id=n.readVarint():a===2?t.bitmap=n.readBytes():a===3?t.width=n.readVarint():a===4?t.height=n.readVarint():a===5?t.left=n.readSVarint():a===6?t.top=n.readSVarint():a===7&&(t.advance=n.readVarint())}const gg=cf;function gl(a){let t=0,n=0;for(const _ of a)t+=_.w*_.h,n=Math.max(n,_.w);a.sort((_,w)=>w.h-_.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let d=0,g=0;for(const _ of a)for(let w=o.length-1;w>=0;w--){const E=o[w];if(!(_.w>E.w||_.h>E.h)){if(_.x=E.x,_.y=E.y,g=Math.max(g,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===E.w&&_.h===E.h){const P=o.pop();w<o.length&&(o[w]=P)}else _.h===E.h?(E.x+=_.w,E.w-=_.w):_.w===E.w?(E.y+=_.h,E.h-=_.h):(o.push({x:E.x+_.w,y:E.y,w:E.w-_.w,h:_.h}),E.y+=_.h,E.h-=_.h);break}}return{w:d,h:g,fill:t/(d*g)||0}}const En=1;class nd{constructor(t,{pixelRatio:n,version:o,stretchX:d,stretchY:g,content:_,textFitWidth:w,textFitHeight:E}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=d,this.stretchY=g,this.content=_,this.version=o,this.textFitWidth=w,this.textFitHeight=E}get tl(){return[this.paddedRect.x+En,this.paddedRect.y+En]}get br(){return[this.paddedRect.x+this.paddedRect.w-En,this.paddedRect.y+this.paddedRect.h-En]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*En)/this.pixelRatio,(this.paddedRect.h-2*En)/this.pixelRatio]}}class Jc{constructor(t,n){const o={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,o,g),this.addImages(n,d,g);const{w:_,h:w}=gl(g),E=new Ta({width:_||1,height:w||1});for(const P in t){const D=t[P],O=o[P].paddedRect;Ta.copy(D.data,E,{x:0,y:0},{x:O.x+En,y:O.y+En},D.data)}for(const P in n){const D=n[P],O=d[P].paddedRect,U=O.x+En,V=O.y+En,q=D.data.width,H=D.data.height;Ta.copy(D.data,E,{x:0,y:0},{x:U,y:V},D.data),Ta.copy(D.data,E,{x:0,y:H-1},{x:U,y:V-1},{width:q,height:1}),Ta.copy(D.data,E,{x:0,y:0},{x:U,y:V+H},{width:q,height:1}),Ta.copy(D.data,E,{x:q-1,y:0},{x:U-1,y:V},{width:1,height:H}),Ta.copy(D.data,E,{x:0,y:0},{x:U+q,y:V},{width:1,height:H})}this.image=E,this.iconPositions=o,this.patternPositions=d}addImages(t,n,o){for(const d in t){const g=t[d],_={x:0,y:0,w:g.data.width+2*En,h:g.data.height+2*En};o.push(_),n[d]=new nd(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in t.updatedImages)this.patchUpdatedImage(this.iconPositions[o],t.getImage(o),n),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o),n)}patchUpdatedImage(t,n,o){if(!t||!n||t.version===n.version)return;t.version=n.version;const[d,g]=t.tl;o.update(n.data,void 0,{x:d,y:g})}}var _l;yt("ImagePosition",nd),yt("ImageAtlas",Jc),z.al=void 0,(_l=z.al||(z.al={}))[_l.none=0]="none",_l[_l.horizontal=1]="horizontal",_l[_l.vertical=2]="vertical",_l[_l.horizontalOnly=3]="horizontalOnly";const ad=-17;class nh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,o){const d=new nh;return d.scale=t||1,d.fontStack=n,d.verticalAlign=o||"bottom",d}static forImage(t,n){const o=new nh;return o.imageName=t,o.verticalAlign=n||"bottom",o}}class hc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const o=new hc;for(let d=0;d<t.sections.length;d++){const g=t.sections[d];g.image?o.addImageSection(g):o.addTextSection(g,n)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let o=0;o<t.length;o++){const d=t.charCodeAt(o+1)||null,g=t.charCodeAt(o-1)||null;n+=d&&Ds(d)&&!fs[t[o+1]]||g&&Ds(g)&&!fs[t[o-1]]||!fs[t[o]]?t[o]:fs[t[o]]}return n}(this.text)}trim(){let t=0;for(let o=0;o<this.text.length&&uf[this.text.charCodeAt(o)];o++)t++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&uf[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const o=new hc;return o.text=this.text.substring(t,n),o.sectionIndex=this.sectionIndex.slice(t,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}getMaxImageSize(t){let n=0,o=0;for(let d=0;d<this.length();d++){const g=this.getSection(d);if(g.imageName){const _=t[g.imageName];if(!_)continue;const w=_.displaySize;n=Math.max(n,w[0]),o=Math.max(o,w[1])}}return{maxImageWidth:n,maxImageHeight:o}}addTextSection(t,n){this.text+=t.text,this.sections.push(nh.forText(t.scale,t.fontStack||n,t.verticalAlign));const o=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(o)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void tr("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(nh.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):tr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ah(a,t,n,o,d,g,_,w,E,P,D,O,U,V,q){const H=hc.fromFeature(a,d);let J;O===z.al.vertical&&H.verticalizePunctuation();const{processBidirectionalText:se,processStyledBidirectionalText:ye}=as;if(se&&H.sections.length===1){J=[];const W=se(H.toString(),hf(H,P,g,t,o,V));for(const de of W){const Le=new hc;Le.text=de,Le.sections=H.sections;for(let rt=0;rt<de.length;rt++)Le.sectionIndex.push(0);J.push(Le)}}else if(ye){J=[];const W=ye(H.text,H.sectionIndex,hf(H,P,g,t,o,V));for(const de of W){const Le=new hc;Le.text=de[0],Le.sectionIndex=de[1],Le.sections=H.sections,J.push(Le)}}else J=function(W,de){const Le=[],rt=W.text;let Fe=0;for(const Xe of de)Le.push(W.substring(Fe,Xe)),Fe=Xe;return Fe<rt.length&&Le.push(W.substring(Fe,rt.length)),Le}(H,hf(H,P,g,t,o,V));const le=[],N={positionedLines:le,text:H.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:O,iconsInText:!1,verticalizable:!1};return function(W,de,Le,rt,Fe,Xe,ot,at,ct,Qe,wt,Dt){let Pt=0,Mt=0,ni=0,Ii=0;const Wi=at==="right"?1:at==="left"?0:.5,vr=jr/Dt;let On=0;for(const dr of Fe){dr.trim();const Yr=dr.getMaxScale(),Fr={positionedGlyphs:[],lineOffset:0};W.positionedLines[On]=Fr;const pn=Fr.positionedGlyphs;let Bn=0;if(!dr.length()){Mt+=Xe,++On;continue}const Xn=zm(rt,dr,vr);for(let fa=0;fa<dr.length();fa++){const Ir=dr.getSection(fa),Ur=dr.getSectionIndex(fa),Kr=dr.getCharCode(fa),fr=Pm(ct,wt,Kr);let Zi;if(Ir.imageName){if(W.iconsInText=!0,Ir.scale=Ir.scale*vr,Zi=Im(Ir,fr,Yr,Xn,rt),!Zi)continue;Bn=Math.max(Bn,Zi.imageOffset)}else if(Zi=ff(Ir,Kr,fr,Xn,de,Le),!Zi)continue;const{rect:Ma,metrics:ou,baselineOffset:Hs}=Zi;pn.push({glyph:Kr,imageName:Ir.imageName,x:Pt,y:Mt+Hs+ad,vertical:fr,scale:Ir.scale,fontStack:Ir.fontStack,sectionIndex:Ur,metrics:ou,rect:Ma}),fr?(W.verticalizable=!0,Pt+=(Ir.imageName?ou.advance:jr)*Ir.scale+Qe):Pt+=ou.advance*Ir.scale+Qe}pn.length!==0&&(ni=Math.max(Pt-Qe,ni),Dm(pn,0,pn.length-1,Wi)),Pt=0,Fr.lineOffset=Math.max(Bn,(Yr-1)*jr);const Qr=Xe*Yr+Bn;Mt+=Qr,Ii=Math.max(Qr,Ii),++On}const{horizontalAlign:fn,verticalAlign:hr}=df(ot);(function(dr,Yr,Fr,pn,Bn,Xn,Qr,fa,Ir){const Ur=(Yr-Fr)*Bn;let Kr=0;Kr=Xn!==Qr?-fa*pn-ad:-pn*Ir*Qr+.5*Qr;for(const fr of dr)for(const Zi of fr.positionedGlyphs)Zi.x+=Ur,Zi.y+=Kr})(W.positionedLines,Wi,fn,hr,ni,Ii,Xe,Mt,Fe.length),W.top+=-hr*Mt,W.bottom=W.top+Mt,W.left+=-fn*ni,W.right=W.left+ni}(N,t,n,o,J,_,w,E,O,P,U,q),!function(W){for(const de of W)if(de.positionedGlyphs.length!==0)return!1;return!0}(le)&&N}const uf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_g={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},yg={40:!0};function xp(a,t,n,o,d,g){if(t.imageName){const _=o[t.imageName];return _?_.displaySize[0]*t.scale*jr/g+d:0}{const _=n[t.fontStack],w=_&&_[a];return w?w.metrics.advance*t.scale+d:0}}function wp(a,t,n,o){const d=Math.pow(a-t,2);return o?a<t?d/2:2*d:d+Math.abs(n)*n}function sh(a,t,n){let o=0;return a===10&&(o-=1e4),n&&(o+=150),a!==40&&a!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function sd(a,t,n,o,d,g){let _=null,w=wp(t,n,d,g);for(const E of o){const P=wp(t-E.x,n,d,g)+E.badness;P<=w&&(_=E,w=P)}return{index:a,x:t,priorBreak:_,badness:w}}function Tp(a){return a?Tp(a.priorBreak).concat(a.index):[]}function hf(a,t,n,o,d,g){if(!a)return[];const _=[],w=function(O,U,V,q,H,J){let se=0;for(let ye=0;ye<O.length();ye++){const le=O.getSection(ye);se+=xp(O.getCharCode(ye),le,q,H,U,J)}return se/Math.max(1,Math.ceil(se/V))}(a,t,n,o,d,g),E=a.text.indexOf("")>=0;let P=0;for(let O=0;O<a.length();O++){const U=a.getSection(O),V=a.getCharCode(O);if(uf[V]||(P+=xp(V,U,o,d,t,g)),O<a.length()-1){const q=!((D=V)<11904)&&(!!ii["CJK Compatibility Forms"](D)||!!ii["CJK Compatibility"](D)||!!ii["CJK Strokes"](D)||!!ii["CJK Symbols and Punctuation"](D)||!!ii["Enclosed CJK Letters and Months"](D)||!!ii["Halfwidth and Fullwidth Forms"](D)||!!ii["Ideographic Description Characters"](D)||!!ii["Vertical Forms"](D)||ns.test(String.fromCodePoint(D)));(_g[V]||q||U.imageName||O!==a.length()-2&&yg[a.getCharCode(O+1)])&&_.push(sd(O+1,P,w,_,sh(V,a.getCharCode(O+1),q&&E),!1))}}var D;return Tp(sd(a.length(),P,w,_,0,!0))}function df(a){let t=.5,n=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function zm(a,t,n){const o=t.getMaxScale()*jr,{maxImageWidth:d,maxImageHeight:g}=t.getMaxImageSize(a),_=Math.max(o,g*n);return{verticalLineContentWidth:Math.max(o,d*n),horizontalLineContentHeight:_}}function Sp(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function Pm(a,t,n){return!(a===z.al.horizontal||!t&&!Oa(n)||t&&(uf[n]||(o=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function ff(a,t,n,o,d,g){const _=g[a.fontStack],w=function(P,D,O,U){if(P&&P.rect)return P;const V=D[O.fontStack],q=V&&V[U];return q?{rect:null,metrics:q.metrics}:null}(_&&_[t],d,a,t);if(w===null)return null;let E;if(n)E=o.verticalLineContentWidth-a.scale*jr;else{const P=Sp(a.verticalAlign);E=(o.horizontalLineContentHeight-a.scale*jr)*P}return{rect:w.rect,metrics:w.metrics,baselineOffset:E}}function Im(a,t,n,o,d){const g=d[a.imageName];if(!g)return null;const _=g.paddedRect,w=g.displaySize,E={width:w[0],height:w[1],left:En,top:-3,advance:t?w[1]:w[0]};let P;if(t)P=o.verticalLineContentWidth-w[1]*a.scale;else{const D=Sp(a.verticalAlign);P=(o.horizontalLineContentHeight-w[1]*a.scale)*D}return{rect:_,metrics:E,baselineOffset:P,imageOffset:(t?w[0]:w[1])*a.scale-jr*n}}function Dm(a,t,n,o){if(o===0)return;const d=a[n],g=(a[n].x+d.metrics.advance*d.scale)*o;for(let _=t;_<=n;_++)a[_].x-=g}function or(a,t,n){const{horizontalAlign:o,verticalAlign:d}=df(n),g=t[0]-a.displaySize[0]*o,_=t[1]-a.displaySize[1]*d;return{image:a,top:_,bottom:_+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function pf(a){var t,n;let o=a.left,d=a.top,g=a.right-o,_=a.bottom-d;const w=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",E=(n=a.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",P=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(E==="proportional"){if(w==="stretchOnly"&&g/_<P||w==="proportional"){const D=Math.ceil(_*P);o*=D/g,g=D}}else if(w==="proportional"&&E==="stretchOnly"&&P!==0&&g/_>P){const D=Math.ceil(g/P);d*=D/_,_=D}return{x1:o,y1:d,x2:o+g,y2:d+_}}function Rm(a,t,n,o,d,g){const _=a.image;let w;if(_.content){const J=_.content,se=_.pixelRatio||1;w=[J[0]/se,J[1]/se,_.displaySize[0]-J[2]/se,_.displaySize[1]-J[3]/se]}const E=t.left*g,P=t.right*g;let D,O,U,V;n==="width"||n==="both"?(V=d[0]+E-o[3],O=d[0]+P+o[1]):(V=d[0]+(E+P-_.displaySize[0])/2,O=V+_.displaySize[0]);const q=t.top*g,H=t.bottom*g;return n==="height"||n==="both"?(D=d[1]+q-o[0],U=d[1]+H+o[2]):(D=d[1]+(q+H-_.displaySize[1])/2,U=D+_.displaySize[1]),{image:_,top:D,right:O,bottom:U,left:V,collisionPadding:w}}const oh=255,Eo=128,dc=oh*Eo;function km(a,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Gi(a+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:d}=n;let g=0;for(;g<o.length&&o[g]<=a;)g++;g=Math.max(0,g-1);let _=g;for(;_<o.length&&o[_]<a+1;)_++;_=Math.min(o.length-1,_);const w=o[g],E=o[_];return n.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:E,interpolationType:d}:{kind:"camera",minZoom:w,maxZoom:E,minSize:n.evaluate(new Gi(w)),maxSize:n.evaluate(new Gi(E)),interpolationType:d}}}function lh(a,t,n){let o="never";const d=a.get(t);return d?o=d:a.get(n)&&(o="always"),o}const ch=fl.VectorTileFeature.types,Mp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function eu(a,t,n,o,d,g,_,w,E,P,D,O,U){const V=w?Math.min(dc,Math.round(w[0])):0,q=w?Math.min(dc,Math.round(w[1])):0;a.emplaceBack(t,n,Math.round(32*o),Math.round(32*d),g,_,(V<<1)+(E?1:0),q,16*P,16*D,256*O,256*U)}function od(a,t,n){a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n)}function tu(a){for(const t of a.sections)if(qc(t.text))return!0;return!1}class ps{constructor(t){this.layoutVertexArray=new ar,this.indexArray=new xi,this.programConfigurations=t,this.segments=new Ti,this.dynamicLayoutVertexArray=new ki,this.opacityVertexArray=new sr,this.hasVisibleVertices=!1,this.placedSymbolArray=new pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,o,d){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,bp.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Mp,!0),this.opacityVertexBuffer.itemSize=1),(o||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}yt("SymbolBuffers",ps);class iu{constructor(t,n,o){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new o,this.segments=new Ti,this.collisionVertexArray=new Ni}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,af.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}yt("CollisionBuffers",iu);class uh{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=km(this.zoom,n["text-size"]),this.iconSizeData=km(this.zoom,n["icon-size"]);const o=this.layers[0].layout,d=o.get("symbol-sort-key"),g=o.get("symbol-z-order");this.canOverlap=lh(o,"text-overlap","text-allow-overlap")!=="never"||lh(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map(_=>z.al[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new ps(new Ns(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new ps(new Ns(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new xe,this.lineVertexArray=new _e,this.symbolInstances=new ge,this.textAnchorOffsets=new Ye}calculateGlyphDependencies(t,n,o,d,g){for(let _=0;_<t.length;_++)if(n[t.charCodeAt(_)]=!0,(o||d)&&g){const w=fs[t.charAt(_)];w&&(n[w.charCodeAt(0)]=!0)}}populate(t,n,o){const d=this.layers[0],g=d.layout,_=g.get("text-font"),w=g.get("text-field"),E=g.get("icon-image"),P=(w.value.kind!=="constant"||w.value.value instanceof Gr&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),D=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,O=g.get("symbol-sort-key");if(this.features=[],!P&&!D)return;const U=n.iconDependencies,V=n.glyphDependencies,q=n.availableImages,H=new Gi(this.zoom);for(const{feature:J,id:se,index:ye,sourceLayerIndex:le}of t){const N=d._featureFilter.needGeometry,W=ca(J,N);if(!d._featureFilter.filter(H,W,o))continue;let de,Le;if(N||(W.geometry=wa(J)),P){const Fe=d.getValueAndResolveTokens("text-field",W,o,q),Xe=Gr.factory(Fe),ot=this.hasRTLText=this.hasRTLText||tu(Xe);(!ot||as.getRTLTextPluginStatus()==="unavailable"||ot&&as.isParsed())&&(de=Ln(Xe,d,W))}if(D){const Fe=d.getValueAndResolveTokens("icon-image",W,o,q);Le=Fe instanceof Pn?Fe:Pn.fromString(Fe)}if(!de&&!Le)continue;const rt=this.sortFeaturesByKey?O.evaluate(W,{},o):void 0;if(this.features.push({id:se,text:de,icon:Le,index:ye,sourceLayerIndex:le,geometry:W.geometry,properties:J.properties,type:ch[J.type],sortKey:rt}),Le&&(U[Le.name]=!0),de){const Fe=_.evaluate(W,{},o).join(","),Xe=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(z.al.vertical)>=0;for(const ot of de.sections)if(ot.image)U[ot.image.name]=!0;else{const at=Vc(de.toString()),ct=ot.fontStack||Fe,Qe=V[ct]=V[ct]||{};this.calculateGlyphDependencies(ot.text,Qe,Xe,this.allowVerticalPlacement,at)}}}g.get("symbol-placement")==="line"&&(this.features=function(J){const se={},ye={},le=[];let N=0;function W(Fe){le.push(J[Fe]),N++}function de(Fe,Xe,ot){const at=ye[Fe];return delete ye[Fe],ye[Xe]=at,le[at].geometry[0].pop(),le[at].geometry[0]=le[at].geometry[0].concat(ot[0]),at}function Le(Fe,Xe,ot){const at=se[Xe];return delete se[Xe],se[Fe]=at,le[at].geometry[0].shift(),le[at].geometry[0]=ot[0].concat(le[at].geometry[0]),at}function rt(Fe,Xe,ot){const at=ot?Xe[0][Xe[0].length-1]:Xe[0][0];return`${Fe}:${at.x}:${at.y}`}for(let Fe=0;Fe<J.length;Fe++){const Xe=J[Fe],ot=Xe.geometry,at=Xe.text?Xe.text.toString():null;if(!at){W(Fe);continue}const ct=rt(at,ot),Qe=rt(at,ot,!0);if(ct in ye&&Qe in se&&ye[ct]!==se[Qe]){const wt=Le(ct,Qe,ot),Dt=de(ct,Qe,le[wt].geometry);delete se[ct],delete ye[Qe],ye[rt(at,le[Dt].geometry,!0)]=Dt,le[wt].geometry=null}else ct in ye?de(ct,Qe,ot):Qe in se?Le(ct,Qe,ot):(W(Fe),se[ct]=N-1,ye[Qe]=N-1)}return le.filter(Fe=>Fe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,se)=>J.sortKey-se.sortKey)}update(t,n,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,o),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,o))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const o=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(n[t.segment+1]),g=t.dist(n[t.segment]);const _={};for(let w=t.segment+1;w<n.length;w++)_[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:d},w<n.length-1&&(d+=n[w+1].dist(n[w]));for(let w=t.segment||0;w>=0;w--)_[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:g},w>0&&(g+=n[w-1].dist(n[w]));for(let w=0;w<n.length;w++){const E=_[w];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,n,o,d,g,_,w,E,P,D,O,U){const V=t.indexArray,q=t.layoutVertexArray,H=t.segments.prepareSegment(4*n.length,q,V,this.canOverlap?_.sortKey:void 0),J=this.glyphOffsetArray.length,se=H.vertexLength,ye=this.allowVerticalPlacement&&w===z.al.vertical?Math.PI/2:0,le=_.text&&_.text.sections;for(let N=0;N<n.length;N++){const{tl:W,tr:de,bl:Le,br:rt,tex:Fe,pixelOffsetTL:Xe,pixelOffsetBR:ot,minFontScaleX:at,minFontScaleY:ct,glyphOffset:Qe,isSDF:wt,sectionIndex:Dt}=n[N],Pt=H.vertexLength,Mt=Qe[1];eu(q,E.x,E.y,W.x,Mt+W.y,Fe.x,Fe.y,o,wt,Xe.x,Xe.y,at,ct),eu(q,E.x,E.y,de.x,Mt+de.y,Fe.x+Fe.w,Fe.y,o,wt,ot.x,Xe.y,at,ct),eu(q,E.x,E.y,Le.x,Mt+Le.y,Fe.x,Fe.y+Fe.h,o,wt,Xe.x,ot.y,at,ct),eu(q,E.x,E.y,rt.x,Mt+rt.y,Fe.x+Fe.w,Fe.y+Fe.h,o,wt,ot.x,ot.y,at,ct),od(t.dynamicLayoutVertexArray,E,ye),V.emplaceBack(Pt,Pt+2,Pt+1),V.emplaceBack(Pt+1,Pt+2,Pt+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qe[0]),N!==n.length-1&&Dt===n[N+1].sectionIndex||t.programConfigurations.populatePaintArrays(q.length,_,_.index,{},U,le&&le[Dt])}t.placedSymbolArray.emplaceBack(E.x,E.y,J,this.glyphOffsetArray.length-J,se,P,D,E.segment,o?o[0]:0,o?o[1]:0,d[0],d[1],w,0,!1,0,O)}_addCollisionDebugVertex(t,n,o,d,g,_){return n.emplaceBack(0,0),t.emplaceBack(o.x,o.y,d,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,n,o,d,g,_,w){const E=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),P=E.vertexLength,D=g.layoutVertexArray,O=g.collisionVertexArray,U=w.anchorX,V=w.anchorY;this._addCollisionDebugVertex(D,O,_,U,V,new Pe(t,n)),this._addCollisionDebugVertex(D,O,_,U,V,new Pe(o,n)),this._addCollisionDebugVertex(D,O,_,U,V,new Pe(o,d)),this._addCollisionDebugVertex(D,O,_,U,V,new Pe(t,d)),E.vertexLength+=4;const q=g.indexArray;q.emplaceBack(P,P+1),q.emplaceBack(P+1,P+2),q.emplaceBack(P+2,P+3),q.emplaceBack(P+3,P),E.primitiveLength+=4}addDebugCollisionBoxes(t,n,o,d){for(let g=t;g<n;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new iu(Ki,id.members,Lr),this.iconCollisionBox=new iu(Ki,id.members,Lr);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,o,d,g,_,w,E,P){const D={};for(let O=n;O<o;O++){const U=t.get(O);D.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.textFeatureIndex=U.featureIndex;break}for(let O=d;O<g;O++){const U=t.get(O);D.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalTextFeatureIndex=U.featureIndex;break}for(let O=_;O<w;O++){const U=t.get(O);D.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.iconFeatureIndex=U.featureIndex;break}for(let O=E;O<P;O++){const U=t.get(O);D.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalIconFeatureIndex=U.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const o=t.placedSymbolArray.get(n),d=o.vertexStartIndex+4*o.numGlyphs;for(let g=o.vertexStartIndex;g<d;g+=4)t.indexArray.emplaceBack(g,g+2,g+1),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),o=Math.cos(t),d=[],g=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const E=this.symbolInstances.get(w);d.push(0|Math.round(n*E.anchorX+o*E.anchorY)),g.push(E.featureIndex)}return _.sort((w,E)=>d[w]-d[E]||g[E]-g[w]),_}addToSortKeyRanges(t,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((d,g,_)=>{d>=0&&_.indexOf(d)===g&&this.addIndicesForPlacedSymbol(this.text,d)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ep,Cp;yt("SymbolBucket",uh,{omit:["layers","collisionBoxArray","features","compareText"]}),uh.MAX_GLYPHS=65535,uh.addDynamicAttributes=od;var mf={get paint(){return Cp=Cp||new ur({"icon-opacity":new jt(ee.paint_symbol["icon-opacity"]),"icon-color":new jt(ee.paint_symbol["icon-color"]),"icon-halo-color":new jt(ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new jt(ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jt(ee.paint_symbol["icon-halo-blur"]),"icon-translate":new mt(ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new mt(ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new jt(ee.paint_symbol["text-opacity"]),"text-color":new jt(ee.paint_symbol["text-color"],{runtimeType:ji,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new jt(ee.paint_symbol["text-halo-color"]),"text-halo-width":new jt(ee.paint_symbol["text-halo-width"]),"text-halo-blur":new jt(ee.paint_symbol["text-halo-blur"]),"text-translate":new mt(ee.paint_symbol["text-translate"]),"text-translate-anchor":new mt(ee.paint_symbol["text-translate-anchor"])})},get layout(){return Ep=Ep||new ur({"symbol-placement":new mt(ee.layout_symbol["symbol-placement"]),"symbol-spacing":new mt(ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mt(ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jt(ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mt(ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mt(ee.layout_symbol["icon-allow-overlap"]),"icon-overlap":new mt(ee.layout_symbol["icon-overlap"]),"icon-ignore-placement":new mt(ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new mt(ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mt(ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new jt(ee.layout_symbol["icon-size"]),"icon-text-fit":new mt(ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mt(ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new jt(ee.layout_symbol["icon-image"]),"icon-rotate":new jt(ee.layout_symbol["icon-rotate"]),"icon-padding":new jt(ee.layout_symbol["icon-padding"]),"icon-keep-upright":new mt(ee.layout_symbol["icon-keep-upright"]),"icon-offset":new jt(ee.layout_symbol["icon-offset"]),"icon-anchor":new jt(ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mt(ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mt(ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mt(ee.layout_symbol["text-rotation-alignment"]),"text-field":new jt(ee.layout_symbol["text-field"]),"text-font":new jt(ee.layout_symbol["text-font"]),"text-size":new jt(ee.layout_symbol["text-size"]),"text-max-width":new jt(ee.layout_symbol["text-max-width"]),"text-line-height":new mt(ee.layout_symbol["text-line-height"]),"text-letter-spacing":new jt(ee.layout_symbol["text-letter-spacing"]),"text-justify":new jt(ee.layout_symbol["text-justify"]),"text-radial-offset":new jt(ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mt(ee.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new jt(ee.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new jt(ee.layout_symbol["text-anchor"]),"text-max-angle":new mt(ee.layout_symbol["text-max-angle"]),"text-writing-mode":new mt(ee.layout_symbol["text-writing-mode"]),"text-rotate":new jt(ee.layout_symbol["text-rotate"]),"text-padding":new mt(ee.layout_symbol["text-padding"]),"text-keep-upright":new mt(ee.layout_symbol["text-keep-upright"]),"text-transform":new jt(ee.layout_symbol["text-transform"]),"text-offset":new jt(ee.layout_symbol["text-offset"]),"text-allow-overlap":new mt(ee.layout_symbol["text-allow-overlap"]),"text-overlap":new mt(ee.layout_symbol["text-overlap"]),"text-ignore-placement":new mt(ee.layout_symbol["text-ignore-placement"]),"text-optional":new mt(ee.layout_symbol["text-optional"])})}};class Ap{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Zt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}yt("FormatSectionOverride",Ap,{omit:["defaultValue"]});class gf extends xa{constructor(t){super(t,mf)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const d=[];for(const g of o)d.indexOf(g)<0&&d.push(g);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,o,d){const g=this.layout.get(t).evaluate(n,{},o,d),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||tl(_.value)||!g?g:function(w,E){return E.replace(/{([^{}]+)}/g,(P,D)=>w&&D in w?String(w[D]):"")}(n.properties,g)}createBucket(t){return new uh(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of mf.paint.overridableProperties){if(!gf.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),o=new Ap(n),d=new $l(o,n.property.specification);let g=null;g=n.value.kind==="constant"||n.value.kind==="source"?new fo("source",d):new il("composite",d,n.value.zoomStops),this.paint._values[t]=new $t(n.property,g,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&gf.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const o=t.get("text-field"),d=mf.paint.properties[n];let g=!1;const _=w=>{for(const E of w)if(d.overrides&&d.overrides.hasOverride(E))return void(g=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Gr)_(o.value.value.sections);else if(o.value.kind==="source"){const w=P=>{g||(P instanceof Ht&&Qi(P.value)===Al?_(P.value.sections):P instanceof Su?_(P.sections):P.eachChild(w))},E=o.value;E._styleExpression&&w(E._styleExpression.expression)}return g}}let _f;var Lm={get paint(){return _f=_f||new ur({"background-color":new mt(ee.paint_background["background-color"]),"background-pattern":new Rs(ee.paint_background["background-pattern"]),"background-opacity":new mt(ee.paint_background["background-opacity"])})}};class Om extends xa{constructor(t){super(t,Lm)}}let Bm;var zp={get paint(){return Bm=Bm||new ur({"raster-opacity":new mt(ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new mt(ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mt(ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mt(ee.paint_raster["raster-brightness-max"]),"raster-saturation":new mt(ee.paint_raster["raster-saturation"]),"raster-contrast":new mt(ee.paint_raster["raster-contrast"]),"raster-resampling":new mt(ee.paint_raster["raster-resampling"]),"raster-fade-duration":new mt(ee.paint_raster["raster-fade-duration"])})}};class Pp extends xa{constructor(t){super(t,zp)}}class vg extends xa{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class bg{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const ld={once:!0},Ip=63710088e-1;class yl{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new yl(It(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,o=this.lat*n,d=t.lat*n,g=Math.sin(o)*Math.sin(d)+Math.cos(o)*Math.cos(d)*Math.cos((t.lng-this.lng)*n);return Ip*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof yl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new yl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new yl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const _i=2*Math.PI*Ip;function yf(a){return _i*Math.cos(a*Math.PI/180)}function cd(a){return(180+a)/360}function vf(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Dp(a,t){return a/yf(t)}function ud(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function hh(a,t){return a*yf(ud(t))}class fc{constructor(t,n,o=0){this.x=+t,this.y=+n,this.z=+o}static fromLngLat(t,n=0){const o=yl.convert(t);return new fc(cd(o.lng),vf(o.lat),Dp(n,o.lat))}toLngLat(){return new yl(360*this.x-180,ud(this.y))}toAltitude(){return hh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/_i*(t=ud(this.y),1/Math.cos(t*Math.PI/180));var t}}function ru(a,t,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[a*o-2*Math.PI*6378137/2,t*o-2*Math.PI*6378137/2]}class bf{constructor(t,n,o){if(!function(d,g,_){return!(d<0||d>25||_<0||_>=Math.pow(2,d)||g<0||g>=Math.pow(2,d))}(t,n,o))throw new Error(`x=${n}, y=${o}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=o,this.key=nu(0,t,t,n,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,o){const d=(_=this.y,w=this.z,E=ru(256*(g=this.x),256*(_=Math.pow(2,w)-_-1),w),P=ru(256*(g+1),256*(_+1),w),E[0]+","+E[1]+","+P[0]+","+P[1]);var g,_,w,E,P;const D=function(O,U,V){let q,H="";for(let J=O;J>0;J--)q=1<<J-1,H+=(U&q?1:0)+(V&q?2:0);return H}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new Pe((t.x*n-this.x)*Ge,(t.y*n-this.y)*Ge)}toString(){return`${this.z}/${this.x}/${this.y}`}}class jm{constructor(t,n){this.wrap=t,this.canonical=n,this.key=nu(t,n.z,n.z,n.x,n.y)}}class Va{constructor(t,n,o,d,g){if(this.terrainRttPosMatrix32f=null,t<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${o}`);this.overscaledZ=t,this.wrap=n,this.canonical=new bf(o,+d,+g),this.key=nu(n,t,o,d,g)}clone(){return new Va(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new Va(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Va(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?nu(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):nu(this.wrap*+n,t,t,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new Va(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,d=2*this.canonical.y;return[new Va(n,this.wrap,n,o,d),new Va(n,this.wrap,n,o+1,d),new Va(n,this.wrap,n,o,d+1),new Va(n,this.wrap,n,o+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Va(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Va(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new jm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new fc(t.x-this.wrap,t.y))}}function nu(a,t,n,o,d){(a*=2)<0&&(a=-1*a-1);const g=1<<n;return(g*g*a+g*d+o).toString(36)+n.toString(36)+t.toString(36)}yt("CanonicalTileID",bf),yt("OverscaledTileID",Va,{omit:["terrainRttPosMatrix32f"]});class Rp{constructor(t,n,o,d=1,g=1,_=1,w=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void tr(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const E=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=g,this.blueFactor=_,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<E;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(E,P)]=this.data[this._idx(E-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,E)]=this.data[this._idx(P,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<E;P++)for(let D=0;D<E;D++){const O=this.get(P,D);O>this.max&&(this.max=O),O<this.min&&(this.min=O)}}get(t,n){const o=new Uint8Array(this.data.buffer),d=4*this._idx(t,n);return this.unpack(o[d],o[d+1],o[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,o){return t*this.redFactor+n*this.greenFactor+o*this.blueFactor-this.baseShift}getPixels(){return new Ta({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=n*this.dim,g=n*this.dim+this.dim,_=o*this.dim,w=o*this.dim+this.dim;switch(n){case-1:d=g-1;break;case 1:g=d+1}switch(o){case-1:_=w-1;break;case 1:w=_+1}const E=-n*this.dim,P=-o*this.dim;for(let D=_;D<w;D++)for(let O=d;O<g;O++)this.data[this._idx(O,D)]=t.data[this._idx(O+E,D+P)]}}yt("DEMData",Rp);class hd{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const o=t[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Yi{constructor(t,n,o,d,g){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=o,t._y=d,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class xf{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Is(Ge,16,0),this.grid3D=new Is(Ge,16,0),this.featureIndexArray=new Ue,this.promoteId=n}insert(t,n,o,d,g,_){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,d,g);const E=_?this.grid3D:this.grid;for(let P=0;P<n.length;P++){const D=n[P],O=[1/0,1/0,-1/0,-1/0];for(let U=0;U<D.length;U++){const V=D[U];O[0]=Math.min(O[0],V.x),O[1]=Math.min(O[1],V.y),O[2]=Math.max(O[2],V.x),O[3]=Math.max(O[3],V.y)}O[0]<Ge&&O[1]<Ge&&O[2]>=0&&O[3]>=0&&E.insert(w,O[0],O[1],O[2],O[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new fl.VectorTile(new da(this.rawTileData)).layers,this.sourceLayerCoder=new hd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,o,d){this.loadVTLayers();const g=t.params,_=Ge/t.tileSize/t.scale,w=ra(g.filter),E=t.queryGeometry,P=t.queryPadding*_,D=Fm(E),O=this.grid.query(D.minX-P,D.minY-P,D.maxX+P,D.maxY+P),U=Fm(t.cameraQueryGeometry),V=this.grid3D.query(U.minX-P,U.minY-P,U.maxX+P,U.maxY+P,(J,se,ye,le)=>function(N,W,de,Le,rt){for(const Xe of N)if(W<=Xe.x&&de<=Xe.y&&Le>=Xe.x&&rt>=Xe.y)return!0;const Fe=[new Pe(W,de),new Pe(W,rt),new Pe(Le,rt),new Pe(Le,de)];if(N.length>2){for(const Xe of Fe)if(ic(N,Xe))return!0}for(let Xe=0;Xe<N.length-1;Xe++)if(ip(N[Xe],N[Xe+1],Fe))return!0;return!1}(t.cameraQueryGeometry,J-P,se-P,ye+P,le+P));for(const J of V)O.push(J);O.sort(kp);const q={};let H;for(let J=0;J<O.length;J++){const se=O[J];if(se===H)continue;H=se;const ye=this.featureIndexArray.get(se);let le=null;this.loadMatchingFeature(q,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,w,g.layers,g.availableImages,n,o,d,(N,W,de)=>(le||(le=wa(N)),W.queryIntersectsFeature({queryGeometry:E,feature:N,featureState:de,geometry:le,zoom:this.z,transform:t.transform,pixelsToTileUnits:_,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return q}loadMatchingFeature(t,n,o,d,g,_,w,E,P,D,O){const U=this.bucketLayerIDs[n];if(_&&!U.some(J=>_.has(J)))return;const V=this.sourceLayerCoder.decode(o),q=this.vtLayers[V].feature(d);if(g.needGeometry){const J=ca(q,!0);if(!g.filter(new Gi(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!g.filter(new Gi(this.tileID.overscaledZ),q))return;const H=this.getId(q,V);for(let J=0;J<U.length;J++){const se=U[J];if(_&&!_.has(se))continue;const ye=E[se];if(!ye)continue;let le={};H&&D&&(le=D.getState(ye.sourceLayer||"_geojsonTileLayer",H));const N=di({},P[se]);N.paint=Cn(N.paint,ye.paint,q,le,w),N.layout=Cn(N.layout,ye.layout,q,le,w);const W=!O||O(q,ye,le);if(!W)continue;const de=new Yi(q,this.z,this.x,this.y,H);de.layer=N;let Le=t[se];Le===void 0&&(Le=t[se]=[]),Le.push({featureIndex:d,feature:de,intersectionZ:W})}}lookupSymbolFeatures(t,n,o,d,g,_,w,E){const P={};this.loadVTLayers();const D=ra(g);for(const O of t)this.loadMatchingFeature(P,o,d,O,D,_,w,E,n);return P}hasLayer(t){for(const n of this.bucketLayerIDs)for(const o of n)if(t===o)return!0;return!1}getId(t,n){var o;let d=t.id;return this.promoteId&&(d=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((o=t.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(d=Number(t.properties.cluster_id))),d}}function Cn(a,t,n,o,d){return er(a,(g,_)=>{const w=t instanceof zi?t.get(_):null;return w&&w.evaluate?w.evaluate(n,o,d):w})}function Fm(a){let t=1/0,n=1/0,o=-1/0,d=-1/0;for(const g of a)t=Math.min(t,g.x),n=Math.min(n,g.y),o=Math.max(o,g.x),d=Math.max(d,g.y);return{minX:t,minY:n,maxX:o,maxY:d}}function kp(a,t){return t-a}function wf(a,t,n,o,d){const g=[];for(let _=0;_<a.length;_++){const w=a[_];let E;for(let P=0;P<w.length-1;P++){let D=w[P],O=w[P+1];D.x<t&&O.x<t||(D.x<t?D=new Pe(t,D.y+(t-D.x)/(O.x-D.x)*(O.y-D.y))._round():O.x<t&&(O=new Pe(t,D.y+(t-D.x)/(O.x-D.x)*(O.y-D.y))._round()),D.y<n&&O.y<n||(D.y<n?D=new Pe(D.x+(n-D.y)/(O.y-D.y)*(O.x-D.x),n)._round():O.y<n&&(O=new Pe(D.x+(n-D.y)/(O.y-D.y)*(O.x-D.x),n)._round()),D.x>=o&&O.x>=o||(D.x>=o?D=new Pe(o,D.y+(o-D.x)/(O.x-D.x)*(O.y-D.y))._round():O.x>=o&&(O=new Pe(o,D.y+(o-D.x)/(O.x-D.x)*(O.y-D.y))._round()),D.y>=d&&O.y>=d||(D.y>=d?D=new Pe(D.x+(d-D.y)/(O.y-D.y)*(O.x-D.x),d)._round():O.y>=d&&(O=new Pe(D.x+(d-D.y)/(O.y-D.y)*(O.x-D.x),d)._round()),E&&D.equals(E[E.length-1])||(E=[D],g.push(E)),E.push(O)))))}}return g}yt("FeatureIndex",xf,{omit:["rawTileData","sourceLayerCoder"]});class Gs extends Pe{constructor(t,n,o,d){super(t,n),this.angle=o,d!==void 0&&(this.segment=d)}clone(){return new Gs(this.x,this.y,this.angle,this.segment)}}function Lp(a,t,n,o,d){if(t.segment===void 0||n===0)return!0;let g=t,_=t.segment+1,w=0;for(;w>-n/2;){if(_--,_<0)return!1;w-=a[_].dist(g),g=a[_]}w+=a[_].dist(a[_+1]),_++;const E=[];let P=0;for(;w<n/2;){const D=a[_],O=a[_+1];if(!O)return!1;let U=a[_-1].angleTo(D)-D.angleTo(O);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:w,angleDelta:U}),P+=U;w-E[0].distance>o;)P-=E.shift().angleDelta;if(P>d)return!1;_++,w+=D.dist(O)}return!0}function Op(a){let t=0;for(let n=0;n<a.length-1;n++)t+=a[n].dist(a[n+1]);return t}function Tf(a,t,n){return a?.6*t*n:0}function Sf(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function xg(a,t,n,o,d,g){const _=Tf(n,d,g),w=Sf(n,o)*g;let E=0;const P=Op(a)/2;for(let D=0;D<a.length-1;D++){const O=a[D],U=a[D+1],V=O.dist(U);if(E+V>P){const q=(P-E)/V,H=Xa.number(O.x,U.x,q),J=Xa.number(O.y,U.y,q),se=new Gs(H,J,U.angleTo(O),D);return se._round(),!_||Lp(a,se,w,_,t)?se:void 0}E+=V}}function Um(a,t,n,o,d,g,_,w,E){const P=Tf(o,g,_),D=Sf(o,d),O=D*_,U=a[0].x===0||a[0].x===E||a[0].y===0||a[0].y===E;return t-O<t/4&&(t=O+t/4),Nm(a,U?t/2*w%t:(D/2+2*g)*_*w%t,t,P,n,O,U,!1,E)}function Nm(a,t,n,o,d,g,_,w,E){const P=g/2,D=Op(a);let O=0,U=t-n,V=[];for(let q=0;q<a.length-1;q++){const H=a[q],J=a[q+1],se=H.dist(J),ye=J.angleTo(H);for(;U+n<O+se;){U+=n;const le=(U-O)/se,N=Xa.number(H.x,J.x,le),W=Xa.number(H.y,J.y,le);if(N>=0&&N<E&&W>=0&&W<E&&U-P>=0&&U+P<=D){const de=new Gs(N,W,ye,q);de._round(),o&&!Lp(a,de,g,o,d)||V.push(de)}}O+=se}return w||V.length||_||(V=Nm(a,O/2,n,o,d,g,_,!0,E)),V}yt("Anchor",Gs);const dh=En;function Vm(a,t,n,o){const d=[],g=a.image,_=g.pixelRatio,w=g.paddedRect.w-2*dh,E=g.paddedRect.h-2*dh;let P={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const D=g.stretchX||[[0,w]],O=g.stretchY||[[0,E]],U=(Qe,wt)=>Qe+wt[1]-wt[0],V=D.reduce(U,0),q=O.reduce(U,0),H=w-V,J=E-q;let se=0,ye=V,le=0,N=q,W=0,de=H,Le=0,rt=J;if(g.content&&o){const Qe=g.content,wt=Qe[2]-Qe[0],Dt=Qe[3]-Qe[1];(g.textFitWidth||g.textFitHeight)&&(P=pf(a)),se=Mf(D,0,Qe[0]),le=Mf(O,0,Qe[1]),ye=Mf(D,Qe[0],Qe[2]),N=Mf(O,Qe[1],Qe[3]),W=Qe[0]-se,Le=Qe[1]-le,de=wt-ye,rt=Dt-N}const Fe=P.x1,Xe=P.y1,ot=P.x2-Fe,at=P.y2-Xe,ct=(Qe,wt,Dt,Pt)=>{const Mt=dd(Qe.stretch-se,ye,ot,Fe),ni=fh(Qe.fixed-W,de,Qe.stretch,V),Ii=dd(wt.stretch-le,N,at,Xe),Wi=fh(wt.fixed-Le,rt,wt.stretch,q),vr=dd(Dt.stretch-se,ye,ot,Fe),On=fh(Dt.fixed-W,de,Dt.stretch,V),fn=dd(Pt.stretch-le,N,at,Xe),hr=fh(Pt.fixed-Le,rt,Pt.stretch,q),dr=new Pe(Mt,Ii),Yr=new Pe(vr,Ii),Fr=new Pe(vr,fn),pn=new Pe(Mt,fn),Bn=new Pe(ni/_,Wi/_),Xn=new Pe(On/_,hr/_),Qr=t*Math.PI/180;if(Qr){const Ur=Math.sin(Qr),Kr=Math.cos(Qr),fr=[Kr,-Ur,Ur,Kr];dr._matMult(fr),Yr._matMult(fr),pn._matMult(fr),Fr._matMult(fr)}const fa=Qe.stretch+Qe.fixed,Ir=wt.stretch+wt.fixed;return{tl:dr,tr:Yr,bl:pn,br:Fr,tex:{x:g.paddedRect.x+dh+fa,y:g.paddedRect.y+dh+Ir,w:Dt.stretch+Dt.fixed-fa,h:Pt.stretch+Pt.fixed-Ir},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Bn,pixelOffsetBR:Xn,minFontScaleX:de/_/ot,minFontScaleY:rt/_/at,isSDF:n}};if(o&&(g.stretchX||g.stretchY)){const Qe=vl(D,H,V),wt=vl(O,J,q);for(let Dt=0;Dt<Qe.length-1;Dt++){const Pt=Qe[Dt],Mt=Qe[Dt+1];for(let ni=0;ni<wt.length-1;ni++)d.push(ct(Pt,wt[ni],Mt,wt[ni+1]))}}else d.push(ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:E+1}));return d}function Mf(a,t,n){let o=0;for(const d of a)o+=Math.max(t,Math.min(n,d[1]))-Math.max(t,Math.min(n,d[0]));return o}function vl(a,t,n){const o=[{fixed:-1,stretch:0}];for(const[d,g]of a){const _=o[o.length-1];o.push({fixed:d-_.stretch,stretch:_.stretch}),o.push({fixed:d-_.stretch,stretch:_.stretch+(g-d)})}return o.push({fixed:t+dh,stretch:n}),o}function dd(a,t,n,o){return a/t*n+o}function fh(a,t,n,o){return a-t*n/o}class Ef{constructor(t,n,o,d,g,_,w,E,P,D){var O;if(this.boxStartIndex=t.length,P){let U=_.top,V=_.bottom;const q=_.collisionPadding;q&&(U-=q[1],V+=q[3]);let H=V-U;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{const U=!((O=_.image)===null||O===void 0)&&O.content&&(_.image.textFitWidth||_.image.textFitHeight)?pf(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};U.y1=U.y1*w-E[0],U.y2=U.y2*w+E[2],U.x1=U.x1*w-E[3],U.x2=U.x2*w+E[1];const V=_.collisionPadding;if(V&&(U.x1-=V[0]*w,U.y1-=V[1]*w,U.x2+=V[2]*w,U.y2+=V[3]*w),D){const q=new Pe(U.x1,U.y1),H=new Pe(U.x2,U.y1),J=new Pe(U.x1,U.y2),se=new Pe(U.x2,U.y2),ye=D*Math.PI/180;q._rotate(ye),H._rotate(ye),J._rotate(ye),se._rotate(ye),U.x1=Math.min(q.x,H.x,J.x,se.x),U.x2=Math.max(q.x,H.x,J.x,se.x),U.y1=Math.min(q.y,H.y,J.y,se.y),U.y2=Math.max(q.y,H.y,J.y,se.y)}t.emplaceBack(n.x,n.y,U.x1,U.y1,U.x2,U.y2,o,d,g)}this.boxEndIndex=t.length}}class wg{constructor(t=[],n=(o,d)=>o<d?-1:o>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:o}=this,d=n[t];for(;t>0;){const g=t-1>>1,_=n[g];if(o(d,_)>=0)break;n[t]=_,t=g}n[t]=d}_down(t){const{data:n,compare:o}=this,d=this.length>>1,g=n[t];for(;t<d;){let _=1+(t<<1);const w=_+1;if(w<this.length&&o(n[w],n[_])<0&&(_=w),o(n[_],g)>=0)break;n[t]=n[_],t=_}n[t]=g}}function Bp(a,t=1,n=!1){let o=1/0,d=1/0,g=-1/0,_=-1/0;const w=a[0];for(let V=0;V<w.length;V++){const q=w[V];(!V||q.x<o)&&(o=q.x),(!V||q.y<d)&&(d=q.y),(!V||q.x>g)&&(g=q.x),(!V||q.y>_)&&(_=q.y)}const E=Math.min(g-o,_-d);let P=E/2;const D=new wg([],Tg);if(E===0)return new Pe(o,d);for(let V=o;V<g;V+=E)for(let q=d;q<_;q+=E)D.push(new Hn(V+P,q+P,P,a));let O=function(V){let q=0,H=0,J=0;const se=V[0];for(let ye=0,le=se.length,N=le-1;ye<le;N=ye++){const W=se[ye],de=se[N],Le=W.x*de.y-de.x*W.y;H+=(W.x+de.x)*Le,J+=(W.y+de.y)*Le,q+=3*Le}return new Hn(H/q,J/q,0,V)}(a),U=D.length;for(;D.length;){const V=D.pop();(V.d>O.d||!O.d)&&(O=V,n&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,U)),V.max-O.d<=t||(P=V.h/2,D.push(new Hn(V.p.x-P,V.p.y-P,P,a)),D.push(new Hn(V.p.x+P,V.p.y-P,P,a)),D.push(new Hn(V.p.x-P,V.p.y+P,P,a)),D.push(new Hn(V.p.x+P,V.p.y+P,P,a)),U+=4)}return n&&(console.log(`num probes: ${U}`),console.log(`best distance: ${O.d}`)),O.p}function Tg(a,t){return t.max-a.max}function Hn(a,t,n,o){this.p=new Pe(a,t),this.h=n,this.d=function(d,g){let _=!1,w=1/0;for(let E=0;E<g.length;E++){const P=g[E];for(let D=0,O=P.length,U=O-1;D<O;U=D++){const V=P[D],q=P[U];V.y>d.y!=q.y>d.y&&d.x<(q.x-V.x)*(d.y-V.y)/(q.y-V.y)+V.x&&(_=!_),w=Math.min(w,tp(d,V,q))}}return(_?1:-1)*Math.sqrt(w)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var sn;z.aB=void 0,(sn=z.aB||(z.aB={}))[sn.center=1]="center",sn[sn.left=2]="left",sn[sn.right=3]="right",sn[sn.top=4]="top",sn[sn.bottom=5]="bottom",sn[sn["top-left"]=6]="top-left",sn[sn["top-right"]=7]="top-right",sn[sn["bottom-left"]=8]="bottom-left",sn[sn["bottom-right"]=9]="bottom-right";const bl=7,Cf=Number.POSITIVE_INFINITY;function ph(a,t){return t[1]!==Cf?function(n,o,d){let g=0,_=0;switch(o=Math.abs(o),d=Math.abs(d),n){case"top-right":case"top-left":case"top":_=d-bl;break;case"bottom-right":case"bottom-left":case"bottom":_=-d+bl}switch(n){case"top-right":case"bottom-right":case"right":g=-o;break;case"top-left":case"bottom-left":case"left":g=o}return[g,_]}(a,t[0],t[1]):function(n,o){let d=0,g=0;o<0&&(o=0);const _=o/Math.SQRT2;switch(n){case"top-right":case"top-left":g=_-bl;break;case"bottom-right":case"bottom-left":g=-_+bl;break;case"bottom":g=-o+bl;break;case"top":g=o-bl}switch(n){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=o;break;case"right":d=-o}return[d,g]}(a,t[0])}function Za(a,t,n){var o;const d=a.layout,g=(o=d.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(t,{},n);if(g){const w=g.values,E=[];for(let P=0;P<w.length;P+=2){const D=E[P]=w[P],O=w[P+1].map(U=>U*jr);D.startsWith("top")?O[1]-=bl:D.startsWith("bottom")&&(O[1]+=bl),E[P+1]=O}return new mr(E)}const _=d.get("text-variable-anchor");if(_){let w;w=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},n)*jr,Cf]:d.get("text-offset").evaluate(t,{},n).map(P=>P*jr);const E=[];for(const P of _)E.push(P,ph(P,w));return new mr(E)}return null}function Af(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zf(a,t,n,o,d,g,_,w,E,P,D,O){let U=g.textMaxSize.evaluate(t,{});U===void 0&&(U=_);const V=a.layers[0].layout,q=V.get("icon-offset").evaluate(t,{},D),H=Zm(n.horizontal),J=_/24,se=a.tilePixelRatio*J,ye=a.tilePixelRatio*U/24,le=a.tilePixelRatio*w,N=a.tilePixelRatio*V.get("symbol-spacing"),W=V.get("text-padding")*a.tilePixelRatio,de=function(Dt,Pt,Mt,ni=1){const Ii=Dt.get("icon-padding").evaluate(Pt,{},Mt),Wi=Ii&&Ii.values;return[Wi[0]*ni,Wi[1]*ni,Wi[2]*ni,Wi[3]*ni]}(V,t,D,a.tilePixelRatio),Le=V.get("text-max-angle")/180*Math.PI,rt=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",Fe=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",Xe=V.get("symbol-placement"),ot=N/2,at=V.get("icon-text-fit");let ct;o&&at!=="none"&&(a.allowVerticalPlacement&&n.vertical&&(ct=Rm(o,n.vertical,at,V.get("icon-text-fit-padding"),q,J)),H&&(o=Rm(o,H,at,V.get("icon-text-fit-padding"),q,J)));const Qe=D?O.line.getGranularityForZoomLevel(D.z):1,wt=(Dt,Pt)=>{Pt.x<0||Pt.x>=Ge||Pt.y<0||Pt.y>=Ge||function(Mt,ni,Ii,Wi,vr,On,fn,hr,dr,Yr,Fr,pn,Bn,Xn,Qr,fa,Ir,Ur,Kr,fr,Zi,Ma,ou,Hs,Rf){const i=Mt.addToLineVertexArray(ni,Ii);let s,c,p,S,A=0,Z=0,K=0,me=0,Be=-1,tt=-1;const nt={};let Ve=sa("");if(Mt.allowVerticalPlacement&&Wi.vertical){const jn=hr.layout.get("text-rotate").evaluate(Zi,{},Hs)+90;p=new Ef(dr,ni,Yr,Fr,pn,Wi.vertical,Bn,Xn,Qr,jn),fn&&(S=new Ef(dr,ni,Yr,Fr,pn,fn,Ir,Ur,Qr,jn))}if(vr){const jn=hr.layout.get("icon-rotate").evaluate(Zi,{}),Xs=hr.layout.get("icon-text-fit")!=="none",pd=Vm(vr,jn,ou,Xs),xl=fn?Vm(fn,jn,ou,Xs):void 0;c=new Ef(dr,ni,Yr,Fr,pn,vr,Ir,Ur,!1,jn),A=4*pd.length;const md=Mt.iconSizeData;let gc=null;md.kind==="source"?(gc=[Eo*hr.layout.get("icon-size").evaluate(Zi,{})],gc[0]>dc&&tr(`${Mt.layerIds[0]}: Value for "icon-size" is >= ${oh}. Reduce your "icon-size".`)):md.kind==="composite"&&(gc=[Eo*Ma.compositeIconSizes[0].evaluate(Zi,{},Hs),Eo*Ma.compositeIconSizes[1].evaluate(Zi,{},Hs)],(gc[0]>dc||gc[1]>dc)&&tr(`${Mt.layerIds[0]}: Value for "icon-size" is >= ${oh}. Reduce your "icon-size".`)),Mt.addSymbols(Mt.icon,pd,gc,fr,Kr,Zi,z.al.none,ni,i.lineStartIndex,i.lineLength,-1,Hs),Be=Mt.icon.placedSymbolArray.length-1,xl&&(Z=4*xl.length,Mt.addSymbols(Mt.icon,xl,gc,fr,Kr,Zi,z.al.vertical,ni,i.lineStartIndex,i.lineLength,-1,Hs),tt=Mt.icon.placedSymbolArray.length-1)}const He=Object.keys(Wi.horizontal);for(const jn of He){const Xs=Wi.horizontal[jn];if(!s){Ve=sa(Xs.text);const xl=hr.layout.get("text-rotate").evaluate(Zi,{},Hs);s=new Ef(dr,ni,Yr,Fr,pn,Xs,Bn,Xn,Qr,xl)}const pd=Xs.positionedLines.length===1;if(K+=Co(Mt,ni,Xs,On,hr,Qr,Zi,fa,i,Wi.vertical?z.al.horizontal:z.al.horizontalOnly,pd?He:[jn],nt,Be,Ma,Hs),pd)break}Wi.vertical&&(me+=Co(Mt,ni,Wi.vertical,On,hr,Qr,Zi,fa,i,z.al.vertical,["vertical"],nt,tt,Ma,Hs));const Kt=s?s.boxStartIndex:Mt.collisionBoxArray.length,Xt=s?s.boxEndIndex:Mt.collisionBoxArray.length,Ji=p?p.boxStartIndex:Mt.collisionBoxArray.length,Ie=p?p.boxEndIndex:Mt.collisionBoxArray.length,Me=c?c.boxStartIndex:Mt.collisionBoxArray.length,Oe=c?c.boxEndIndex:Mt.collisionBoxArray.length,st=S?S.boxStartIndex:Mt.collisionBoxArray.length,Rt=S?S.boxEndIndex:Mt.collisionBoxArray.length;let Wt=-1;const Nt=(jn,Xs)=>jn&&jn.circleDiameter?Math.max(jn.circleDiameter,Xs):Xs;Wt=Nt(s,Wt),Wt=Nt(p,Wt),Wt=Nt(c,Wt),Wt=Nt(S,Wt);const Yt=Wt>-1?1:0;Yt&&(Wt*=Rf/jr),Mt.glyphOffsetArray.length>=uh.MAX_GLYPHS&&tr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zi.sortKey!==void 0&&Mt.addToSortKeyRanges(Mt.symbolInstances.length,Zi.sortKey);const An=Za(hr,Zi,Hs),[Di,mc]=function(jn,Xs){const pd=jn.length,xl=Xs==null?void 0:Xs.values;if((xl==null?void 0:xl.length)>0)for(let md=0;md<xl.length;md+=2){const gc=xl[md+1];jn.emplaceBack(z.aB[xl[md]],gc[0],gc[1])}return[pd,jn.length]}(Mt.textAnchorOffsets,An);Mt.symbolInstances.emplaceBack(ni.x,ni.y,nt.right>=0?nt.right:-1,nt.center>=0?nt.center:-1,nt.left>=0?nt.left:-1,nt.vertical||-1,Be,tt,Ve,Kt,Xt,Ji,Ie,Me,Oe,st,Rt,Yr,K,me,A,Z,Yt,0,Bn,Wt,Di,mc)}(a,Pt,Dt,n,o,d,ct,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,se,[W,W,W,W],rt,E,le,de,Fe,q,t,g,P,D,_)};if(Xe==="line")for(const Dt of wf(t.geometry,0,0,Ge,Ge)){const Pt=ac(Dt,Qe),Mt=Um(Pt,N,Le,n.vertical||H,o,24,ye,a.overscaling,Ge);for(const ni of Mt)H&&Sg(a,H.text,ot,ni)||wt(Pt,ni)}else if(Xe==="line-center"){for(const Dt of t.geometry)if(Dt.length>1){const Pt=ac(Dt,Qe),Mt=xg(Pt,Le,n.vertical||H,o,24,ye);Mt&&wt(Pt,Mt)}}else if(t.type==="Polygon")for(const Dt of zc(t.geometry,0)){const Pt=Bp(Dt,16);wt(ac(Dt[0],Qe,!0),new Gs(Pt.x,Pt.y,0))}else if(t.type==="LineString")for(const Dt of t.geometry){const Pt=ac(Dt,Qe);wt(Pt,new Gs(Pt[0].x,Pt[0].y,0))}else if(t.type==="Point")for(const Dt of t.geometry)for(const Pt of Dt)wt([Pt],new Gs(Pt.x,Pt.y,0))}function Co(a,t,n,o,d,g,_,w,E,P,D,O,U,V,q){const H=function(ye,le,N,W,de,Le,rt,Fe){const Xe=W.layout.get("text-rotate").evaluate(Le,{})*Math.PI/180,ot=[];for(const at of le.positionedLines)for(const ct of at.positionedGlyphs){if(!ct.rect)continue;const Qe=ct.rect||{};let wt=gg+1,Dt=!0,Pt=1,Mt=0;const ni=(de||Fe)&&ct.vertical,Ii=ct.metrics.advance*ct.scale/2;if(Fe&&le.verticalizable&&(Mt=at.lineOffset/2-(ct.imageName?-(jr-ct.metrics.width*ct.scale)/2:(ct.scale-1)*jr)),ct.imageName){const Ur=rt[ct.imageName];Dt=Ur.sdf,Pt=Ur.pixelRatio,wt=En/Pt}const Wi=de?[ct.x+Ii,ct.y]:[0,0];let vr=de?[0,0]:[ct.x+Ii+N[0],ct.y+N[1]-Mt],On=[0,0];ni&&(On=vr,vr=[0,0]);const fn=ct.metrics.isDoubleResolution?2:1,hr=(ct.metrics.left-wt)*ct.scale-Ii+vr[0],dr=(-ct.metrics.top-wt)*ct.scale+vr[1],Yr=hr+Qe.w/fn*ct.scale/Pt,Fr=dr+Qe.h/fn*ct.scale/Pt,pn=new Pe(hr,dr),Bn=new Pe(Yr,dr),Xn=new Pe(hr,Fr),Qr=new Pe(Yr,Fr);if(ni){const Ur=new Pe(-Ii,Ii-ad),Kr=-Math.PI/2,fr=jr/2-Ii,Zi=new Pe(5-ad-fr,-(ct.imageName?fr:0)),Ma=new Pe(...On);pn._rotateAround(Kr,Ur)._add(Zi)._add(Ma),Bn._rotateAround(Kr,Ur)._add(Zi)._add(Ma),Xn._rotateAround(Kr,Ur)._add(Zi)._add(Ma),Qr._rotateAround(Kr,Ur)._add(Zi)._add(Ma)}if(Xe){const Ur=Math.sin(Xe),Kr=Math.cos(Xe),fr=[Kr,-Ur,Ur,Kr];pn._matMult(fr),Bn._matMult(fr),Xn._matMult(fr),Qr._matMult(fr)}const fa=new Pe(0,0),Ir=new Pe(0,0);ot.push({tl:pn,tr:Bn,bl:Xn,br:Qr,tex:Qe,writingMode:le.writingMode,glyphOffset:Wi,sectionIndex:ct.sectionIndex,isSDF:Dt,pixelOffsetTL:fa,pixelOffsetBR:Ir,minFontScaleX:0,minFontScaleY:0})}return ot}(0,n,w,d,g,_,o,a.allowVerticalPlacement),J=a.textSizeData;let se=null;J.kind==="source"?(se=[Eo*d.layout.get("text-size").evaluate(_,{})],se[0]>dc&&tr(`${a.layerIds[0]}: Value for "text-size" is >= ${oh}. Reduce your "text-size".`)):J.kind==="composite"&&(se=[Eo*V.compositeTextSizes[0].evaluate(_,{},q),Eo*V.compositeTextSizes[1].evaluate(_,{},q)],(se[0]>dc||se[1]>dc)&&tr(`${a.layerIds[0]}: Value for "text-size" is >= ${oh}. Reduce your "text-size".`)),a.addSymbols(a.text,H,se,w,g,_,P,t,E.lineStartIndex,E.lineLength,U,q);for(const ye of D)O[ye]=a.text.placedSymbolArray.length-1;return 4*H.length}function Zm(a){for(const t in a)return a[t];return null}function Sg(a,t,n,o){const d=a.compareText;if(t in d){const g=d[t];for(let _=g.length-1;_>=0;_--)if(o.dist(g[_])<n)return!0}else d[t]=[];return d[t].push(o),!1}const au=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=o>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const g=au[15&o];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[w]=new Uint32Array(t,4,1);return new Pf(w,_,g,t)}constructor(t,n=64,o=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=au.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,w=t*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-w%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+w+E,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+w+E),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+w+E,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=n,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return jp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,o,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:w}=this,E=[0,g.length-1,0],P=[];for(;E.length;){const D=E.pop()||0,O=E.pop()||0,U=E.pop()||0;if(O-U<=w){for(let J=U;J<=O;J++){const se=_[2*J],ye=_[2*J+1];se>=t&&se<=o&&ye>=n&&ye<=d&&P.push(g[J])}continue}const V=U+O>>1,q=_[2*V],H=_[2*V+1];q>=t&&q<=o&&H>=n&&H<=d&&P.push(g[V]),(D===0?t<=q:n<=H)&&(E.push(U),E.push(V-1),E.push(1-D)),(D===0?o>=q:d>=H)&&(E.push(V+1),E.push(O),E.push(1-D))}return P}within(t,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:_}=this,w=[0,d.length-1,0],E=[],P=o*o;for(;w.length;){const D=w.pop()||0,O=w.pop()||0,U=w.pop()||0;if(O-U<=_){for(let J=U;J<=O;J++)$m(g[2*J],g[2*J+1],t,n)<=P&&E.push(d[J]);continue}const V=U+O>>1,q=g[2*V],H=g[2*V+1];$m(q,H,t,n)<=P&&E.push(d[V]),(D===0?t-o<=q:n-o<=H)&&(w.push(U),w.push(V-1),w.push(1-D)),(D===0?t+o>=q:n+o>=H)&&(w.push(V+1),w.push(O),w.push(1-D))}return E}}function jp(a,t,n,o,d,g){if(d-o<=n)return;const _=o+d>>1;qm(a,t,_,o,d,g),jp(a,t,n,o,_-1,1-g),jp(a,t,n,_+1,d,1-g)}function qm(a,t,n,o,d,g){for(;d>o;){if(d-o>600){const P=d-o+1,D=n-o+1,O=Math.log(P),U=.5*Math.exp(2*O/3),V=.5*Math.sqrt(O*U*(P-U)/P)*(D-P/2<0?-1:1);qm(a,t,n,Math.max(o,Math.floor(n-D*U/P+V)),Math.min(d,Math.floor(n+(P-D)*U/P+V)),g)}const _=t[2*n+g];let w=o,E=d;for(fd(a,t,o,n),t[2*d+g]>_&&fd(a,t,o,d);w<E;){for(fd(a,t,w,E),w++,E--;t[2*w+g]<_;)w++;for(;t[2*E+g]>_;)E--}t[2*o+g]===_?fd(a,t,o,E):(E++,fd(a,t,E,d)),E<=n&&(o=E+1),n<=E&&(d=E-1)}}function fd(a,t,n,o){Fp(a,n,o),Fp(t,2*n,2*o),Fp(t,2*n+1,2*o+1)}function Fp(a,t,n){const o=a[t];a[t]=a[n],a[n]=o}function $m(a,t,n,o){const d=a-n,g=t-o;return d*d+g*g}var Up;z.co=void 0,(Up=z.co||(z.co={})).create="create",Up.load="load",Up.fullLoad="fullLoad";let If=null,mh=[];const pc=1e3/60,su="loadTime",Df="fullLoadTime",Mg={mark(a){performance.mark(a)},frame(a){const t=a;If!=null&&mh.push(t-If),If=t},clearMetrics(){If=null,mh=[],performance.clearMeasures(su),performance.clearMeasures(Df);for(const a in z.co)performance.clearMarks(z.co[a])},getPerformanceMetrics(){performance.measure(su,z.co.create,z.co.load),performance.measure(Df,z.co.create,z.co.fullLoad);const a=performance.getEntriesByName(su)[0].duration,t=performance.getEntriesByName(Df)[0].duration,n=mh.length,o=1/(mh.reduce((g,_)=>g+_,0)/n/1e3),d=mh.filter(g=>g>pc).reduce((g,_)=>g+(_-pc)/pc,0);return{loadTime:a,fullLoadTime:t,fps:o,percentDroppedFrames:d/(n+d)*100,totalFrames:n}}};z.$=fc,z.A=Bt,z.B=Xa,z.C=Gi,z.D=mt,z.E=be,z.F=Wf,z.G=function(a){if(Ks==null){const t=a.navigator?a.navigator.userAgent:null;Ks=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ks},z.H=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new bg(()=>this.process()),this.subscription=Io(this.target,"message",n=>this.receive(n),!1),this.globalScope=qa(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise((n,o)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),g=t?Io(t.signal,"abort",()=>{g==null||g.unsubscribe(),delete this.resolveRejects[d];const E={id:d,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(E)},ld):null;this.resolveRejects[d]={resolve:E=>{g==null||g.unsubscribe(),n(E)},reject:E=>{g==null||g.unsubscribe(),o(E)}};const _=[],w=Object.assign(Object.assign({},a),{id:d,sourceMapId:this.mapId,origin:location.origin,data:sl(a.data,_)});this.target.postMessage(w,{transfer:_})})}receive(a){const t=a.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const o=this.abortControllers[n];return delete this.abortControllers[n],void(o&&o.abort())}if(qa(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return u(this,void 0,void 0,function*(){if(t.type==="<response>"){const d=this.resolveRejects[a];return delete this.resolveRejects[a],d?void(t.error?d.reject(go(t.error)):d.resolve(go(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=go(t.data),o=new AbortController;this.abortControllers[a]=o;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,n,o);this.completeTask(a,null,d)}catch(d){this.completeTask(a,d)}})}completeTask(a,t,n){const o=[];delete this.abortControllers[a];const d={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?sl(t):null,data:sl(n,o)};this.target.postMessage(d,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},z.I=nd,z.J=Cl,z.K=function(){var a=new Bt(16);return Bt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},z.L=function(a,t,n){var o,d,g,_,w,E,P,D,O,U,V,q,H=n[0],J=n[1],se=n[2];return t===a?(a[12]=t[0]*H+t[4]*J+t[8]*se+t[12],a[13]=t[1]*H+t[5]*J+t[9]*se+t[13],a[14]=t[2]*H+t[6]*J+t[10]*se+t[14],a[15]=t[3]*H+t[7]*J+t[11]*se+t[15]):(d=t[1],g=t[2],_=t[3],w=t[4],E=t[5],P=t[6],D=t[7],O=t[8],U=t[9],V=t[10],q=t[11],a[0]=o=t[0],a[1]=d,a[2]=g,a[3]=_,a[4]=w,a[5]=E,a[6]=P,a[7]=D,a[8]=O,a[9]=U,a[10]=V,a[11]=q,a[12]=o*H+w*J+O*se+t[12],a[13]=d*H+E*J+U*se+t[13],a[14]=g*H+P*J+V*se+t[14],a[15]=_*H+D*J+q*se+t[15]),a},z.M=function(a,t,n){var o=n[0],d=n[1],g=n[2];return a[0]=t[0]*o,a[1]=t[1]*o,a[2]=t[2]*o,a[3]=t[3]*o,a[4]=t[4]*d,a[5]=t[5]*d,a[6]=t[6]*d,a[7]=t[7]*d,a[8]=t[8]*g,a[9]=t[9]*g,a[10]=t[10]*g,a[11]=t[11]*g,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},z.N=function(a,t,n){var o=t[0],d=t[1],g=t[2],_=t[3],w=t[4],E=t[5],P=t[6],D=t[7],O=t[8],U=t[9],V=t[10],q=t[11],H=t[12],J=t[13],se=t[14],ye=t[15],le=n[0],N=n[1],W=n[2],de=n[3];return a[0]=le*o+N*w+W*O+de*H,a[1]=le*d+N*E+W*U+de*J,a[2]=le*g+N*P+W*V+de*se,a[3]=le*_+N*D+W*q+de*ye,a[4]=(le=n[4])*o+(N=n[5])*w+(W=n[6])*O+(de=n[7])*H,a[5]=le*d+N*E+W*U+de*J,a[6]=le*g+N*P+W*V+de*se,a[7]=le*_+N*D+W*q+de*ye,a[8]=(le=n[8])*o+(N=n[9])*w+(W=n[10])*O+(de=n[11])*H,a[9]=le*d+N*E+W*U+de*J,a[10]=le*g+N*P+W*V+de*se,a[11]=le*_+N*D+W*q+de*ye,a[12]=(le=n[12])*o+(N=n[13])*w+(W=n[14])*O+(de=n[15])*H,a[13]=le*d+N*E+W*U+de*J,a[14]=le*g+N*P+W*V+de*se,a[15]=le*_+N*D+W*q+de*ye,a},z.O=function(a,t){const n={};for(let o=0;o<t.length;o++){const d=t[o];d in a&&(n[d]=a[d])}return n},z.P=Pe,z.Q=yl,z.R=Ta,z.S=vf,z.T=$h,z.U=cd,z.V=Tt,z.W=qt,z.X=Ml,z.Y=Va,z.Z=Ge,z._=u,z.a=kr,z.a$=function(a,t,n){var o=Math.sin(n),d=Math.cos(n),g=t[4],_=t[5],w=t[6],E=t[7],P=t[8],D=t[9],O=t[10],U=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=g*d+P*o,a[5]=_*d+D*o,a[6]=w*d+O*o,a[7]=E*d+U*o,a[8]=P*d-g*o,a[9]=D*d-_*o,a[10]=O*d-w*o,a[11]=U*d-E*o,a},z.a0=25,z.a1=bf,z.a2=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const o of a){const d=window.document.createElement("source");Ce(o)||(t.crossOrigin="Anonymous"),d.src=o,t.appendChild(d)}})},z.a3=qe,z.a4=function(){return li++},z.a5=ae,z.a6=uh,z.a7=ra,z.a8=ca,z.a9=Yi,z.aA=function(a,t,n,o,d=!1){if(!n[0]&&!n[1])return[0,0];const g=d?o==="map"?-a.bearingInRadians:0:o==="viewport"?a.bearingInRadians:0;if(g){const _=Math.sin(g),w=Math.cos(g);n=[n[0]*w-n[1]*_,n[0]*_+n[1]*w]}return[d?n[0]:gt(t,n[0],a.zoom),d?n[1]:gt(t,n[1],a.zoom)]},z.aC=lh,z.aD=Af,z.aE=df,z.aF=Pf,z.aG=rr,z.aH=zr,z.aI=$e,z.aJ=Ti,z.aK=xi,z.aL=It,z.aM=bs,z.aN=hh,z.aO=function(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a[2]=t[2]*n,a},z.aP=function(a,t,n){return a[0]=t[0]+n[0],a[1]=t[1]+n[1],a[2]=t[2]+n[2],a},z.aQ=function(a){var t=new Bt(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},z.aR=function(a,t,n){return a[0]=t[0]*n[0],a[1]=t[1]*n[1],a[2]=t[2]*n[2],a[3]=t[3]*n[3],a},z.aS=function(a,t,n){return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],a},z.aT=function(a,t){var n=t[0],o=t[1],d=t[2],g=n*n+o*o+d*d;return g>0&&(g=1/Math.sqrt(g)),a[0]=t[0]*g,a[1]=t[1]*g,a[2]=t[2]*g,a},z.aU=function(a,t,n){var o=t[0],d=t[1],g=t[2],_=n[0],w=n[1],E=n[2];return a[0]=d*E-g*w,a[1]=g*_-o*E,a[2]=o*w-d*_,a},z.aV=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},z.aW=jm,z.aX=nu,z.aY=function(a,t,n,o,d){var g,_=1/Math.tan(t/2);return a[0]=_/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=_,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,d!=null&&d!==1/0?(a[10]=(d+o)*(g=1/(o-d)),a[14]=2*d*o*g):(a[10]=-1,a[14]=-2*o),a},z.aZ=function(a){var t=new Bt(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},z.a_=function(a,t,n){var o=Math.sin(n),d=Math.cos(n),g=t[0],_=t[1],w=t[2],E=t[3],P=t[4],D=t[5],O=t[6],U=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=g*d+P*o,a[1]=_*d+D*o,a[2]=w*d+O*o,a[3]=E*d+U*o,a[4]=P*d-g*o,a[5]=D*d-_*o,a[6]=O*d-w*o,a[7]=U*d-E*o,a},z.aa=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,d,g)=>{const _=d||g;return t[o]=!_||_.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},z.ab=Ws,z.ac=function(a){return Math.pow(2,a)},z.ad=ti,z.ae=Ct,z.af=85.051129,z.ag=Dp,z.ah=function(a){return Math.log(a)/Math.LN2},z.ai=function(a){var t=a[0],n=a[1];return t*t+n*n},z.aj=function(a,t){const n=[];for(const o in a)o in t||n.push(o);return n},z.ak=function(a,t){let n=0,o=0;if(a.kind==="constant")o=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:d,minZoom:g,maxZoom:_}=a,w=d?Ct(gn.interpolationFactor(d,t,g,_),0,1):0;a.kind==="camera"?o=Xa.number(a.minSize,a.maxSize,w):n=w}return{uSizeT:n,uSize:o}},z.am=function(a,{uSize:t,uSizeT:n},{lowerSize:o,upperSize:d}){return a.kind==="source"?o/Eo:a.kind==="composite"?Xa.number(o/Eo,d/Eo,n):t},z.an=function(a,t){var n=t[0],o=t[1],d=t[2],g=t[3],_=t[4],w=t[5],E=t[6],P=t[7],D=t[8],O=t[9],U=t[10],V=t[11],q=t[12],H=t[13],J=t[14],se=t[15],ye=n*w-o*_,le=n*E-d*_,N=n*P-g*_,W=o*E-d*w,de=o*P-g*w,Le=d*P-g*E,rt=D*H-O*q,Fe=D*J-U*q,Xe=D*se-V*q,ot=O*J-U*H,at=O*se-V*H,ct=U*se-V*J,Qe=ye*ct-le*at+N*ot+W*Xe-de*Fe+Le*rt;return Qe?(a[0]=(w*ct-E*at+P*ot)*(Qe=1/Qe),a[1]=(d*at-o*ct-g*ot)*Qe,a[2]=(H*Le-J*de+se*W)*Qe,a[3]=(U*de-O*Le-V*W)*Qe,a[4]=(E*Xe-_*ct-P*Fe)*Qe,a[5]=(n*ct-d*Xe+g*Fe)*Qe,a[6]=(J*N-q*Le-se*le)*Qe,a[7]=(D*Le-U*N+V*le)*Qe,a[8]=(_*at-w*Xe+P*rt)*Qe,a[9]=(o*Xe-n*at-g*rt)*Qe,a[10]=(q*de-H*N+se*ye)*Qe,a[11]=(O*N-D*de-V*ye)*Qe,a[12]=(w*Fe-_*ot-E*rt)*Qe,a[13]=(n*ot-o*Fe+d*rt)*Qe,a[14]=(H*le-q*W-J*ye)*Qe,a[15]=(D*W-O*le+U*ye)*Qe,a):null},z.ao=we,z.ap=function(a){return Math.hypot(a[0],a[1])},z.aq=function(a){return a[0]=0,a[1]=0,a},z.ar=function(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a},z.as=od,z.at=Et,z.au=function(a,t,n,o){const d=t.y-a.y,g=t.x-a.x,_=o.y-n.y,w=o.x-n.x,E=_*g-w*d;if(E===0)return null;const P=(w*(a.y-n.y)-_*(a.x-n.x))/E;return new Pe(a.x+P*g,a.y+P*d)},z.av=wf,z.aw=Nd,z.ax=function(a){let t=1/0,n=1/0,o=-1/0,d=-1/0;for(const g of a)t=Math.min(t,g.x),n=Math.min(n,g.y),o=Math.max(o,g.x),d=Math.max(d,g.y);return[t,n,o,d]},z.ay=jr,z.az=gt,z.b=Rr,z.b$=class extends G{},z.b0=function(){const a=new Float32Array(16);return ti(a),a},z.b1=function(){const a=new Float64Array(16);return ti(a),a},z.b2=function(){return new Float64Array(16)},z.b3=function(a,t,n){const o=new Float64Array(4);return function(d,g,_,w){var E=.5*Math.PI/180;g*=E,_*=E,w*=E;var P=Math.sin(g),D=Math.cos(g),O=Math.sin(_),U=Math.cos(_),V=Math.sin(w),q=Math.cos(w);d[0]=P*U*q-D*O*V,d[1]=D*O*q+P*U*V,d[2]=D*U*V-P*O*q,d[3]=D*U*q+P*O*V}(o,a,t-90,n),o},z.b4=function(a,t,n,o){var d,g,_,w,E,P=t[0],D=t[1],O=t[2],U=t[3],V=n[0],q=n[1],H=n[2],J=n[3];return(g=P*V+D*q+O*H+U*J)<0&&(g=-g,V=-V,q=-q,H=-H,J=-J),1-g>xt?(d=Math.acos(g),_=Math.sin(d),w=Math.sin((1-o)*d)/_,E=Math.sin(o*d)/_):(w=1-o,E=o),a[0]=w*P+E*V,a[1]=w*D+E*q,a[2]=w*O+E*H,a[3]=w*U+E*J,a},z.b5=function(a){const t=new Float64Array(9);var n,o,d,g,_,w,E,P,D,O,U,V,q,H,J,se,ye,le;O=(d=(o=a)[0])*(E=d+d),U=(g=o[1])*E,q=(_=o[2])*E,H=_*(P=g+g),se=(w=o[3])*E,ye=w*P,le=w*(D=_+_),(n=t)[0]=1-(V=g*P)-(J=_*D),n[3]=U-le,n[6]=q+ye,n[1]=U+le,n[4]=1-O-J,n[7]=H-se,n[2]=q-ye,n[5]=H+se,n[8]=1-O-V;const N=bs(-Math.asin(Ct(t[2],-1,1)));let W,de;return Math.hypot(t[5],t[8])<.001?(W=0,de=-bs(Math.atan2(t[3],t[4]))):(W=bs(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),de=bs(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:W,pitch:N+90,bearing:de}},z.b6=function(a,t){return a.roll==t.roll&&a.pitch==t.pitch&&a.bearing==t.bearing},z.b7=ui,z.b8=Xc,z.b9=nc,z.bA=function(a){if(a.type==="custom")return new vg(a);switch(a.type){case"background":return new Om(a);case"circle":return new mm(a);case"fill":return new pp(a);case"fill-extrusion":return new Hi(a);case"heatmap":return new op(a);case"hillshade":return new Hd(a);case"line":return new td(a);case"raster":return new Pp(a);case"symbol":return new gf(a)}},z.bB=Bi,z.bC=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let n=[];try{if(!De(a.version,t.version))return[{command:"setStyle",args:[t]}];De(a.center,t.center)||n.push({command:"setCenter",args:[t.center]}),De(a.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),De(a.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),De(a.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),De(a.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),De(a.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),De(a.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),De(a.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),De(a.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),De(a.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),De(a.light,t.light)||n.push({command:"setLight",args:[t.light]}),De(a.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),De(a.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),De(a.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const o={},d=[];(function(_,w,E,P){let D;for(D in w=w||{},_=_||{})Object.prototype.hasOwnProperty.call(_,D)&&(Object.prototype.hasOwnProperty.call(w,D)||et(D,E,P));for(D in w)Object.prototype.hasOwnProperty.call(w,D)&&(Object.prototype.hasOwnProperty.call(_,D)?De(_[D],w[D])||(_[D].type==="geojson"&&w[D].type==="geojson"&&_t(_,w,D)?je(E,{command:"setGeoJSONSourceData",args:[D,w[D].data]}):ft(D,w,E,P)):Ae(D,w,E))})(a.sources,t.sources,d,o);const g=[];a.layers&&a.layers.forEach(_=>{"source"in _&&o[_.source]?n.push({command:"removeLayer",args:[_.id]}):g.push(_)}),n=n.concat(d),function(_,w,E){w=w||[];const P=(_=_||[]).map(kt),D=w.map(kt),O=_.reduce(zt,{}),U=w.reduce(zt,{}),V=P.slice(),q=Object.create(null);let H,J,se,ye,le;for(let N=0,W=0;N<P.length;N++)H=P[N],Object.prototype.hasOwnProperty.call(U,H)?W++:(je(E,{command:"removeLayer",args:[H]}),V.splice(V.indexOf(H,W),1));for(let N=0,W=0;N<D.length;N++)H=D[D.length-1-N],V[V.length-1-N]!==H&&(Object.prototype.hasOwnProperty.call(O,H)?(je(E,{command:"removeLayer",args:[H]}),V.splice(V.lastIndexOf(H,V.length-W),1)):W++,ye=V[V.length-N],je(E,{command:"addLayer",args:[U[H],ye]}),V.splice(V.length-N,0,H),q[H]=!0);for(let N=0;N<D.length;N++)if(H=D[N],J=O[H],se=U[H],!q[H]&&!De(J,se))if(De(J.source,se.source)&&De(J["source-layer"],se["source-layer"])&&De(J.type,se.type)){for(le in At(J.layout,se.layout,E,H,null,"setLayoutProperty"),At(J.paint,se.paint,E,H,null,"setPaintProperty"),De(J.filter,se.filter)||je(E,{command:"setFilter",args:[H,se.filter]}),De(J.minzoom,se.minzoom)&&De(J.maxzoom,se.maxzoom)||je(E,{command:"setLayerZoomRange",args:[H,se.minzoom,se.maxzoom]}),J)Object.prototype.hasOwnProperty.call(J,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?At(J[le],se[le],E,H,le.slice(6),"setPaintProperty"):De(J[le],se[le])||je(E,{command:"setLayerProperty",args:[H,le,se[le]]}));for(le in se)Object.prototype.hasOwnProperty.call(se,le)&&!Object.prototype.hasOwnProperty.call(J,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?At(J[le],se[le],E,H,le.slice(6),"setPaintProperty"):De(J[le],se[le])||je(E,{command:"setLayerProperty",args:[H,le,se[le]]}))}else je(E,{command:"removeLayer",args:[H]}),ye=V[V.lastIndexOf(H)+1],je(E,{command:"addLayer",args:[se,ye]})}(g,t.layers,n)}catch(o){console.warn("Unable to compute style diff:",o),n=[{command:"setStyle",args:[t]}]}return n},z.bD=function(a){const t=[],n=a.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},z.bE=function a(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(!a(t[o],n[o]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const o in t)if(!a(t[o],n[o]))return!1;return!0}return t===n},z.bF=er,z.bG=lr,z.bH=class extends Li{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},z.bI=Fd,z.bJ=class extends Li{constructor(a,t){super(a,t),this.current=tc}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},z.bK=Gh,z.bL=class extends Li{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},z.bM=class extends Li{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},z.bN=Pi,z.bO=function(a,t){var n=Math.sin(t),o=Math.cos(t);return a[0]=o,a[1]=n,a[2]=0,a[3]=-n,a[4]=o,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},z.bP=function(a,t,n){var o=t[0],d=t[1],g=t[2];return a[0]=o*n[0]+d*n[3]+g*n[6],a[1]=o*n[1]+d*n[4]+g*n[7],a[2]=o*n[2]+d*n[5]+g*n[8],a},z.bQ=function(a,t,n,o,d,g,_){var w=1/(t-n),E=1/(o-d),P=1/(g-_);return a[0]=-2*w,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*E,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*P,a[11]=0,a[12]=(t+n)*w,a[13]=(d+o)*E,a[14]=(_+g)*P,a[15]=1,a},z.bR=class extends Li{constructor(a,t){super(a,t),this.current=new Array}set(a){if(a!=this.current){this.current=a;const t=new Float32Array(4*a.length);for(let n=0;n<a.length;n++)t[4*n]=a[n].r,t[4*n+1]=a[n].g,t[4*n+2]=a[n].b,t[4*n+3]=a[n].a;this.gl.uniform4fv(this.location,t)}}},z.bS=class extends Li{constructor(a,t){super(a,t),this.current=new Array}set(a){if(a!=this.current){this.current=a;const t=new Float32Array(a);this.gl.uniform1fv(this.location,t)}}},z.bT=class extends m{},z.bU=cc,z.bV=class extends M{},z.bW=Qh,z.bX=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},z.bY=Gd,z.bZ=function(a,t,n){var o=t[0],d=t[1],g=t[2],_=n[3]*o+n[7]*d+n[11]*g+n[15];return a[0]=(n[0]*o+n[4]*d+n[8]*g+n[12])/(_=_||1),a[1]=(n[1]*o+n[5]*d+n[9]*g+n[13])/_,a[2]=(n[2]*o+n[6]*d+n[10]*g+n[14])/_,a},z.b_=class extends Ls{},z.ba=Ju,z.bb=Sa,z.bc=Ke,z.bd=lt,z.be=Jr,z.bf=function(a,t,n,o,d){return Ke(o,d,Ct((a-t)/(n-t),0,1))},z.bg=ue,z.bh=function(){return new Float64Array(3)},z.bi=function(a,t,n,o){return a[0]=t[0]+n[0]*o,a[1]=t[1]+n[1]*o,a[2]=t[2]+n[2]*o,a},z.bj=xr,z.bk=function(){return new Float64Array(4)},z.bl=function(a,t,n,o){var d=[],g=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],g[0]=d[0]*Math.cos(o)-d[1]*Math.sin(o),g[1]=d[0]*Math.sin(o)+d[1]*Math.cos(o),g[2]=d[2],a[0]=g[0]+n[0],a[1]=g[1]+n[1],a[2]=g[2]+n[2],a},z.bm=function(a,t,n,o){var d=[],g=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],g[0]=d[0],g[1]=d[1]*Math.cos(o)-d[2]*Math.sin(o),g[2]=d[1]*Math.sin(o)+d[2]*Math.cos(o),a[0]=g[0]+n[0],a[1]=g[1]+n[1],a[2]=g[2]+n[2],a},z.bn=function(a,t,n,o){var d=[],g=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],g[0]=d[2]*Math.sin(o)+d[0]*Math.cos(o),g[1]=d[1],g[2]=d[2]*Math.cos(o)-d[0]*Math.sin(o),a[0]=g[0]+n[0],a[1]=g[1]+n[1],a[2]=g[2]+n[2],a},z.bo=Mi,z.bp=function(a,t,n){var o=Math.sin(n),d=Math.cos(n),g=t[0],_=t[1],w=t[2],E=t[3],P=t[8],D=t[9],O=t[10],U=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=g*d-P*o,a[1]=_*d-D*o,a[2]=w*d-O*o,a[3]=E*d-U*o,a[8]=g*o+P*d,a[9]=_*o+D*d,a[10]=w*o+O*d,a[11]=E*o+U*d,a},z.bq=function(a,t){const n=ue(a,360),o=ue(t,360),d=o-n,g=o>n?d-360:d+360;return Math.abs(d)<Math.abs(g)?d:g},z.br=function(a){return a[0]=0,a[1]=0,a[2]=0,a},z.bs=function(a,t,n,o){const d=Math.sqrt(a*a+t*t),g=Math.sqrt(n*n+o*o);a/=d,t/=d,n/=g,o/=g;const _=Math.acos(a*n+t*o);return-t*n+a*o>0?_:-_},z.bt=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]},z.bu=Ip,z.bv=function(a,t){const n=ue(a,2*Math.PI),o=ue(t,2*Math.PI);return Math.min(Math.abs(n-o),Math.abs(n-o+2*Math.PI),Math.abs(n-o-2*Math.PI))},z.bw=function(){const a={},t=ee.$version;for(const n in ee.$root){const o=ee.$root[n];if(o.required){let d=null;d=n==="version"?t:o.type==="array"?[]:{},d!=null&&(a[n]=d)}}return a},z.bx=Nu,z.by=cn,z.bz=function(a){a=a.slice();const t=Object.create(null);for(let n=0;n<a.length;n++)t[a[n].id]=a[n];for(let n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=Se(a[n],t[a[n].ref]));return a},z.c=mn,z.c0=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},z.c1=function(a,t){var n=a[0],o=a[1],d=a[2],g=a[3],_=a[4],w=a[5],E=a[6],P=a[7],D=a[8],O=a[9],U=a[10],V=a[11],q=a[12],H=a[13],J=a[14],se=a[15],ye=t[0],le=t[1],N=t[2],W=t[3],de=t[4],Le=t[5],rt=t[6],Fe=t[7],Xe=t[8],ot=t[9],at=t[10],ct=t[11],Qe=t[12],wt=t[13],Dt=t[14],Pt=t[15];return Math.abs(n-ye)<=xt*Math.max(1,Math.abs(n),Math.abs(ye))&&Math.abs(o-le)<=xt*Math.max(1,Math.abs(o),Math.abs(le))&&Math.abs(d-N)<=xt*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(g-W)<=xt*Math.max(1,Math.abs(g),Math.abs(W))&&Math.abs(_-de)<=xt*Math.max(1,Math.abs(_),Math.abs(de))&&Math.abs(w-Le)<=xt*Math.max(1,Math.abs(w),Math.abs(Le))&&Math.abs(E-rt)<=xt*Math.max(1,Math.abs(E),Math.abs(rt))&&Math.abs(P-Fe)<=xt*Math.max(1,Math.abs(P),Math.abs(Fe))&&Math.abs(D-Xe)<=xt*Math.max(1,Math.abs(D),Math.abs(Xe))&&Math.abs(O-ot)<=xt*Math.max(1,Math.abs(O),Math.abs(ot))&&Math.abs(U-at)<=xt*Math.max(1,Math.abs(U),Math.abs(at))&&Math.abs(V-ct)<=xt*Math.max(1,Math.abs(V),Math.abs(ct))&&Math.abs(q-Qe)<=xt*Math.max(1,Math.abs(q),Math.abs(Qe))&&Math.abs(H-wt)<=xt*Math.max(1,Math.abs(H),Math.abs(wt))&&Math.abs(J-Dt)<=xt*Math.max(1,Math.abs(J),Math.abs(Dt))&&Math.abs(se-Pt)<=xt*Math.max(1,Math.abs(se),Math.abs(Pt))},z.c2=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},z.c3=a=>a.type==="symbol",z.c4=a=>a.type==="circle",z.c5=a=>a.type==="heatmap",z.c6=a=>a.type==="line",z.c7=a=>a.type==="fill",z.c8=a=>a.type==="fill-extrusion",z.c9=a=>a.type==="hillshade",z.cA=qs,z.cB=Kc,z.cC=fl,z.cD=da,z.cE=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},z.cF=function(a,t,n,o,d){return u(this,void 0,void 0,function*(){if(qt())try{return yield Ml(a,t,n,o,d)}catch{}return function(g,_,w,E,P){const D=g.width,O=g.height;Fn&&Qn||(Fn=new OffscreenCanvas(D,O),Qn=Fn.getContext("2d",{willReadFrequently:!0})),Fn.width=D,Fn.height=O,Qn.drawImage(g,0,0,D,O);const U=Qn.getImageData(_,w,E,P);return Qn.clearRect(0,0,D,O),U.data}(a,t,n,o,d)})},z.cG=Rp,z.cH=oe,z.cI=Te,z.cJ=eh,z.cK=lf,z.cL=Cs,z.cM=as,z.ca=a=>a.type==="raster",z.cb=a=>a.type==="background",z.cc=a=>a.type==="custom",z.cd=ut,z.ce=function(a,t,n){const o=We(t.x-n.x,t.y-n.y),d=We(a.x-n.x,a.y-n.y);var g,_;return bs(Math.atan2(o[0]*d[1]-o[1]*d[0],(g=o)[0]*(_=d)[0]+g[1]*_[1]))},z.cf=vt,z.cg=function(a,t){return $a[t]&&(a instanceof MouseEvent||a instanceof WheelEvent)},z.ch=function(a,t){return El[t]&&"touches"in a},z.ci=function(a){return El[a]||$a[a]},z.cj=function(a,t,n){var o=t[0],d=t[1];return a[0]=n[0]*o+n[4]*d+n[12],a[1]=n[1]*o+n[5]*d+n[13],a},z.ck=function(a,t){const{x:n,y:o}=fc.fromLngLat(t);return!(a<0||a>25||o<0||o>=1||n<0||n>=1)},z.cl=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},z.cm=class extends ll{},z.cn=Mg,z.cp=function(a){return a.message===Wr},z.cq=pa,z.cr=function(a,t){kr.REGISTERED_PROTOCOLS[a]=t},z.cs=function(a){delete kr.REGISTERED_PROTOCOLS[a]},z.ct=function(a,t){const n={};for(let d=0;d<a.length;d++){const g=t&&t[a[d].id]||Ia(a[d]);t&&(t[a[d].id]=g);let _=n[g];_||(_=n[g]=[]),_.push(a[d])}const o=[];for(const d in n)o.push(n[d]);return o},z.cu=yt,z.cv=hd,z.cw=xf,z.cx=Jc,z.cy=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Ge/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],n=t.layout,o=t._unevaluatedLayout._values,d={layoutIconSize:o["icon-size"].possiblyEvaluate(new Gi(a.bucket.zoom+1),a.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Gi(a.bucket.zoom+1),a.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Gi(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:D}=a.bucket.textSizeData;d.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Gi(P),a.canonical),o["text-size"].possiblyEvaluate(new Gi(D),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:D}=a.bucket.iconSizeData;d.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Gi(P),a.canonical),o["icon-size"].possiblyEvaluate(new Gi(D),a.canonical)]}const g=n.get("text-line-height")*jr,_=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",w=n.get("text-keep-upright"),E=n.get("text-size");for(const P of a.bucket.features){const D=n.get("text-font").evaluate(P,{},a.canonical).join(","),O=E.evaluate(P,{},a.canonical),U=d.layoutTextSize.evaluate(P,{},a.canonical),V=d.layoutIconSize.evaluate(P,{},a.canonical),q={horizontal:{},vertical:void 0},H=P.text;let J,se=[0,0];if(H){const N=H.toString(),W=n.get("text-letter-spacing").evaluate(P,{},a.canonical)*jr,de=jd(N)?W:0,Le=n.get("text-anchor").evaluate(P,{},a.canonical),rt=Za(t,P,a.canonical);if(!rt){const at=n.get("text-radial-offset").evaluate(P,{},a.canonical);se=at?ph(Le,[at*jr,Cf]):n.get("text-offset").evaluate(P,{},a.canonical).map(ct=>ct*jr)}let Fe=_?"center":n.get("text-justify").evaluate(P,{},a.canonical);const Xe=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(P,{},a.canonical)*jr:1/0,ot=()=>{a.bucket.allowVerticalPlacement&&Vc(N)&&(q.vertical=ah(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Xe,g,Le,"left",de,se,z.al.vertical,!0,U,O))};if(!_&&rt){const at=new Set;if(Fe==="auto")for(let Qe=0;Qe<rt.values.length;Qe+=2)at.add(Af(rt.values[Qe]));else at.add(Fe);let ct=!1;for(const Qe of at)if(!q.horizontal[Qe])if(ct)q.horizontal[Qe]=q.horizontal[0];else{const wt=ah(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Xe,g,"center",Qe,de,se,z.al.horizontal,!1,U,O);wt&&(q.horizontal[Qe]=wt,ct=wt.positionedLines.length===1)}ot()}else{Fe==="auto"&&(Fe=Af(Le));const at=ah(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Xe,g,Le,Fe,de,se,z.al.horizontal,!1,U,O);at&&(q.horizontal[Fe]=at),ot(),Vc(N)&&_&&w&&(q.vertical=ah(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Xe,g,Le,Fe,de,se,z.al.vertical,!1,U,O))}}let ye=!1;if(P.icon&&P.icon.name){const N=a.imageMap[P.icon.name];N&&(J=or(a.imagePositions[P.icon.name],n.get("icon-offset").evaluate(P,{},a.canonical),n.get("icon-anchor").evaluate(P,{},a.canonical)),ye=!!N.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=ye:a.bucket.sdfIcons!==ye&&tr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(N.pixelRatio!==a.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const le=Zm(q.horizontal)||q.vertical;a.bucket.iconsInText=!!le&&le.iconsInText,(le||J)&&zf(a.bucket,P,q,J,a.imageMap,d,U,V,se,ye,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},z.cz=Pr,z.d=Ce,z.e=di,z.f=a=>u(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),z.g=Js,z.h=a=>new Promise((t,n)=>{const o=new Image;o.onload=()=>{t(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=wc})},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(a)],{type:"image/png"});o.src=a.byteLength?URL.createObjectURL(d):wc}),z.i=qa,z.j=(a,t)=>Kn(di(a,{type:"json"}),t),z.k=he,z.l=te,z.m=Kn,z.n=(a,t)=>Kn(di(a,{type:"arrayBuffer"}),t),z.o=function(a){return new da(a).readFields(Na,[])},z.p=gl,z.q=Yu,z.r=ur,z.s=Io,z.t=Fc,z.u=ii,z.v=ee,z.w=tr,z.x=Uc,z.y=Ql,z.z=function([a,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(n),y:a*Math.sin(t)*Math.sin(n),z:a*Math.cos(n)}}}),R("worker",["./shared"],function(z){class u{constructor(X){this.keyCache={},X&&this.replace(X)}replace(X){this._layerConfigs={},this._layers={},this.update(X,[])}update(X,Y){for(const he of X){this._layerConfigs[he.id]=he;const be=this._layers[he.id]=z.bA(he);be._featureFilter=z.a7(be.filter),this.keyCache[he.id]&&delete this.keyCache[he.id]}for(const he of Y)delete this.keyCache[he],delete this._layerConfigs[he],delete this._layers[he];this.familiesBySource={};const te=z.ct(Object.values(this._layerConfigs),this.keyCache);for(const he of te){const be=he.map(Ae=>this._layers[Ae.id]),ee=be[0];if(ee.visibility==="none")continue;const Re=ee.source||"";let Se=this.familiesBySource[Re];Se||(Se=this.familiesBySource[Re]={});const De=ee.sourceLayer||"_geojsonTileLayer";let je=Se[De];je||(je=Se[De]=[]),je.push(be)}}}class oe{constructor(X){const Y={},te=[];for(const Re in X){const Se=X[Re],De=Y[Re]={};for(const je in Se){const Ae=Se[+je];if(!Ae||Ae.bitmap.width===0||Ae.bitmap.height===0)continue;const et={x:0,y:0,w:Ae.bitmap.width+2,h:Ae.bitmap.height+2};te.push(et),De[je]={rect:et,metrics:Ae.metrics}}}const{w:he,h:be}=z.p(te),ee=new z.q({width:he||1,height:be||1});for(const Re in X){const Se=X[Re];for(const De in Se){const je=Se[+De];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const Ae=Y[Re][De].rect;z.q.copy(je.bitmap,ee,{x:0,y:0},{x:Ae.x+1,y:Ae.y+1},je.bitmap)}}this.image=ee,this.positions=Y}}z.cu("GlyphAtlas",oe);class Q{constructor(X){this.tileID=new z.Y(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.uid=X.uid,this.zoom=X.zoom,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=X.showCollisionBoxes,this.collectResourceTiming=!!X.collectResourceTiming,this.returnDependencies=!!X.returnDependencies,this.promoteId=X.promoteId,this.inFlightDependencies=[]}parse(X,Y,te,he,be){return z._(this,void 0,void 0,function*(){this.status="parsing",this.data=X,this.collisionBoxArray=new z.a5;const ee=new z.cv(Object.keys(X.layers).sort()),Re=new z.cw(this.tileID,this.promoteId);Re.bucketLayerIDs=[];const Se={},De={featureIndex:Re,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:te,subdivisionGranularity:be},je=Y.familiesBySource[this.source];for(const Zt in je){const Je=X.layers[Zt];if(!Je)continue;Je.version===1&&z.w(`Vector tile source "${this.source}" layer "${Zt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ft=ee.encode(Zt),Gt=[];for(let ji=0;ji<Je.length;ji++){const qi=Je.feature(ji),$r=Re.getId(qi,Zt);Gt.push({feature:qi,id:$r,index:ji,sourceLayerIndex:Ft})}for(const ji of je[Zt]){const qi=ji[0];qi.source!==this.source&&z.w(`layer.source = ${qi.source} does not equal this.source = ${this.source}`),qi.minzoom&&this.zoom<Math.floor(qi.minzoom)||qi.maxzoom&&this.zoom>=qi.maxzoom||qi.visibility!=="none"&&(ve(ji,this.zoom,te),(Se[qi.id]=qi.createBucket({index:Re.bucketLayerIDs.length,layers:ji,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ft,sourceID:this.source})).populate(Gt,De,this.tileID.canonical),Re.bucketLayerIDs.push(ji.map($r=>$r.id)))}}const Ae=z.bF(De.glyphDependencies,Zt=>Object.keys(Zt).map(Number));this.inFlightDependencies.forEach(Zt=>Zt==null?void 0:Zt.abort()),this.inFlightDependencies=[];let et=Promise.resolve({});if(Object.keys(Ae).length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),et=he.sendAsync({type:"GG",data:{stacks:Ae,source:this.source,tileID:this.tileID,type:"glyphs"}},Zt)}const ft=Object.keys(De.iconDependencies);let _t=Promise.resolve({});if(ft.length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),_t=he.sendAsync({type:"GI",data:{icons:ft,source:this.source,tileID:this.tileID,type:"icons"}},Zt)}const At=Object.keys(De.patternDependencies);let kt=Promise.resolve({});if(At.length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),kt=he.sendAsync({type:"GI",data:{icons:At,source:this.source,tileID:this.tileID,type:"patterns"}},Zt)}const[zt,qe,yi]=yield Promise.all([et,_t,kt]),ci=new oe(zt),vi=new z.cx(qe,yi);for(const Zt in Se){const Je=Se[Zt];Je instanceof z.a6?(ve(Je.layers,this.zoom,te),z.cy({bucket:Je,glyphMap:zt,glyphPositions:ci.positions,imageMap:qe,imagePositions:vi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:De.subdivisionGranularity})):Je.hasPattern&&(Je instanceof z.cz||Je instanceof z.cA||Je instanceof z.cB)&&(ve(Je.layers,this.zoom,te),Je.addFeatures(De,this.tileID.canonical,vi.patternPositions))}return this.status="done",{buckets:Object.values(Se).filter(Zt=>!Zt.isEmpty()),featureIndex:Re,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ci.image,imageAtlas:vi,glyphMap:this.returnDependencies?zt:null,iconMap:this.returnDependencies?qe:null,glyphPositions:this.returnDependencies?ci.positions:null}})}}function ve(Ce,X,Y){const te=new z.C(X);for(const he of Ce)he.recalculate(te,Y)}class Te{constructor(X,Y,te){this.actor=X,this.layerIndex=Y,this.availableImages=te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(X,Y){return z._(this,void 0,void 0,function*(){const te=yield z.n(X.request,Y);try{return{vectorTile:new z.cC.VectorTile(new z.cD(te.data)),rawData:te.data,cacheControl:te.cacheControl,expires:te.expires}}catch(he){const be=new Uint8Array(te.data);let ee=`Unable to parse the tile at ${X.request.url}, `;throw ee+=be[0]===31&&be[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${he.message}`,new Error(ee)}})}loadTile(X){return z._(this,void 0,void 0,function*(){const Y=X.uid,te=!!(X&&X.request&&X.request.collectResourceTiming)&&new z.cE(X.request),he=new Q(X);this.loading[Y]=he;const be=new AbortController;he.abort=be;try{const ee=yield this.loadVectorTile(X,be);if(delete this.loading[Y],!ee)return null;const Re=ee.rawData,Se={};ee.expires&&(Se.expires=ee.expires),ee.cacheControl&&(Se.cacheControl=ee.cacheControl);const De={};if(te){const Ae=te.finish();Ae&&(De.resourceTiming=JSON.parse(JSON.stringify(Ae)))}he.vectorTile=ee.vectorTile;const je=he.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,X.subdivisionGranularity);this.loaded[Y]=he,this.fetching[Y]={rawTileData:Re,cacheControl:Se,resourceTiming:De};try{const Ae=yield je;return z.e({rawTileData:Re.slice(0)},Ae,Se,De)}finally{delete this.fetching[Y]}}catch(ee){throw delete this.loading[Y],he.status="done",this.loaded[Y]=he,ee}})}reloadTile(X){return z._(this,void 0,void 0,function*(){const Y=X.uid;if(!this.loaded||!this.loaded[Y])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const te=this.loaded[Y];if(te.showCollisionBoxes=X.showCollisionBoxes,te.status==="parsing"){const he=yield te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,X.subdivisionGranularity);let be;if(this.fetching[Y]){const{rawTileData:ee,cacheControl:Re,resourceTiming:Se}=this.fetching[Y];delete this.fetching[Y],be=z.e({rawTileData:ee.slice(0)},he,Re,Se)}else be=he;return be}if(te.status==="done"&&te.vectorTile)return te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,X.subdivisionGranularity)})}abortTile(X){return z._(this,void 0,void 0,function*(){const Y=this.loading,te=X.uid;Y&&Y[te]&&Y[te].abort&&(Y[te].abort.abort(),delete Y[te])})}removeTile(X){return z._(this,void 0,void 0,function*(){this.loaded&&this.loaded[X.uid]&&delete this.loaded[X.uid]})}}class Ee{constructor(){this.loaded={}}loadTile(X){return z._(this,void 0,void 0,function*(){const{uid:Y,encoding:te,rawImageData:he,redFactor:be,greenFactor:ee,blueFactor:Re,baseShift:Se}=X,De=he.width+2,je=he.height+2,Ae=z.b(he)?new z.R({width:De,height:je},yield z.cF(he,-1,-1,De,je)):he,et=new z.cG(Y,Ae,te,be,ee,Re,Se);return this.loaded=this.loaded||{},this.loaded[Y]=et,et})}removeTile(X){const Y=this.loaded,te=X.uid;Y&&Y[te]&&delete Y[te]}}var ne,Pe,Ze=function(){if(Pe)return ne;function Ce(Y,te){if(Y.length!==0){X(Y[0],te);for(var he=1;he<Y.length;he++)X(Y[he],!te)}}function X(Y,te){for(var he=0,be=0,ee=0,Re=Y.length,Se=Re-1;ee<Re;Se=ee++){var De=(Y[ee][0]-Y[Se][0])*(Y[Se][1]+Y[ee][1]),je=he+De;be+=Math.abs(he)>=Math.abs(De)?he-je+De:De-je+he,he=je}he+be>=0!=!!te&&Y.reverse()}return Pe=1,ne=function Y(te,he){var be,ee=te&&te.type;if(ee==="FeatureCollection")for(be=0;be<te.features.length;be++)Y(te.features[be],he);else if(ee==="GeometryCollection")for(be=0;be<te.geometries.length;be++)Y(te.geometries[be],he);else if(ee==="Feature")Y(te.geometry,he);else if(ee==="Polygon")Ce(te.coordinates,he);else if(ee==="MultiPolygon")for(be=0;be<te.coordinates.length;be++)Ce(te.coordinates[be],he);return te}}(),bt=z.cH(Ze);const Vt=z.cC.VectorTileFeature.prototype.toGeoJSON;class Ot{constructor(X){this._feature=X,this.extent=z.Z,this.type=X.type,this.properties=X.tags,"id"in X&&!isNaN(X.id)&&(this.id=parseInt(X.id,10))}loadGeometry(){if(this._feature.type===1){const X=[];for(const Y of this._feature.geometry)X.push([new z.P(Y[0],Y[1])]);return X}{const X=[];for(const Y of this._feature.geometry){const te=[];for(const he of Y)te.push(new z.P(he[0],he[1]));X.push(te)}return X}}toGeoJSON(X,Y,te){return Vt.call(this,X,Y,te)}}class Tt{constructor(X){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=z.Z,this.length=X.length,this._features=X}feature(X){return new Ot(this._features[X])}}var qt,xt,Bt,Pi={exports:{}},ti=function(){if(Bt)return Pi.exports;Bt=1;var Ce=z.cK(),X=function(){if(xt)return qt;xt=1;var je=z.cI(),Ae=z.cJ().VectorTileFeature;function et(_t,At){this.options=At||{},this.features=_t,this.length=_t.length}function ft(_t,At){this.id=typeof _t.id=="number"?_t.id:void 0,this.type=_t.type,this.rawGeometry=_t.type===1?[_t.geometry]:_t.geometry,this.properties=_t.tags,this.extent=At||4096}return qt=et,et.prototype.feature=function(_t){return new ft(this.features[_t],this.options.extent)},ft.prototype.loadGeometry=function(){var _t=this.rawGeometry;this.geometry=[];for(var At=0;At<_t.length;At++){for(var kt=_t[At],zt=[],qe=0;qe<kt.length;qe++)zt.push(new je(kt[qe][0],kt[qe][1]));this.geometry.push(zt)}return this.geometry},ft.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _t=this.geometry,At=1/0,kt=-1/0,zt=1/0,qe=-1/0,yi=0;yi<_t.length;yi++)for(var ci=_t[yi],vi=0;vi<ci.length;vi++){var Zt=ci[vi];At=Math.min(At,Zt.x),kt=Math.max(kt,Zt.x),zt=Math.min(zt,Zt.y),qe=Math.max(qe,Zt.y)}return[At,zt,kt,qe]},ft.prototype.toGeoJSON=Ae.prototype.toGeoJSON,qt}();function Y(je){var Ae=new Ce;return function(et,ft){for(var _t in et.layers)ft.writeMessage(3,te,et.layers[_t])}(je,Ae),Ae.finish()}function te(je,Ae){var et;Ae.writeVarintField(15,je.version||1),Ae.writeStringField(1,je.name||""),Ae.writeVarintField(5,je.extent||4096);var ft={keys:[],values:[],keycache:{},valuecache:{}};for(et=0;et<je.length;et++)ft.feature=je.feature(et),Ae.writeMessage(2,he,ft);var _t=ft.keys;for(et=0;et<_t.length;et++)Ae.writeStringField(3,_t[et]);var At=ft.values;for(et=0;et<At.length;et++)Ae.writeMessage(4,De,At[et])}function he(je,Ae){var et=je.feature;et.id!==void 0&&Ae.writeVarintField(1,et.id),Ae.writeMessage(2,be,je),Ae.writeVarintField(3,et.type),Ae.writeMessage(4,Se,et)}function be(je,Ae){var et=je.feature,ft=je.keys,_t=je.values,At=je.keycache,kt=je.valuecache;for(var zt in et.properties){var qe=et.properties[zt],yi=At[zt];if(qe!==null){yi===void 0&&(ft.push(zt),At[zt]=yi=ft.length-1),Ae.writeVarint(yi);var ci=typeof qe;ci!=="string"&&ci!=="boolean"&&ci!=="number"&&(qe=JSON.stringify(qe));var vi=ci+":"+qe,Zt=kt[vi];Zt===void 0&&(_t.push(qe),kt[vi]=Zt=_t.length-1),Ae.writeVarint(Zt)}}}function ee(je,Ae){return(Ae<<3)+(7&je)}function Re(je){return je<<1^je>>31}function Se(je,Ae){for(var et=je.loadGeometry(),ft=je.type,_t=0,At=0,kt=et.length,zt=0;zt<kt;zt++){var qe=et[zt],yi=1;ft===1&&(yi=qe.length),Ae.writeVarint(ee(1,yi));for(var ci=ft===3?qe.length-1:qe.length,vi=0;vi<ci;vi++){vi===1&&ft!==1&&Ae.writeVarint(ee(2,ci-1));var Zt=qe[vi].x-_t,Je=qe[vi].y-At;Ae.writeVarint(Re(Zt)),Ae.writeVarint(Re(Je)),_t+=Zt,At+=Je}ft===3&&Ae.writeVarint(ee(7,1))}}function De(je,Ae){var et=typeof je;et==="string"?Ae.writeStringField(1,je):et==="boolean"?Ae.writeBooleanField(7,je):et==="number"&&(je%1!=0?Ae.writeDoubleField(3,je):je<0?Ae.writeSVarintField(6,je):Ae.writeVarintField(5,je))}return Pi.exports=Y,Pi.exports.fromVectorTileJs=Y,Pi.exports.fromGeojsonVt=function(je,Ae){Ae=Ae||{};var et={};for(var ft in je)et[ft]=new X(je[ft].features,Ae),et[ft].name=ft,et[ft].version=Ae.version,et[ft].extent=Ae.extent;return Y({layers:et})},Pi.exports.GeoJSONWrapper=X,Pi.exports}(),Oi=z.cH(ti);const Mi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},Ut=Math.fround||(wi=new Float32Array(1),Ce=>(wi[0]=+Ce,wi[0]));var wi;const xr=3,Et=5,pt=6;class we{constructor(X){this.options=Object.assign(Object.create(Mi),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:Y,minZoom:te,maxZoom:he}=this.options;Y&&console.time("total time");const be=`prepare ${X.length} points`;Y&&console.time(be),this.points=X;const ee=[];for(let Se=0;Se<X.length;Se++){const De=X[Se];if(!De.geometry)continue;const[je,Ae]=De.geometry.coordinates,et=Ut(gt(je)),ft=Ut(ue(Ae));ee.push(et,ft,1/0,Se,-1,1),this.options.reduce&&ee.push(0)}let Re=this.trees[he+1]=this._createTree(ee);Y&&console.timeEnd(be);for(let Se=he;Se>=te;Se--){const De=+Date.now();Re=this.trees[Se]=this._createTree(this._cluster(Re,Se)),Y&&console.log("z%d: %d clusters in %dms",Se,Re.numItems,+Date.now()-De)}return Y&&console.timeEnd("total time"),this}getClusters(X,Y){let te=((X[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,X[1]));let be=X[2]===180?180:((X[2]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)te=-180,be=180;else if(te>be){const Ae=this.getClusters([te,he,180,ee],Y),et=this.getClusters([-180,he,be,ee],Y);return Ae.concat(et)}const Re=this.trees[this._limitZoom(Y)],Se=Re.range(gt(te),ue(ee),gt(be),ue(he)),De=Re.data,je=[];for(const Ae of Se){const et=this.stride*Ae;je.push(De[et+Et]>1?We(De,et,this.clusterProps):this.points[De[et+xr]])}return je}getChildren(X){const Y=this._getOriginId(X),te=this._getOriginZoom(X),he="No cluster with the specified id.",be=this.trees[te];if(!be)throw new Error(he);const ee=be.data;if(Y*this.stride>=ee.length)throw new Error(he);const Re=this.options.radius/(this.options.extent*Math.pow(2,te-1)),Se=be.within(ee[Y*this.stride],ee[Y*this.stride+1],Re),De=[];for(const je of Se){const Ae=je*this.stride;ee[Ae+4]===X&&De.push(ee[Ae+Et]>1?We(ee,Ae,this.clusterProps):this.points[ee[Ae+xr]])}if(De.length===0)throw new Error(he);return De}getLeaves(X,Y,te){const he=[];return this._appendLeaves(he,X,Y=Y||10,te=te||0,0),he}getTile(X,Y,te){const he=this.trees[this._limitZoom(X)],be=Math.pow(2,X),{extent:ee,radius:Re}=this.options,Se=Re/ee,De=(te-Se)/be,je=(te+1+Se)/be,Ae={features:[]};return this._addTileFeatures(he.range((Y-Se)/be,De,(Y+1+Se)/be,je),he.data,Y,te,be,Ae),Y===0&&this._addTileFeatures(he.range(1-Se/be,De,1,je),he.data,be,te,be,Ae),Y===be-1&&this._addTileFeatures(he.range(0,De,Se/be,je),he.data,-1,te,be,Ae),Ae.features.length?Ae:null}getClusterExpansionZoom(X){let Y=this._getOriginZoom(X)-1;for(;Y<=this.options.maxZoom;){const te=this.getChildren(X);if(Y++,te.length!==1)break;X=te[0].properties.cluster_id}return Y}_appendLeaves(X,Y,te,he,be){const ee=this.getChildren(Y);for(const Re of ee){const Se=Re.properties;if(Se&&Se.cluster?be+Se.point_count<=he?be+=Se.point_count:be=this._appendLeaves(X,Se.cluster_id,te,he,be):be<he?be++:X.push(Re),X.length===te)break}return be}_createTree(X){const Y=new z.aF(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let te=0;te<X.length;te+=this.stride)Y.add(X[te],X[te+1]);return Y.finish(),Y.data=X,Y}_addTileFeatures(X,Y,te,he,be,ee){for(const Re of X){const Se=Re*this.stride,De=Y[Se+Et]>1;let je,Ae,et;if(De)je=Ge(Y,Se,this.clusterProps),Ae=Y[Se],et=Y[Se+1];else{const At=this.points[Y[Se+xr]];je=At.properties;const[kt,zt]=At.geometry.coordinates;Ae=gt(kt),et=ue(zt)}const ft={type:1,geometry:[[Math.round(this.options.extent*(Ae*be-te)),Math.round(this.options.extent*(et*be-he))]],tags:je};let _t;_t=De||this.options.generateId?Y[Se+xr]:this.points[Y[Se+xr]].id,_t!==void 0&&(ft.id=_t),ee.features.push(ft)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,Y){const{radius:te,extent:he,reduce:be,minPoints:ee}=this.options,Re=te/(he*Math.pow(2,Y)),Se=X.data,De=[],je=this.stride;for(let Ae=0;Ae<Se.length;Ae+=je){if(Se[Ae+2]<=Y)continue;Se[Ae+2]=Y;const et=Se[Ae],ft=Se[Ae+1],_t=X.within(Se[Ae],Se[Ae+1],Re),At=Se[Ae+Et];let kt=At;for(const zt of _t){const qe=zt*je;Se[qe+2]>Y&&(kt+=Se[qe+Et])}if(kt>At&&kt>=ee){let zt,qe=et*At,yi=ft*At,ci=-1;const vi=((Ae/je|0)<<5)+(Y+1)+this.points.length;for(const Zt of _t){const Je=Zt*je;if(Se[Je+2]<=Y)continue;Se[Je+2]=Y;const Ft=Se[Je+Et];qe+=Se[Je]*Ft,yi+=Se[Je+1]*Ft,Se[Je+4]=vi,be&&(zt||(zt=this._map(Se,Ae,!0),ci=this.clusterProps.length,this.clusterProps.push(zt)),be(zt,this._map(Se,Je)))}Se[Ae+4]=vi,De.push(qe/kt,yi/kt,1/0,vi,-1,kt),be&&De.push(ci)}else{for(let zt=0;zt<je;zt++)De.push(Se[Ae+zt]);if(kt>1)for(const zt of _t){const qe=zt*je;if(!(Se[qe+2]<=Y)){Se[qe+2]=Y;for(let yi=0;yi<je;yi++)De.push(Se[qe+yi])}}}}return De}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,Y,te){if(X[Y+Et]>1){const ee=this.clusterProps[X[Y+pt]];return te?Object.assign({},ee):ee}const he=this.points[X[Y+xr]].properties,be=this.options.map(he);return te&&be===he?Object.assign({},be):be}}function We(Ce,X,Y){return{type:"Feature",id:Ce[X+xr],properties:Ge(Ce,X,Y),geometry:{type:"Point",coordinates:[(te=Ce[X],360*(te-.5)),Ke(Ce[X+1])]}};var te}function Ge(Ce,X,Y){const te=Ce[X+Et],he=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te,be=Ce[X+pt],ee=be===-1?{}:Object.assign({},Y[be]);return Object.assign(ee,{cluster:!0,cluster_id:Ce[X+xr],point_count:te,point_count_abbreviated:he})}function gt(Ce){return Ce/360+.5}function ue(Ce){const X=Math.sin(Ce*Math.PI/180),Y=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return Y<0?0:Y>1?1:Y}function Ke(Ce){const X=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function lt(Ce,X,Y,te){let he=te;const be=X+(Y-X>>1);let ee,Re=Y-X;const Se=Ce[X],De=Ce[X+1],je=Ce[Y],Ae=Ce[Y+1];for(let et=X+3;et<Y;et+=3){const ft=ut(Ce[et],Ce[et+1],Se,De,je,Ae);if(ft>he)ee=et,he=ft;else if(ft===he){const _t=Math.abs(et-be);_t<Re&&(ee=et,Re=_t)}}he>te&&(ee-X>3&&lt(Ce,X,ee,te),Ce[ee+2]=he,Y-ee>3&&lt(Ce,ee,Y,te))}function ut(Ce,X,Y,te,he,be){let ee=he-Y,Re=be-te;if(ee!==0||Re!==0){const Se=((Ce-Y)*ee+(X-te)*Re)/(ee*ee+Re*Re);Se>1?(Y=he,te=be):Se>0&&(Y+=ee*Se,te+=Re*Se)}return ee=Ce-Y,Re=X-te,ee*ee+Re*Re}function vt(Ce,X,Y,te){const he={id:Ce??null,type:X,geometry:Y,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(X==="Point"||X==="MultiPoint"||X==="LineString")Ct(he,Y);else if(X==="Polygon")Ct(he,Y[0]);else if(X==="MultiLineString")for(const be of Y)Ct(he,be);else if(X==="MultiPolygon")for(const be of Y)Ct(he,be[0]);return he}function Ct(Ce,X){for(let Y=0;Y<X.length;Y+=3)Ce.minX=Math.min(Ce.minX,X[Y]),Ce.minY=Math.min(Ce.minY,X[Y+1]),Ce.maxX=Math.max(Ce.maxX,X[Y]),Ce.maxY=Math.max(Ce.maxY,X[Y+1])}function It(Ce,X,Y,te){if(!X.geometry)return;const he=X.geometry.coordinates;if(he&&he.length===0)return;const be=X.geometry.type,ee=Math.pow(Y.tolerance/((1<<Y.maxZoom)*Y.extent),2);let Re=[],Se=X.id;if(Y.promoteId?Se=X.properties[Y.promoteId]:Y.generateId&&(Se=te||0),be==="Point")di(he,Re);else if(be==="MultiPoint")for(const De of he)di(De,Re);else if(be==="LineString")li(he,Re,ee,!1);else if(be==="MultiLineString"){if(Y.lineMetrics){for(const De of he)Re=[],li(De,Re,ee,!1),Ce.push(vt(Se,"LineString",Re,X.properties));return}er(he,Re,ee,!1)}else if(be==="Polygon")er(he,Re,ee,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(const De of X.geometry.geometries)It(Ce,{id:Se,geometry:De,properties:X.properties},Y,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const De of he){const je=[];er(De,je,ee,!0),Re.push(je)}}Ce.push(vt(Se,be,Re,X.properties))}function di(Ce,X){X.push(lr(Ce[0]),Bi(Ce[1]),0)}function li(Ce,X,Y,te){let he,be,ee=0;for(let Se=0;Se<Ce.length;Se++){const De=lr(Ce[Se][0]),je=Bi(Ce[Se][1]);X.push(De,je,0),Se>0&&(ee+=te?(he*je-De*be)/2:Math.sqrt(Math.pow(De-he,2)+Math.pow(je-be,2))),he=De,be=je}const Re=X.length-3;X[2]=1,lt(X,0,Re,Y),X[Re+2]=1,X.size=Math.abs(ee),X.start=0,X.end=X.size}function er(Ce,X,Y,te){for(let he=0;he<Ce.length;he++){const be=[];li(Ce[he],be,Y,te),X.push(be)}}function lr(Ce){return Ce/360+.5}function Bi(Ce){const X=Math.sin(Ce*Math.PI/180),Y=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return Y<0?0:Y>1?1:Y}function cr(Ce,X,Y,te,he,be,ee,Re){if(te/=X,be>=(Y/=X)&&ee<te)return Ce;if(ee<Y||be>=te)return null;const Se=[];for(const De of Ce){const je=De.geometry;let Ae=De.type;const et=he===0?De.minX:De.minY,ft=he===0?De.maxX:De.maxY;if(et>=Y&&ft<te){Se.push(De);continue}if(ft<Y||et>=te)continue;let _t=[];if(Ae==="Point"||Ae==="MultiPoint")tr(je,_t,Y,te,he);else if(Ae==="LineString")Ri(je,_t,Y,te,he,!1,Re.lineMetrics);else if(Ae==="MultiLineString")Ks(je,_t,Y,te,he,!1);else if(Ae==="Polygon")Ks(je,_t,Y,te,he,!0);else if(Ae==="MultiPolygon")for(const At of je){const kt=[];Ks(At,kt,Y,te,he,!0),kt.length&&_t.push(kt)}if(_t.length){if(Re.lineMetrics&&Ae==="LineString"){for(const At of _t)Se.push(vt(De.id,Ae,At,De.tags));continue}Ae!=="LineString"&&Ae!=="MultiLineString"||(_t.length===1?(Ae="LineString",_t=_t[0]):Ae="MultiLineString"),Ae!=="Point"&&Ae!=="MultiPoint"||(Ae=_t.length===3?"Point":"MultiPoint"),Se.push(vt(De.id,Ae,_t,De.tags))}}return Se.length?Se:null}function tr(Ce,X,Y,te,he){for(let be=0;be<Ce.length;be+=3){const ee=Ce[be+he];ee>=Y&&ee<=te&&Rr(X,Ce[be],Ce[be+1],Ce[be+2])}}function Ri(Ce,X,Y,te,he,be,ee){let Re=qa(Ce);const Se=he===0?wc:Ml;let De,je,Ae=Ce.start;for(let kt=0;kt<Ce.length-3;kt+=3){const zt=Ce[kt],qe=Ce[kt+1],yi=Ce[kt+2],ci=Ce[kt+3],vi=Ce[kt+4],Zt=he===0?zt:qe,Je=he===0?ci:vi;let Ft=!1;ee&&(De=Math.sqrt(Math.pow(zt-ci,2)+Math.pow(qe-vi,2))),Zt<Y?Je>Y&&(je=Se(Re,zt,qe,ci,vi,Y),ee&&(Re.start=Ae+De*je)):Zt>te?Je<te&&(je=Se(Re,zt,qe,ci,vi,te),ee&&(Re.start=Ae+De*je)):Rr(Re,zt,qe,yi),Je<Y&&Zt>=Y&&(je=Se(Re,zt,qe,ci,vi,Y),Ft=!0),Je>te&&Zt<=te&&(je=Se(Re,zt,qe,ci,vi,te),Ft=!0),!be&&Ft&&(ee&&(Re.end=Ae+De*je),X.push(Re),Re=qa(Ce)),ee&&(Ae+=De)}let et=Ce.length-3;const ft=Ce[et],_t=Ce[et+1],At=he===0?ft:_t;At>=Y&&At<=te&&Rr(Re,ft,_t,Ce[et+2]),et=Re.length-3,be&&et>=3&&(Re[et]!==Re[0]||Re[et+1]!==Re[1])&&Rr(Re,Re[0],Re[1],Re[2]),Re.length&&X.push(Re)}function qa(Ce){const X=[];return X.size=Ce.size,X.start=Ce.start,X.end=Ce.end,X}function Ks(Ce,X,Y,te,he,be){for(const ee of Ce)Ri(ee,X,Y,te,he,be,!1)}function Rr(Ce,X,Y,te){Ce.push(X,Y,te)}function wc(Ce,X,Y,te,he,be){const ee=(be-X)/(te-X);return Rr(Ce,be,Y+(he-Y)*ee,1),ee}function Ml(Ce,X,Y,te,he,be){const ee=(be-Y)/(he-Y);return Rr(Ce,X+(te-X)*ee,be,1),ee}function Fn(Ce,X){const Y=[];for(let te=0;te<Ce.length;te++){const he=Ce[te],be=he.type;let ee;if(be==="Point"||be==="MultiPoint"||be==="LineString")ee=Qn(he.geometry,X);else if(be==="MultiLineString"||be==="Polygon"){ee=[];for(const Re of he.geometry)ee.push(Qn(Re,X))}else if(be==="MultiPolygon"){ee=[];for(const Re of he.geometry){const Se=[];for(const De of Re)Se.push(Qn(De,X));ee.push(Se)}}Y.push(vt(he.id,be,ee,he.tags))}return Y}function Qn(Ce,X){const Y=[];Y.size=Ce.size,Ce.start!==void 0&&(Y.start=Ce.start,Y.end=Ce.end);for(let te=0;te<Ce.length;te+=3)Y.push(Ce[te]+X,Ce[te+1],Ce[te+2]);return Y}function Io(Ce,X){if(Ce.transformed)return Ce;const Y=1<<Ce.z,te=Ce.x,he=Ce.y;for(const be of Ce.features){const ee=be.geometry,Re=be.type;if(be.geometry=[],Re===1)for(let Se=0;Se<ee.length;Se+=2)be.geometry.push(Ws(ee[Se],ee[Se+1],X,Y,te,he));else for(let Se=0;Se<ee.length;Se++){const De=[];for(let je=0;je<ee[Se].length;je+=2)De.push(Ws(ee[Se][je],ee[Se][je+1],X,Y,te,he));be.geometry.push(De)}}return Ce.transformed=!0,Ce}function Ws(Ce,X,Y,te,he,be){return[Math.round(Y*(Ce*te-he)),Math.round(Y*(X*te-be))]}function bs(Ce,X,Y,te,he){const be=X===he.maxZoom?0:he.tolerance/((1<<X)*he.extent),ee={features:[],numPoints:0,numSimplified:0,numFeatures:Ce.length,source:null,x:Y,y:te,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Re of Ce)El(ee,Re,be,he);return ee}function El(Ce,X,Y,te){const he=X.geometry,be=X.type,ee=[];if(Ce.minX=Math.min(Ce.minX,X.minX),Ce.minY=Math.min(Ce.minY,X.minY),Ce.maxX=Math.max(Ce.maxX,X.maxX),Ce.maxY=Math.max(Ce.maxY,X.maxY),be==="Point"||be==="MultiPoint")for(let Re=0;Re<he.length;Re+=3)ee.push(he[Re],he[Re+1]),Ce.numPoints++,Ce.numSimplified++;else if(be==="LineString")$a(ee,he,Ce,Y,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(let Re=0;Re<he.length;Re++)$a(ee,he[Re],Ce,Y,be==="Polygon",Re===0);else if(be==="MultiPolygon")for(let Re=0;Re<he.length;Re++){const Se=he[Re];for(let De=0;De<Se.length;De++)$a(ee,Se[De],Ce,Y,!0,De===0)}if(ee.length){let Re=X.tags||null;if(be==="LineString"&&te.lineMetrics){Re={};for(const De in X.tags)Re[De]=X.tags[De];Re.mapbox_clip_start=he.start/he.size,Re.mapbox_clip_end=he.end/he.size}const Se={geometry:ee,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:Re};X.id!==null&&(Se.id=X.id),Ce.features.push(Se)}}function $a(Ce,X,Y,te,he,be){const ee=te*te;if(te>0&&X.size<(he?ee:te))return void(Y.numPoints+=X.length/3);const Re=[];for(let Se=0;Se<X.length;Se+=3)(te===0||X[Se+2]>ee)&&(Y.numSimplified++,Re.push(X[Se],X[Se+1])),Y.numPoints++;he&&function(Se,De){let je=0;for(let Ae=0,et=Se.length,ft=et-2;Ae<et;ft=Ae,Ae+=2)je+=(Se[Ae]-Se[ft])*(Se[Ae+1]+Se[ft+1]);if(je>0===De)for(let Ae=0,et=Se.length;Ae<et/2;Ae+=2){const ft=Se[Ae],_t=Se[Ae+1];Se[Ae]=Se[et-2-Ae],Se[Ae+1]=Se[et-1-Ae],Se[et-2-Ae]=ft,Se[et-1-Ae]=_t}}(Re,be),Ce.push(Re)}const Wr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class mn{constructor(X,Y){const te=(Y=this.options=function(be,ee){for(const Re in ee)be[Re]=ee[Re];return be}(Object.create(Wr),Y)).debug;if(te&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");let he=function(be,ee){const Re=[];if(be.type==="FeatureCollection")for(let Se=0;Se<be.features.length;Se++)It(Re,be.features[Se],ee,Se);else It(Re,be.type==="Feature"?be:{geometry:be},ee);return Re}(X,Y);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(be,ee){const Re=ee.buffer/ee.extent;let Se=be;const De=cr(be,1,-1-Re,Re,0,-1,2,ee),je=cr(be,1,1-Re,2+Re,0,-1,2,ee);return(De||je)&&(Se=cr(be,1,-Re,1+Re,0,-1,2,ee)||[],De&&(Se=Fn(De,1).concat(Se)),je&&(Se=Se.concat(Fn(je,-1)))),Se}(he,Y),he.length&&this.splitTile(he,0,0,0),te&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(X,Y,te,he,be,ee,Re){const Se=[X,Y,te,he],De=this.options,je=De.debug;for(;Se.length;){he=Se.pop(),te=Se.pop(),Y=Se.pop(),X=Se.pop();const Ae=1<<Y,et=kr(Y,te,he);let ft=this.tiles[et];if(!ft&&(je>1&&console.time("creation"),ft=this.tiles[et]=bs(X,Y,te,he,De),this.tileCoords.push({z:Y,x:te,y:he}),je)){je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,te,he,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));const Ft=`z${Y}`;this.stats[Ft]=(this.stats[Ft]||0)+1,this.total++}if(ft.source=X,be==null){if(Y===De.indexMaxZoom||ft.numPoints<=De.indexMaxPoints)continue}else{if(Y===De.maxZoom||Y===be)continue;if(be!=null){const Ft=be-Y;if(te!==ee>>Ft||he!==Re>>Ft)continue}}if(ft.source=null,X.length===0)continue;je>1&&console.time("clipping");const _t=.5*De.buffer/De.extent,At=.5-_t,kt=.5+_t,zt=1+_t;let qe=null,yi=null,ci=null,vi=null,Zt=cr(X,Ae,te-_t,te+kt,0,ft.minX,ft.maxX,De),Je=cr(X,Ae,te+At,te+zt,0,ft.minX,ft.maxX,De);X=null,Zt&&(qe=cr(Zt,Ae,he-_t,he+kt,1,ft.minY,ft.maxY,De),yi=cr(Zt,Ae,he+At,he+zt,1,ft.minY,ft.maxY,De),Zt=null),Je&&(ci=cr(Je,Ae,he-_t,he+kt,1,ft.minY,ft.maxY,De),vi=cr(Je,Ae,he+At,he+zt,1,ft.minY,ft.maxY,De),Je=null),je>1&&console.timeEnd("clipping"),Se.push(qe||[],Y+1,2*te,2*he),Se.push(yi||[],Y+1,2*te,2*he+1),Se.push(ci||[],Y+1,2*te+1,2*he),Se.push(vi||[],Y+1,2*te+1,2*he+1)}}getTile(X,Y,te){X=+X,Y=+Y,te=+te;const he=this.options,{extent:be,debug:ee}=he;if(X<0||X>24)return null;const Re=1<<X,Se=kr(X,Y=Y+Re&Re-1,te);if(this.tiles[Se])return Io(this.tiles[Se],be);ee>1&&console.log("drilling down to z%d-%d-%d",X,Y,te);let De,je=X,Ae=Y,et=te;for(;!De&&je>0;)je--,Ae>>=1,et>>=1,De=this.tiles[kr(je,Ae,et)];return De&&De.source?(ee>1&&(console.log("found parent tile z%d-%d-%d",je,Ae,et),console.time("drilling down")),this.splitTile(De.source,je,Ae,et,X,Y,te),ee>1&&console.timeEnd("drilling down"),this.tiles[Se]?Io(this.tiles[Se],be):null):null}}function kr(Ce,X,Y){return 32*((1<<Ce)*Y+X)+Ce}function Js(Ce,X){return X?Ce.properties[X]:Ce.id}function Cl(Ce,X){if(Ce==null)return!0;if(Ce.type==="Feature")return Js(Ce,X)!=null;if(Ce.type==="FeatureCollection"){const Y=new Set;for(const te of Ce.features){const he=Js(te,X);if(he==null||Y.has(he))return!1;Y.add(he)}return!0}return!1}function pa(Ce,X){const Y=new Map;if(Ce!=null)if(Ce.type==="Feature")Y.set(Js(Ce,X),Ce);else for(const te of Ce.features)Y.set(Js(te,X),te);return Y}class cn extends Te{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(X,Y){return z._(this,void 0,void 0,function*(){const te=X.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const he=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!he)return null;const be=new Tt(he.features);let ee=Oi(be);return ee.byteOffset===0&&ee.byteLength===ee.buffer.byteLength||(ee=new Uint8Array(ee)),{vectorTile:be,rawData:ee.buffer}})}loadData(X){return z._(this,void 0,void 0,function*(){var Y;(Y=this._pendingRequest)===null||Y===void 0||Y.abort();const te=!!(X&&X.request&&X.request.collectResourceTiming)&&new z.cE(X.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(X,this._pendingRequest),this._geoJSONIndex=X.cluster?new we(function({superclusterOptions:ee,clusterProperties:Re}){if(!Re||!ee)return ee;const Se={},De={},je={accumulated:null,zoom:0},Ae={properties:null},et=Object.keys(Re);for(const ft of et){const[_t,At]=Re[ft],kt=z.cL(At),zt=z.cL(typeof _t=="string"?[_t,["accumulated"],["get",ft]]:_t);Se[ft]=kt.value,De[ft]=zt.value}return ee.map=ft=>{Ae.properties=ft;const _t={};for(const At of et)_t[At]=Se[At].evaluate(je,Ae);return _t},ee.reduce=(ft,_t)=>{Ae.properties=_t;for(const At of et)je.accumulated=ft[At],ft[At]=De[At].evaluate(je,Ae)},ee}(X)).load((yield this._pendingData).features):(he=yield this._pendingData,new mn(he,X.geojsonVtOptions)),this.loaded={};const be={};if(te){const ee=te.finish();ee&&(be.resourceTiming={},be.resourceTiming[X.source]=JSON.parse(JSON.stringify(ee)))}return be}catch(be){if(delete this._pendingRequest,z.cp(be))return{abandoned:!0};throw be}var he})}getData(){return z._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(X){const Y=this.loaded;return Y&&Y[X.uid]?super.reloadTile(X):this.loadTile(X)}loadAndProcessGeoJSON(X,Y){return z._(this,void 0,void 0,function*(){let te=yield this.loadGeoJSON(X,Y);if(delete this._pendingRequest,typeof te!="object")throw new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`);if(bt(te,!0),X.filter){const he=z.cL(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(he.result==="error")throw new Error(he.value.map(ee=>`${ee.key}: ${ee.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter(ee=>he.value.evaluate({zoom:0},ee))}}return te})}loadGeoJSON(X,Y){return z._(this,void 0,void 0,function*(){const{promoteId:te}=X;if(X.request){const he=yield z.j(X.request,Y);return this._dataUpdateable=Cl(he.data,te)?pa(he.data,te):void 0,he.data}if(typeof X.data=="string")try{const he=JSON.parse(X.data);return this._dataUpdateable=Cl(he,te)?pa(he,te):void 0,he}catch{throw new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`)}if(!X.dataDiff)throw new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${X.source}`);return function(he,be,ee){var Re,Se,De,je;if(be.removeAll&&he.clear(),be.remove)for(const Ae of be.remove)he.delete(Ae);if(be.add)for(const Ae of be.add){const et=Js(Ae,ee);et!=null&&he.set(et,Ae)}if(be.update)for(const Ae of be.update){let et=he.get(Ae.id);if(et==null)continue;const ft=!Ae.removeAllProperties&&(((Re=Ae.removeProperties)===null||Re===void 0?void 0:Re.length)>0||((Se=Ae.addOrUpdateProperties)===null||Se===void 0?void 0:Se.length)>0);if((Ae.newGeometry||Ae.removeAllProperties||ft)&&(et=Object.assign({},et),he.set(Ae.id,et),ft&&(et.properties=Object.assign({},et.properties))),Ae.newGeometry&&(et.geometry=Ae.newGeometry),Ae.removeAllProperties)et.properties={};else if(((De=Ae.removeProperties)===null||De===void 0?void 0:De.length)>0)for(const _t of Ae.removeProperties)Object.prototype.hasOwnProperty.call(et.properties,_t)&&delete et.properties[_t];if(((je=Ae.addOrUpdateProperties)===null||je===void 0?void 0:je.length)>0)for(const{key:_t,value:At}of Ae.addOrUpdateProperties)et.properties[_t]=At}}(this._dataUpdateable,X.dataDiff,te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(X){return z._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(X){return this._geoJSONIndex.getClusterExpansionZoom(X.clusterId)}getClusterChildren(X){return this._geoJSONIndex.getChildren(X.clusterId)}getClusterLeaves(X){return this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset)}}class Kn{constructor(X){this.self=X,this.actor=new z.H(X),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Y,te)=>{if(this.externalWorkerSourceTypes[Y])throw new Error(`Worker source with name "${Y}" already registered.`);this.externalWorkerSourceTypes[Y]=te},this.self.addProtocol=z.cr,this.self.removeProtocol=z.cs,this.self.registerRTLTextPlugin=Y=>{z.cM.setMethods(Y)},this.actor.registerMessageHandler("LDT",(Y,te)=>this._getDEMWorkerSource(Y,te.source).loadTile(te)),this.actor.registerMessageHandler("RDT",(Y,te)=>z._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Y,te.source).removeTile(te)})),this.actor.registerMessageHandler("GCEZ",(Y,te)=>z._(this,void 0,void 0,function*(){return this._getWorkerSource(Y,te.type,te.source).getClusterExpansionZoom(te)})),this.actor.registerMessageHandler("GCC",(Y,te)=>z._(this,void 0,void 0,function*(){return this._getWorkerSource(Y,te.type,te.source).getClusterChildren(te)})),this.actor.registerMessageHandler("GCL",(Y,te)=>z._(this,void 0,void 0,function*(){return this._getWorkerSource(Y,te.type,te.source).getClusterLeaves(te)})),this.actor.registerMessageHandler("LD",(Y,te)=>this._getWorkerSource(Y,te.type,te.source).loadData(te)),this.actor.registerMessageHandler("GD",(Y,te)=>this._getWorkerSource(Y,te.type,te.source).getData()),this.actor.registerMessageHandler("LT",(Y,te)=>this._getWorkerSource(Y,te.type,te.source).loadTile(te)),this.actor.registerMessageHandler("RT",(Y,te)=>this._getWorkerSource(Y,te.type,te.source).reloadTile(te)),this.actor.registerMessageHandler("AT",(Y,te)=>this._getWorkerSource(Y,te.type,te.source).abortTile(te)),this.actor.registerMessageHandler("RMT",(Y,te)=>this._getWorkerSource(Y,te.type,te.source).removeTile(te)),this.actor.registerMessageHandler("RS",(Y,te)=>z._(this,void 0,void 0,function*(){if(!this.workerSources[Y]||!this.workerSources[Y][te.type]||!this.workerSources[Y][te.type][te.source])return;const he=this.workerSources[Y][te.type][te.source];delete this.workerSources[Y][te.type][te.source],he.removeSource!==void 0&&he.removeSource(te)})),this.actor.registerMessageHandler("RM",Y=>z._(this,void 0,void 0,function*(){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y]})),this.actor.registerMessageHandler("SR",(Y,te)=>z._(this,void 0,void 0,function*(){this.referrer=te})),this.actor.registerMessageHandler("SRPS",(Y,te)=>this._syncRTLPluginState(Y,te)),this.actor.registerMessageHandler("IS",(Y,te)=>z._(this,void 0,void 0,function*(){this.self.importScripts(te)})),this.actor.registerMessageHandler("SI",(Y,te)=>this._setImages(Y,te)),this.actor.registerMessageHandler("UL",(Y,te)=>z._(this,void 0,void 0,function*(){this._getLayerIndex(Y).update(te.layers,te.removedIds)})),this.actor.registerMessageHandler("SL",(Y,te)=>z._(this,void 0,void 0,function*(){this._getLayerIndex(Y).replace(te)}))}_setImages(X,Y){return z._(this,void 0,void 0,function*(){this.availableImages[X]=Y;for(const te in this.workerSources[X]){const he=this.workerSources[X][te];for(const be in he)he[be].availableImages=Y}})}_syncRTLPluginState(X,Y){return z._(this,void 0,void 0,function*(){return yield z.cM.syncState(Y,this.self.importScripts)})}_getAvailableImages(X){let Y=this.availableImages[X];return Y||(Y=[]),Y}_getLayerIndex(X){let Y=this.layerIndexes[X];return Y||(Y=this.layerIndexes[X]=new u),Y}_getWorkerSource(X,Y,te){if(this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][Y]||(this.workerSources[X][Y]={}),!this.workerSources[X][Y][te]){const he={sendAsync:(be,ee)=>(be.targetMapId=X,this.actor.sendAsync(be,ee))};switch(Y){case"vector":this.workerSources[X][Y][te]=new Te(he,this._getLayerIndex(X),this._getAvailableImages(X));break;case"geojson":this.workerSources[X][Y][te]=new cn(he,this._getLayerIndex(X),this._getAvailableImages(X));break;default:this.workerSources[X][Y][te]=new this.externalWorkerSourceTypes[Y](he,this._getLayerIndex(X),this._getAvailableImages(X))}}return this.workerSources[X][Y][te]}_getDEMWorkerSource(X,Y){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][Y]||(this.demWorkerSources[X][Y]=new Ee),this.demWorkerSources[X][Y]}}return z.i(self)&&(self.worker=new Kn(self)),Kn}),R("index",["exports","./shared"],function(z,u){var oe="5.5.0";function Q(){var f=new u.A(4);return u.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let ve,Te;const Ee={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,r){const l=requestAnimationFrame(m=>{h(),e(m)}),{unsubscribe:h}=u.s(f.signal,"abort",()=>{h(),cancelAnimationFrame(l),r(u.c())},!1)},frameAsync(f){return new Promise((e,r)=>{this.frame(f,e,r)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,r.drawImage(f,0,0,f.width,f.height),r},resolveURL:f=>(ve||(ve=document.createElement("a")),ve.href=f,ve.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Te==null&&(Te=matchMedia("(prefers-reduced-motion: reduce)")),Te.matches)}};class ne{static testProp(e){if(!ne.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in ne.docStyle)return e[r];return e[0]}static create(e,r,l){const h=window.document.createElement(e);return r!==void 0&&(h.className=r),l&&l.appendChild(h),h}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){ne.docStyle&&ne.selectProp&&(ne.userSelect=ne.docStyle[ne.selectProp],ne.docStyle[ne.selectProp]="none")}static enableDrag(){ne.docStyle&&ne.selectProp&&(ne.docStyle[ne.selectProp]=ne.userSelect)}static setTransform(e,r){e.style[ne.transformProp]=r}static addEventListener(e,r,l,h={}){e.addEventListener(r,l,"passive"in h?h:h.capture)}static removeEventListener(e,r,l,h={}){e.removeEventListener(r,l,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ne.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ne.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ne.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,l){const h=r.boundingClientRect;return new u.P((l.clientX-h.left)/r.x-e.clientLeft,(l.clientY-h.top)/r.y-e.clientTop)}static mousePos(e,r){const l=ne.getScale(e);return ne.getPoint(e,l,r)}static touchPos(e,r){const l=[],h=ne.getScale(e);for(let m=0;m<r.length;m++)l.push(ne.getPoint(e,h,r[m]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=r.querySelectorAll("script");for(const h of l)h.remove();return ne.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const l=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const l of r)ne.removeAttributes(l),ne.clean(l)}static removeAttributes(e){for(const{name:r,value:l}of e.attributes)ne.isPossiblyDangerous(r,l)&&e.removeAttribute(r)}}ne.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ne.selectProp=ne.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ne.transformProp=ne.testProp(["transform","WebkitTransform"]);const Pe={supported:!1,testSupport:function(f){!Vt&&bt&&(Ot?Tt(f):Ze=f)}};let Ze,bt,Vt=!1,Ot=!1;function Tt(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,bt),f.isContextLost())return;Pe.supported=!0}catch{}f.deleteTexture(e),Vt=!0}var qt;typeof document<"u"&&(bt=document.createElement("img"),bt.onload=()=>{Ze&&Tt(Ze),Ze=null,Ot=!0},bt.onerror=()=>{Vt=!0,Ze=null},bt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,r,l,h;f.resetRequestQueue=()=>{e=[],r=0,l=0,h={}},f.addThrottleControl=C=>{const I=l++;return h[I]=C,I},f.removeThrottleControl=C=>{delete h[C],x()},f.getImage=(C,I,k=!0)=>new Promise((j,B)=>{Pe.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),u.e(C,{type:"image"}),e.push({abortController:I,requestParameters:C,supportImageRefresh:k,state:"queued",onError:$=>{B($)},onSuccess:$=>{j($)}}),x()});const m=C=>u._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:I,supportImageRefresh:k,onError:j,onSuccess:B,abortController:$}=C,G=k===!1&&!u.i(self)&&!u.g(I.url)&&(!I.headers||Object.keys(I.headers).reduce((ae,ce)=>ae&&ce==="accept",!0));r++;const re=G?M(I,$):u.m(I,$);try{const ae=yield re;delete C.abortController,C.state="completed",ae.data instanceof HTMLImageElement||u.b(ae.data)?B(ae):ae.data&&B({data:yield(ie=ae.data,typeof createImageBitmap=="function"?u.f(ie):u.h(ie)),cacheControl:ae.cacheControl,expires:ae.expires})}catch(ae){delete C.abortController,j(ae)}finally{r--,x()}var ie}),x=()=>{const C=(()=>{for(const I of Object.keys(h))if(h[I]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=r;I<C&&e.length>0;I++){const k=e.shift();k.abortController.signal.aborted?I--:m(k)}},M=(C,I)=>new Promise((k,j)=>{const B=new Image,$=C.url,G=C.credentials;G&&G==="include"?B.crossOrigin="use-credentials":(G&&G==="same-origin"||!u.d($))&&(B.crossOrigin="anonymous"),I.signal.addEventListener("abort",()=>{B.src="",j(u.c())}),B.fetchPriority="high",B.onload=()=>{B.onerror=B.onload=null,k({data:B})},B.onerror=()=>{B.onerror=B.onload=null,I.signal.aborted||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},B.src=$})}(qt||(qt={})),qt.resetRequestQueue();class xt{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Bt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const r=[];for(const{id:l,url:h}of f){const m=`${l}${h}`;r.indexOf(m)===-1&&(r.push(m),e.push({id:l,url:h}))}}return e}function Pi(f,e,r){try{const l=new URL(f);return l.pathname+=`${e}${r}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class ti{constructor(e,r,l,h){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(r,h)}update(e,r,l){const{width:h,height:m}=e,x=!(this.size&&this.size[0]===h&&this.size[1]===m||l),{context:M}=this,{gl:C}=M;if(this.useMipmap=!!(r&&r.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!r||r.premultiply!==!1)),x)this.size=[h,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,e):C.texImage2D(C.TEXTURE_2D,0,this.format,h,m,0,this.format,C.UNSIGNED_BYTE,e.data);else{const{x:I,y:k}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?C.texSubImage2D(C.TEXTURE_2D,0,I,k,C.RGBA,C.UNSIGNED_BYTE,e):C.texSubImage2D(C.TEXTURE_2D,0,I,k,h,m,C.RGBA,C.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D),M.pixelStoreUnpackFlipY.setDefault(),M.pixelStoreUnpack.setDefault(),M.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,r,l){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),l!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,l||e),this.filter=e),r!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Oi(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class Mi extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:l}of this.requestors)l(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const l=r.spriteData;r.data=new u.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let l=!0;const h=r.data||r.spriteData;return this._validateStretch(r.stretchX,h&&h.width)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,h&&h.height)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,r){if(!e)return!0;let l=0;for(const h of e){if(h[0]<l||h[1]<h[0]||r<h[1])return!1;l=h[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const l=r.spriteData,h=l&&l.width||r.data.width,m=l&&l.height||r.data.height;return!(e[0]<0||h<e[0]||e[1]<0||m<e[1]||e[2]<0||h<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,l=!0){const h=this.getImage(e);if(l&&(h.data.width!==r.data.width||h.data.height!==r.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=h.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,l)=>{let h=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(h=!1);this.isLoaded()||h?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const l of e){let h=this.getImage(l);h||(this.fire(new u.l("styleimagemissing",{id:l})),h=this.getImage(l)),h?r[l]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:u.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],l=this.getImage(e);if(!l)return null;if(r&&r.position.version===l.version)return r.position;if(r)r.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},m=new u.I(h,l);this.patterns[e]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ti(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:r,h:l}=u.p(e),h=this.atlasImage;h.resize({width:r||1,height:l||1});for(const m in this.patterns){const{bin:x}=this.patterns[m],M=x.x+1,C=x.y+1,I=this.getImage(m).data,k=I.width,j=I.height;u.R.copy(I,h,{x:0,y:0},{x:M,y:C},{width:k,height:j}),u.R.copy(I,h,{x:0,y:j-1},{x:M,y:C-1},{width:k,height:1}),u.R.copy(I,h,{x:0,y:0},{x:M,y:C+j},{width:k,height:1}),u.R.copy(I,h,{x:k-1,y:0},{x:M-1,y:C},{width:1,height:j}),u.R.copy(I,h,{x:0,y:0},{x:M+k,y:C},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const l=this.getImage(r);l||u.w(`Image with ID: "${r}" was not found`),Oi(l)&&this.updateImage(r,l)}}}const Ut=1e20;function wi(f,e,r,l,h,m,x,M,C){for(let I=e;I<e+l;I++)xr(f,r*m+I,m,h,x,M,C);for(let I=r;I<r+h;I++)xr(f,I*m+e,1,l,x,M,C)}function xr(f,e,r,l,h,m,x){m[0]=0,x[0]=-1e20,x[1]=Ut,h[0]=f[e];for(let M=1,C=0,I=0;M<l;M++){h[M]=f[e+M*r];const k=M*M;do{const j=m[C];I=(h[M]-h[j]+k-j*j)/(M-j)/2}while(I<=x[C]&&--C>-1);C++,m[C]=M,x[C]=I,x[C+1]=Ut}for(let M=0,C=0;M<l;M++){for(;x[C+1]<M;)C++;const I=m[C],k=M-I;f[e+M*r]=h[I]+k*k}}class Et{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return u._(this,void 0,void 0,function*(){const r=[];for(const m in e)for(const x of e[m])r.push(this._getAndCacheGlyphsPromise(m,x));const l=yield Promise.all(r),h={};for(const{stack:m,id:x,glyph:M}of l)h[m]||(h[m]={}),h[m][x]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return h})}_getAndCacheGlyphsPromise(e,r){return u._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=l.glyphs[r];if(h!==void 0)return{stack:e,id:r,glyph:h};if(h=this._tinySDF(l,e,r),h)return l.glyphs[r]=h,{stack:e,id:r,glyph:h};const m=Math.floor(r/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[m])return{stack:e,id:r,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[m]){const M=Et.loadGlyphRange(e,m,this.url,this.requestManager);l.requests[m]=M}const x=yield l.requests[m];for(const M in x)this._doesCharSupportLocalGlyph(+M)||(l.glyphs[+M]=x[+M]);return l.ranges[m]=!0,{stack:e,id:r,glyph:x[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||u.u["CJK Unified Ideographs"](e)||u.u["Hangul Syllables"](e)||u.u.Hiragana(e)||u.u.Katakana(e)||u.u["CJK Symbols and Punctuation"](e)||u.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let m=e.tinySDF;if(!m){let M="400";/bold/i.test(r)?M="900":/medium/i.test(r)?M="500":/light/i.test(r)&&(M="200"),m=e.tinySDF=new Et.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:M})}const x=m.draw(String.fromCharCode(l));return{id:l,bitmap:new u.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}Et.loadGlyphRange=function(f,e,r,l){return u._(this,void 0,void 0,function*(){const h=256*e,m=h+255,x=l.transformRequest(r.replace("{fontstack}",f).replace("{range}",`${h}-${m}`),"Glyphs"),M=yield u.n(x,new AbortController);if(!M||!M.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${m}`);const C={};for(const I of u.o(M.data))C[I.id]=I;return C})},Et.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:r=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=r;const M=this.size=f+4*e,C=this._createCanvas(M),I=this.ctx=C.getContext("2d",{willReadFrequently:!0});I.font=`${x} ${m} ${f}px ${h}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(f),x=Math.ceil(r),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),C=Math.min(this.size-this.buffer,x+Math.ceil(l)),I=M+2*this.buffer,k=C+2*this.buffer,j=Math.max(I*k,0),B=new Uint8ClampedArray(j),$={data:B,width:I,height:k,glyphWidth:M,glyphHeight:C,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(M===0||C===0)return $;const{ctx:G,buffer:re,gridInner:ie,gridOuter:ae}=this;G.clearRect(re,re,M,C),G.fillText(f,re,re+x);const ce=G.getImageData(re,re,M,C);ae.fill(Ut,0,j),ie.fill(0,0,j);for(let pe=0;pe<C;pe++)for(let fe=0;fe<M;fe++){const ge=ce.data[4*(pe*M+fe)+3]/255;if(ge===0)continue;const xe=(pe+re)*I+fe+re;if(ge===1)ae[xe]=0,ie[xe]=Ut;else{const _e=.5-ge;ae[xe]=_e>0?_e*_e:0,ie[xe]=_e<0?_e*_e:0}}wi(ae,0,0,I,k,I,this.f,this.v,this.z),wi(ie,re,re,M,C,I,this.f,this.v,this.z);for(let pe=0;pe<j;pe++){const fe=Math.sqrt(ae[pe])-Math.sqrt(ie[pe]);B[pe]=Math.round(255-255*(fe/this.radius+this.cutoff))}return $}};class pt{constructor(){this.specification=u.v.light.position}possiblyEvaluate(e,r){return u.z(e.expression.evaluate(r))}interpolate(e,r,l){return{x:u.B.number(e.x,r.x,l),y:u.B.number(e.y,r.y,l),z:u.B.number(e.z,r.z,l)}}}let we;class We extends u.E{constructor(e){super(),we=we||new u.r({anchor:new u.D(u.v.light.anchor),position:new pt,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(we),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(u.t,e,r))for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l){return(!l||l.validate!==!1)&&u.x(this,e.call(u.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const Ge=new u.r({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class gt extends u.E{constructor(e){super(),this._transitionable=new u.T(Ge),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.C(0))}setSky(e,r={}){if(!this._validate(u.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l={}){return(l==null?void 0:l.validate)!==!1&&u.x(this,e.call(u.y,u.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class ue{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const l=e.join(",")+String(r);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,r)),this.dashEntry[l]}getDashRanges(e,r,l){const h=[];let m=e.length%2==1?-e[e.length-1]*l:0,x=e[0]*l,M=!0;h.push({left:m,right:x,isDash:M,zeroLength:e[0]===0});let C=e[0];for(let I=1;I<e.length;I++){M=!M;const k=e[I];m=C*l,C+=k,x=C*l,h.push({left:m,right:x,isDash:M,zeroLength:k===0})}return h}addRoundDash(e,r,l){const h=r/2;for(let m=-l;m<=l;m++){const x=this.width*(this.nextRow+l+m);let M=0,C=e[M];for(let I=0;I<this.width;I++){I/C.right>1&&(C=e[++M]);const k=Math.abs(I-C.left),j=Math.abs(I-C.right),B=Math.min(k,j);let $;const G=m/l*(h+1);if(C.isDash){const re=h-Math.abs(G);$=Math.sqrt(B*B+re*re)}else $=h-Math.sqrt(B*B+G*G);this.data[x+I]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e){for(let M=e.length-1;M>=0;--M){const C=e[M],I=e[M+1];C.zeroLength?e.splice(M,1):I&&I.isDash===C.isDash&&(I.left=C.left,e.splice(M,1))}const r=e[0],l=e[e.length-1];r.isDash===l.isDash&&(r.left=l.left-this.width,l.right=r.right+this.width);const h=this.width*this.nextRow;let m=0,x=e[m];for(let M=0;M<this.width;M++){M/x.right>1&&(x=e[++m]);const C=Math.abs(M-x.left),I=Math.abs(M-x.right),k=Math.min(C,I);this.data[h+M]=Math.max(0,Math.min(255,(x.isDash?k:-k)+128))}}addDash(e,r){const l=r?7:0,h=2*l+1;if(this.nextRow+h>this.height)return u.w("LineAtlas out of space"),null;let m=0;for(let M=0;M<e.length;M++)m+=e[M];if(m!==0){const M=this.width/m,C=this.getDashRanges(e,this.width,M);r?this.addRoundDash(C,M,l):this.addRegularDash(C)}const x={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:m};return this.nextRow+=h,this.dirty=!0,x}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const Ke="maplibre_preloaded_worker_pool";class lt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<lt.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ke]}numActive(){return Object.keys(this.active).length}}const ut=Math.floor(Ee.hardwareConcurrency/2);let vt,Ct;function It(){return vt||(vt=new lt),vt}lt.workerCount=u.G(globalThis)?Math.max(Math.min(ut,3),1):1;class di{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const l=this.workerPool.acquire(r);for(let h=0;h<l.length;h++){const m=new u.H(l[h],r);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const l=[];for(const h of this.actors)l.push(h.sendAsync({type:e,data:r}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const l of this.actors)l.registerMessageHandler(e,r)}}function li(){return Ct||(Ct=new di(It(),u.J),Ct.registerMessageHandler("GR",(f,e,r)=>u.m(e,r))),Ct}function er(f,e){const r=u.K();return u.L(r,r,[1,1,0]),u.M(r,r,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?u.N(r,r,f.calculatePosMatrix(e.toUnwrapped())):r}function lr(f,e,r,l,h,m,x){var M;const C=function(B,$,G){if(B)for(const re of B){const ie=$[re];if(ie&&ie.source===G&&ie.type==="fill-extrusion")return!0}else for(const re in $){const ie=$[re];if(ie.source===G&&ie.type==="fill-extrusion")return!0}return!1}((M=h==null?void 0:h.layers)!==null&&M!==void 0?M:null,e,f.id),I=m.maxPitchScaleFactor(),k=f.tilesIn(l,I,C);k.sort(Bi);const j=[];for(const B of k)j.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(e,r,f._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,h,m,I,er(f.transform,B.tileID),x?($,G)=>x(B.tileID,$,G):void 0)});return function(B,$){for(const G in B)for(const re of B[G])cr(re,$);return B}(function(B){const $={},G={};for(const re of B){const ie=re.queryResults,ae=re.wrappedTileID,ce=G[ae]=G[ae]||{};for(const pe in ie){const fe=ie[pe],ge=ce[pe]=ce[pe]||{},xe=$[pe]=$[pe]||[];for(const _e of fe)ge[_e.featureIndex]||(ge[_e.featureIndex]=!0,xe.push(_e))}}return $}(j),f)}function Bi(f,e){const r=f.tileID,l=e.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}function cr(f,e){const r=f.feature,l=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=l}function tr(f,e,r){return u._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield u.j(e.transformRequest(f.url,"Source"),r)).data:yield Ee.frameAsync(r),!l)return null;const h=u.O(u.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(h.vectorLayerIds=l.vector_layers.map(m=>m.id)),h})}class Ri{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof u.Q?new u.Q(e.lng,e.lat):u.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof u.Q?new u.Q(e.lng,e.lat):u.Q.convert(e),this}extend(e){const r=this._sw,l=this._ne;let h,m;if(e instanceof u.Q)h=e,m=e;else{if(!(e instanceof Ri))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ri.convert(e)):this.extend(u.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(u.Q.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return r||l?(r.lng=Math.min(h.lng,r.lng),r.lat=Math.min(h.lat,r.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new u.Q(h.lng,h.lat),this._ne=new u.Q(m.lng,m.lat)),this}getCenter(){return new u.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.Q(this.getWest(),this.getNorth())}getSouthEast(){return new u.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=u.Q.convert(e);let h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(e){return e instanceof Ri?e:e&&new Ri(e)}static fromLngLat(e,r=0){const l=360*r/40075017,h=l/Math.cos(Math.PI/180*e.lat);return new Ri(new u.Q(e.lng-h,e.lat-l),new u.Q(e.lng+h,e.lat+l))}adjustAntiMeridian(){const e=new u.Q(this._sw.lng,this._sw.lat),r=new u.Q(this._ne.lng,this._ne.lat);return new Ri(e,e.lng>r.lng?new u.Q(r.lng+360,r.lat):r)}}class qa{constructor(e,r,l){this.bounds=Ri.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),l=Math.floor(u.U(this.bounds.getWest())*r),h=Math.floor(u.S(this.bounds.getNorth())*r),m=Math.ceil(u.U(this.bounds.getEast())*r),x=Math.ceil(u.S(this.bounds.getSouth())*r);return e.x>=l&&e.x<m&&e.y>=h&&e.y<x}}class Ks extends u.E{constructor(e,r,l,h){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.O(r,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield tr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(u.e(this,e),e.bounds&&(this.tileBounds=new qa(e.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new u.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,x)=>{e.reloadPromise={resolve:m,reject:x}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:h,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Rr extends u.E{constructor(e,r,l,h){super(),this.id=e,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},r),u.e(this,u.O(r,["url","scheme","tileSize"]))}load(){return u._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield tr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(u.e(this,r),r.bounds&&(this.tileBounds=new qa(r.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new u.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return u.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield qt.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const h=this.map.painter.context,m=h.gl,x=l.data;e.texture=this.map.painter.getTileTexture(x.width),e.texture?e.texture.update(x,{useMipmap:!0}):(e.texture=new ti(h,x,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class wc extends Rr{constructor(e,r,l,h){super(e,r,l,h),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield qt.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const m=h.data;this.map._refreshExpiredTiles&&(h.cacheControl||h.expires)&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const x=u.b(m)&&u.V()?m:yield this.readImageNow(m),M={type:this.type,uid:e.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const C=yield e.actor.sendAsync({type:"LDT",data:M});e.dem=C,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.W()){const r=e.width+2,l=e.height+2;try{return new u.R({width:r,height:l},yield u.X(e,-1,-1,r,l))}catch{}}return Ee.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,l=Math.pow(2,r.z),h=(r.x-1+l)%l,m=r.x===0?e.wrap-1:e.wrap,x=(r.x+1+l)%l,M=r.x+1===l?e.wrap+1:e.wrap,C={};return C[new u.Y(e.overscaledZ,m,r.z,h,r.y).key]={backfilled:!1},C[new u.Y(e.overscaledZ,M,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(C[new u.Y(e.overscaledZ,m,r.z,h,r.y-1).key]={backfilled:!1},C[new u.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},C[new u.Y(e.overscaledZ,M,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<l&&(C[new u.Y(e.overscaledZ,m,r.z,h,r.y+1).key]={backfilled:!1},C[new u.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},C[new u.Y(e.overscaledZ,M,r.z,x,r.y+1).key]={backfilled:!1}),C}unloadTile(e){return u._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Ml extends u.E{constructor(e,r,l,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(h),this._data=r.data,this._options=u.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:u.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:u.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(u.Z/this.tileSize)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return u._(this,void 0,void 0,function*(){const e=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(r=>r.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return u._(this,void 0,void 0,function*(){const e=new Ri,r=yield this.getData();let l;switch(r.type){case"FeatureCollection":l=r.features.map(h=>this.getCoordinatesFromGeometry(h.geometry)).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(r.geometry);break;default:l=this.getCoordinatesFromGeometry(r)}if(l.length==0)return e;for(let h=0;h<l.length-1;h+=2)e.extend([l[h],l[h+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:l}})}_updateWorkerData(e){return u._(this,void 0,void 0,function*(){const r=u.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(Ee.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new u.l("dataabort",{dataType:"source"}));let h=null;l.resourceTiming&&l.resourceTiming[this.id]&&(h=l.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&u.e(m,{resourceTiming:h}),this.fire(new u.l("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new u.l("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new u.l("dataabort",{dataType:"source"}));this.fire(new u.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:r,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,r==="RT")})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Fn extends u.E{constructor(e,r,l,h){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=r}load(e){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield qt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new u.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(u.$.fromLngLat);var l;return this.tileID=function(h){let m=1/0,x=1/0,M=-1/0,C=-1/0;for(const B of h)m=Math.min(m,B.x),x=Math.min(x,B.y),M=Math.max(M,B.x),C=Math.max(C,B.y);const I=Math.max(M-m,C-x),k=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),j=Math.pow(2,k);return new u.a1(k,Math.floor((m+M)/2*j),Math.floor((x+C)/2*j))}(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new ti(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let r=1/0,l=1/0,h=-1/0,m=-1/0;for(const M of e)r=Math.min(r,M.x),l=Math.min(l,M.y),h=Math.max(h,M.x),m=Math.max(m,M.y);const x={};for(let M=0;M<=u.a0;M++){const C=Math.pow(2,M),I=Math.floor(r*C),k=Math.floor(l*C),j=Math.floor(h*C),B=Math.floor(m*C);x[M]={minTileX:I,minTileY:k,maxTileX:j,maxTileY:B}}return x}}class Qn extends Fn{constructor(e,r,l,h){super(e,r,l,h),this.roundZoom=!0,this.type="video",this.options=r}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield u.a2(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new u.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new u.k(new u.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new ti(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Io extends Fn{constructor(e,r,l,h){super(e,r,l,h),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(x=>typeof x!="number"))||this.fire(new u.k(new u.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.k(new u.a3(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new u.k(new u.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new u.k(new u.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.k(new u.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ti(r,this.canvas,l.RGBA,{premultiply:!0});let h=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,h=!0)}h&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Ws={},bs=f=>{switch(f){case"geojson":return Ml;case"image":return Fn;case"raster":return Rr;case"raster-dem":return wc;case"vector":return Ks;case"video":return Qn;case"canvas":return Io}return Ws[f]},El="RTLPluginLoaded";class $a extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=li()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return u._(this,arguments,void 0,function*(r,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Ee.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.l(El))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Wr=null;function mn(){return Wr||(Wr=new $a),Wr}class kr{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=u.a4(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const x={};if(!m)return x;for(const M of h){const C=M.layerIds.map(I=>m.getLayer(I)).filter(Boolean);if(C.length!==0){M.layers=C,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(I=>C.filter(k=>k.id===I)[0]));for(const I of C)x[I.id]=M}}return x}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a6){if(this.hasSymbolBuckets=!0,!l)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a6&&m.hasRTLText){this.hasRTLText=!0,mn().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new u.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ti(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ti(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,l,h,m,x,M,C,I,k,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:x,tileSize:this.tileSize,pixelPosMatrix:k,transform:C,params:M,queryPadding:this.queryPadding*I,getElevation:j},e,r,l):{}}querySourceFeatures(e,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),m=r&&r.sourceLayer?r.sourceLayer:"",x=h._geojsonTileLayer||h[m];if(!x)return;const M=u.a7(r&&r.filter),{z:C,x:I,y:k}=this.tileID.canonical,j={z:C,x:I,y:k};for(let B=0;B<x.length;B++){const $=x.feature(B);if(M.needGeometry){const ie=u.a8($,!0);if(!M.filter(new u.C(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!M.filter(new u.C(this.tileID.overscaledZ),$))continue;const G=l.getId($,m),re=new u.a9($,C,I,k,G);re.tile=j,e.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const l=u.aa(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(r)if(this.expirationTime<r)h=!0;else{const m=this.expirationTime-r;m?this.expirationTime=l+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!r.style.hasLayer(h))continue;const m=this.buckets[h],x=m.layers[0].sourceLayer||"_geojsonTileLayer",M=l[x],C=e[x];if(!M||!C||Object.keys(C).length===0)continue;m.update(C,M,this.imageAtlas&&this.imageAtlas.patternPositions||{});const I=r&&r.style&&r.style.getLayer(h);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ee.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ee.now()+e}setDependencies(e,r){const l={};for(const h of r)l[h]=!0;this.dependencies[e]=l}hasDependency(e,r){for(const l of e){const h=this.dependencies[l];if(h){for(const m of r)if(h[m])return!0}}return!1}}class Js{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,l){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:r,timeout:void 0};if(l!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},l)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const l=e.wrapped().key,h=r===void 0?0:this.data[l].indexOf(r),m=this.data[l][h];return this.data[l].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(m.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const l in this.data)for(const h of this.data[l])e(h.value)||r.push(h);for(const l of r)this.remove(l.value.tileID,l)}}class Cl{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,l){const h=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},u.e(this.stateChanges[e][h],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])l[m]||(this.deletedStates[e][h][m]=null)}else for(const m in l)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,r,l){if(this.deletedStates[e]===null)return;const h=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&r!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][l]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(l in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][l]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,r){const l=String(r),h=u.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][r];if(m===null)return{};for(const x in m)delete h[x]}return h}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),u.e(this.state[h][x],this.stateChanges[h][x]),m[x]=this.state[h][x];l[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const x in this.state[h])m[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(const M of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][M];m[x]=this.state[h][x]}l[h]=l[h]||{},u.e(l[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in e)e[h].setFeatureState(l,r)}}const pa=89.25;function cn(f,e){const r=u.ae(e.lat,-85.051129,u.af);return new u.P(u.U(e.lng)*f,u.S(r)*f)}function Kn(f,e){return new u.$(e.x/f,e.y/f).toLngLat()}function Ce(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(u.ab(90-f.pitch)),Math.tan(u.ab(pa-f.pitch)))}function X(f,e){const r=f.canonical,l=e/u.ac(r.z),h=r.x+Math.pow(2,r.z)*f.wrap,m=u.ad(new Float64Array(16));return u.L(m,m,[h*l,r.y*l,0]),u.M(m,m,[l/u.Z,l/u.Z,1]),m}function Y(f,e,r,l,h){const m=u.$.fromLngLat(f,e),x=h*u.ag(1,f.lat),M=x*Math.cos(u.ab(r)),C=Math.sqrt(x*x-M*M),I=C*Math.sin(u.ab(-l)),k=C*Math.cos(u.ab(-l));return new u.$(m.x+I,m.y+k,m.z+M)}function te(f,e,r){const l=e.intersectsFrustum(f);if(!r)return l;const h=e.intersectsPlane(r);return l===0||h===0?0:l===2&&h===2?2:1}function he(f,e,r){let l=0;const h=(r-e)/10;for(let m=0;m<10;m++)l+=h*Math.pow(Math.cos(e+(m+.5)/10*(r-e)),f);return l}function be(f,e){return function(r,l,h,m,x){const M=2*((f-1)/u.ah(Math.cos(u.ab(pa-x))/Math.cos(u.ab(pa)))-1),C=Math.acos(h/m),I=2*he(M-1,0,u.ab(x/2)),k=Math.min(u.ab(pa),C+u.ab(x/2)),j=he(M-1,Math.min(k,C-u.ab(x/2)),k),B=Math.atan(l/h),$=Math.hypot(l,h);let G=r;return G+=u.ah(m/$/Math.max(.5,Math.cos(u.ab(x/2)))),G+=M*u.ah(Math.cos(B))/2,G-=u.ah(Math.max(1,j/I/e))/2,G}}const ee=be(9.314,3);function Re(f,e){const r=(e.roundZoom?Math.round:Math.floor)(f.zoom+u.ah(f.tileSize/e.tileSize));return Math.max(0,r)}function Se(f,e){const r=f.getCameraFrustum(),l=f.getClippingPlane(),h=f.screenPointToMercatorCoordinate(f.getCameraPoint()),m=u.$.fromLngLat(f.center,f.elevation);h.z=m.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const x=f.getCoveringTilesDetailsProvider(),M=x.allowVariableZoom(f,e),C=Re(f,e),I=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,j=Math.min(Math.max(0,C),k),B=Math.pow(2,j),$=[B*h.x,B*h.y,0],G=[B*m.x,B*m.y,0],re=Math.hypot(m.x-h.x,m.y-h.y),ie=Math.abs(m.z-h.z),ae=Math.hypot(re,ie),ce=ge=>({zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),pe=[],fe=[];if(f.renderWorldCopies&&x.allowWorldCopies())for(let ge=1;ge<=3;ge++)pe.push(ce(-ge)),pe.push(ce(ge));for(pe.push(ce(0));pe.length>0;){const ge=pe.pop(),xe=ge.x,_e=ge.y;let ke=ge.fullyVisible;const Ye={x:xe,y:_e,z:ge.zoom},Ne=x.getTileAABB(Ye,ge.wrap,f.elevation,e);if(!ke){const ht=te(r,Ne,l);if(ht===0)continue;ke=ht===2}const Ue=x.distanceToTile2d(h.x,h.y,Ye,Ne);let $e=C;M&&($e=(e.calculateTileZoom||ee)(f.zoom+u.ah(f.tileSize/e.tileSize),Ue,ie,ae,f.fov)),$e=(e.roundZoom?Math.round:Math.floor)($e),$e=Math.max(0,$e);const dt=Math.min($e,k);if(ge.wrap=x.getWrap(m,Ye,ge.wrap),ge.zoom>=dt){if(ge.zoom<I)continue;const ht=j-ge.zoom,it=$[0]-.5-(xe<<ht),St=$[1]-.5-(_e<<ht),ei=e.reparseOverscaled?Math.max(ge.zoom,$e):ge.zoom;fe.push({tileID:new u.Y(ge.zoom===k?ei:ge.zoom,ge.wrap,ge.zoom,xe,_e),distanceSq:u.ai([G[0]-.5-xe,G[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(it*it+St*St)})}else for(let ht=0;ht<4;ht++)pe.push({zoom:ge.zoom+1,x:(xe<<1)+ht%2,y:(_e<<1)+(ht>>1),wrap:ge.wrap,fullyVisible:ke})}return fe.sort((ge,xe)=>ge.distanceSq-xe.distanceSq).map(ge=>ge.tileID)}class De extends u.E{constructor(e,r,l){super(),this.id=e,this.dispatcher=l,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,m,x,M)=>{const C=new(bs(m.type))(h,m,x,M);if(C.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${C.id}`);return C})(e,r,l,this),this._tiles={},this._cache=new Js(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Cl,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,l){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,l)}catch(h){e.state="errored",h.status!==404?this._source.fire(new u.k(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new u.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(je).map(e=>e.key)}getRenderableIds(e){const r=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&r.push(this._tiles[l]);return e?r.sort((l,h)=>{const m=l.tileID,x=h.tileID,M=new u.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),C=new u.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-x.overscaledZ||C.y-M.y||C.x-M.x}).map(l=>l.tileID.key):r.map(l=>l.tileID).sort(je).map(l=>l.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(e||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return u._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=r),yield this._loadTile(l,e,r))})}_tileLoaded(e,r,l){e.timeAdded=Ee.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new u.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let h=0;h<r.length;h++){const m=r[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const x=this.getTileByID(m);l(e,x),l(x,e)}}function l(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=m.tileID.canonical.x-h.tileID.canonical.x;const M=m.tileID.canonical.y-h.tileID.canonical.y,C=Math.pow(2,h.tileID.canonical.z),I=m.tileID.key;x===0&&M===0||Math.abs(M)>1||(Math.abs(x)>1&&(Math.abs(x+C)===1?x+=C:Math.abs(x-C)===1&&(x-=C)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,x,M),h.neighboringTiles&&h.neighboringTiles[I]&&(h.neighboringTiles[I].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,l,h){for(const m in this._tiles){let x=this._tiles[m];if(h[m]||!x.hasData()||x.tileID.overscaledZ<=r||x.tileID.overscaledZ>l)continue;let M=x.tileID;for(;x&&x.tileID.overscaledZ>r+1;){const I=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[I.key],x&&x.hasData()&&(M=I)}let C=M;for(;C.overscaledZ>r;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]||e[C.canonical.key]){h[M.key]=M;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=e.overscaledZ-1;l>=r;l--){const h=e.scaledTo(l),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(r*l*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const l={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+r),l[m.tileID.key]=m}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,r,l,h,m,x){const M={},C={},I=Object.keys(e),k=Ee.now();for(const j of I){const B=e[j],$=this._tiles[j];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=k)continue;const G=this.findLoadedParent(B,r),re=this.findLoadedSibling(B),ie=G||re||null;ie&&(this._addTile(ie.tileID),M[ie.tileID.key]=ie.tileID),C[j]=B}this._retainLoadedChildren(C,h,l,e);for(const j in M)e[j]||(this._coveredTiles[j]=!0,e[j]=M[j]);if(x){const j={},B={};for(const $ of m)this._tiles[$.key].hasData()?j[$.key]=$:B[$.key]=$;for(const $ in B){const G=B[$].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(j[G[0].key]=e[G[0].key]=G[0],j[G[1].key]=e[G[1].key]=G[1],j[G[2].key]=e[G[2].key]=G[2],j[G[3].key]=e[G[3].key]=G[3],delete B[$])}for(const $ in B){const G=B[$],re=this.findLoadedParent(G,this._source.minzoom),ie=this.findLoadedSibling(G),ae=re||ie||null;if(ae){j[ae.tileID.key]=e[ae.tileID.key]=ae.tileID;for(const ce in j)j[ce].isChildOf(ae.tileID)&&delete j[ce]}}for(const $ in this._tiles)j[$]||(this._coveredTiles[$]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new u.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(l=Se(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(k=>this._source.hasTile(k)))):l=[];const h=Re(e,this._source),m=Math.max(h-De.maxOverzooming,this._source.minzoom),x=Math.max(h+De.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const j of l)if(j.canonical.z>this._source.minzoom){const B=j.scaledTo(j.canonical.z-1);k[B.key]=B;const $=j.scaledTo(Math.max(this._source.minzoom,Math.min(j.canonical.z,5)));k[$.key]=$}l=l.concat(Object.values(k))}const M=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,M&&this.fire(new u.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(l,h);Ae(this._source.type)&&this._updateCoveredAndRetainedTiles(C,m,x,h,l,r);for(const k in C)this._tiles[k].clearFadeHold();const I=u.aj(this._tiles,C);for(const k of I){const j=this._tiles[k];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var l;const h={},m={},x=Math.max(r-De.maxOverzooming,this._source.minzoom),M=Math.max(r+De.maxUnderzooming,this._source.minzoom),C={};for(const I of e){const k=this._addTile(I);h[I.key]=I,k.hasData()||r<this._source.maxzoom&&(C[I.key]=I)}this._retainLoadedChildren(C,r,M,h);for(const I of e){let k=this._tiles[I.key];if(k.hasData())continue;if(r+1>this._source.maxzoom){const B=I.children(this._source.maxzoom)[0],$=this.getTile(B);if($&&$.hasData()){h[B.key]=B;continue}}else{const B=I.children(this._source.maxzoom);if(h[B[0].key]&&h[B[1].key]&&h[B[2].key]&&h[B[3].key])continue}let j=k.wasRequested();for(let B=I.overscaledZ-1;B>=x;--B){const $=I.scaledTo(B);if(m[$.key])break;if(m[$.key]=!0,k=this.getTile($),!k&&j&&(k=this._addTile($)),k){const G=k.hasData();if((G||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||j)&&(h[$.key]=$),j=k.wasRequested(),G)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let l,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}r.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(m),l)break;h=m}for(const m of r)this._loadedParentTiles[m]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,l=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=l}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const l=r;return r||(r=new kr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,l||this._source.fire(new u.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=r.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}refreshTiles(e){for(const r in this._tiles)this._isIdRenderable(r)&&e.some(l=>l.equals(this._tiles[r].tileID.canonical))&&this._reloadTile(r,"expired")}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,l){const h=[],m=this.transform;if(!m)return h;const x=l?m.getCameraQueryGeometry(e):e,M=e.map(G=>m.screenPointToMercatorCoordinate(G,this.terrain)),C=x.map(G=>m.screenPointToMercatorCoordinate(G,this.terrain)),I=this.getIds();let k=1/0,j=1/0,B=-1/0,$=-1/0;for(const G of C)k=Math.min(k,G.x),j=Math.min(j,G.y),B=Math.max(B,G.x),$=Math.max($,G.y);for(let G=0;G<I.length;G++){const re=this._tiles[I[G]];if(re.holdingForFade())continue;const ie=m.getCoveringTilesDetailsProvider().allowWorldCopies()?re.tileID:re.tileID.unwrapTo(0),ae=Math.pow(2,m.zoom-re.tileID.overscaledZ),ce=r*re.queryPadding*u.Z/re.tileSize/ae,pe=[ie.getTilePoint(new u.$(k,j)),ie.getTilePoint(new u.$(B,$))];if(pe[0].x-ce<u.Z&&pe[0].y-ce<u.Z&&pe[1].x+ce>=0&&pe[1].y+ce>=0){const fe=M.map(xe=>ie.getTilePoint(xe)),ge=C.map(xe=>ie.getTilePoint(xe));h.push({tile:re,tileID:ie,queryGeometry:fe,cameraQueryGeometry:ge,scale:ae})}}return h}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(Ae(this._source.type)){const e=Ee.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,l){this._state.updateState(e=e||"_geojsonTileLayer",r,l)}removeFeatureState(e,r,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,l)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,l){const h=this._tiles[e];h&&h.setDependencies(r,l)}reloadTilesForDependencies(e,r){for(const l in this._tiles)this._tiles[l].hasDependency(e,r)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,r))}}function je(f,e){const r=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-r||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Ae(f){return f==="raster"||f==="image"||f==="video"}De.maxOverzooming=10,De.maxUnderzooming=3;class et{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=u.ae(e,0,1);let r=1,l=this._distances[r];const h=e*this.paddedLength+this.padding;for(;l<h&&r<this._distances.length;)l=this._distances[++r];const m=r-1,x=this._distances[m],M=l-x,C=M>0?(h-x)/M:0;return this.points[m].mult(1-C).add(this.points[r].mult(C))}}function ft(f,e){let r=!0;return f==="always"||f!=="never"&&e!=="never"||(r=!1),r}class _t{constructor(e,r,l){const h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,l,h,m){this._forEachCell(r,l,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(e,r,l,h){this._forEachCell(r-h,l-h,r+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(l),this.circles.push(h)}_insertBoxCell(e,r,l,h,m,x){this.boxCells[m].push(x)}_insertCircleCell(e,r,l,h,m,x){this.circleCells[m].push(x)}_query(e,r,l,h,m,x,M){if(l<0||e>this.width||h<0||r>this.height)return[];const C=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=h){if(m)return[{key:null,x1:e,y1:r,x2:l,y2:h}];for(let I=0;I<this.boxKeys.length;I++)C.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const k=this.circles[3*I],j=this.circles[3*I+1],B=this.circles[3*I+2];C.push({key:this.circleKeys[I],x1:k-B,y1:j-B,x2:k+B,y2:j+B})}}else this._forEachCell(e,r,l,h,this._queryCell,C,{hitTest:m,overlapMode:x,seenUids:{box:{},circle:{}}},M);return C}query(e,r,l,h){return this._query(e,r,l,h,!1,null)}hitTest(e,r,l,h,m,x){return this._query(e,r,l,h,!0,m,x).length>0}hitTestCircle(e,r,l,h,m){const x=e-l,M=e+l,C=r-l,I=r+l;if(M<0||x>this.width||I<0||C>this.height)return!1;const k=[];return this._forEachCell(x,C,M,I,this._queryCellCircle,k,{hitTest:!0,overlapMode:h,circle:{x:e,y:r,radius:l},seenUids:{box:{},circle:{}}},m),k.length>0}_queryCell(e,r,l,h,m,x,M,C){const{seenUids:I,hitTest:k,overlapMode:j}=M,B=this.boxCells[m];if(B!==null){const G=this.bboxes;for(const re of B)if(!I.box[re]){I.box[re]=!0;const ie=4*re,ae=this.boxKeys[re];if(e<=G[ie+2]&&r<=G[ie+3]&&l>=G[ie+0]&&h>=G[ie+1]&&(!C||C(ae))&&(!k||!ft(j,ae.overlapMode))&&(x.push({key:ae,x1:G[ie],y1:G[ie+1],x2:G[ie+2],y2:G[ie+3]}),k))return!0}}const $=this.circleCells[m];if($!==null){const G=this.circles;for(const re of $)if(!I.circle[re]){I.circle[re]=!0;const ie=3*re,ae=this.circleKeys[re];if(this._circleAndRectCollide(G[ie],G[ie+1],G[ie+2],e,r,l,h)&&(!C||C(ae))&&(!k||!ft(j,ae.overlapMode))){const ce=G[ie],pe=G[ie+1],fe=G[ie+2];if(x.push({key:ae,x1:ce-fe,y1:pe-fe,x2:ce+fe,y2:pe+fe}),k)return!0}}}return!1}_queryCellCircle(e,r,l,h,m,x,M,C){const{circle:I,seenUids:k,overlapMode:j}=M,B=this.boxCells[m];if(B!==null){const G=this.bboxes;for(const re of B)if(!k.box[re]){k.box[re]=!0;const ie=4*re,ae=this.boxKeys[re];if(this._circleAndRectCollide(I.x,I.y,I.radius,G[ie+0],G[ie+1],G[ie+2],G[ie+3])&&(!C||C(ae))&&!ft(j,ae.overlapMode))return x.push(!0),!0}}const $=this.circleCells[m];if($!==null){const G=this.circles;for(const re of $)if(!k.circle[re]){k.circle[re]=!0;const ie=3*re,ae=this.circleKeys[re];if(this._circlesCollide(G[ie],G[ie+1],G[ie+2],I.x,I.y,I.radius)&&(!C||C(ae))&&!ft(j,ae.overlapMode))return x.push(!0),!0}}}_forEachCell(e,r,l,h,m,x,M,C){const I=this._convertToXCellCoord(e),k=this._convertToYCellCoord(r),j=this._convertToXCellCoord(l),B=this._convertToYCellCoord(h);for(let $=I;$<=j;$++)for(let G=k;G<=B;G++)if(m.call(this,e,r,l,h,this.xCellCount*G+$,x,M,C))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,l,h,m,x){const M=h-e,C=m-r,I=l+x;return I*I>M*M+C*C}_circleAndRectCollide(e,r,l,h,m,x,M){const C=(x-h)/2,I=Math.abs(e-(h+C));if(I>C+l)return!1;const k=(M-m)/2,j=Math.abs(r-(m+k));if(j>k+l)return!1;if(I<=C||j<=k)return!0;const B=I-C,$=j-k;return B*B+$*$<=l*l}}function At(f,e,r){const l=u.K();if(!f){const{vecSouth:j,vecEast:B}=zt(e),$=Q();$[0]=B[0],$[1]=B[1],$[2]=j[0],$[3]=j[1],h=$,(k=(x=(m=$)[0])*(I=m[3])-(C=m[2])*(M=m[1]))&&(h[0]=I*(k=1/k),h[1]=-M*k,h[2]=-C*k,h[3]=x*k),l[0]=$[0],l[1]=$[1],l[4]=$[2],l[5]=$[3]}var h,m,x,M,C,I,k;return u.M(l,l,[1/r,1/r,1]),l}function kt(f,e,r,l){if(f){const h=u.K();if(!e){const{vecSouth:m,vecEast:x}=zt(r);h[0]=x[0],h[1]=x[1],h[4]=m[0],h[5]=m[1]}return u.M(h,h,[l,l,1]),h}return r.pixelsToClipSpaceMatrix}function zt(f){const e=Math.cos(f.rollInRadians),r=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),h=Math.cos(f.bearingInRadians),m=Math.sin(f.bearingInRadians),x=u.ao();x[0]=-h*l*r-m*e,x[1]=-m*l*r+h*e;const M=u.ap(x);M<1e-9?u.aq(x):u.ar(x,x,1/M);const C=u.ao();C[0]=h*l*e-m*r,C[1]=m*l*e+h*r;const I=u.ap(C);return I<1e-9?u.aq(C):u.ar(C,C,1/I),{vecEast:C,vecSouth:x}}function qe(f,e,r,l){let h;l?(h=[f,e,l(f,e),1],u.at(h,h,r)):(h=[f,e,0,1],eo(h,h,r));const m=h[3];return{point:new u.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function yi(f,e){return .5+f/e*.5}function ci(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function vi(f,e,r,l,h,m,x,M,C,I,k,j,B){const $=r?f.textSizeData:f.iconSizeData,G=u.ak($,e.transform.zoom),re=[256/e.width*2+1,256/e.height*2+1],ie=r?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ie.clear();const ae=f.lineVertexArray,ce=r?f.text.placedSymbolArray:f.icon.placedSymbolArray,pe=e.transform.width/e.transform.height;let fe=!1;for(let ge=0;ge<ce.length;ge++){const xe=ce.get(ge);if(xe.hidden||xe.writingMode===u.al.vertical&&!fe){xs(xe.numGlyphs,ie);continue}fe=!1;const _e=new u.P(xe.anchorX,xe.anchorY),ke={getElevation:B,pitchedLabelPlaneMatrix:l,lineVertexArray:ae,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:_e,unwrappedTileID:C,width:I,height:k,translation:j},Ye=Lt(xe.anchorX,xe.anchorY,ke);if(!ci(Ye.point,re)){xs(xe.numGlyphs,ie);continue}const Ne=yi(e.transform.cameraToCenterDistance,Ye.signedDistanceFromCamera),Ue=u.am($,G,xe),$e=m?Ue*e.transform.getPitchedTextCorrection(xe.anchorX,xe.anchorY,C)/Ne:Ue*Ne,dt=Ft({projectionContext:ke,pitchedLabelPlaneMatrixInverse:h,symbol:xe,fontSize:$e,flip:!1,keepUpright:x,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ie,aspectRatio:pe,rotateToLine:M});fe=dt.useVertical,(dt.notEnoughRoom||fe||dt.needsFlipping&&Ft({projectionContext:ke,pitchedLabelPlaneMatrixInverse:h,symbol:xe,fontSize:$e,flip:!0,keepUpright:x,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ie,aspectRatio:pe,rotateToLine:M}).notEnoughRoom)&&xs(xe.numGlyphs,ie)}r?f.text.dynamicLayoutVertexBuffer.updateData(ie):f.icon.dynamicLayoutVertexBuffer.updateData(ie)}function Zt(f,e,r,l,h,m,x,M){const C=m.glyphStartIndex+m.numGlyphs,I=m.lineStartIndex,k=m.lineStartIndex+m.lineLength,j=e.getoffsetX(m.glyphStartIndex),B=e.getoffsetX(C-1),$=Wn(f*j,r,l,h,m.segment,I,k,M,x);if(!$)return null;const G=Wn(f*B,r,l,h,m.segment,I,k,M,x);return G?M.projectionCache.anyProjectionOccluded?null:{first:$,last:G}:null}function Je(f,e,r,l){return f===u.al.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*l?{useVertical:!0}:(f===u.al.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function Ft(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:l,fontSize:h,flip:m,keepUpright:x,glyphOffsetArray:M,dynamicLayoutVertexArray:C,aspectRatio:I,rotateToLine:k}=f,j=h/24,B=l.lineOffsetX*j,$=l.lineOffsetY*j;let G;if(l.numGlyphs>1){const re=l.glyphStartIndex+l.numGlyphs,ie=l.lineStartIndex,ae=l.lineStartIndex+l.lineLength,ce=Zt(j,M,B,$,m,l,k,e);if(!ce)return{notEnoughRoom:!0};const pe=$r(ce.first.point.x,ce.first.point.y,e,r),fe=$r(ce.last.point.x,ce.last.point.y,e,r);if(x&&!m){const ge=Je(l.writingMode,pe,fe,I);if(ge)return ge}G=[ce.first];for(let ge=l.glyphStartIndex+1;ge<re-1;ge++)G.push(Wn(j*M.getoffsetX(ge),B,$,m,l.segment,ie,ae,e,k));G.push(ce.last)}else{if(x&&!m){const ie=qi(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ae=l.lineStartIndex+l.segment+1,ce=new u.P(e.lineVertexArray.getx(ae),e.lineVertexArray.gety(ae)),pe=qi(ce.x,ce.y,e),fe=pe.signedDistanceFromCamera>0?pe.point:Gt(e.tileAnchorPoint,ce,ie,1,e),ge=$r(ie.x,ie.y,e,r),xe=$r(fe.x,fe.y,e,r),_e=Je(l.writingMode,ge,xe,I);if(_e)return _e}const re=Wn(j*M.getoffsetX(l.glyphStartIndex),B,$,m,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,k);if(!re||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};G=[re]}for(const re of G)u.as(C,re.point,re.angle);return{}}function Gt(f,e,r,l,h){const m=f.add(f.sub(e)._unit()),x=qi(m.x,m.y,h).point,M=r.sub(x);return r.add(M._mult(l/M.mag()))}function ji(f,e,r){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const h=new u.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),m=qi(h.x,h.y,e);if(m.signedDistanceFromCamera>0)return l.projections[f]=m.point,l.anyProjectionOccluded=l.anyProjectionOccluded||m.isOccluded,m.point;const x=f-r.direction;return Gt(r.distanceFromAnchor===0?e.tileAnchorPoint:new u.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),h,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function qi(f,e,r){const l=f+r.translation[0],h=e+r.translation[1];let m;return r.pitchWithMap?(m=qe(l,h,r.pitchedLabelPlaneMatrix,r.getElevation),m.isOccluded=!1):(m=r.transform.projectTileCoordinates(l,h,r.unwrappedTileID,r.getElevation),m.point.x=(.5*m.point.x+.5)*r.width,m.point.y=(.5*-m.point.y+.5)*r.height),m}function $r(f,e,r,l){if(r.pitchWithMap){const h=[f,e,0,1];return u.at(h,h,l),r.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],r.unwrappedTileID,r.getElevation).point}return{x:f/r.width*2-1,y:e/r.height*2-1}}function Lt(f,e,r){return r.transform.projectTileCoordinates(f,e,r.unwrappedTileID,r.getElevation)}function Do(f,e,r){return f._unit()._perp()._mult(e*r)}function Al(f,e,r,l,h,m,x,M,C){if(M.projectionCache.offsets[f])return M.projectionCache.offsets[f];const I=r.add(e);if(f+C.direction<l||f+C.direction>=h)return M.projectionCache.offsets[f]=I,I;const k=ji(f+C.direction,M,C),j=Do(k.sub(r),x,C.direction),B=r.add(j),$=k.add(j);return M.projectionCache.offsets[f]=u.au(m,I,B,$)||I,M.projectionCache.offsets[f]}function Wn(f,e,r,l,h,m,x,M,C){const I=l?f-e:f+e;let k=I>0?1:-1,j=0;l&&(k*=-1,j=Math.PI),k<0&&(j+=Math.PI);let B,$=k>0?m+h:m+h+1;M.projectionCache.cachedAnchorPoint?B=M.projectionCache.cachedAnchorPoint:(B=qi(M.tileAnchorPoint.x,M.tileAnchorPoint.y,M).point,M.projectionCache.cachedAnchorPoint=B);let G,re,ie=B,ae=B,ce=0,pe=0;const fe=Math.abs(I),ge=[];let xe;for(;ce+pe<=fe;){if($+=k,$<m||$>=x)return null;ce+=pe,ae=ie,re=G;const Ye={absOffsetX:fe,direction:k,distanceFromAnchor:ce,previousVertex:ae};if(ie=ji($,M,Ye),r===0)ge.push(ae),xe=ie.sub(ae);else{let Ne;const Ue=ie.sub(ae);Ne=Ue.mag()===0?Do(ji($+k,M,Ye).sub(ie),r,k):Do(Ue,r,k),re||(re=ae.add(Ne)),G=Al($,Ne,ie,m,x,re,r,M,Ye),ge.push(re),xe=G.sub(re)}pe=xe.mag()}const _e=xe._mult((fe-ce)/pe)._add(re||ae),ke=j+Math.atan2(ie.y-ae.y,ie.x-ae.x);return ge.push(_e),{point:_e,angle:C?ke:0,path:ge}}const Ga=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function xs(f,e){for(let r=0;r<f;r++){const l=e.length;e.resize(l+4),e.float32.set(Ga,3*l)}}function eo(f,e,r){const l=e[0],h=e[1];return f[0]=r[0]*l+r[4]*h+r[12],f[1]=r[1]*l+r[5]*h+r[13],f[3]=r[3]*l+r[7]*h+r[15],f}const wr=100;class Jn{constructor(e,r=new _t(e.width+200,e.height+200,25),l=new _t(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+wr,this.screenBottomBoundary=e.height+wr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,l,h,m,x,M,C,I,k,j,B){const $=this.projectAndGetPerspectiveRatio(e.anchorPointX+C[0],e.anchorPointY+C[1],m,k,B),G=l*$.perspectiveRatio;let re;if(x||M)re=this._projectCollisionBox(e,G,h,m,x,M,C,$,k,j,B);else{const xe=$.x+(j?j.x*G:0),_e=$.y+(j?j.y*G:0);re={allPointsOccluded:!1,box:[xe+e.x1*G,_e+e.y1*G,xe+e.x2*G,_e+e.y2*G]}}const[ie,ae,ce,pe]=re.box,fe=x?re.allPointsOccluded:$.isOccluded;let ge=fe;return ge||(ge=$.perspectiveRatio<this.perspectiveRatioCutoff),ge||(ge=!this.isInsideGrid(ie,ae,ce,pe)),ge||r!=="always"&&this.grid.hitTest(ie,ae,ce,pe,r,I)?{box:[ie,ae,ce,pe],placeable:!1,offscreen:!1,occluded:fe}:{box:[ie,ae,ce,pe],placeable:!0,offscreen:this.isOffscreen(ie,ae,ce,pe),occluded:fe}}placeCollisionCircles(e,r,l,h,m,x,M,C,I,k,j,B,$,G){const re=[],ie=new u.P(r.anchorX,r.anchorY),ae=this.getPerspectiveRatio(ie.x,ie.y,x,G),ce=(I?m*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,x)/ae:m*ae)/u.ay,pe={getElevation:G,pitchedLabelPlaneMatrix:M,lineVertexArray:l,pitchWithMap:I,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ie,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:$},fe=Zt(ce,h,r.lineOffsetX*ce,r.lineOffsetY*ce,!1,r,!1,pe);let ge=!1,xe=!1,_e=!0;if(fe){const ke=.5*j*ae+B,Ye=new u.P(-100,-100),Ne=new u.P(this.screenRightBoundary,this.screenBottomBoundary),Ue=new et,$e=fe.first,dt=fe.last;let ht=[];for(let ei=$e.path.length-1;ei>=1;ei--)ht.push($e.path[ei]);for(let ei=1;ei<dt.path.length;ei++)ht.push(dt.path[ei]);const it=2.5*ke;if(I){const ei=this.projectPathToScreenSpace(ht,pe);ht=ei.some(oi=>oi.signedDistanceFromCamera<=0)?[]:ei.map(oi=>oi.point)}let St=[];if(ht.length>0){const ei=ht[0].clone(),oi=ht[0].clone();for(let ar=1;ar<ht.length;ar++)ei.x=Math.min(ei.x,ht[ar].x),ei.y=Math.min(ei.y,ht[ar].y),oi.x=Math.max(oi.x,ht[ar].x),oi.y=Math.max(oi.y,ht[ar].y);St=ei.x>=Ye.x&&oi.x<=Ne.x&&ei.y>=Ye.y&&oi.y<=Ne.y?[ht]:oi.x<Ye.x||ei.x>Ne.x||oi.y<Ye.y||ei.y>Ne.y?[]:u.av([ht],Ye.x,Ye.y,Ne.x,Ne.y)}for(const ei of St){Ue.reset(ei,.25*ke);let oi=0;oi=Ue.length<=.5*ke?1:Math.ceil(Ue.paddedLength/it)+1;for(let ar=0;ar<oi;ar++){const ki=ar/Math.max(oi-1,1),sr=Ue.lerp(ki),Ki=sr.x+wr,Ni=sr.y+wr;re.push(Ki,Ni,ke,0);const xi=Ki-ke,Lr=Ni-ke,Xr=Ki+ke,nn=Ni+ke;if(_e=_e&&this.isOffscreen(xi,Lr,Xr,nn),xe=xe||this.isInsideGrid(xi,Lr,Xr,nn),e!=="always"&&this.grid.hitTestCircle(Ki,Ni,ke,e,k)&&(ge=!0,!C))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!C&&ge||!xe||ae<this.perspectiveRatioCutoff?[]:re,offscreen:_e,collisionDetected:ge}}projectPathToScreenSpace(e,r){const l=function(h,m){const x=u.K();return u.an(x,m.pitchedLabelPlaneMatrix),h.map(M=>{const C=qe(M.x,M.y,x,m.getElevation),I=m.transform.projectTileCoordinates(C.point.x,C.point.y,m.unwrappedTileID,m.getElevation);return I.point.x=(.5*I.point.x+.5)*m.width,I.point.y=(.5*-I.point.y+.5)*m.height,I})}(e,r);return function(h){let m=0,x=0,M=0,C=0;for(let I=0;I<h.length;I++)h[I].isOccluded?(M=I+1,C=0):(C++,C>x&&(x=C,m=M));return h.slice(m,m+x)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,h=1/0,m=-1/0,x=-1/0;for(const k of e){const j=new u.P(k.x+wr,k.y+wr);l=Math.min(l,j.x),h=Math.min(h,j.y),m=Math.max(m,j.x),x=Math.max(x,j.y),r.push(j)}const M=this.grid.query(l,h,m,x).concat(this.ignoredGrid.query(l,h,m,x)),C={},I={};for(const k of M){const j=k.key;if(C[j.bucketInstanceId]===void 0&&(C[j.bucketInstanceId]={}),C[j.bucketInstanceId][j.featureIndex])continue;const B=[new u.P(k.x1,k.y1),new u.P(k.x2,k.y1),new u.P(k.x2,k.y2),new u.P(k.x1,k.y2)];u.aw(r,B)&&(C[j.bucketInstanceId][j.featureIndex]=!0,I[j.bucketInstanceId]===void 0&&(I[j.bucketInstanceId]=[]),I[j.bucketInstanceId].push(j.featureIndex))}return I}insertCollisionBox(e,r,l,h,m,x){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:x,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,l,h,m,x){const M=l?this.ignoredGrid:this.grid,C={bucketInstanceId:h,featureIndex:m,collisionGroupID:x,overlapMode:r};for(let I=0;I<e.length;I+=4)M.insertCircle(C,e[I],e[I+1],e[I+2])}projectAndGetPerspectiveRatio(e,r,l,h,m){if(m){let x;h?(x=[e,r,h(e,r),1],u.at(x,x,m)):(x=[e,r,0,1],eo(x,x,m));const M=x[3];return{x:(x[0]/M+1)/2*this.transform.width+wr,y:(-x[1]/M+1)/2*this.transform.height+wr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M*.5,isOccluded:!1,signedDistanceFromCamera:M}}{const x=this.transform.projectTileCoordinates(e,r,l,h);return{x:(x.point.x+1)/2*this.transform.width+wr,y:(1-x.point.y)/2*this.transform.height+wr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,l,h){const m=this.transform.projectTileCoordinates(e,r,l,h);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,r,l,h){return l<wr||e>=this.screenRightBoundary||h<wr||r>this.screenBottomBoundary}isInsideGrid(e,r,l,h){return l>=0&&e<this.gridRightBoundary&&h>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=u.ad([]);return u.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,l,h,m,x,M,C,I,k,j){let B=1,$=0,G=0,re=1;const ie=e.anchorPointX+M[0],ae=e.anchorPointY+M[1];if(x&&!m){const ht=this.projectAndGetPerspectiveRatio(ie+1,ae,h,I,j),it=ht.x-C.x,St=Math.atan((ht.y-C.y)/it)+(it<0?Math.PI:0),ei=Math.sin(St),oi=Math.cos(St);B=oi,$=ei,G=-ei,re=oi}else if(!x&&m){const ht=zt(this.transform);B=ht.vecEast[0],$=ht.vecEast[1],G=ht.vecSouth[0],re=ht.vecSouth[1]}let ce=C.x,pe=C.y,fe=r;m&&(ce=ie,pe=ae,fe=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),fe*=this.transform.getPitchedTextCorrection(ie,ae,h),k||(fe*=u.ae(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(ce+=B*k.x*fe+G*k.y*fe,pe+=$*k.x*fe+re*k.y*fe);const ge=e.x1*fe,xe=e.x2*fe,_e=(ge+xe)/2,ke=e.y1*fe,Ye=e.y2*fe,Ne=(ke+Ye)/2,Ue=[{offsetX:ge,offsetY:ke},{offsetX:_e,offsetY:ke},{offsetX:xe,offsetY:ke},{offsetX:xe,offsetY:Ne},{offsetX:xe,offsetY:Ye},{offsetX:_e,offsetY:Ye},{offsetX:ge,offsetY:Ye},{offsetX:ge,offsetY:Ne}];let $e=[];for(const{offsetX:ht,offsetY:it}of Ue)$e.push(new u.P(ce+B*ht+G*it,pe+$*ht+re*it));let dt=!1;if(m){const ht=$e.map(it=>this.projectAndGetPerspectiveRatio(it.x,it.y,h,I,j));dt=ht.some(it=>!it.isOccluded),$e=ht.map(it=>new u.P(it.x,it.y))}else dt=!0;return{box:u.ax($e),allPointsOccluded:!dt}}}class Fi{constructor(e,r,l,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class to{constructor(e,r,l,h,m){this.text=new Fi(e?e.text:null,r,l,m),this.icon=new Fi(e?e.icon:null,r,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Un{constructor(e,r,l){this.text=e,this.icon=r,this.skipFade=l}}class Tc{constructor(e,r,l,h,m){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=m}}class io{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[e]}}function Nn(f,e,r,l,h){const{horizontalAlign:m,verticalAlign:x}=u.aE(f);return new u.P(-(m-.5)*e+l[0]*h,-(x-.5)*r+l[1]*h)}class _u{constructor(e,r,l,h,m){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new Jn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new io(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(l,h)=>r.getElevation(e,l,h):null}getBucketParts(e,r,l,h){const m=l.getBucket(r),x=l.latestFeatureIndex;if(!m||!x||r.id!==m.layerIds[0])return;const M=l.collisionBoxArray,C=m.layers[0].layout,I=m.layers[0].paint,k=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),j=l.tileSize/u.Z,B=l.tileID.toUnwrapped(),$=C.get("text-rotation-alignment")==="map",G=u.az(l,1,this.transform.zoom),re=u.aA(this.collisionIndex.transform,l,I.get("text-translate"),I.get("text-translate-anchor")),ie=u.aA(this.collisionIndex.transform,l,I.get("icon-translate"),I.get("icon-translate-anchor")),ae=At($,this.transform,G);this.retainedQueryData[m.bucketInstanceId]=new Tc(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,l.tileID);const ce={bucket:m,layout:C,translationText:re,translationIcon:ie,unwrappedTileID:B,pitchedLabelPlaneMatrix:ae,scale:k,textPixelRatio:j,holdingForFade:l.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:u.ak(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(const pe of m.sortKeyRanges){const{sortKey:fe,symbolInstanceStart:ge,symbolInstanceEnd:xe}=pe;e.push({sortKey:fe,symbolInstanceStart:ge,symbolInstanceEnd:xe,parameters:ce})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(e,r,l,h,m,x,M,C,I,k,j,B,$,G,re,ie,ae,ce,pe,fe){const ge=u.aB[e.textAnchor],xe=[e.textOffset0,e.textOffset1],_e=Nn(ge,l,h,xe,m),ke=this.collisionIndex.placeCollisionBox(r,B,C,I,k,M,x,ie,j.predicate,pe,_e,fe);if((!ce||this.collisionIndex.placeCollisionBox(ce,B,C,I,k,M,x,ae,j.predicate,pe,_e,fe).placeable)&&ke.placeable){let Ye;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Ye=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:xe,width:l,height:h,anchor:ge,textBoxScale:m,prevAnchor:Ye},this.markUsedJustification(G,ge,$,re),G.allowVerticalPlacement&&(this.markUsedOrientation(G,re,$),this.placedOrientations[$.crossTileID]=re),{shift:_e,placedGlyphBoxes:ke}}}placeLayerBucketPart(e,r,l){const{bucket:h,layout:m,translationText:x,translationIcon:M,unwrappedTileID:C,pitchedLabelPlaneMatrix:I,textPixelRatio:k,holdingForFade:j,collisionBoxArray:B,partiallyEvaluatedTextSize:$,collisionGroup:G}=e.parameters,re=m.get("text-optional"),ie=m.get("icon-optional"),ae=u.aC(m,"text-overlap","text-allow-overlap"),ce=ae==="always",pe=u.aC(m,"icon-overlap","icon-allow-overlap"),fe=pe==="always",ge=m.get("text-rotation-alignment")==="map",xe=m.get("text-pitch-alignment")==="map",_e=m.get("icon-text-fit")!=="none",ke=m.get("symbol-z-order")==="viewport-y",Ye=ce&&(fe||!h.hasIconData()||ie),Ne=fe&&(ce||!h.hasTextData()||re);!h.collisionArrays&&B&&h.deserializeCollisionBoxes(B);const Ue=this.retainedQueryData[h.bucketInstanceId].tileID,$e=this._getTerrainElevationFunc(Ue),dt=this.transform.getFastPathSimpleProjectionMatrix(Ue),ht=(it,St,ei)=>{var oi,ar;if(r[it.crossTileID])return;if(j)return void(this.placements[it.crossTileID]=new Un(!1,!1,!1));let ki=!1,sr=!1,Ki=!0,Ni=null,xi={box:null,placeable:!1,offscreen:null,occluded:!1},Lr={placeable:!1},Xr=null,nn=null,Ti=null,ls=0,Ba=0,Os=0;St.textFeatureIndex?ls=St.textFeatureIndex:it.useRuntimeCollisionCircles&&(ls=it.featureIndex),St.verticalTextFeatureIndex&&(Ba=St.verticalTextFeatureIndex);const Bs=St.textBox;if(Bs){const aa=_r=>{let Or=u.al.horizontal;if(h.allowVerticalPlacement&&!_r&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[it.crossTileID];wn&&(this.placedOrientations[it.crossTileID]=wn,Or=wn,this.markUsedOrientation(h,Or,it))}return Or},Fs=(_r,Or)=>{if(h.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&St.verticalTextBox){for(const wn of h.writingModes)if(wn===u.al.vertical?(xi=Or(),Lr=xi):xi=_r(),xi&&xi.placeable)break}else xi=_r()},sa=it.textAnchorOffsetStartIndex,cs=it.textAnchorOffsetEndIndex;if(cs===sa){const _r=(Or,wn)=>{const Li=this.collisionIndex.placeCollisionBox(Or,ae,k,Ue,C,xe,ge,x,G.predicate,$e,void 0,dt);return Li&&Li.placeable&&(this.markUsedOrientation(h,wn,it),this.placedOrientations[it.crossTileID]=wn),Li};Fs(()=>_r(Bs,u.al.horizontal),()=>{const Or=St.verticalTextBox;return h.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Or?_r(Or,u.al.vertical):{box:null,offscreen:null}}),aa(xi&&xi.placeable)}else{let _r=u.aB[(ar=(oi=this.prevPlacement)===null||oi===void 0?void 0:oi.variableOffsets[it.crossTileID])===null||ar===void 0?void 0:ar.anchor];const Or=(Li,Xc,Gh)=>{const Fd=Li.x2-Li.x1,tc=Li.y2-Li.y1,ul=it.textBoxScale,vo=_e&&pe==="never"?Xc:null;let Tn=null,oa=ae==="never"?1:2,la="never";_r&&oa++;for(let us=0;us<oa;us++){for(let Us=sa;Us<cs;Us++){const Ns=h.textAnchorOffsets.get(Us);if(_r&&Ns.textAnchor!==_r)continue;const Gn=this.attemptAnchorPlacement(Ns,Li,Fd,tc,ul,ge,xe,k,Ue,C,G,la,it,h,Gh,x,M,vo,$e);if(Gn&&(Tn=Gn.placedGlyphBoxes,Tn&&Tn.placeable))return ki=!0,Ni=Gn.shift,Tn}_r?_r=null:la=ae}return l&&!Tn&&(Tn={box:this.collisionIndex.placeCollisionBox(Bs,"always",k,Ue,C,xe,ge,x,G.predicate,$e,void 0,dt).box,offscreen:!1,placeable:!1,occluded:!1}),Tn};Fs(()=>Or(Bs,St.iconBox,u.al.horizontal),()=>{const Li=St.verticalTextBox;return h.allowVerticalPlacement&&(!xi||!xi.placeable)&&it.numVerticalGlyphVertices>0&&Li?Or(Li,St.verticalIconBox,u.al.vertical):{box:null,occluded:!0,offscreen:null}}),xi&&(ki=xi.placeable,Ki=xi.offscreen);const wn=aa(xi&&xi.placeable);if(!ki&&this.prevPlacement){const Li=this.prevPlacement.variableOffsets[it.crossTileID];Li&&(this.variableOffsets[it.crossTileID]=Li,this.markUsedJustification(h,Li.anchor,it,wn))}}}if(Xr=xi,ki=Xr&&Xr.placeable,Ki=Xr&&Xr.offscreen,it.useRuntimeCollisionCircles){const aa=h.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),Fs=u.am(h.textSizeData,$,aa),sa=m.get("text-padding");nn=this.collisionIndex.placeCollisionCircles(ae,aa,h.lineVertexArray,h.glyphOffsetArray,Fs,C,I,l,xe,G.predicate,it.collisionCircleDiameter,sa,x,$e),nn.circles.length&&nn.collisionDetected&&!l&&u.w("Collisions detected, but collision boxes are not shown"),ki=ce||nn.circles.length>0&&!nn.collisionDetected,Ki=Ki&&nn.offscreen}if(St.iconFeatureIndex&&(Os=St.iconFeatureIndex),St.iconBox){const aa=Fs=>this.collisionIndex.placeCollisionBox(Fs,pe,k,Ue,C,xe,ge,M,G.predicate,$e,_e&&Ni?Ni:void 0,dt);Lr&&Lr.placeable&&St.verticalIconBox?(Ti=aa(St.verticalIconBox),sr=Ti.placeable):(Ti=aa(St.iconBox),sr=Ti.placeable),Ki=Ki&&Ti.offscreen}const ec=re||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,js=ie||it.numIconVertices===0;ec||js?js?ec||(sr=sr&&ki):ki=sr&&ki:sr=ki=sr&&ki;const cl=sr&&Ti.placeable;if(ki&&Xr.placeable&&this.collisionIndex.insertCollisionBox(Xr.box,ae,m.get("text-ignore-placement"),h.bucketInstanceId,Lr&&Lr.placeable&&Ba?Ba:ls,G.ID),cl&&this.collisionIndex.insertCollisionBox(Ti.box,pe,m.get("icon-ignore-placement"),h.bucketInstanceId,Os,G.ID),nn&&ki&&this.collisionIndex.insertCollisionCircles(nn.circles,ae,m.get("text-ignore-placement"),h.bucketInstanceId,ls,G.ID),l&&this.storeCollisionData(h.bucketInstanceId,ei,St,Xr,Ti,nn),it.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[it.crossTileID]=new Un((ki||Ye)&&!(Xr!=null&&Xr.occluded),(sr||Ne)&&!(Ti!=null&&Ti.occluded),Ki||h.justReloaded),r[it.crossTileID]=!0};if(ke){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const it=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let St=it.length-1;St>=0;--St){const ei=it[St];ht(h.symbolInstances.get(ei),h.collisionArrays[ei],ei)}}else for(let it=e.symbolInstanceStart;it<e.symbolInstanceEnd;it++)ht(h.symbolInstances.get(it),h.collisionArrays[it],it);h.justReloaded=!1}storeCollisionData(e,r,l,h,m,x){if(l.textBox||l.iconBox){let M,C;this.collisionBoxArrays.has(e)?M=this.collisionBoxArrays.get(e):(M=new Map,this.collisionBoxArrays.set(e,M)),M.has(r)?C=M.get(r):(C={text:null,icon:null},M.set(r,C)),l.textBox&&(C.text=h.box),l.iconBox&&(C.icon=m.box)}if(x){let M=this.collisionCircleArrays[e];M===void 0&&(M=this.collisionCircleArrays[e]=[]);for(let C=0;C<x.circles.length;C+=4)M.push(x.circles[C+0]-wr),M.push(x.circles[C+1]-wr),M.push(x.circles[C+2]),M.push(x.collisionDetected?1:0)}}markUsedJustification(e,r,l,h){let m;m=h===u.al.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[u.aD(r)];const x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const M of x)M>=0&&(e.text.placedSymbolArray.get(M).crossTileID=m>=0&&M!==m?0:l.crossTileID)}markUsedOrientation(e,r,l){const h=r===u.al.horizontal||r===u.al.horizontalOnly?r:0,m=r===u.al.vertical?r:0,x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const M of x)e.text.placedSymbolArray.get(M).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const h=r?r.symbolFadeChange(e):1,m=r?r.opacities:{},x=r?r.variableOffsets:{},M=r?r.placedOrientations:{};for(const C in this.placements){const I=this.placements[C],k=m[C];k?(this.opacities[C]=new to(k,h,I.text,I.icon),l=l||I.text!==k.text.placed||I.icon!==k.icon.placed):(this.opacities[C]=new to(null,h,I.text,I.icon,I.skipFade),l=l||I.text||I.icon)}for(const C in m){const I=m[C];if(!this.opacities[C]){const k=new to(I,h,!1,!1);k.isHidden()||(this.opacities[C]=k,l=l||I.text.placed||I.icon.placed)}}for(const C in x)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=x[C]);for(const C in M)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=M[C]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const l={};for(const h of r){const m=h.getBucket(e);m&&h.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,l,h.collisionBoxArray)}}updateBucketOpacities(e,r,l,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],x=m.layout,M=new to(null,0,!1,!1,!0),C=x.get("text-allow-overlap"),I=x.get("icon-allow-overlap"),k=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=x.get("text-rotation-alignment")==="map",B=x.get("text-pitch-alignment")==="map",$=x.get("icon-text-fit")!=="none",G=new to(null,0,C&&(I||!e.hasIconData()||x.get("icon-optional")),I&&(C||!e.hasTextData()||x.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const re=(ae,ce,pe)=>{for(let fe=0;fe<ce/4;fe++)ae.opacityVertexArray.emplaceBack(pe);ae.hasVisibleVertices=ae.hasVisibleVertices||pe!==ko},ie=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ae=0;ae<e.symbolInstances.length;ae++){const ce=e.symbolInstances.get(ae),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:fe,crossTileID:ge}=ce;let xe=this.opacities[ge];l[ge]?xe=M:xe||(xe=G,this.opacities[ge]=xe),l[ge]=!0;const _e=ce.numIconVertices>0,ke=this.placedOrientations[ce.crossTileID],Ye=ke===u.al.vertical,Ne=ke===u.al.horizontal||ke===u.al.horizontalOnly;if(pe>0||fe>0){const $e=zl(xe.text);re(e.text,pe,Ye?ko:$e),re(e.text,fe,Ne?ko:$e);const dt=xe.text.isHidden();[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(St=>{St>=0&&(e.text.placedSymbolArray.get(St).hidden=dt||Ye?1:0)}),ce.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ce.verticalPlacedTextSymbolIndex).hidden=dt||Ne?1:0);const ht=this.variableOffsets[ce.crossTileID];ht&&this.markUsedJustification(e,ht.anchor,ce,ke);const it=this.placedOrientations[ce.crossTileID];it&&(this.markUsedJustification(e,"left",ce,it),this.markUsedOrientation(e,it,ce))}if(_e){const $e=zl(xe.icon),dt=!($&&ce.verticalPlacedIconSymbolIndex&&Ye);ce.placedIconSymbolIndex>=0&&(re(e.icon,ce.numIconVertices,dt?$e:ko),e.icon.placedSymbolArray.get(ce.placedIconSymbolIndex).hidden=xe.icon.isHidden()),ce.verticalPlacedIconSymbolIndex>=0&&(re(e.icon,ce.numVerticalIconVertices,dt?ko:$e),e.icon.placedSymbolArray.get(ce.verticalPlacedIconSymbolIndex).hidden=xe.icon.isHidden())}const Ue=ie&&ie.has(ae)?ie.get(ae):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const $e=e.collisionArrays[ae];if($e){let dt=new u.P(0,0);if($e.textBox||$e.verticalTextBox){let ht=!0;if(k){const it=this.variableOffsets[ge];it?(dt=Nn(it.anchor,it.width,it.height,it.textOffset,it.textBoxScale),j&&dt._rotate(B?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ht=!1}if($e.textBox||$e.verticalTextBox){let it;$e.textBox&&(it=Ye),$e.verticalTextBox&&(it=Ne),Sc(e.textCollisionBox.collisionVertexArray,xe.text.placed,!ht||it,Ue.text,dt.x,dt.y)}}if($e.iconBox||$e.verticalIconBox){const ht=!!(!Ne&&$e.verticalIconBox);let it;$e.iconBox&&(it=ht),$e.verticalIconBox&&(it=!ht),Sc(e.iconCollisionBox.collisionVertexArray,xe.icon.placed,it,Ue.icon,$?dt.x:0,$?dt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Sc(f,e,r,l,h,m){l&&l.length!==0||(l=[0,0,0,0]);const x=l[0]-wr,M=l[1]-wr,C=l[2]-wr,I=l[3]-wr;f.emplaceBack(e?1:0,r?1:0,h||0,m||0,x,M),f.emplaceBack(e?1:0,r?1:0,h||0,m||0,C,M),f.emplaceBack(e?1:0,r?1:0,h||0,m||0,C,I),f.emplaceBack(e?1:0,r?1:0,h||0,m||0,x,I)}const Sd=Math.pow(2,25),Ro=Math.pow(2,24),ea=Math.pow(2,17),Md=Math.pow(2,16),Gf=Math.pow(2,9),yu=Math.pow(2,8),Ch=Math.pow(2,1);function zl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,r=Math.floor(127*f.opacity);return r*Sd+e*Ro+r*ea+e*Md+r*Gf+e*yu+r*Ch+e}const ko=0;class Vn{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,l,h,m){const x=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(x,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((M,C)=>M.sortKey-C.sortKey));this._currentPartIndex<x.length;)if(r.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,m())return!0;return!1}}class vu{constructor(e,r,l,h,m,x,M,C){this.placement=new _u(e,r,x,M,C),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,r,l){const h=Ee.now(),m=()=>!this._forceFullPlacement&&Ee.now()-h>2;for(;this._currentPlacementIndex>=0;){const x=r[e[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=M)&&(!x.maxzoom||x.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new Vn(x)),this._inProgressLayer.continuePlacement(l[x.source],this.placement,this._showCollisionBoxes,x,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const ro=512/u.Z/2;class Mc{constructor(e,r,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const h=new Map;for(let m=0;m<r.length;m++){const x=r.get(m),M=x.key,C=h.get(M);C?C.push(x):h.set(M,[x])}for(const[m,x]of h){const M={positions:x.map(C=>({x:Math.floor(C.anchorX*ro),y:Math.floor(C.anchorY*ro)})),crossTileIDs:x.map(C=>C.crossTileID)};if(M.positions.length>128){const C=new u.aF(M.positions.length,16,Uint16Array);for(const{x:I,y:k}of M.positions)C.add(I,k);C.finish(),delete M.positions,M.index=C}this._symbolsByKey[m]=M}}getScaledCoordinates(e,r){const{x:l,y:h,z:m}=this.tileID.canonical,{x,y:M,z:C}=r.canonical,I=ro/Math.pow(2,C-m),k=(M*u.Z+e.anchorY)*I,j=h*u.Z*ro;return{x:Math.floor((x*u.Z+e.anchorX)*I-l*u.Z*ro),y:Math.floor(k-j)}}findMatches(e,r,l){const h=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let m=0;m<e.length;m++){const x=e.get(m);if(x.crossTileID)continue;const M=this._symbolsByKey[x.key];if(!M)continue;const C=this.getScaledCoordinates(x,r);if(M.index){const I=M.index.range(C.x-h,C.y-h,C.x+h,C.y+h).sort();for(const k of I){const j=M.crossTileIDs[k];if(!l[j]){l[j]=!0,x.crossTileID=j;break}}}else if(M.positions)for(let I=0;I<M.positions.length;I++){const k=M.positions[I],j=M.crossTileIDs[I];if(Math.abs(k.x-C.x)<=h&&Math.abs(k.y-C.y)<=h&&!l[j]){l[j]=!0,x.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Pl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Il{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const l in this.indexes){const h=this.indexes[l],m={};for(const x in h){const M=h[x];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+r),m[M.tileID.key]=M}this.indexes[l]=m}this.lng=e}addBucket(e,r,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<r.symbolInstances.length;m++)r.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const x=this.indexes[m];if(Number(m)>e.overscaledZ)for(const M in x){const C=x[M];C.tileID.isChildOf(e)&&C.findMatches(r.symbolInstances,e,h)}else{const M=x[e.scaledTo(Number(m)).key];M&&M.findMatches(r.symbolInstances,e,h)}}for(let m=0;m<r.symbolInstances.length;m++){const x=r.symbolInstances.get(m);x.crossTileID||(x.crossTileID=l.generate(),h[x.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Mc(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const l of r.getCrossTileIDsLists())for(const h of l)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let r=!1;for(const l in this.indexes){const h=this.indexes[l];for(const m in h)e[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[m]),delete h[m],r=!0)}return r}}class Dl{constructor(){this.layerIndexes={},this.crossTileIDs=new Pl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,l){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Il);let m=!1;const x={};h.handleWrapJump(l);for(const M of r){const C=M.getBucket(e);C&&e.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(M.tileID,C,this.crossTileIDs)&&(m=!0),x[C.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(m=!0),m}pruneUnusedLayers(e){const r={};e.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var no="void main() {fragColor=vec4(1.0);}";const zn={prelude:fi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:fi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:fi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:fi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:fi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:fi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:fi(no,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:fi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:fi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:fi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:fi(no,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:fi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:fi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:fi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:fi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:fi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:fi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:fi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:fi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:fi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:fi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:fi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:fi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:fi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:fi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:fi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:fi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:fi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:fi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:fi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:fi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:fi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function fi(f,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),h=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=m?m.concat(h):h,M={};return{fragmentSource:f=f.replace(r,(C,I,k,j,B)=>(M[B]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
in ${k} ${j} ${B};
#else
uniform ${k} ${j} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${k} ${j} ${B} = u_${B};
#endif
`)),vertexSource:e=e.replace(r,(C,I,k,j,B)=>{const $=j==="float"?"vec2":"vec4",G=B.match(/color/)?"color":$;return M[B]?I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${k} ${$} a_${B};
out ${k} ${j} ${B};
#else
uniform ${k} ${j} u_${B};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${k} ${j} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${G}(a_${B}, u_${B}_t);
#else
    ${k} ${j} ${B} = u_${B};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${k} ${$} a_${B};
#else
uniform ${k} ${j} u_${B};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${k} ${j} ${B} = a_${B};
#else
    ${k} ${j} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${k} ${j} ${B} = unpack_mix_${G}(a_${B}, u_${B}_t);
#else
    ${k} ${j} ${B} = u_${B};
#endif
`}),staticAttributes:l,staticUniforms:x}}class Lo{constructor(e,r,l){this.vertexBuffer=e,this.indexBuffer=r,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var un=u.aG([{name:"a_pos",type:"Int16",components:2}]);const Oo="#define PROJECTION_MERCATOR",ui="mercator";class ao{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return ui}get shaderDefine(){return Oo}get shaderPreludeCode(){return zn.projectionMercator}get vertexShaderPreludeCode(){return zn.projectionMercator.vertexSource}get subdivisionGranularity(){return u.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,l,h,m){if(this._cachedMesh)return this._cachedMesh;const x=new u.aI;x.emplaceBack(0,0),x.emplaceBack(u.Z,0),x.emplaceBack(0,u.Z),x.emplaceBack(u.Z,u.Z);const M=e.createVertexBuffer(x,un.members),C=u.aJ.simpleSegment(0,0,4,2),I=new u.aK;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3);const k=e.createIndexBuffer(I);return this._cachedMesh=new Lo(M,k,C),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Bo{constructor(e=0,r=0,l=0,h=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=l,this.right=h}interpolate(e,r,l){return r.top!=null&&e.top!=null&&(this.top=u.B.number(e.top,r.top,l)),r.bottom!=null&&e.bottom!=null&&(this.bottom=u.B.number(e.bottom,r.bottom,l)),r.left!=null&&e.left!=null&&(this.left=u.B.number(e.left,r.left,l)),r.right!=null&&e.right!=null&&(this.right=u.B.number(e.right,r.right,l)),this}getCenter(e,r){const l=u.ae((this.left+e-this.right)/2,0,e),h=u.ae((this.top+r-this.bottom)/2,0,r);return new u.P(l,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Bo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function so(f,e){if(!f.renderWorldCopies||f.lngRange)return;const r=e.lng-f.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Gr(f){return Math.max(0,Math.floor(f))}class Tr{constructor(e,r,l,h,m,x){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=h??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new u.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Gr(this._zoom),this._scale=u.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Bo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Gr(this._zoom),this._scale=u.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Bo(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=u.aL(e,-180,180)*Math.PI/180;var l,h,m,x,M,C,I,k,j;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=Q(),l=this._rotationMatrix,m=-this._bearingInRadians,x=(h=this._rotationMatrix)[0],M=h[1],C=h[2],I=h[3],k=Math.sin(m),j=Math.cos(m),l[0]=x*j+C*k,l[1]=M*j+I*k,l[2]=x*-k+C*j,l[3]=M*-k+I*j)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=u.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return u.aM(this._fovInRadians)}setFov(e){e=u.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=u.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=u.ac(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,l){this._unmodified=!1,this._edgeInsets.interpolate(e,r,l),this._constrain(),this._calcMatrices()}resize(e,r,l=!0){this._width=e,this._height=r,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ri([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,u.af])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{let l=e.x,h=e.y,m=e.x,x=e.y;for(const M of r)l=Math.min(l,M.x),h=Math.min(h,M.y),m=Math.max(m,M.x),x=Math.max(x,M.y);return[new u.P(l,h),new u.P(m,h),new u.P(m,x),new u.P(l,x),new u.P(l,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=u.ad(new Float64Array(16));u.M(e,e,[this._width/2,-this._height/2,1]),u.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=u.ad(new Float64Array(16)),u.M(e,e,[1,-1,1]),u.L(e,e,[-1,-1,0]),u.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,l,h){const m=l!==void 0?l:this.bearing,x=h=h!==void 0?h:this.pitch,M=u.$.fromLngLat(e,r),C=-Math.cos(u.ab(x)),I=Math.sin(u.ab(x)),k=I*Math.sin(u.ab(m)),j=-I*Math.cos(u.ab(m));let B=this.elevation;const $=r-B;let G;C*$>=0||Math.abs(C)<.1?(G=1e4,B=r+G*C):G=-$/C;let re,ie,ae=u.aN(1,M.y),ce=0;do{if(ce+=1,ce>10)break;ie=G/ae,re=new u.$(M.x+k*ie,M.y+j*ie),ae=1/re.meterInMercatorCoordinateUnits()}while(Math.abs(G-ie*ae)>1e-12);return{center:re.toLngLat(),elevation:B,zoom:u.ah(this.height/2/Math.tan(this.fovInRadians/2)/ie/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=u.ag(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/r,h=u.$.fromLngLat(this.center,this.elevation),m=Y(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const x=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),u.aN(m.z,h.y),this.bearing,this.pitch);this._elevation=x.elevation,this._center=x.center,this.setZoom(x.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=u.ag(1,this.center.lat)*this.worldSize;return Y(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/u.Z,1/r/u.Z]}}class Sr{constructor(e,r){this.min=e,this.max=r,this.center=u.aO([],u.aP([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],l=u.aQ(this.min),h=u.aQ(this.max);for(let m=0;m<r.length;m++)l[m]=r[m]?this.min[m]:this.center[m],h[m]=r[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Sr(l,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let l=0;l<e.planes.length;l++){const h=this.intersectsPlane(e.planes[l]);if(h===0)return 0;h===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],l=e[3];for(let h=0;h<3;h++)e[h]>0?(r+=e[h]*this.min[h],l+=e[h]*this.max[h]):(l+=e[h]*this.min[h],r+=e[h]*this.max[h]);return r>=0?2:l<0?0:1}}class Hr{distanceToTile2d(e,r,l,h){const m=h.distanceX([e,r]),x=h.distanceY([e,r]);return Math.hypot(m,x)}getWrap(e,r,l){return l}getTileAABB(e,r,l,h){var m,x;let M=l,C=l;if(h.terrain){const k=new u.Y(e.z,r,e.z,e.x,e.y),j=h.terrain.getMinMaxElevation(k);M=(m=j.minElevation)!==null&&m!==void 0?m:l,C=(x=j.maxElevation)!==null&&x!==void 0?x:l}const I=1<<e.z;return new Sr([r+e.x/I,e.y/I,M],[r+(e.x+1)/I,(e.y+1)/I,C])}allowVariableZoom(e,r){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,h=u.ae(78.5-l/2,0,60);return!!r.terrain||e.pitch>h}allowWorldCopies(){return!0}recalculateCache(){}}class $i{constructor(e,r,l){this.points=e,this.planes=r,this.aabb=l}static fromInvProjectionMatrix(e,r=1,l=0){const h=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const k=1/(I=u.at([],I,e))[3]/r*h;return u.aR(I,I,[k,k,1/I[3],k])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const k=u.aS([],m[I[0]],m[I[1]]),j=u.aS([],m[I[2]],m[I[1]]),B=u.aT([],u.aU([],k,j)),$=-u.aV(B,m[I[1]]);return B.concat($)}),M=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],C=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const I of m)for(let k=0;k<3;k++)M[k]=Math.min(M[k],I[k]),C[k]=Math.max(C[k],I[k]);return new $i(m,x,new Sr(M,C))}}class Ha{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,l,h,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Tr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(x,M)=>this.getConstrained(x,M)},e,r,l,h,m),this._coveringTilesDetailsProvider=new Hr}clone(){const e=new Ha;return e.apply(this),e}apply(e,r,l){this._helper.apply(e,r,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new u.aW(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new u.P(0,0)),h=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new u.P(0,this._helper._height)),M=Math.floor(Math.min(l.x,h.x,m.x,x.x)),C=Math.floor(Math.max(l.x,h.x,m.x,x.x)),I=1;for(let k=M-I;k<=C+I;k++)k!==0&&r.push(new u.aW(k,e))}return r}getCameraFrustum(){return $i.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,r){const l=u.ag(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(r,l),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),x=u.$.fromLngLat(e),M=new u.$(x.x-(h.x-m.x),x.y-(h.y-m.y));this.setCenter(M==null?void 0:M.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(u.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(u.$.fromLngLat(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const l=r||0,h=[e.x,e.y,0,1],m=[e.x,e.y,1,1];u.at(h,h,this._pixelMatrixInverse),u.at(m,m,this._pixelMatrixInverse);const x=h[3],M=m[3],C=h[1]/x,I=m[1]/M,k=h[2]/x,j=m[2]/M,B=k===j?0:(l-k)/(j-k);return new u.$(u.B.number(h[0]/x,m[0]/M,B)/this.worldSize,u.B.number(C,I,B)/this.worldSize,l)}coordinatePoint(e,r=0,l=this._pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,r,1];return u.at(h,h,l),new u.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Ce(this));return new Ri().extend(this.screenPointToLocation(new u.P(0,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new u.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-Ce(this)}calculatePosMatrix(e,r=!1,l){var h;const m=(h=e.key)!==null&&h!==void 0?h:u.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),x=r?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(m)){const I=x.get(m);return l?I.f32:I.f64}const M=X(e,this.worldSize);u.N(M,r?this._alignedProjMatrix:this._viewProjMatrix,M);const C={f64:M,f32:new Float32Array(M)};return x.set(m,C),l?C.f32:C.f64}calculateFogMatrix(e){const r=e.key,l=this._fogMatrixCacheF32;if(l.has(r))return l.get(r);const h=X(e,this.worldSize);return u.N(h,this._fogMatrix,h),l.set(r,new Float32Array(h)),l.get(r)}getConstrained(e,r){r=u.ae(+r,this.minZoom,this.maxZoom);const l={center:new u.Q(e.lng,e.lat),zoom:r};let h=this._helper._lngRange;this._helper._renderWorldCopies||h!==null||(h=[-179.9999999999,180-1e-10]);const m=this.tileSize*u.ac(l.zoom);let x=0,M=m,C=0,I=m,k=0,j=0;const{x:B,y:$}=this.size;if(this._helper._latRange){const pe=this._helper._latRange;x=u.S(pe[1])*m,M=u.S(pe[0])*m,M-x<$&&(k=$/(M-x))}h&&(C=u.aL(u.U(h[0])*m,0,m),I=u.aL(u.U(h[1])*m,0,m),I<C&&(I+=m),I-C<B&&(j=B/(I-C)));const{x:G,y:re}=cn(m,e);let ie,ae;const ce=Math.max(j||0,k||0);if(ce){const pe=new u.P(j?(I+C)/2:G,k?(M+x)/2:re);return l.center=Kn(m,pe).wrap(),l.zoom+=u.ah(ce),l}if(this._helper._latRange){const pe=$/2;re-pe<x&&(ae=x+pe),re+pe>M&&(ae=M-pe)}if(h){const pe=(C+I)/2;let fe=G;this._helper._renderWorldCopies&&(fe=u.aL(G,pe-m/2,pe+m/2));const ge=B/2;fe-ge<C&&(ie=C+ge),fe+ge>I&&(ie=I-ge)}if(ie!==void 0||ae!==void 0){const pe=new u.P(ie??G,ae??re);l.center=Kn(m,pe).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,r,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,h)}_calculateNearFarZIfNeeded(e,r,l){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-h*this._helper._pixelPerMeter/Math.cos(r),x=h<0?m:e,M=Math.PI/2+this.pitchInRadians,C=u.ab(this.fov)*(Math.abs(Math.cos(u.ab(this.roll)))*this.height+Math.abs(Math.sin(u.ab(this.roll)))*this.width)/this.height*(.5+l.y/this.height),I=Math.sin(C)*x/Math.sin(u.ae(Math.PI-M-C,.01,Math.PI-.01)),k=Ce(this),j=Math.atan(k/this._helper.cameraToCenterDistance),B=u.ab(.75),$=j>B?2*j*(.5+l.y/(2*k)):B,G=Math.sin($)*x/Math.sin(u.ae(Math.PI-M-$,.01,Math.PI-.01)),re=Math.min(I,G);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*re+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=cn(this.worldSize,this.center),l=r.x,h=r.y;this._helper._pixelPerMeter=u.ag(1,this.center.lat)*this.worldSize;const m=u.ab(Math.min(this.pitch,pa)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let M;this._calculateNearFarZIfNeeded(x,m,e),M=new Float64Array(16),u.aY(M,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),u.an(this._invProjMatrix,M),M[8]=2*-e.x/this._helper._width,M[9]=2*e.y/this._helper._height,this._projectionMatrix=u.aZ(M),u.M(M,M,[1,-1,1]),u.L(M,M,[0,0,-this._helper.cameraToCenterDistance]),u.a_(M,M,-this.rollInRadians),u.a$(M,M,this.pitchInRadians),u.a_(M,M,-this.bearingInRadians),u.L(M,M,[-l,-h,0]),this._mercatorMatrix=u.M([],M,[this.worldSize,this.worldSize,this.worldSize]),u.M(M,M,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=u.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,M),u.L(M,M,[0,0,-this.elevation]),this._viewProjMatrix=M,this._invViewProjMatrix=u.an([],M);const C=[0,0,-1,1];u.at(C,C,this._invViewProjMatrix),this._cameraPosition=[C[0]/C[3],C[1]/C[3],C[2]/C[3]],this._fogMatrix=new Float64Array(16),u.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,u.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),u.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),u.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),u.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),u.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),u.L(this._fogMatrix,this._fogMatrix,[-l,-h,0]),u.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),u.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=u.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,M);const I=this._helper._width%2/2,k=this._helper._height%2/2,j=Math.cos(this.bearingInRadians),B=Math.sin(-this.bearingInRadians),$=l-Math.round(l)+j*I+B*k,G=h-Math.round(h)+j*k+B*I,re=new Float64Array(M);if(u.L(re,re,[$>.5?$-1:$,G>.5?G-1:G,0]),this._alignedProjMatrix=re,M=u.an(new Float64Array(16),this._pixelMatrix),!M)throw new Error("failed to invert matrix");this._pixelMatrixInverse=M,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new u.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return u.at(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=u.ag(1,this.center.lat)*this.worldSize;return Y(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const l=u.$.fromLngLat(e),h=[l.x*this.worldSize,l.y*this.worldSize,r,1];return u.at(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(e){const{overscaledTileID:r,aligned:l,applyTerrainMatrix:h}=e,m=this._helper.getMercatorTileCoordinates(r),x=r?this.calculatePosMatrix(r,l,!0):null;let M;return M=r&&r.terrainRttPosMatrix32f&&h?r.terrainRttPosMatrix32f:x||u.b0(),{mainMatrix:M,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:M}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,l){return 1}transformLightDirection(e){return u.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,l,h){const m=this.calculatePosMatrix(l);let x;h?(x=[e,r,h(e,r),1],u.at(x,x,m)):(x=[e,r,0,1],eo(x,x,m));const M=x[3];return{point:new u.P(x[0]/M,x[1]/M),signedDistanceFromCamera:M,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const l=u.$.fromLngLat(e,r),h=l.meterInMercatorCoordinateUnits(),m=u.b1();return u.L(m,m,[l.x,l.y,l.z]),u.a_(m,m,Math.PI),u.a$(m,m,Math.PI/2),u.M(m,m,[-h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const r=new u.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),h=X(r,this.worldSize);u.N(h,this._viewProjMatrix,h),l.tileMercatorCoords=[0,0,1,1];const m=[u.Z,u.Z,this.worldSize/this._helper.pixelsPerMeter],x=u.b2();return u.M(x,h,m),l.fallbackMatrix=x,l.mainMatrix=x,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function mr(){u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Pn(f){if(f.useSlerp)if(f.k<1){const e=u.b3(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),r=u.b3(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);u.b4(l,e,r,f.k);const h=u.b5(l);f.tr.setRoll(h.roll),f.tr.setPitch(h.pitch),f.tr.setBearing(h.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(u.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(u.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(u.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Jr(f,e,r,l,h){const m=h.padding,x=cn(h.worldSize,r.getNorthWest()),M=cn(h.worldSize,r.getNorthEast()),C=cn(h.worldSize,r.getSouthEast()),I=cn(h.worldSize,r.getSouthWest()),k=u.ab(-l),j=x.rotate(k),B=M.rotate(k),$=C.rotate(k),G=I.rotate(k),re=new u.P(Math.max(j.x,B.x,G.x,$.x),Math.max(j.y,B.y,G.y,$.y)),ie=new u.P(Math.min(j.x,B.x,G.x,$.x),Math.min(j.y,B.y,G.y,$.y)),ae=re.sub(ie),ce=(h.width-(m.left+m.right+e.left+e.right))/ae.x,pe=(h.height-(m.top+m.bottom+e.top+e.bottom))/ae.y;if(pe<0||ce<0)return void mr();const fe=Math.min(u.ah(h.scale*Math.min(ce,pe)),f.maxZoom),ge=u.P.convert(f.offset),xe=new u.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(u.ab(l)),_e=ge.add(xe).mult(h.scale/u.ac(fe));return{center:Kn(h.worldSize,x.add(C).div(2).sub(_e)),zoom:fe,bearing:l}}class ma{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,l){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,r,l,h,m){return Jr(e,r,l,h,m)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(u.Q.convert(r.center))}handleEaseTo(e,r){const l=e.zoom,h=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},M=r.zoom!==void 0,C=!e.isPaddingEqual(r.padding);let I=!1;const k=M?+r.zoom:e.zoom;let j=e.centerPoint.add(r.offsetAsPoint);const B=e.screenPointToLocation(j),{center:$,zoom:G}=e.getConstrained(u.Q.convert(r.center||B),k??l);so(e,$);const re=cn(e.worldSize,B),ie=cn(e.worldSize,$).sub(re),ae=u.ac(G-l);return I=G!==l,{easeFunc:ce=>{if(I&&e.setZoom(u.B.number(l,G,ce)),u.b6(m,x)||Pn({startEulerAngles:m,endEulerAngles:x,tr:e,k:ce,useSlerp:m.roll!=x.roll}),C&&(e.interpolatePadding(h,r.padding,ce),j=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const pe=u.ac(e.zoom-l),fe=G>l?Math.min(2,ae):Math.max(.5,ae),ge=Math.pow(fe,1-ce),xe=Kn(e.worldSize,re.add(ie.mult(ce*ge)).mult(pe));e.setLocationAtPoint(e.renderWorldCopies?xe.wrap():xe,j)}},isZooming:I,elevationCenter:$}}handleFlyTo(e,r){const l=r.zoom!==void 0,h=e.zoom,m=e.getConstrained(u.Q.convert(r.center||r.locationAtOffset),l?+r.zoom:h),x=m.center,M=m.zoom;so(e,x);const C=cn(e.worldSize,r.locationAtOffset),I=cn(e.worldSize,x).sub(C),k=I.mag(),j=u.ac(M-h);let B;if(r.minZoom!==void 0){const $=Math.min(+r.minZoom,h,M),G=e.getConstrained(x,$).zoom;B=u.ac(G-h)}return{easeFunc:($,G,re,ie)=>{e.setZoom($===1?M:h+u.ah(G));const ae=$===1?x:Kn(e.worldSize,C.add(I.mult(re)).mult(G));e.setLocationAtPoint(e.renderWorldCopies?ae.wrap():ae,ie)},scaleOfZoom:j,targetCenter:x,scaleOfMinZoom:B,pixelPathLength:k}}}class Ai{constructor(e,r,l){this.blendFunction=e,this.blendColor=r,this.mask=l}}Ai.Replace=[1,0],Ai.disabled=new Ai(Ai.Replace,u.b7.transparent,[!1,!1,!1,!1]),Ai.unblended=new Ai(Ai.Replace,u.b7.transparent,[!0,!0,!0,!0]),Ai.alphaBlended=new Ai([1,771],u.b7.transparent,[!0,!0,!0,!0]);const Qi=2305;class ai{constructor(e,r,l){this.enable=e,this.mode=r,this.frontFace=l}}ai.disabled=new ai(!1,1029,Qi),ai.backCCW=new ai(!0,1029,Qi),ai.frontCCW=new ai(!0,1028,Qi);class Ht{constructor(e,r,l){this.func=e,this.mask=r,this.range=l}}Ht.ReadOnly=!1,Ht.ReadWrite=!0,Ht.disabled=new Ht(519,Ht.ReadOnly,[0,1]);const ws=7680;class Jt{constructor(e,r,l,h,m,x){this.test=e,this.ref=r,this.mask=l,this.fail=h,this.depthFail=m,this.pass=x}}Jt.disabled=new Jt({func:519,mask:0},0,0,ws,ws,ws);const hn=new WeakMap;function Mr(f){var e;if(hn.has(f))return hn.get(f);{const r=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return hn.set(f,r),r}}class Rl{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,l=r.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const h=new u.aI;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const m=new u.aK;m.emplaceBack(0,1,2),this._fullscreenTriangle=new Lo(r.createVertexBuffer(h,un.members),r.createIndexBuffer(m),u.aJ.simpleSegment(0,0,h.length,m.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(l.TEXTURE1);const x=l.createTexture();l.bindTexture(l.TEXTURE_2D,x),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),Mr(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const l=this._cachedRenderContext.context,h=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:u.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,h.TRIANGLES,Ht.disabled,Jt.disabled,Ai.unblended,ai.disabled,((m,x)=>({u_input:m,u_output_expected:x}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Mr(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const m=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Mr(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return u.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Rl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const jo=u.Z/128;function Ec(f,e){const r=f.granularity!==void 0?Math.max(f.granularity,1):1,l=r+(f.generateBorders?2:0),h=r+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),m=l+1,x=h+1,M=f.generateBorders?-1:0,C=f.generateBorders||f.extendToNorthPole?-1:0,I=r+(f.generateBorders?1:0),k=r+(f.generateBorders||f.extendToSouthPole?1:0),j=m*x,B=l*h*6,$=m*x>65536;if($&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const G=$||e==="32bit",re=new Int16Array(2*j);let ie=0;for(let pe=C;pe<=k;pe++)for(let fe=M;fe<=I;fe++){let ge=fe/r*u.Z;fe===-1&&(ge=-64),fe===r+1&&(ge=u.Z+jo);let xe=pe/r*u.Z;pe===-1&&(xe=f.extendToNorthPole?u.b9:-64),pe===r+1&&(xe=f.extendToSouthPole?u.ba:u.Z+jo),re[ie++]=ge,re[ie++]=xe}const ae=G?new Uint32Array(B):new Uint16Array(B);let ce=0;for(let pe=0;pe<h;pe++)for(let fe=0;fe<l;fe++){const ge=fe+1+pe*m,xe=fe+(pe+1)*m,_e=fe+1+(pe+1)*m;ae[ce++]=fe+pe*m,ae[ce++]=xe,ae[ce++]=ge,ae[ce++]=ge,ae[ce++]=xe,ae[ce++]=_e}return{vertices:re.buffer.slice(0),indices:ae.buffer.slice(0),uses32bitIndices:G}}const oo=new u.aH({fill:new u.bb(128,2),line:new u.bb(512,0),tile:new u.bb(128,32),stencil:new u.bb(128,1),circle:3});class Fo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return zn.projectionGlobe}get vertexShaderPreludeCode(){return zn.projectionMercator.vertexSource}get subdivisionGranularity(){return oo}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Rl(e));const r=u.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(r,l),m=Ee.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=m);const x=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=u.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,u.bd(x))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,l,h,m){const x=(m==="stencil"?oo.stencil:oo.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:x,generateBorders:l,extendToNorthPole:r.y===0&&h,extendToSouthPole:r.y===(1<<r.z)-1&&h})}_getMesh(e,r){const l=this._getMeshKey(r);if(l in this._tileMeshCache)return this._tileMeshCache[l];const h=function(m,x){const M=Ec(x,"16bit"),C=u.aI.deserialize({arrayBuffer:M.vertices,length:M.vertices.byteLength/2/2}),I=u.aK.deserialize({arrayBuffer:M.indices,length:M.indices.byteLength/2/3});return new Lo(m.createVertexBuffer(C,un.members),m.createIndexBuffer(I),u.aJ.simpleSegment(0,0,C.length,I.length))}(e,r);return this._tileMeshCache[l]=h,h}recalculate(e){}hasTransition(){const e=Ee.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Uo=new u.r({type:new u.D(u.v.projection.type)});class No extends u.E{constructor(e){super(),this._transitionable=new u.T(Uo),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.C(0)),this._mercatorProjection=new ao,this._verticalPerspectiveProjection=new Fo}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof u.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,l,h,m){return this.currentProjection.getMeshFromTileID(e,r,l,h,m)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function kl(f){const e=Zo(f.worldSize,f.center.lat);return 2*Math.PI*e}function Vo(f,e,r,l,h){const m=1/(1<<h),x=e/u.Z*m+l*m,M=u.bg((f/u.Z*m+r*m)*Math.PI*2+Math.PI,2*Math.PI),C=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,I=Math.cos(C),k=new Float64Array(3);return k[0]=Math.sin(M)*I,k[1]=Math.sin(C),k[2]=Math.cos(M)*I,k}function en(f){return function(e,r){const l=Math.cos(r),h=new Float64Array(3);return h[0]=Math.sin(e)*l,h[1]=Math.sin(r),h[2]=Math.cos(e)*l,h}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function Zo(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function qo(f){const e=Math.asin(f[1])/Math.PI*180,r=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(r>1e-6){const l=f[0]/r,h=Math.acos(f[2]/r),m=(l>0?h:-h)/Math.PI*180;return new u.Q(u.aL(m,-180,180),e)}return new u.Q(0,e)}function lo(f){return Math.cos(f*Math.PI/180)}function tn(f,e){const r=lo(f),l=lo(e);return u.ah(l/r)}function bu(f,e){const r=f.rotate(e.bearingInRadians),l=e.zoom+tn(e.center.lat,0),h=u.bc(1/lo(e.center.lat),1/lo(Math.min(Math.abs(e.center.lat),60)),u.bf(l,7,3,0,1)),m=360/kl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new u.Q(e.center.lng-r.x*m*h,u.ae(e.center.lat+r.y*m,-85.051129,u.af))}function xu(f){const e=.5*f,r=Math.sin(e),l=Math.cos(e);return Math.log(r+l)-Math.log(l-r)}function Ed(f,e,r,l){const h=f.lat+r*l;if(Math.abs(r)>1){const m=(Math.sign(f.lat+r)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,x=Math.abs(f.lat+r)*Math.PI/180,M=xu(m+l*(x-m)),C=xu(m),I=xu(x);return new u.Q(f.lng+e*((M-C)/(I-C)),h)}return new u.Q(f.lng+e*l,h)}class Cd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,r,l,h){const m=`${e.z}_${e.x}_${e.y}`,x=this._cache.get(m);if(x)return x;const M=this._cachePrevious.get(m);if(M)return this._cache.set(m,M),M;const C=this._aabbFactory(e,r,l,h);return this._cache.set(m,C),this._hadAnyChanges=!0,C}}function gn(f,e,r){const l=f-e;return l<0?-l:Math.max(0,l-r)}function Cc(f,e,r,l,h){const m=f-r;let x;return x=m<0?Math.min(-m,1+m-h):m>1?Math.min(Math.max(m-h,0),1-m):0,Math.max(x,gn(e,l,h))}class Xa{constructor(){this._aabbCache=new Cd(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,r,l,h){const m=1<<l.z,x=1/m,M=l.x/m,C=l.y/m;let I=2;return I=Math.min(I,Cc(e,r,M,C,x)),I=Math.min(I,Cc(e,r,M+.5,-C-x,x)),I=Math.min(I,Cc(e,r,M+.5,2-C-x,x)),I}getWrap(e,r,l){const h=1<<r.z,m=1/h,x=r.x/h,M=gn(e.x,x,m),C=gn(e.x,x-1,m),I=gn(e.x,x+1,m),k=Math.min(M,C,I);return k===I?1:k===C?-1:0}allowVariableZoom(e,r){return Re(e,r)>4}allowWorldCopies(){return!1}getTileAABB(e,r,l,h){return this._aabbCache.getTileAABB(e,r,l,h)}_computeTileAABB(e,r,l,h){if(e.z<=0)return new Sr([-1,-1,-1],[1,1,1]);if(e.z===1)return new Sr([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const m=[Vo(0,0,e.x,e.y,e.z),Vo(u.Z,0,e.x,e.y,e.z),Vo(u.Z,u.Z,e.x,e.y,e.z),Vo(0,u.Z,e.x,e.y,e.z)],x=[1,1,1],M=[-1,-1,-1];for(const C of m)for(let I=0;I<3;I++)x[I]=Math.min(x[I],C[I]),M[I]=Math.max(M[I],C[I]);if(e.y===0||e.y===(1<<e.z)-1){const C=[0,e.y===0?1:-1,0];for(let I=0;I<3;I++)x[I]=Math.min(x[I],C[I]),M[I]=Math.max(M[I],C[I])}return new Sr(x,M)}}}class $o{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=u.bk(),this._projectionMatrix=u.b1(),this._globeViewProjMatrix32f=u.b0(),this._globeViewProjMatrixNoCorrection=u.b1(),this._globeViewProjMatrixNoCorrectionInverted=u.b1(),this._globeProjMatrixInverted=u.b1(),this._cameraPosition=u.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Tr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new Xa}clone(){const e=new $o;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=u.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:l}=e,h=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,l=this.cameraToCenterDistance/e,h=Math.sin(r)*l,m=Math.cos(r)*l+1,x=1/Math.sqrt(h*h+m*m)*1;let M=-h,C=m;const I=Math.sqrt(M*M+C*C);M/=I,C/=I;const k=[0,M,C];u.bl(k,k,[0,0,0],-this.bearingInRadians),u.bm(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),u.bn(k,k,[0,0,0],this.center.lng*Math.PI/180);const j=1/u.bo(k);return u.aO(k,k,j),[...k,-x*j]}isLocationOccluded(e){return!this.isSurfacePointVisible(en(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,h=Math.cos(l),m=[Math.sin(r)*h,Math.sin(l),Math.cos(r)*h],x=[m[2],0,-m[0]],M=[0,0,0];u.aU(M,x,m),u.aT(x,x),u.aT(M,M);const C=[0,0,0];return u.aT(C,[x[0]*e[0]+M[0]*e[1]+m[0]*e[2],x[1]*e[0]+M[1]*e[1]+m[1]*e[2],x[2]*e[0]+M[2]*e[1]+m[2]*e[2]]),C}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,l){const h=function(M,C,I){const k=1/(1<<I.z);return new u.$(M/u.Z*k+I.x*k,C/u.Z*k+I.y*k)}(e,r,l.canonical),m=(x=h.y,[u.bg(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,r,l,h){const m=l.canonical,x=Vo(e,r,m.x,m.y,m.z),M=1+(h?h(e,r):0)/u.bu,C=[x[0]*M,x[1]*M,x[2]*M,1];u.at(C,C,this._globeViewProjMatrixNoCorrection);const I=this._cachedClippingPlane,k=I[0]*x[0]+I[1]*x[1]+I[2]*x[2]+I[3]<0;return{point:new u.P(C[0]/C[3],C[1]/C[3]),signedDistanceFromCamera:C[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Zo(this.worldSize,this.center.lat),r=u.b2(),l=u.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),u.aY(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;r[8]=2*-h.x/this._helper._width,r[9]=2*h.y/this._helper._height,this._projectionMatrix=u.aZ(r),this._globeProjMatrixInverted=u.b2(),u.an(this._globeProjMatrixInverted,r),u.L(r,r,[0,0,-this.cameraToCenterDistance]),u.a_(r,r,this.rollInRadians),u.a$(r,r,-this.pitchInRadians),u.a_(r,r,this.bearingInRadians),u.L(r,r,[0,0,-e]);const m=u.bh();m[0]=e,m[1]=e,m[2]=e,u.a$(l,r,this.center.lat*Math.PI/180),u.bp(l,l,-this.center.lng*Math.PI/180),u.M(l,l,m),this._globeViewProjMatrixNoCorrection=l,u.a$(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),u.bp(r,r,-this.center.lng*Math.PI/180),u.M(r,r,m),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=u.b2(),u.an(this._globeViewProjMatrixNoCorrectionInverted,l);const x=u.bh();this._cameraPosition=u.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,u.bl(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),u.bm(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),u.bl(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),u.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),u.bm(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),u.bn(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const M=u.aZ(this._globeViewProjMatrixNoCorrectionInverted);u.M(M,M,[1,1,-1]),this._cachedFrustum=$i.fromInvProjectionMatrix(M)}calculateFogMatrix(e){u.w("calculateFogMatrix is not supported on globe projection.");const r=u.b2();return u.ad(r),r}getVisibleUnwrappedCoordinates(e){return[new u.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&u.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=en(e);u.aO(l,l,1+r/u.bu);const h=u.bk();return u.at(h,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,l=[new u.P(0,0),new u.P(e,0),new u.P(this.width,0),new u.P(this.width,r),new u.P(this.width,this.height),new u.P(e,this.height),new u.P(0,this.height),new u.P(0,r)],h=[];for(const j of l)h.push(this.unprojectScreenPoint(j));let m=0,x=0,M=0,C=0;const I=this.center;for(const j of h){const B=u.bq(I.lng,j.lng),$=u.bq(I.lat,j.lat);B<x&&(x=B),B>m&&(m=B),$<C&&(C=$),$>M&&(M=$)}const k=[I.lng+x,I.lat+C,I.lng+m,I.lat+M];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new Ri(k)}getConstrained(e,r){const l=u.ae(e.lat,-85.051129,u.af),h=u.ae(+r,this.minZoom+tn(0,l),this.maxZoom);return{center:new u.Q(e.lng,l),zoom:h}}calculateCenterFromCameraLngLatAlt(e,r,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,h)}setLocationAtPoint(e,r){const l=en(this.unprojectScreenPoint(r)),h=en(e),m=u.bh();u.br(m);const x=u.bh();u.bn(x,l,m,-this.center.lng*Math.PI/180),u.bm(x,x,m,this.center.lat*Math.PI/180);const M=h[0]*h[0]+h[2]*h[2],C=x[0]*x[0];if(M<C)return;const I=Math.sqrt(M-C),k=-I,j=u.bs(h[0],h[2],x[0],I),B=u.bs(h[0],h[2],x[0],k),$=u.bh();u.bn($,h,m,-j);const G=u.bs($[1],$[2],x[1],x[2]),re=u.bh();u.bn(re,h,m,-B);const ie=u.bs(re[1],re[2],x[1],x[2]),ae=.5*Math.PI,ce=G>=-ae&&G<=ae,pe=ie>=-ae&&ie<=ae;let fe,ge;if(ce&&pe){const Ye=this.center.lng*Math.PI/180,Ne=this.center.lat*Math.PI/180;u.bv(j,Ye)+u.bv(G,Ne)<u.bv(B,Ye)+u.bv(ie,Ne)?(fe=j,ge=G):(fe=B,ge=ie)}else if(ce)fe=j,ge=G;else{if(!pe)return;fe=B,ge=ie}const xe=fe/Math.PI*180,_e=ge/Math.PI*180,ke=this.center.lat;this.setCenter(new u.Q(xe,u.ae(_e,-90,90))),this.setZoom(this.zoom+tn(ke,this.center.lat))}locationToScreenPoint(e,r){const l=en(e);if(r){const h=r.getElevationForLngLatZoom(e,this._helper._tileZoom);u.aO(l,l,1+h/u.bu)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const r=u.bk();return u.at(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new u.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l)return l}return u.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,r){const l=this._cameraPosition,h=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,h)}getRayDirectionFromPixel(e){const r=u.bk();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,u.at(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const l=u.bh();l[0]=r[0]-this._cameraPosition[0],l[1]=r[1]-this._cameraPosition[1],l[2]=r[2]-this._cameraPosition[2];const h=u.bh();return u.aT(h,l),h}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=u.bk();return u.at(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const l=u.aV(e,r),h=u.bh(),m=u.bh();u.aO(m,r,l),u.aS(h,e,m);const x=1-u.aV(h,h);if(x<0)return null;const M=u.aV(e,e)-1,C=-l+(l<0?1:-1)*Math.sqrt(x),I=M/C,k=C;return{tMin:Math.min(I,k),tMax:Math.max(I,k)}}unprojectScreenPoint(e){const r=this._cameraPosition,l=this.getRayDirectionFromPixel(e),h=this.rayPlanetIntersection(r,l);if(h){const k=u.bh();u.aP(k,r,[l[0]*h.tMin,l[1]*h.tMin,l[2]*h.tMin]);const j=u.bh();return u.aT(j,k),qo(j)}const m=this._cachedClippingPlane,x=m[0]*l[0]+m[1]*l[1]+m[2]*l[2],M=-u.bt(m,r)/x,C=u.bh();if(M>0)u.aP(C,r,[l[0]*M,l[1]*M,l[2]*M]);else{const k=u.bh();u.aP(k,r,[2*l[0],2*l[1],2*l[2]]);const j=u.bt(this._cachedClippingPlane,k);u.aS(C,k,[this._cachedClippingPlane[0]*j,this._cachedClippingPlane[1]*j,this._cachedClippingPlane[2]*j])}const I=function(k){const j=u.bh();return j[0]=k[0]*-k[3],j[1]=k[1]*-k[3],j[2]=k[2]*-k[3],{center:j,radius:Math.sqrt(1-k[3]*k[3])}}(m);return qo(function(k,j,B){const $=u.bh();u.aS($,B,k);const G=u.bh();return u.bi(G,k,$,j/u.bj($)),G}(I.center,I.radius,C))}getMatrixForModel(e,r){const l=u.Q.convert(e),h=1/u.bu,m=u.b1();return u.bp(m,m,l.lng/180*Math.PI),u.a$(m,m,-l.lat/180*Math.PI),u.L(m,m,[0,0,1+r/u.bu]),u.a$(m,m,.5*Math.PI),u.M(m,m,[h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new u.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class Go{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Tr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new Ha,this._verticalPerspectiveTransform=new $o}clone(){const e=new Go;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:r.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return u.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return u.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,l){const h=this._mercatorTransform.getPitchedTextCorrection(e,r,l),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,l);return u.bc(h,m,this._globeness)}projectTileCoordinates(e,r,l,h){return this.currentTransform.projectTileCoordinates(e,r,l,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,h)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=r.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class ga{get useGlobeControls(){return!0}handlePanInertia(e,r){const l=bu(e,r);return Math.abs(l.lng-r.center.lng)>180&&(l.lng=r.center.lng+179.5*Math.sign(l.lng-r.center.lng)),{easingCenter:l,easingOffset:new u.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const l=e.around,h=r.screenPointToLocation(l);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const m=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const x=r.zoom-m;if(x===0)return;const M=u.bq(r.center.lng,h.lng),C=M/(Math.abs(M/180)+1),I=u.bq(r.center.lat,h.lat),k=r.getRayDirectionFromPixel(l),j=r.cameraPosition,B=-1*u.aV(j,k),$=u.bh();u.aP($,j,[k[0]*B,k[1]*B,k[2]*B]);const G=u.bo($)-1,re=Math.exp(.5*-Math.max(G-.3,0)),ie=Zo(r.worldSize,r.center.lat)/Math.min(r.width,r.height),ae=u.bf(ie,.9,.5,1,.25),ce=(1-u.ac(-x))*Math.min(re,ae),pe=r.center.lat,fe=r.zoom,ge=new u.Q(r.center.lng+C*ce,u.ae(r.center.lat+I*ce,-85.051129,u.af));r.setLocationAtPoint(h,l);const xe=r.center,_e=u.bf(Math.abs(M),45,85,0,1),ke=u.bf(ie,.75,.35,0,1),Ye=Math.pow(Math.max(_e,ke),.25),Ne=u.bq(xe.lng,ge.lng),Ue=u.bq(xe.lat,ge.lat);r.setCenter(new u.Q(xe.lng+Ne*Ye,xe.lat+Ue*Ye).wrap()),r.setZoom(fe+tn(pe,r.center.lat))}handleMapControlsPan(e,r,l){if(!e.panDelta)return;const h=r.center.lat,m=r.zoom;r.setCenter(bu(e.panDelta,r).wrap()),r.setZoom(m+tn(h,r.center.lat))}cameraForBoxAndBearing(e,r,l,h,m){const x=Jr(e,r,l,h,m),M=r.left/m.width*2-1,C=(m.width-r.right)/m.width*2-1,I=r.top/m.height*-2+1,k=(m.height-r.bottom)/m.height*-2+1,j=u.bq(l.getWest(),l.getEast())<0,B=j?l.getEast():l.getWest(),$=j?l.getWest():l.getEast(),G=Math.max(l.getNorth(),l.getSouth()),re=Math.min(l.getNorth(),l.getSouth()),ie=B+.5*u.bq(B,$),ae=G+.5*u.bq(G,re),ce=m.clone();ce.setCenter(x.center),ce.setBearing(x.bearing),ce.setPitch(0),ce.setRoll(0),ce.setZoom(x.zoom);const pe=ce.modelViewProjectionMatrix,fe=[en(l.getNorthWest()),en(l.getNorthEast()),en(l.getSouthWest()),en(l.getSouthEast()),en(new u.Q($,ae)),en(new u.Q(B,ae)),en(new u.Q(ie,G)),en(new u.Q(ie,re))],ge=en(x.center);let xe=Number.POSITIVE_INFINITY;for(const _e of fe)M<0&&(xe=ga.getLesserNonNegativeNonNull(xe,ga.solveVectorScale(_e,ge,pe,"x",M))),C>0&&(xe=ga.getLesserNonNegativeNonNull(xe,ga.solveVectorScale(_e,ge,pe,"x",C))),I>0&&(xe=ga.getLesserNonNegativeNonNull(xe,ga.solveVectorScale(_e,ge,pe,"y",I))),k<0&&(xe=ga.getLesserNonNegativeNonNull(xe,ga.solveVectorScale(_e,ge,pe,"y",k)));if(Number.isFinite(xe)&&xe!==0)return x.zoom=ce.zoom+u.ah(xe),x;mr()}handleJumpToCenterZoom(e,r){const l=e.center.lat,h=e.getConstrained(r.center?u.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(h.wrap());const m=r.zoom!==void 0?+r.zoom:e.zoom+tn(l,h.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,r){const l=e.zoom,h=e.center,m=e.padding,x={roll:e.roll,pitch:e.pitch,bearing:e.bearing},M={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},C=r.zoom!==void 0,I=!e.isPaddingEqual(r.padding);let k=!1;const j=r.center?u.Q.convert(r.center):h,B=e.getConstrained(j,l).center;so(e,B);const $=e.clone();$.setCenter(B),$.setZoom(C?+r.zoom:l+tn(h.lat,j.lat)),$.setBearing(r.bearing);const G=new u.P(u.ae(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),u.ae(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));$.setLocationAtPoint(B,G);const re=(r.offset&&r.offsetAsPoint.mag())>0?$.center:B,ie=C?+r.zoom:l+tn(h.lat,re.lat),ae=l+tn(h.lat,0),ce=ie+tn(re.lat,0),pe=u.bq(h.lng,re.lng),fe=u.bq(h.lat,re.lat),ge=u.ac(ce-ae);return k=ie!==l,{easeFunc:xe=>{if(u.b6(x,M)||Pn({startEulerAngles:x,endEulerAngles:M,tr:e,k:xe,useSlerp:x.roll!=M.roll}),I&&e.interpolatePadding(m,r.padding,xe),r.around)u.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const _e=ce>ae?Math.min(2,ge):Math.max(.5,ge),ke=Math.pow(_e,1-xe),Ye=Ed(h,pe,fe,xe*ke);e.setCenter(Ye.wrap())}if(k){const _e=u.B.number(ae,ce,xe)+tn(0,e.center.lat);e.setZoom(_e)}},isZooming:k,elevationCenter:re}}handleFlyTo(e,r){const l=r.zoom!==void 0,h=e.center,m=e.zoom,x=e.padding,M=!e.isPaddingEqual(r.padding),C=e.getConstrained(u.Q.convert(r.center||r.locationAtOffset),m).center,I=l?+r.zoom:e.zoom+tn(e.center.lat,C.lat),k=e.clone();k.setCenter(C),k.setZoom(I),k.setBearing(r.bearing);const j=new u.P(u.ae(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),u.ae(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(C,j);const B=k.center;so(e,B);const $=function(fe,ge,xe){const _e=en(ge),ke=en(xe),Ye=u.aV(_e,ke),Ne=Math.acos(Ye),Ue=kl(fe);return Ne/(2*Math.PI)*Ue}(e,h,B),G=m+tn(h.lat,0),re=I+tn(B.lat,0),ie=u.ac(re-G);let ae;if(typeof r.minZoom=="number"){const fe=+r.minZoom+tn(B.lat,0),ge=Math.min(fe,G,re)+tn(0,B.lat),xe=e.getConstrained(B,ge).zoom+tn(B.lat,0);ae=u.ac(xe-G)}const ce=u.bq(h.lng,B.lng),pe=u.bq(h.lat,B.lat);return{easeFunc:(fe,ge,xe,_e)=>{const ke=Ed(h,ce,pe,xe);M&&e.interpolatePadding(x,r.padding,fe);const Ye=fe===1?B:ke;e.setCenter(Ye.wrap());const Ne=G+u.ah(ge);e.setZoom(fe===1?I:Ne+tn(0,Ye.lat))},scaleOfZoom:ie,targetCenter:B,scaleOfMinZoom:ae,pixelPathLength:$}}static solveVectorScale(e,r,l,h,m){const x=h==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],M=[l[3],l[7],l[11],l[15]],C=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],I=e[0]*M[0]+e[1]*M[1]+e[2]*M[2],k=r[0]*x[0]+r[1]*x[1]+r[2]*x[2],j=r[0]*M[0]+r[1]*M[1]+r[2]*M[2];return k+m*I===C+m*j||M[3]*(C-k)+x[3]*(j-I)+C*j==k*I?null:(k+x[3]-m*j-m*M[3])/(k-C-m*j+m*I)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class Ho{constructor(e){this._globe=e,this._mercatorCameraHelper=new ma,this._verticalPerspectiveCameraHelper=new ga}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,l){this.currentHelper.handleMapControlsPan(e,r,l)}cameraForBoxAndBearing(e,r,l,h,m){return this.currentHelper.cameraForBoxAndBearing(e,r,l,h,m)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const wu=(f,e)=>u.x(f,e&&e.filter(r=>r.identifier!=="source.canvas")),Ad=u.bw();class Ah extends u.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const h=this.sourceCaches[l].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new di(It(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,h)=>this.getGlyphs(l,h)),this.dispatcher.registerMessageHandler("GI",(l,h)=>this.getImages(l,h)),this.imageManager=new Mi,this.imageManager.setEventedParent(this),this.glyphManager=new Et(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new ue(256,512),this.crossTileSymbolIndex=new Dl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.by()),mn().on(El,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const h=this.sourceCaches[l.sourceId];if(!h)return;const m=h.getSource();if(m&&m.vectorLayerIds)for(const x in this._layers){const M=this._layers[x];M.source===m.id&&this._validateLayer(M)}})}loadURL(e,r={},l){this.fire(new u.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;u.j(h,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,r,l)}).catch(x=>{this._loadStyleRequest=null,x&&!m.signal.aborted&&this.fire(new u.k(x))})}loadJSON(e,r={},l){this.fire(new u.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Ee.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,l)}).catch(()=>{})}loadEmpty(){this.fire(new u.l("dataloading",{dataType:"style"})),this._load(Ad,{validate:!1})}_load(e,r,l){var h,m;const x=r.transformStyle?r.transformStyle(l,e):e;if(!r.validate||!wu(this,u.y(x))){this._loaded=!0,this.stylesheet=x;for(const M in x.sources)this.addSource(M,x.sources[M],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new We(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new gt(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new u.l("data",{dataType:"style"})),this.fire(new u.l("style.load"))}}_createLayers(){const e=u.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const l=u.bA(r);l.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=l}}_loadSprite(e,r=!1,l=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,x,M,C){return u._(this,void 0,void 0,function*(){const I=Bt(m),k=M>1?"@2x":"",j={},B={};for(const{id:$,url:G}of I){const re=x.transformRequest(Pi(G,k,".json"),"SpriteJSON");j[$]=u.j(re,C);const ie=x.transformRequest(Pi(G,k,".png"),"SpriteImage");B[$]=qt.getImage(ie,C)}return yield Promise.all([...Object.values(j),...Object.values(B)]),function($,G){return u._(this,void 0,void 0,function*(){const re={};for(const ie in $){re[ie]={};const ae=Ee.getImageCanvasContext((yield G[ie]).data),ce=(yield $[ie]).data;for(const pe in ce){const{width:fe,height:ge,x:xe,y:_e,sdf:ke,pixelRatio:Ye,stretchX:Ne,stretchY:Ue,content:$e,textFitWidth:dt,textFitHeight:ht}=ce[pe];re[ie][pe]={data:null,pixelRatio:Ye,sdf:ke,stretchX:Ne,stretchY:Ue,content:$e,textFitWidth:dt,textFitHeight:ht,spriteData:{width:fe,height:ge,x:xe,y:_e,context:ae}}}}return re})}(j,B)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const x in m){this._spritesImagesIds[x]=[];const M=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(C=>!(C in m)):[];for(const C of M)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in m[x]){const I=x==="default"?C:`${x}:${C}`;this._spritesImagesIds[x].push(I),I in this.imageManager.images?this.imageManager.updateImage(I,m[x][C],!1):this.imageManager.addImage(I,m[x][C]),r&&(this._changedImages[I]=!0)}}}).catch(m=>{this._spriteRequest=null,h=m,this.fire(new u.k(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"})),l&&l(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const l=e.sourceLayer;if(!l)return;const h=r.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new u.k(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?u.bB(l):l);const h=[];for(const m of e)if(l[m]){const x=r?u.bB(l[m]):l[m];h.push(x)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const l of r){const h=this._layers[l];h.type!=="custom"&&(e[l]=h.serialize())}return e}hasTransitions(){var e,r,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(const x in this._updatedSources){const M=this._updatedSources[x];if(M==="reload")this._reloadSource(x);else{if(M!=="clear")throw new Error(`Invalid action ${M}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const m=this.sourceCaches[h];l[h]=m.used,m.used=!1}for(const h of this._order){const m=this._layers[h];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const h in l){const m=this.sourceCaches[h];!!l[h]!=!!m.used&&m.fire(new u.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new u.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var l;this._checkLoaded();const h=this.serialize();if(e=r.transformStyle?r.transformStyle(h,e):e,((l=r.validate)===null||l===void 0||l)&&wu(this,u.y(e)))return!1;(e=u.bB(e)).layers=u.bz(e.layers);const m=u.bC(h,e),x=this._getOperationsToPerform(m);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const M of x.operations)M();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],l=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":r.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":r.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":r.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setTransition":r.push(()=>{});break;default:l.push(h.command)}return{operations:r,unimplemented:l}}addImage(e,r){if(this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(u.y.source,`sources.${e}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const h=this.sourceCaches[e]=new De(e,r,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new u.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new u.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,l={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new u.k(new Error(`Layer "${h}" already exists on this map.`)));let m;if(e.type==="custom"){if(wu(this,u.bD(e)))return;m=u.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=u.bB(e),e=u.e(e,{source:h})),this._validate(u.y.layer,`layers.${h}`,e,{arrayIndex:-1},l))return;m=u.bA(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}const x=r?this._order.indexOf(r):this._order.length;if(r&&x===-1)this.fire(new u.k(new Error(`Cannot add layer "${h}" before non-existing layer "${r}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){const M=this._removedLayers[h];delete this._removedLayers[h],M.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new u.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const l=this._order.indexOf(e);this._order.splice(l,1);const h=r?this._order.indexOf(r):this._order.length;r&&h===-1?this.fire(new u.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new u.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,l){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===r&&h.maxzoom===l||(r!=null&&(h.minzoom=r),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new u.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,l={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!u.bE(h.filter,r))return r==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(u.y.filter,`layers.${h.id}.filter`,r,null,l)||(h.filter=u.bB(r),this._updateLayer(h)))}else this.fire(new u.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return u.bB(this.getLayer(e).filter)}setLayoutProperty(e,r,l,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.bE(m.getLayoutProperty(r),l)||(m.setLayoutProperty(r,l,h),this._updateLayer(m)):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const l=this.getLayer(e);if(l)return l.getLayoutProperty(r);this.fire(new u.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,l,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.bE(m.getPaintProperty(r),l)||(m.setPaintProperty(r,l,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const l=e.source,h=e.sourceLayer,m=this.sourceCaches[l];if(m===void 0)return void this.fire(new u.k(new Error(`The source '${l}' does not exist in the map's style.`)));const x=m.getSource().type;x==="geojson"&&h?this.fire(new u.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,e.id,r)):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const l=e.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new u.k(new Error(`The source '${l}' does not exist in the map's style.`)));const m=h.getSource().type,x=m==="vector"?e.sourceLayer:void 0;m!=="vector"||x?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new u.k(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,e.id,r):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,l=e.sourceLayer,h=this.sourceCaches[r];if(h!==void 0)return h.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,e.id)):void this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=u.bF(this.sourceCaches,m=>m.serialize()),r=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,h=this.stylesheet;return u.bG({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:e,layers:r,terrain:l},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=x=>this._layers[x].type==="fill-extrusion",l={},h=[];for(let x=this._order.length-1;x>=0;x--){const M=this._order[x];if(r(M)){l[M]=x;for(const C of e){const I=C[M];if(I)for(const k of I)h.push(k)}}}h.sort((x,M)=>M.intersectionZ-x.intersectionZ);const m=[];for(let x=this._order.length-1;x>=0;x--){const M=this._order[x];if(r(M))for(let C=h.length-1;C>=0;C--){const I=h[C].feature;if(l[I.layer.id]<x)break;m.push(I),h.pop()}else for(const C of e){const I=C[M];if(I)for(const k of I)m.push(k.feature)}}return m}queryRenderedFeatures(e,r,l){r&&r.filter&&this._validate(u.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const h={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new u.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const I of r.layers){const k=this._layers[I];if(!k)return this.fire(new u.k(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];h[k.source]=!0}}const m=[];r.availableImages=this._availableImages;const x=this._serializedAllLayers(),M=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,C=Object.assign(Object.assign({},r),{layers:M});for(const I in this.sourceCaches)r.layers&&!h[I]||m.push(lr(this.sourceCaches[I],this._layers,x,e,C,l,this.map.terrain?(k,j,B)=>this.map.terrain.getElevation(k,j,B):void 0));return this.placement&&m.push(function(I,k,j,B,$,G,re){const ie={},ae=G.queryRenderedSymbols(B),ce=[];for(const pe of Object.keys(ae).map(Number))ce.push(re[pe]);ce.sort(Bi);for(const pe of ce){const fe=pe.featureIndex.lookupSymbolFeatures(ae[pe.bucketInstanceId],k,pe.bucketIndex,pe.sourceLayerIndex,$.filter,$.layers,$.availableImages,I);for(const ge in fe){const xe=ie[ge]=ie[ge]||[],_e=fe[ge];_e.sort((ke,Ye)=>{const Ne=pe.featureSortOrder;if(Ne){const Ue=Ne.indexOf(ke.featureIndex);return Ne.indexOf(Ye.featureIndex)-Ue}return Ye.featureIndex-ke.featureIndex});for(const ke of _e)xe.push(ke)}}return function(pe,fe,ge){for(const xe in pe)for(const _e of pe[xe])cr(_e,ge[fe[xe].source]);return pe}(ie,I,j)}(this._layers,x,this.sourceCaches,e,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,r){r&&r.filter&&this._validate(u.y.filter,"querySourceFeatures.filter",r.filter,null,r);const l=this.sourceCaches[e];return l?function(h,m){const x=h.getRenderableIds().map(I=>h.getTileByID(I)),M=[],C={};for(let I=0;I<x.length;I++){const k=x[I],j=k.tileID.canonical.key;C[j]||(C[j]=!0,k.querySourceFeatures(M,m))}return M}(l,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const x in e)if(!u.bE(e[x],l[x])){h=!0;break}if(!h)return;const m={now:Ee.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const l=this.getSky();let h=!1;if(!e&&!l)return;if(e&&!l)h=!0;else if(!e&&l)h=!0;else for(const x in e)if(!u.bE(e[x],l[x])){h=!0;break}if(!h)return;const m={now:Ee.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(m)}_setProjectionInternal(e){const r=function(l){if(Array.isArray(l)){const h=new No({type:l});return{projection:h,transform:new Go,cameraHelper:new Ho(h)}}switch(l){case"mercator":return{projection:new ao,transform:new Ha,cameraHelper:new ma};case"globe":{const h=new No({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new Go,cameraHelper:new Ho(h)}}case"vertical-perspective":return{projection:new Fo,transform:new $o,cameraHelper:new ga};default:return u.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new ao,transform:new Ha,cameraHelper:new ma}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,r,l,h,m={}){return(!m||m.validate!==!1)&&wu(this,e.call(u.y,u.e({key:r,style:this.serialize(),value:l,styleSpec:u.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),mn().off(El,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const l=this.sourceCaches[r];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,l,h,m=!1){let x=!1,M=!1;const C={};for(const I of this._order){const k=this._layers[I];if(k.type!=="symbol")continue;if(!C[k.source]){const B=this.sourceCaches[k.source];C[k.source]=B.getRenderableIds(!0).map($=>B.getTileByID($)).sort(($,G)=>G.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(G.tileID)?-1:1))}const j=this.crossTileSymbolIndex.addLayer(k,C[k.source],e.center.lng);x=x||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ee.now(),e.zoom))&&(this.pauseablePlacement=new vu(e,this.map.terrain,this._order,m,r,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ee.now()),M=!0),x&&this.pauseablePlacement.placement.setStale()),M||x)for(const I of this._order){const k=this._layers[I];k.type==="symbol"&&this.placement.updateLayerOpacities(k,C[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ee.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return u._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[r.source];return h&&h.setDependencies(r.tileID.key,r.type,r.icons),l})}getGlyphs(e,r){return u._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(r.stacks),h=this.sourceCaches[r.source];return h&&h.setDependencies(r.tileID.key,r.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(u.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,l={},h){this._checkLoaded();const m=[{id:e,url:r}],x=[...Bt(this.stylesheet.sprite),...m];this._validate(u.y.sprite,"sprite",x,null,l)||(this.stylesheet.sprite=x,this._loadSprite(m,!0,h))}removeSprite(e){this._checkLoaded();const r=Bt(this.stylesheet.sprite);if(r.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;r.splice(r.findIndex(l=>l.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}else this.fire(new u.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Bt(this.stylesheet.sprite)}setSprite(e,r={},l){this._checkLoaded(),e&&this._validate(u.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Hf=u.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Xf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,l,h,m,x,M,C,I){this.context=e;let k=this.boundPaintVertexBuffers.length!==h.length;for(let j=0;!k&&j<h.length;j++)this.boundPaintVertexBuffers[j]!==h[j]&&(k=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||k||this.boundIndexBuffer!==m||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==I?this.freshBind(r,l,h,m,x,M,C,I):(e.bindVertexArray.set(this.vao),M&&M.bind(),m&&m.dynamicDraw&&m.bind(),C&&C.bind(),I&&I.bind())}freshBind(e,r,l,h,m,x,M,C){const I=e.numAttributes,k=this.context,j=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=C,r.enableAttributes(j,e);for(const B of l)B.enableAttributes(j,e);x&&x.enableAttributes(j,e),M&&M.enableAttributes(j,e),C&&C.enableAttributes(j,e),r.bind(),r.setVertexAttribPointers(j,e,m);for(const B of l)B.bind(),B.setVertexAttribPointers(j,e,m);x&&(x.bind(),x.setVertexAttribPointers(j,e,m)),h&&h.bind(),M&&(M.bind(),M.setVertexAttribPointers(j,e,m)),C&&(C.bind(),C.setVertexAttribPointers(j,e,m)),k.currentNumAttributes=I}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Yf=(f,e,r,l,h)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):u.b7.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:r?r.calculateFogBlendOpacity(l):0,u_horizon_color:r?r.properties.get("horizon-color"):u.b7.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),Tu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ll(f){const e=[];for(let r=0;r<f.length;r++){if(f[r]===null)continue;const l=f[r].split(" ");e.push(l.pop())}return e}class Su{constructor(e,r,l,h,m,x,M,C,I=[]){const k=e.gl;this.program=k.createProgram();const j=Ll(r.staticAttributes),B=l?l.getBinderAttributes():[],$=j.concat(B),G=zn.prelude.staticUniforms?Ll(zn.prelude.staticUniforms):[],re=M.staticUniforms?Ll(M.staticUniforms):[],ie=r.staticUniforms?Ll(r.staticUniforms):[],ae=l?l.getBinderUniforms():[],ce=G.concat(re).concat(ie).concat(ae),pe=[];for(const Ne of ce)pe.indexOf(Ne)<0&&pe.push(Ne);const fe=l?l.defines():[];Mr(k)&&fe.unshift("#version 300 es"),m&&fe.push("#define OVERDRAW_INSPECTOR;"),x&&fe.push("#define TERRAIN3D;"),C&&fe.push(C),I&&fe.push(...I);let ge=fe.concat(zn.prelude.fragmentSource,M.fragmentSource,r.fragmentSource).join(`
`),xe=fe.concat(zn.prelude.vertexSource,M.vertexSource,r.vertexSource).join(`
`);Mr(k)||(ge=function(Ne){return Ne.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ge),xe=function(Ne){return Ne.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(xe));const _e=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(_e,ge),k.compileShader(_e),!k.getShaderParameter(_e,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(_e)}`);k.attachShader(this.program,_e);const ke=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ke,xe),k.compileShader(ke),!k.getShaderParameter(ke,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(ke)}`);k.attachShader(this.program,ke),this.attributes={};const Ye={};this.numAttributes=$.length;for(let Ne=0;Ne<this.numAttributes;Ne++)$[Ne]&&(k.bindAttribLocation(this.program,Ne,$[Ne]),this.attributes[$[Ne]]=Ne);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(ke),k.deleteShader(_e);for(let Ne=0;Ne<pe.length;Ne++){const Ue=pe[Ne];if(Ue&&!Ye[Ue]){const $e=k.getUniformLocation(this.program,Ue);$e&&(Ye[Ue]=$e)}}this.fixedUniforms=h(e,Ye),this.terrainUniforms=((Ne,Ue)=>({u_depth:new u.bH(Ne,Ue.u_depth),u_terrain:new u.bH(Ne,Ue.u_terrain),u_terrain_dim:new u.b8(Ne,Ue.u_terrain_dim),u_terrain_matrix:new u.bJ(Ne,Ue.u_terrain_matrix),u_terrain_unpack:new u.bK(Ne,Ue.u_terrain_unpack),u_terrain_exaggeration:new u.b8(Ne,Ue.u_terrain_exaggeration)}))(e,Ye),this.projectionUniforms=((Ne,Ue)=>({u_projection_matrix:new u.bJ(Ne,Ue.u_projection_matrix),u_projection_tile_mercator_coords:new u.bK(Ne,Ue.u_projection_tile_mercator_coords),u_projection_clipping_plane:new u.bK(Ne,Ue.u_projection_clipping_plane),u_projection_transition:new u.b8(Ne,Ue.u_projection_transition),u_projection_fallback_matrix:new u.bJ(Ne,Ue.u_projection_fallback_matrix)}))(e,Ye),this.binderUniforms=l?l.getUniforms(e,Ye):[]}draw(e,r,l,h,m,x,M,C,I,k,j,B,$,G,re,ie,ae,ce,pe){const fe=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(h),e.setColorMode(m),e.setCullFace(x),C){e.activeTexture.set(fe.TEXTURE2),fe.bindTexture(fe.TEXTURE_2D,C.depthTexture),e.activeTexture.set(fe.TEXTURE3),fe.bindTexture(fe.TEXTURE_2D,C.texture);for(const xe in this.terrainUniforms)this.terrainUniforms[xe].set(C[xe])}if(I)for(const xe in I)this.projectionUniforms[Tu[xe]].set(I[xe]);if(M)for(const xe in this.fixedUniforms)this.fixedUniforms[xe].set(M[xe]);ie&&ie.setUniforms(e,this.binderUniforms,G,{zoom:re});let ge=0;switch(r){case fe.LINES:ge=2;break;case fe.TRIANGLES:ge=3;break;case fe.LINE_STRIP:ge=1}for(const xe of $.get()){const _e=xe.vaos||(xe.vaos={});(_e[k]||(_e[k]=new Xf)).bind(e,this,j,ie?ie.getPaintVertexBuffers():[],B,xe.vertexOffset,ae,ce,pe),fe.drawElements(r,xe.primitiveLength*ge,fe.UNSIGNED_SHORT,xe.primitiveOffset*ge*2)}}}function Mu(f,e,r){const l=1/u.az(r,1,e.transform.tileZoom),h=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,e.transform.tileZoom)/h,x=m*(r.tileID.canonical.x+r.tileID.wrap*h),M=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[x>>16,M>>16],u_pixel_coord_lower:[65535&x,65535&M]}}const Eu=(f,e,r,l)=>{const h=f.style.light,m=h.properties.get("position"),x=[m.x,m.y,m.z],M=u.bN();h.properties.get("anchor")==="viewport"&&u.bO(M,f.transform.bearingInRadians),u.bP(x,x,M);const C=f.transform.transformLightDirection(x),I=h.properties.get("color");return{u_lightpos:x,u_lightpos_globe:C,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:l}},_a=(f,e,r,l,h,m,x)=>u.e(Eu(f,e,r,l),Mu(m,f,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),Ol=(f,e,r,l)=>u.e(Mu(e,f,r),{u_fill_translate:l}),zh=(f,e)=>({u_world:f,u_fill_translate:e}),Bl=(f,e,r,l,h)=>u.e(Ol(f,e,r,h),{u_world:l}),jl=(f,e,r,l,h)=>{const m=f.transform;let x,M,C=0;if(r.paint.get("circle-pitch-alignment")==="map"){const I=u.az(e,1,m.zoom);x=!0,M=[I,I],C=I/(u.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*h}else x=!1,M=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:M,u_globe_extrude_scale:C,u_translate:l}},zd=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),Ac=f=>({u_viewport_size:[f.width,f.height]}),Ph=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),ya=(f,e,r,l)=>{const h=u.az(f,1,e)/(u.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:u.az(f,1,e),u_intensity:r,u_globe_extrude_scale:h}},Pd=(f,e,r,l)=>{const h=u.K();u.bQ(h,0,f.width,f.height,0,0,1);const m=f.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:r,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},Id=(f,e,r)=>{const l=r.paint.get("hillshade-accent-color");let h;switch(r.paint.get("hillshade-method")){case"basic":h=4;break;case"combined":h=1;break;case"igor":h=2;break;case"multidirectional":h=3;break;default:h=0}const m=r.getIlluminationProperties();for(let x=0;x<m.directionRadians.length;x++)r.paint.get("hillshade-illumination-anchor")==="viewport"&&(m.directionRadians[x]+=f.transform.bearingInRadians);return{u_image:0,u_latrange:Ih(0,e.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:m.altitudeRadians,u_azimuths:m.directionRadians,u_accent:l,u_method:h,u_highlights:m.highlightColor,u_shadows:m.shadowColor}},Qf=(f,e)=>{const r=e.stride,l=u.K();return u.bQ(l,0,u.Z,-8192,0,0,1),u.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[r,r],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function Ih(f,e){const r=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new u.$(0,l/r).toLngLat().lat,new u.$(0,(l+1)/r).toLngLat().lat]}const Fl=(f,e,r,l)=>{const h=f.transform;return{u_translation:Ts(f,e,r),u_ratio:l/u.az(e,1,h.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Ul=(f,e,r,l,h)=>u.e(Fl(f,e,r,l),{u_image:0,u_image_height:h}),Nl=(f,e,r,l,h)=>{const m=f.transform,x=Vl(e,m);return{u_translation:Ts(f,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:l/u.az(e,1,m.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[x,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Dd=(f,e,r,l,h,m)=>{const x=f.lineAtlas,M=Vl(e,f.transform),C=r.layout.get("line-cap")==="round",I=x.getDash(h.from,C),k=x.getDash(h.to,C),j=I.width*m.fromScale,B=k.width*m.toScale;return u.e(Fl(f,e,r,l),{u_patternscale_a:[M/j,-I.height/2],u_patternscale_b:[M/B,-k.height/2],u_sdfgamma:x.width/(256*Math.min(j,B)*f.pixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:k.y,u_mix:m.t})};function Vl(f,e){return 1/u.az(f,1,e.tileZoom)}function Ts(f,e,r){return u.aA(f.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const Dh=(f,e,r,l,h)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(x=l.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(m=l.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Cu(l.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var m,x};function Cu(f){f*=Math.PI/180;const e=Math.sin(f),r=Math.cos(f);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const co=(f,e,r,l,h,m,x,M,C,I,k,j,B)=>{const $=x.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:$.width/$.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:M,u_coord_matrix:C,u_is_text:+k,u_pitch_with_map:+l,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:j,u_texture:0,u_translation:I,u_pitched_scale:B}},Rh=(f,e,r,l,h,m,x,M,C,I,k,j,B,$)=>{const G=x.transform;return u.e(co(f,e,r,l,h,m,x,M,C,I,k,j,$),{u_gamma_scale:l?Math.cos(G.pitch*Math.PI/180)*G.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},zc=(f,e,r,l,h,m,x,M,C,I,k,j,B)=>u.e(Rh(f,e,r,l,h,m,x,M,C,I,!0,k,0,B),{u_texsize_icon:j,u_texture_icon:1}),Rd=(f,e)=>({u_opacity:f,u_color:e}),Kf=(f,e,r,l,h)=>u.e(function(m,x,M,C){const I=M.imageManager.getPattern(m.from.toString()),k=M.imageManager.getPattern(m.to.toString()),{width:j,height:B}=M.imageManager.getPixelSize(),$=Math.pow(2,C.tileID.overscaledZ),G=C.tileSize*Math.pow(2,M.transform.tileZoom)/$,re=G*(C.tileID.canonical.x+C.tileID.wrap*$),ie=G*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[j,B],u_mix:x.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/u.az(C,1,M.transform.tileZoom),u_pixel_coord_upper:[re>>16,ie>>16],u_pixel_coord_lower:[65535&re,65535&ie]}}(r,h,e,l),{u_opacity:f}),kh=(f,e)=>{},kd={fillExtrusion:(f,e)=>({u_lightpos:new u.bL(f,e.u_lightpos),u_lightpos_globe:new u.bL(f,e.u_lightpos_globe),u_lightintensity:new u.b8(f,e.u_lightintensity),u_lightcolor:new u.bL(f,e.u_lightcolor),u_vertical_gradient:new u.b8(f,e.u_vertical_gradient),u_opacity:new u.b8(f,e.u_opacity),u_fill_translate:new u.bM(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new u.bL(f,e.u_lightpos),u_lightpos_globe:new u.bL(f,e.u_lightpos_globe),u_lightintensity:new u.b8(f,e.u_lightintensity),u_lightcolor:new u.bL(f,e.u_lightcolor),u_vertical_gradient:new u.b8(f,e.u_vertical_gradient),u_height_factor:new u.b8(f,e.u_height_factor),u_opacity:new u.b8(f,e.u_opacity),u_fill_translate:new u.bM(f,e.u_fill_translate),u_image:new u.bH(f,e.u_image),u_texsize:new u.bM(f,e.u_texsize),u_pixel_coord_upper:new u.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bM(f,e.u_pixel_coord_lower),u_scale:new u.bL(f,e.u_scale),u_fade:new u.b8(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new u.bM(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new u.bH(f,e.u_image),u_texsize:new u.bM(f,e.u_texsize),u_pixel_coord_upper:new u.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bM(f,e.u_pixel_coord_lower),u_scale:new u.bL(f,e.u_scale),u_fade:new u.b8(f,e.u_fade),u_fill_translate:new u.bM(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new u.bM(f,e.u_world),u_fill_translate:new u.bM(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new u.bM(f,e.u_world),u_image:new u.bH(f,e.u_image),u_texsize:new u.bM(f,e.u_texsize),u_pixel_coord_upper:new u.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bM(f,e.u_pixel_coord_lower),u_scale:new u.bL(f,e.u_scale),u_fade:new u.b8(f,e.u_fade),u_fill_translate:new u.bM(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_scale_with_map:new u.bH(f,e.u_scale_with_map),u_pitch_with_map:new u.bH(f,e.u_pitch_with_map),u_extrude_scale:new u.bM(f,e.u_extrude_scale),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new u.b8(f,e.u_globe_extrude_scale),u_translate:new u.bM(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new u.bM(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new u.bM(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new u.bI(f,e.u_color),u_overlay:new u.bH(f,e.u_overlay),u_overlay_scale:new u.b8(f,e.u_overlay_scale)}),depth:kh,clippingMask:kh,heatmap:(f,e)=>({u_extrude_scale:new u.b8(f,e.u_extrude_scale),u_intensity:new u.b8(f,e.u_intensity),u_globe_extrude_scale:new u.b8(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new u.bJ(f,e.u_matrix),u_world:new u.bM(f,e.u_world),u_image:new u.bH(f,e.u_image),u_color_ramp:new u.bH(f,e.u_color_ramp),u_opacity:new u.b8(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new u.bH(f,e.u_image),u_latrange:new u.bM(f,e.u_latrange),u_exaggeration:new u.b8(f,e.u_exaggeration),u_altitudes:new u.bS(f,e.u_altitudes),u_azimuths:new u.bS(f,e.u_azimuths),u_accent:new u.bI(f,e.u_accent),u_method:new u.bH(f,e.u_method),u_shadows:new u.bR(f,e.u_shadows),u_highlights:new u.bR(f,e.u_highlights)}),hillshadePrepare:(f,e)=>({u_matrix:new u.bJ(f,e.u_matrix),u_image:new u.bH(f,e.u_image),u_dimension:new u.bM(f,e.u_dimension),u_zoom:new u.b8(f,e.u_zoom),u_unpack:new u.bK(f,e.u_unpack)}),line:(f,e)=>({u_translation:new u.bM(f,e.u_translation),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new u.bM(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new u.bM(f,e.u_translation),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new u.bM(f,e.u_units_to_pixels),u_image:new u.bH(f,e.u_image),u_image_height:new u.b8(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new u.bM(f,e.u_translation),u_texsize:new u.bM(f,e.u_texsize),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_image:new u.bH(f,e.u_image),u_units_to_pixels:new u.bM(f,e.u_units_to_pixels),u_scale:new u.bL(f,e.u_scale),u_fade:new u.b8(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new u.bM(f,e.u_translation),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new u.bM(f,e.u_units_to_pixels),u_patternscale_a:new u.bM(f,e.u_patternscale_a),u_patternscale_b:new u.bM(f,e.u_patternscale_b),u_sdfgamma:new u.b8(f,e.u_sdfgamma),u_image:new u.bH(f,e.u_image),u_tex_y_a:new u.b8(f,e.u_tex_y_a),u_tex_y_b:new u.b8(f,e.u_tex_y_b),u_mix:new u.b8(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new u.bM(f,e.u_tl_parent),u_scale_parent:new u.b8(f,e.u_scale_parent),u_buffer_scale:new u.b8(f,e.u_buffer_scale),u_fade_t:new u.b8(f,e.u_fade_t),u_opacity:new u.b8(f,e.u_opacity),u_image0:new u.bH(f,e.u_image0),u_image1:new u.bH(f,e.u_image1),u_brightness_low:new u.b8(f,e.u_brightness_low),u_brightness_high:new u.b8(f,e.u_brightness_high),u_saturation_factor:new u.b8(f,e.u_saturation_factor),u_contrast_factor:new u.b8(f,e.u_contrast_factor),u_spin_weights:new u.bL(f,e.u_spin_weights),u_coords_top:new u.bK(f,e.u_coords_top),u_coords_bottom:new u.bK(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new u.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bH(f,e.u_is_size_feature_constant),u_size_t:new u.b8(f,e.u_size_t),u_size:new u.b8(f,e.u_size),u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_pitch:new u.b8(f,e.u_pitch),u_rotate_symbol:new u.bH(f,e.u_rotate_symbol),u_aspect_ratio:new u.b8(f,e.u_aspect_ratio),u_fade_change:new u.b8(f,e.u_fade_change),u_label_plane_matrix:new u.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new u.bJ(f,e.u_coord_matrix),u_is_text:new u.bH(f,e.u_is_text),u_pitch_with_map:new u.bH(f,e.u_pitch_with_map),u_is_along_line:new u.bH(f,e.u_is_along_line),u_is_variable_anchor:new u.bH(f,e.u_is_variable_anchor),u_texsize:new u.bM(f,e.u_texsize),u_texture:new u.bH(f,e.u_texture),u_translation:new u.bM(f,e.u_translation),u_pitched_scale:new u.b8(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new u.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bH(f,e.u_is_size_feature_constant),u_size_t:new u.b8(f,e.u_size_t),u_size:new u.b8(f,e.u_size),u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_pitch:new u.b8(f,e.u_pitch),u_rotate_symbol:new u.bH(f,e.u_rotate_symbol),u_aspect_ratio:new u.b8(f,e.u_aspect_ratio),u_fade_change:new u.b8(f,e.u_fade_change),u_label_plane_matrix:new u.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new u.bJ(f,e.u_coord_matrix),u_is_text:new u.bH(f,e.u_is_text),u_pitch_with_map:new u.bH(f,e.u_pitch_with_map),u_is_along_line:new u.bH(f,e.u_is_along_line),u_is_variable_anchor:new u.bH(f,e.u_is_variable_anchor),u_texsize:new u.bM(f,e.u_texsize),u_texture:new u.bH(f,e.u_texture),u_gamma_scale:new u.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_is_halo:new u.bH(f,e.u_is_halo),u_translation:new u.bM(f,e.u_translation),u_pitched_scale:new u.b8(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new u.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bH(f,e.u_is_size_feature_constant),u_size_t:new u.b8(f,e.u_size_t),u_size:new u.b8(f,e.u_size),u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_pitch:new u.b8(f,e.u_pitch),u_rotate_symbol:new u.bH(f,e.u_rotate_symbol),u_aspect_ratio:new u.b8(f,e.u_aspect_ratio),u_fade_change:new u.b8(f,e.u_fade_change),u_label_plane_matrix:new u.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new u.bJ(f,e.u_coord_matrix),u_is_text:new u.bH(f,e.u_is_text),u_pitch_with_map:new u.bH(f,e.u_pitch_with_map),u_is_along_line:new u.bH(f,e.u_is_along_line),u_is_variable_anchor:new u.bH(f,e.u_is_variable_anchor),u_texsize:new u.bM(f,e.u_texsize),u_texsize_icon:new u.bM(f,e.u_texsize_icon),u_texture:new u.bH(f,e.u_texture),u_texture_icon:new u.bH(f,e.u_texture_icon),u_gamma_scale:new u.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_is_halo:new u.bH(f,e.u_is_halo),u_translation:new u.bM(f,e.u_translation),u_pitched_scale:new u.b8(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new u.b8(f,e.u_opacity),u_color:new u.bI(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new u.b8(f,e.u_opacity),u_image:new u.bH(f,e.u_image),u_pattern_tl_a:new u.bM(f,e.u_pattern_tl_a),u_pattern_br_a:new u.bM(f,e.u_pattern_br_a),u_pattern_tl_b:new u.bM(f,e.u_pattern_tl_b),u_pattern_br_b:new u.bM(f,e.u_pattern_br_b),u_texsize:new u.bM(f,e.u_texsize),u_mix:new u.b8(f,e.u_mix),u_pattern_size_a:new u.bM(f,e.u_pattern_size_a),u_pattern_size_b:new u.bM(f,e.u_pattern_size_b),u_scale_a:new u.b8(f,e.u_scale_a),u_scale_b:new u.b8(f,e.u_scale_b),u_pixel_coord_upper:new u.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bM(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new u.b8(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new u.bH(f,e.u_texture),u_ele_delta:new u.b8(f,e.u_ele_delta),u_fog_matrix:new u.bJ(f,e.u_fog_matrix),u_fog_color:new u.bI(f,e.u_fog_color),u_fog_ground_blend:new u.b8(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.b8(f,e.u_fog_ground_blend_opacity),u_horizon_color:new u.bI(f,e.u_horizon_color),u_horizon_fog_blend:new u.b8(f,e.u_horizon_fog_blend),u_is_globe_mode:new u.b8(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new u.b8(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new u.bH(f,e.u_texture),u_terrain_coords_id:new u.b8(f,e.u_terrain_coords_id),u_ele_delta:new u.b8(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new u.b8(f,e.u_input),u_output_expected:new u.b8(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new u.bL(f,e.u_sun_pos),u_atmosphere_blend:new u.b8(f,e.u_atmosphere_blend),u_globe_position:new u.bL(f,e.u_globe_position),u_globe_radius:new u.b8(f,e.u_globe_radius),u_inv_proj_matrix:new u.bJ(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new u.bI(f,e.u_sky_color),u_horizon_color:new u.bI(f,e.u_horizon_color),u_horizon:new u.bM(f,e.u_horizon),u_horizon_normal:new u.bM(f,e.u_horizon_normal),u_sky_horizon_blend:new u.b8(f,e.u_sky_horizon_blend),u_sky_blend:new u.b8(f,e.u_sky_blend)})};class Ld{constructor(e,r,l){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Lh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zn{constructor(e,r,l,h){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=h,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let l=0;l<this.attributes.length;l++){const h=r.attributes[this.attributes[l].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,r,l){for(let h=0;h<this.attributes.length;h++){const m=this.attributes[h],x=r.attributes[m.name];x!==void 0&&e.vertexAttribPointer(x,m.components,e[Lh[m.type]],!1,this.itemSize,m.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class si{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ya extends si{getDefault(){return u.b7.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Au extends si{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class zu extends si{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Pu extends si{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Iu extends si{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Oh extends si{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class va extends si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Pc extends si{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ic extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class Bh extends si{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Od extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class Xo extends si{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Yo extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class jh extends si{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Fh extends si{getDefault(){return u.b7.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Qa extends si{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Dc extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class Rc extends si{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Du extends si{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Qo extends si{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Ru extends si{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Zl extends si{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ta extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Uh extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ku extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ia extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class uo extends si{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class In extends si{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const l=this.gl;Mr(l)?l.bindVertexArray(e):(r=l.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Dn extends si{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Ka extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ql extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Ko extends si{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class Ss extends Ko{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class ho extends Ko{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Wo extends Ko{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const kc="Framebuffer is not complete";class ri{constructor(e,r,l,h,m){this.context=e,this.width=r,this.height=l;const x=e.gl,M=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Ss(e,M),h)this.depthAttachment=m?new Wo(e,M):new ho(e,M);else if(m)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(kc)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Ms{constructor(e){var r,l;if(this.gl=e,this.clearColor=new Ya(this),this.clearDepth=new Au(this),this.clearStencil=new zu(this),this.colorMask=new Pu(this),this.depthMask=new Iu(this),this.stencilMask=new Oh(this),this.stencilFunc=new va(this),this.stencilOp=new Pc(this),this.stencilTest=new Ic(this),this.depthRange=new Bh(this),this.depthTest=new Od(this),this.depthFunc=new Xo(this),this.blend=new Yo(this),this.blendFunc=new jh(this),this.blendColor=new Fh(this),this.blendEquation=new Qa(this),this.cullFace=new Dc(this),this.cullFaceSide=new Rc(this),this.frontFace=new Du(this),this.program=new Qo(this),this.activeTexture=new Ru(this),this.viewport=new Zl(this),this.bindFramebuffer=new ta(this),this.bindRenderbuffer=new Uh(this),this.bindTexture=new ku(this),this.bindVertexBuffer=new ia(this),this.bindElementBuffer=new uo(this),this.bindVertexArray=new In(this),this.pixelStoreUnpack=new Dn(this),this.pixelStoreUnpackPremultiplyAlpha=new Ka(this),this.pixelStoreUnpackFlipY=new ql(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Mr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new Ld(this,e,r)}createVertexBuffer(e,r,l){return new Zn(this,e,r,l)}createRenderbuffer(e,r,l){const h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,e,r,l),this.bindRenderbuffer.set(null),m}createFramebuffer(e,r,l,h){return new ri(this,e,r,l,h)}clear({color:e,depth:r,stencil:l}){const h=this.gl;let m=0;e&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),h.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){u.bE(e.blendFunction,Ai.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Mr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return Mr(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Lu;function Rn(f,e,r,l,h){const m=f.context,x=f.transform,M=m.gl,C=f.useProgram("collisionBox"),I=[];let k=0,j=0;for(let ae=0;ae<l.length;ae++){const ce=l[ae],pe=e.getTile(ce).getBucket(r);if(!pe)continue;const fe=h?pe.textCollisionBox:pe.iconCollisionBox,ge=pe.collisionCircleArray;ge.length>0&&(I.push({circleArray:ge,circleOffset:j,coord:ce}),k+=ge.length/4,j=k),fe&&C.draw(m,M.LINES,Ht.disabled,Jt.disabled,f.colorModeForRenderPass(),ai.disabled,zd(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(ce),x.getProjectionData({overscaledTileID:ce,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,null,f.transform.zoom,null,null,fe.collisionVertexBuffer)}if(!h||!I.length)return;const B=f.useProgram("collisionCircle"),$=new u.bT;$.resize(4*k),$._trim();let G=0;for(const ae of I)for(let ce=0;ce<ae.circleArray.length/4;ce++){const pe=4*ce,fe=ae.circleArray[pe+0],ge=ae.circleArray[pe+1],xe=ae.circleArray[pe+2],_e=ae.circleArray[pe+3];$.emplace(G++,fe,ge,xe,_e,0),$.emplace(G++,fe,ge,xe,_e,1),$.emplace(G++,fe,ge,xe,_e,2),$.emplace(G++,fe,ge,xe,_e,3)}(!Lu||Lu.length<2*k)&&(Lu=function(ae){const ce=2*ae,pe=new u.bV;pe.resize(ce),pe._trim();for(let fe=0;fe<ce;fe++){const ge=6*fe;pe.uint16[ge+0]=4*fe+0,pe.uint16[ge+1]=4*fe+1,pe.uint16[ge+2]=4*fe+2,pe.uint16[ge+3]=4*fe+2,pe.uint16[ge+4]=4*fe+3,pe.uint16[ge+5]=4*fe+0}return pe}(k));const re=m.createIndexBuffer(Lu,!0),ie=m.createVertexBuffer($,u.bU.members,!0);for(const ae of I){const ce=Ac(f.transform);B.draw(m,M.TRIANGLES,Ht.disabled,Jt.disabled,f.colorModeForRenderPass(),ai.disabled,ce,f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae.coord),null,r.id,ie,re,u.aJ.simpleSegment(0,2*ae.circleOffset,ae.circleArray.length,ae.circleArray.length/2),null,f.transform.zoom,null,null,null)}ie.destroy(),re.destroy()}const Jo=u.ad(new Float32Array(16));function Es(f,e,r,l,h,m){const{horizontalAlign:x,verticalAlign:M}=u.aE(f);return new u.P((-(x-.5)*e/h+l[0])*m,(-(M-.5)*r/h+l[1])*m)}function Bd(f,e,r,l,h,m){const x=e.tileAnchorPoint.add(new u.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let M=l.mult(m);r||(M=M.rotate(-h));const C=x.add(M);return qe(C.x,C.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const M=qi(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),C=Math.atan(M.y/M.x)+(M.x<0?Math.PI:0);return f.add(l.rotate(C))}return f.add(l)}function Lc(f,e,r,l,h,m,x,M,C,I,k,j){const B=f.text.placedSymbolArray,$=f.text.dynamicLayoutVertexArray,G=f.icon.dynamicLayoutVertexArray,re={};$.clear();for(let ie=0;ie<B.length;ie++){const ae=B.get(ie),ce=ae.hidden||!ae.crossTileID||f.allowVerticalPlacement&&!ae.placedOrientation?null:l[ae.crossTileID];if(ce){const pe=new u.P(ae.anchorX,ae.anchorY),fe={getElevation:j,width:h.width,height:h.height,pitchedLabelPlaneMatrix:m,pitchWithMap:r,transform:h,tileAnchorPoint:pe,translation:I,unwrappedTileID:k},ge=r?Lt(pe.x,pe.y,fe):qi(pe.x,pe.y,fe),xe=yi(h.cameraToCenterDistance,ge.signedDistanceFromCamera);let _e=u.am(f.textSizeData,M,ae)*xe/u.ay;r&&(_e*=f.tilePixelRatio/x);const{width:ke,height:Ye,anchor:Ne,textOffset:Ue,textBoxScale:$e}=ce,dt=Es(Ne,ke,Ye,Ue,$e,_e),ht=h.getPitchedTextCorrection(pe.x+I[0],pe.y+I[1],k),it=Bd(ge.point,fe,e,dt,-h.bearingInRadians,ht),St=f.allowVerticalPlacement&&ae.placedOrientation===u.al.vertical?Math.PI/2:0;for(let ei=0;ei<ae.numGlyphs;ei++)u.as($,it,St);C&&ae.associatedIconIndex>=0&&(re[ae.associatedIconIndex]={shiftedAnchor:it,angle:St})}else xs(ae.numGlyphs,$)}if(C){G.clear();const ie=f.icon.placedSymbolArray;for(let ae=0;ae<ie.length;ae++){const ce=ie.get(ae);if(ce.hidden)xs(ce.numGlyphs,G);else{const pe=re[ae];if(pe)for(let fe=0;fe<ce.numGlyphs;fe++)u.as(G,pe.shiftedAnchor,pe.angle);else xs(ce.numGlyphs,G)}}f.icon.dynamicLayoutVertexBuffer.updateData(G)}f.text.dynamicLayoutVertexBuffer.updateData($)}function el(f,e,r){return r.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function $l(f,e,r,l,h,m,x,M,C,I,k,j,B){const $=f.context,G=$.gl,re=f.transform,ie=M==="map",ae=C==="map",ce=M!=="viewport"&&r.layout.get("symbol-placement")!=="point",pe=ie&&!ae&&!ce,fe=!r.layout.get("symbol-sort-key").isConstant();let ge=!1;const xe=f.getDepthModeForSublayer(0,Ht.ReadOnly),_e=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ke=[],Ye=re.getCircleRadiusCorrection();for(const Ne of l){const Ue=e.getTile(Ne),$e=Ue.getBucket(r);if(!$e)continue;const dt=h?$e.text:$e.icon;if(!dt||!dt.segments.get().length||!dt.hasVisibleVertices)continue;const ht=dt.programConfigurations.get(r.id),it=h||$e.sdfIcons,St=h?$e.textSizeData:$e.iconSizeData,ei=ae||re.pitch!==0,oi=f.useProgram(el(it,h,$e),ht),ar=u.ak(St,re.zoom),ki=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Ne);let sr,Ki,Ni,xi,Lr=[0,0],Xr=null;if(h)Ki=Ue.glyphAtlasTexture,Ni=G.LINEAR,sr=Ue.glyphAtlasTexture.size,$e.iconsInText&&(Lr=Ue.imageAtlasTexture.size,Xr=Ue.imageAtlasTexture,xi=ei||f.options.rotating||f.options.zooming||St.kind==="composite"||St.kind==="camera"?G.LINEAR:G.NEAREST);else{const _r=r.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;Ki=Ue.imageAtlasTexture,Ni=it||f.options.rotating||f.options.zooming||_r||ei?G.LINEAR:G.NEAREST,sr=Ue.imageAtlasTexture.size}const nn=u.az(Ue,1,f.transform.zoom),Ti=At(ie,f.transform,nn),ls=u.K();u.an(ls,Ti);const Ba=kt(ae,ie,f.transform,nn),Os=u.aA(re,Ue,m,x),Bs=re.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),ec=_e&&$e.hasTextData(),js=r.layout.get("icon-text-fit")!=="none"&&ec&&$e.hasIconData();if(ce){const _r=f.style.map.terrain?(wn,Li)=>f.style.map.terrain.getElevation(Ne,wn,Li):null,Or=r.layout.get("text-rotation-alignment")==="map";vi($e,f,h,Ti,ls,ae,I,Or,Ne.toUnwrapped(),re.width,re.height,Os,_r)}const cl=h&&_e||js,aa=ce||cl?Jo:ae?Ti:f.transform.clipSpaceToPixelsMatrix,Fs=it&&r.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let sa;sa=it?$e.iconsInText?zc(St.kind,ar,pe,ae,ce,cl,f,aa,Ba,Os,sr,Lr,Ye):Rh(St.kind,ar,pe,ae,ce,cl,f,aa,Ba,Os,h,sr,0,Ye):co(St.kind,ar,pe,ae,ce,cl,f,aa,Ba,Os,h,sr,Ye);const cs={program:oi,buffers:dt,uniformValues:sa,projectionData:Bs,atlasTexture:Ki,atlasTextureIcon:Xr,atlasInterpolation:Ni,atlasInterpolationIcon:xi,isSDF:it,hasHalo:Fs};if(fe&&$e.canOverlap){ge=!0;const _r=dt.segments.get();for(const Or of _r)ke.push({segments:new u.aJ([Or]),sortKey:Or.sortKey,state:cs,terrainData:ki})}else ke.push({segments:dt.segments,sortKey:0,state:cs,terrainData:ki})}ge&&ke.sort((Ne,Ue)=>Ne.sortKey-Ue.sortKey);for(const Ne of ke){const Ue=Ne.state;if($.activeTexture.set(G.TEXTURE0),Ue.atlasTexture.bind(Ue.atlasInterpolation,G.CLAMP_TO_EDGE),Ue.atlasTextureIcon&&($.activeTexture.set(G.TEXTURE1),Ue.atlasTextureIcon&&Ue.atlasTextureIcon.bind(Ue.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),Ue.isSDF){const $e=Ue.uniformValues;Ue.hasHalo&&($e.u_is_halo=1,tl(Ue.buffers,Ne.segments,r,f,Ue.program,xe,k,j,$e,Ue.projectionData,Ne.terrainData)),$e.u_is_halo=0}tl(Ue.buffers,Ne.segments,r,f,Ue.program,xe,k,j,Ue.uniformValues,Ue.projectionData,Ne.terrainData)}}function tl(f,e,r,l,h,m,x,M,C,I,k){const j=l.context;h.draw(j,j.gl.TRIANGLES,m,x,M,ai.backCCW,C,k,I,r.id,f.layoutVertexBuffer,f.indexBuffer,e,r.paint,l.transform.zoom,f.programConfigurations.get(r.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Cs(f,e,r,l,h){const m=f.context,x=m.gl,M=Jt.disabled,C=new Ai([x.ONE,x.ONE],u.b7.transparent,[!0,!0,!0,!0]),I=e.getBucket(r);if(!I)return;const k=l.key;let j=r.heatmapFbos.get(k);j||(j=il(m,e.tileSize,e.tileSize),r.heatmapFbos.set(k,j)),m.bindFramebuffer.set(j.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:u.b7.transparent});const B=I.programConfigurations.get(r.id),$=f.useProgram("heatmap",B,!h),G=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),re=f.style.map.terrain.getTerrainData(l);$.draw(m,x.TRIANGLES,Ht.disabled,M,C,ai.disabled,ya(e,f.transform.zoom,r.paint.get("heatmap-intensity"),1),re,G,r.id,I.layoutVertexBuffer,I.indexBuffer,I.segments,r.paint,f.transform.zoom,B)}function fo(f,e,r,l,h){const m=f.context,x=m.gl,M=f.transform;m.setColorMode(f.colorModeForRenderPass());const C=Gl(m,e),I=r.key,k=e.heatmapFbos.get(I);if(!k)return;m.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,k.colorAttachment.get()),m.activeTexture.set(x.TEXTURE1),C.bind(x.LINEAR,x.CLAMP_TO_EDGE);const j=M.getProjectionData({overscaledTileID:r,applyTerrainMatrix:h,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(m,x.TRIANGLES,Ht.disabled,Jt.disabled,f.colorModeForRenderPass(),ai.disabled,Pd(f,e,0,1),null,j,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,M.zoom),k.destroy(),e.heatmapFbos.delete(I)}function il(f,e,r){var l,h;const m=f.gl,x=m.createTexture();m.bindTexture(m.TEXTURE_2D,x),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const M=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:m.UNSIGNED_BYTE,C=(h=f.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,C,e,r,0,m.RGBA,M,null);const I=f.createFramebuffer(e,r,!1,!1);return I.colorAttachment.set(x),I}function Gl(f,e){return e.colorRampTexture||(e.colorRampTexture=new ti(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function _n(f,e,r,l,h){if(!r||!l||!l.imageAtlas)return;const m=l.imageAtlas.patternPositions;let x=m[r.to.toString()],M=m[r.from.toString()];if(!x&&M&&(x=M),!M&&x&&(M=x),!x||!M){const C=h.getPaintProperty(e);x=m[C],M=m[C]}x&&M&&f.setConstantPatternPositions(x,M)}function yn(f,e,r,l,h,m,x,M){const C=f.context.gl,I="fill-pattern",k=r.paint.get(I),j=k&&k.constantOr(1),B=r.getCrossfadeParameters();let $,G,re,ie,ae;const ce=f.transform,pe=r.paint.get("fill-translate"),fe=r.paint.get("fill-translate-anchor");x?(G=j&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=C.LINES):(G=j?"fillPattern":"fill",$=C.TRIANGLES);const ge=k.constantOr(null);for(const xe of l){const _e=e.getTile(xe);if(j&&!_e.patternsLoaded())continue;const ke=_e.getBucket(r);if(!ke)continue;const Ye=ke.programConfigurations.get(r.id),Ne=f.useProgram(G,Ye),Ue=f.style.map.terrain&&f.style.map.terrain.getTerrainData(xe);j&&(f.context.activeTexture.set(C.TEXTURE0),_e.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Ye.updatePaintBuffers(B)),_n(Ye,I,ge,_e,r);const $e=ce.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),dt=u.aA(ce,_e,pe,fe);if(x){ie=ke.indexBuffer2,ae=ke.segments2;const it=[C.drawingBufferWidth,C.drawingBufferHeight];re=G==="fillOutlinePattern"&&j?Bl(f,B,_e,it,dt):zh(it,dt)}else ie=ke.indexBuffer,ae=ke.segments,re=j?Ol(f,B,_e,dt):{u_fill_translate:dt};const ht=f.stencilModeForClipping(xe);Ne.draw(f.context,$,h,ht,m,ai.backCCW,re,Ue,$e,r.id,ke.layoutVertexBuffer,ie,ae,r.paint,f.transform.zoom,Ye)}}function za(f,e,r,l,h,m,x,M){const C=f.context,I=C.gl,k="fill-extrusion-pattern",j=r.paint.get(k),B=j.constantOr(1),$=r.getCrossfadeParameters(),G=r.paint.get("fill-extrusion-opacity"),re=j.constantOr(null),ie=f.transform;for(const ae of l){const ce=e.getTile(ae),pe=ce.getBucket(r);if(!pe)continue;const fe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae),ge=pe.programConfigurations.get(r.id),xe=f.useProgram(B?"fillExtrusionPattern":"fillExtrusion",ge);B&&(f.context.activeTexture.set(I.TEXTURE0),ce.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ge.updatePaintBuffers($));const _e=ie.getProjectionData({overscaledTileID:ae,applyGlobeMatrix:!M,applyTerrainMatrix:!0});_n(ge,k,re,ce,r);const ke=u.aA(ie,ce,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Ye=r.paint.get("fill-extrusion-vertical-gradient"),Ne=B?_a(f,Ye,G,ke,ae,$,ce):Eu(f,Ye,G,ke);xe.draw(C,C.gl.TRIANGLES,h,m,x,ai.backCCW,Ne,fe,_e,r.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,r.paint,f.transform.zoom,ge,f.style.map.terrain&&pe.centroidVertexBuffer)}}function Pa(f,e,r,l,h,m,x,M,C){var I;const k=f.style.projection,j=f.context,B=f.transform,$=j.gl,G=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],re=f.useProgram("hillshade",null,!1,G),ie=!f.options.moving;for(const ae of l){const ce=e.getTile(ae),pe=ce.fbo;if(!pe)continue;const fe=k.getMeshFromTileID(j,ae.canonical,M,!0,"raster"),ge=(I=f.style.map.terrain)===null||I===void 0?void 0:I.getTerrainData(ae);j.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,pe.colorAttachment.get());const xe=B.getProjectionData({overscaledTileID:ae,aligned:ie,applyGlobeMatrix:!C,applyTerrainMatrix:!0});re.draw(j,$.TRIANGLES,m,h[ae.overscaledZ],x,ai.backCCW,Id(f,ce,r),ge,xe,r.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const ra=[new u.P(0,0),new u.P(u.Z,0),new u.P(u.Z,u.Z),new u.P(0,u.Z)];function Wa(f,e,r,l,h,m,x,M,C=!1,I=!1){const k=l[l.length-1].overscaledZ,j=f.context,B=j.gl,$=f.useProgram("raster"),G=f.transform,re=f.style.projection,ie=f.colorModeForRenderPass(),ae=!f.options.moving;for(const ce of l){const pe=f.getDepthModeForSublayer(ce.overscaledZ-k,r.paint.get("raster-opacity")===1?Ht.ReadWrite:Ht.ReadOnly,B.LESS),fe=e.getTile(ce);fe.registerFadeDuration(r.paint.get("raster-fade-duration"));const ge=e.findLoadedParent(ce,0),xe=e.findLoadedSibling(ce),_e=Nh(fe,ge||xe||null,e,r,f.transform,f.style.map.terrain);let ke,Ye;const Ne=r.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;j.activeTexture.set(B.TEXTURE0),fe.texture.bind(Ne,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),j.activeTexture.set(B.TEXTURE1),ge?(ge.texture.bind(Ne,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),ke=Math.pow(2,ge.tileID.overscaledZ-fe.tileID.overscaledZ),Ye=[fe.tileID.canonical.x*ke%1,fe.tileID.canonical.y*ke%1]):fe.texture.bind(Ne,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),fe.texture.useMipmap&&j.extTextureFilterAnisotropic&&f.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const Ue=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ce),$e=G.getProjectionData({overscaledTileID:ce,aligned:ae,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),dt=Dh(Ye||[0,0],ke||1,_e,r,M),ht=re.getMeshFromTileID(j,ce.canonical,m,x,"raster");$.draw(j,B.TRIANGLES,pe,h?h[ce.overscaledZ]:Jt.disabled,ie,C?ai.frontCCW:ai.backCCW,dt,Ue,$e,r.id,ht.vertexBuffer,ht.indexBuffer,ht.segments)}}function Nh(f,e,r,l,h,m){const x=l.paint.get("raster-fade-duration");if(!m&&x>0){const M=Ee.now(),C=(M-f.timeAdded)/x,I=e?(M-e.timeAdded)/x:-1,k=r.getSource(),j=Re(h,{tileSize:k.tileSize,roundZoom:k.roundZoom}),B=!e||Math.abs(e.tileID.overscaledZ-j)>Math.abs(f.tileID.overscaledZ-j),$=B&&f.refreshedUponExpiration?1:u.ae(B?C:1-I,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const Hl=new u.b7(1,0,0,1),Oc=new u.b7(0,1,0,1),vn=new u.b7(0,0,1,1),gr=new u.b7(1,0,1,1),bi=new u.b7(0,1,1,1);function Ja(f,e,r,l){rl(f,0,e+r/2,f.transform.width,r,l)}function Ia(f,e,r,l){rl(f,e-r/2,0,r,f.transform.height,l)}function rl(f,e,r,l,h,m){const x=f.context,M=x.gl;M.enable(M.SCISSOR_TEST),M.scissor(e*f.pixelRatio,r*f.pixelRatio,l*f.pixelRatio,h*f.pixelRatio),x.clear({color:m}),M.disable(M.SCISSOR_TEST)}function Ui(f,e,r){const l=f.context,h=l.gl,m=f.useProgram("debug"),x=Ht.disabled,M=Jt.disabled,C=f.colorModeForRenderPass(),I="$debug",k=f.style.map.terrain&&f.style.map.terrain.getTerrainData(r);l.activeTexture.set(h.TEXTURE0);const j=e.getTileByID(r.key).latestRawTileData,B=Math.floor((j&&j.byteLength||0)/1024),$=e.getTile(r).tileSize,G=512/Math.min($,512)*(r.overscaledZ/f.transform.zoom)*.5;let re=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(re+=` => ${r.overscaledZ}`),function(ae,ce){ae.initDebugOverlayCanvas();const pe=ae.debugOverlayCanvas,fe=ae.context.gl,ge=ae.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,pe.width,pe.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(ce,5,5),ge.strokeText(ce,5,5),ae.debugOverlayTexture.update(pe),ae.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(f,`${re} ${B}kB`);const ie=f.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(l,h.TRIANGLES,x,M,Ai.alphaBlended,ai.disabled,Ph(u.b7.transparent,G),null,ie,I,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),m.draw(l,h.LINE_STRIP,x,M,C,ai.disabled,Ph(u.b7.red),k,ie,I,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function As(f,e,r,l){const{isRenderingGlobe:h}=l,m=f.context,x=m.gl,M=f.transform,C=f.colorModeForRenderPass(),I=f.getDepthModeFor3D(),k=f.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,f.width,f.height]);for(const j of r){const B=e.getTerrainMesh(j.tileID),$=f.renderToTexture.getTexture(j),G=e.getTerrainData(j.tileID);m.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,$.texture);const re=e.getMeshFrameDelta(M.zoom),ie=M.calculateFogMatrix(j.tileID.toUnwrapped()),ae=Yf(re,ie,f.style.sky,M.pitch,h),ce=M.getProjectionData({overscaledTileID:j.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(m,x.TRIANGLES,I,Jt.disabled,C,ai.backCCW,ae,G,ce,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}}function qn(f,e){if(!e.mesh){const r=new u.aI;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const l=new u.aK;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new Lo(f.createVertexBuffer(r,un.members),f.createIndexBuffer(l),u.aJ.simpleSegment(0,0,r.length,l.length))}return e.mesh}class nl{constructor(e,r){this.context=new Ms(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=De.maxUnderzooming+De.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Dl}resize(e,r,l){if(this.width=Math.floor(e*l),this.height=Math.floor(r*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,r=new u.aI;r.emplaceBack(0,0),r.emplaceBack(u.Z,0),r.emplaceBack(0,u.Z),r.emplaceBack(u.Z,u.Z),this.tileExtentBuffer=e.createVertexBuffer(r,un.members),this.tileExtentSegments=u.aJ.simpleSegment(0,0,4,2);const l=new u.aI;l.emplaceBack(0,0),l.emplaceBack(u.Z,0),l.emplaceBack(0,u.Z),l.emplaceBack(u.Z,u.Z),this.debugBuffer=e.createVertexBuffer(l,un.members),this.debugSegments=u.aJ.simpleSegment(0,0,4,5);const h=new u.b_;h.emplaceBack(0,0,0,0),h.emplaceBack(u.Z,0,u.Z,0),h.emplaceBack(0,u.Z,0,u.Z),h.emplaceBack(u.Z,u.Z,u.Z,u.Z),this.rasterBoundsBuffer=e.createVertexBuffer(h,Hf.members),this.rasterBoundsSegments=u.aJ.simpleSegment(0,0,4,2);const m=new u.aI;m.emplaceBack(0,0),m.emplaceBack(u.Z,0),m.emplaceBack(0,u.Z),m.emplaceBack(u.Z,u.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,un.members),this.rasterBoundsSegmentsPosOnly=u.aJ.simpleSegment(0,0,4,5);const x=new u.aI;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(x,un.members),this.viewportSegments=u.aJ.simpleSegment(0,0,4,2);const M=new u.b$;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(M);const C=new u.aK;C.emplaceBack(1,0,2),C.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(C);const I=this.context.gl;this.stencilClearMode=new Jt({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.tileExtentMesh=new Lo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=u.K();u.bQ(l,0,this.width,this.height,0,0,1),u.M(l,l,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const h={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Ht.disabled,this.stencilClearMode,Ai.disabled,ai.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const h=this.context;h.setColorMode(Ai.disabled),h.setDepthMode(Ht.disabled);const m={};for(const x of r)m[x.key]=this.nextStencilID++;this._renderTileMasks(m,r,l,!0),this._renderTileMasks(m,r,l,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,r,l,h){const m=this.context,x=m.gl,M=this.style.projection,C=this.transform,I=this.useProgram("clippingMask");for(const k of r){const j=e[k.key],B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),$=M.getMeshFromTileID(this.context,k.canonical,h,!0,"stencil"),G=C.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!l,applyTerrainMatrix:!0});I.draw(m,x.TRIANGLES,Ht.disabled,new Jt({func:x.ALWAYS,mask:0},j,255,x.KEEP,x.KEEP,x.REPLACE),Ai.disabled,l?ai.disabled:ai.backCCW,null,B,G,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,l=this.style.projection,h=this.transform,m=this.useProgram("depth"),x=this.getDepthModeFor3D(),M=Se(h,{tileSize:h.tileSize});for(const C of M){const I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C),k=l.getMeshFromTileID(this.context,C.canonical,!0,!0,"raster"),j=h.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,r.TRIANGLES,x,Jt.disabled,Ai.disabled,ai.backCCW,null,I,j,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new Jt({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new Jt({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,l=e.sort((x,M)=>M.overscaledZ-x.overscaledZ),h=l[l.length-1].overscaledZ,m=l[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const x={};for(let M=0;M<m;M++)x[M+h]=new Jt({func:r.GEQUAL,mask:255},M+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=m,[x,l]}return[{[h]:Jt.disabled},l]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,l=e.sort((x,M)=>M.overscaledZ-x.overscaledZ),h=l[l.length-1].overscaledZ,m=l[0].overscaledZ-h+1;if(this.clearStencil(),m>1){const x={},M={};for(let C=0;C<m;C++)x[C+h]=new Jt({func:r.GREATER,mask:255},m+1+C,255,r.KEEP,r.KEEP,r.REPLACE),M[C+h]=new Jt({func:r.GREATER,mask:255},1+C,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*m+1,[x,M,l]}return this.nextStencilID=3,[{[h]:new Jt({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[h]:new Jt({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Ai([e.CONSTANT_COLOR,e.ONE],new u.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ai.unblended:Ai.alphaBlended}getDepthModeForSublayer(e,r,l){if(!this.opaquePassEnabledForLayer())return Ht.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ht(l||this.context.gl.LEQUAL,r,[h,h])}getDepthModeFor3D(){return new Ht(this.context.gl.LEQUAL,Ht.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var l,h;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Ee.now()),this.imageManager.beginFrame();const m=this.style._order,x=this.style.sourceCaches,M={},C={},I={},k={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const B in x){const $=x[B];$.used&&$.prepare(this.context),M[B]=$.getVisibleCoordinates(!1),C[B]=M[B].slice().reverse(),I[B]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<m.length;B++)if(this.style._layers[m[B]].is3D()){this.opaquePassCutoff=B;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const B of m){const $=this.style._layers[B];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const G=C[$.source];($.type==="custom"||G.length)&&this.renderLayer(this,x[$.source],$,G,k)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:B=>this.useProgram(B)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?u.b7.black:u.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(B,$){const G=B.context,re=G.gl,ie=((xe,_e,ke)=>{const Ye=Math.cos(_e.rollInRadians),Ne=Math.sin(_e.rollInRadians),Ue=Ce(_e),$e=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:xe.properties.get("sky-color"),u_horizon_color:xe.properties.get("horizon-color"),u_horizon:[(_e.width/2-Ue*Ne)*ke,(_e.height/2+Ue*Ye)*ke],u_horizon_normal:[-Ne,Ye],u_sky_horizon_blend:xe.properties.get("sky-horizon-blend")*_e.height/2*ke,u_sky_blend:$e}})($,B.style.map.transform,B.pixelRatio),ae=new Ht(re.LEQUAL,Ht.ReadWrite,[0,1]),ce=Jt.disabled,pe=B.colorModeForRenderPass(),fe=B.useProgram("sky"),ge=qn(G,$);fe.draw(G,re.TRIANGLES,ae,ce,pe,ai.disabled,ie,null,void 0,"sky",ge.vertexBuffer,ge.indexBuffer,ge.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[m[this.currentLayer]],$=x[B.source],G=M[B.source];this._renderTileClippingMasks(B,G,!1),this.renderLayer(this,$,B,G,k)}this.renderPass="translucent";let j=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const B=this.style._layers[m[this.currentLayer]],$=x[B.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(B,k))continue;this.opaquePassEnabledForLayer()||j||(j=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const G=(B.type==="symbol"?I:C)[B.source];this._renderTileClippingMasks(B,M[B.source],!!this.renderToTexture),this.renderLayer(this,$,B,G,k)}if(k.isRenderingGlobe&&function(B,$,G){const re=B.context,ie=re.gl,ae=B.useProgram("atmosphere"),ce=new Ht(ie.LEQUAL,Ht.ReadOnly,[0,1]),pe=B.transform,fe=function($e,dt){const ht=$e.properties.get("position"),it=[-ht.x,-ht.y,-ht.z],St=u.ad(new Float64Array(16));return $e.properties.get("anchor")==="map"&&(u.a_(St,St,dt.rollInRadians),u.a$(St,St,-dt.pitchInRadians),u.a_(St,St,dt.bearingInRadians),u.a$(St,St,dt.center.lat*Math.PI/180),u.bp(St,St,-dt.center.lng*Math.PI/180)),u.bZ(it,it,St),it}(G,B.transform),ge=pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),xe=$.properties.get("atmosphere-blend")*ge.projectionTransition;if(xe===0)return;const _e=Zo(pe.worldSize,pe.center.lat),ke=pe.inverseProjectionMatrix,Ye=new Float64Array(4);Ye[3]=1,u.at(Ye,Ye,pe.modelViewProjectionMatrix),Ye[0]/=Ye[3],Ye[1]/=Ye[3],Ye[2]/=Ye[3],Ye[3]=1,u.at(Ye,Ye,ke),Ye[0]/=Ye[3],Ye[1]/=Ye[3],Ye[2]/=Ye[3],Ye[3]=1;const Ne=(($e,dt,ht,it,St)=>({u_sun_pos:$e,u_atmosphere_blend:dt,u_globe_position:ht,u_globe_radius:it,u_inv_proj_matrix:St}))(fe,xe,[Ye[0],Ye[1],Ye[2]],_e,ke),Ue=qn(re,$);ae.draw(re,ie.TRIANGLES,ce,Jt.disabled,Ai.alphaBlended,ai.disabled,Ne,null,null,"atmosphere",Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const B=function($,G){let re=null;const ie=Object.values($._layers).flatMap(fe=>fe.source&&!fe.isHidden(G)?[$.sourceCaches[fe.source]]:[]),ae=ie.filter(fe=>fe.getSource().type==="vector"),ce=ie.filter(fe=>fe.getSource().type!=="vector"),pe=fe=>{(!re||re.getSource().maxzoom<fe.getSource().maxzoom)&&(re=fe)};return ae.forEach(fe=>pe(fe)),re||ce.forEach(fe=>pe(fe)),re}(this.style,this.transform.zoom);B&&function($,G,re){for(let ie=0;ie<re.length;ie++)Ui($,G,re[ie])}(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const $=B.transform.padding;Ja(B,B.transform.height-($.top||0),3,Hl),Ja(B,$.bottom||0,3,Oc),Ia(B,$.left||0,3,vn),Ia(B,B.transform.width-($.right||0),3,gr);const G=B.transform.centerPoint;(function(re,ie,ae,ce){rl(re,ie-1,ae-10,2,20,ce),rl(re,ie-10,ae-1,20,2,ce)})(B,G.x,B.transform.height-G.y,bi)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!u.c0(r,l):!u.c1(r,l)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(u.c2(r,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,x){const M=m.context,C=M.gl,I=m.transform,k=Ai.unblended,j=new Ht(C.LEQUAL,Ht.ReadWrite,[0,1]),B=x.sourceCache.getRenderableTiles(),$=m.useProgram("terrainDepth");M.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),M.clear({color:u.b7.transparent,depth:1});for(const G of B){const re=x.getTerrainMesh(G.tileID),ie=x.getTerrainData(G.tileID),ae=I.getProjectionData({overscaledTileID:G.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ce={u_ele_delta:x.getMeshFrameDelta(I.zoom)};$.draw(M,C.TRIANGLES,j,Jt.disabled,k,ai.backCCW,ce,ie,ae,"terrain",re.vertexBuffer,re.indexBuffer,re.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,x){const M=m.context,C=M.gl,I=m.transform,k=Ai.unblended,j=new Ht(C.LEQUAL,Ht.ReadWrite,[0,1]),B=x.getCoordsTexture(),$=x.sourceCache.getRenderableTiles(),G=m.useProgram("terrainCoords");M.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),M.clear({color:u.b7.transparent,depth:1}),x.coordsIndex=[];for(const re of $){const ie=x.getTerrainMesh(re.tileID),ae=x.getTerrainData(re.tileID);M.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,B.texture);const ce={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(I.zoom)},pe=I.getProjectionData({overscaledTileID:re.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});G.draw(M,C.TRIANGLES,j,Jt.disabled,k,ai.backCCW,ce,ae,pe,"terrain",ie.vertexBuffer,ie.indexBuffer,ie.segments),x.coordsIndex.push(re.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,r,l,h,m){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,u.c3(l)?function(x,M,C,I,k,j){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:B}=j,$=Jt.disabled,G=x.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(re,ie,ae,ce,pe,fe,ge,xe,_e){const ke=ie.transform,Ye=ie.style.map.terrain,Ne=pe==="map",Ue=fe==="map";for(const $e of re){const dt=ce.getTile($e),ht=dt.getBucket(ae);if(!ht||!ht.text||!ht.text.segments.get().length)continue;const it=u.ak(ht.textSizeData,ke.zoom),St=u.az(dt,1,ie.transform.zoom),ei=At(Ne,ie.transform,St),oi=ae.layout.get("icon-text-fit")!=="none"&&ht.hasIconData();if(it){const ar=Math.pow(2,ke.zoom-dt.tileID.overscaledZ),ki=Ye?(sr,Ki)=>Ye.getElevation($e,sr,Ki):null;Lc(ht,Ne,Ue,_e,ke,ei,ar,it,oi,u.aA(ke,dt,ge,xe),$e.toUnwrapped(),ki)}}}(I,x,C,M,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),k),C.paint.get("icon-opacity").constantOr(1)!==0&&$l(x,M,C,I,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),$,G,B),C.paint.get("text-opacity").constantOr(1)!==0&&$l(x,M,C,I,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),$,G,B),M.map.showCollisionBoxes&&(Rn(x,M,C,I,!0),Rn(x,M,C,I,!1))}(e,r,l,h,this.style.placement.variableOffsets,m):u.c4(l)?function(x,M,C,I,k){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=k,B=C.paint.get("circle-opacity"),$=C.paint.get("circle-stroke-width"),G=C.paint.get("circle-stroke-opacity"),re=!C.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&($.constantOr(1)===0||G.constantOr(1)===0))return;const ie=x.context,ae=ie.gl,ce=x.transform,pe=x.getDepthModeForSublayer(0,Ht.ReadOnly),fe=Jt.disabled,ge=x.colorModeForRenderPass(),xe=[],_e=ce.getCircleRadiusCorrection();for(let ke=0;ke<I.length;ke++){const Ye=I[ke],Ne=M.getTile(Ye),Ue=Ne.getBucket(C);if(!Ue)continue;const $e=C.paint.get("circle-translate"),dt=C.paint.get("circle-translate-anchor"),ht=u.aA(ce,Ne,$e,dt),it=Ue.programConfigurations.get(C.id),St=x.useProgram("circle",it),ei=Ue.layoutVertexBuffer,oi=Ue.indexBuffer,ar=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ye),ki={programConfiguration:it,program:St,layoutVertexBuffer:ei,indexBuffer:oi,uniformValues:jl(x,Ne,C,ht,_e),terrainData:ar,projectionData:ce.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!j,applyTerrainMatrix:!0})};if(re){const sr=Ue.segments.get();for(const Ki of sr)xe.push({segments:new u.aJ([Ki]),sortKey:Ki.sortKey,state:ki})}else xe.push({segments:Ue.segments,sortKey:0,state:ki})}re&&xe.sort((ke,Ye)=>ke.sortKey-Ye.sortKey);for(const ke of xe){const{programConfiguration:Ye,program:Ne,layoutVertexBuffer:Ue,indexBuffer:$e,uniformValues:dt,terrainData:ht,projectionData:it}=ke.state;Ne.draw(ie,ae.TRIANGLES,pe,fe,ge,ai.backCCW,dt,ht,it,C.id,Ue,$e,ke.segments,C.paint,x.transform.zoom,Ye)}}(e,r,l,h,m):u.c5(l)?function(x,M,C,I,k){if(C.paint.get("heatmap-opacity")===0)return;const j=x.context,{isRenderingToTexture:B,isRenderingGlobe:$}=k;if(x.style.map.terrain){for(const G of I){const re=M.getTile(G);M.hasRenderableParent(G)||(x.renderPass==="offscreen"?Cs(x,re,C,G,$):x.renderPass==="translucent"&&fo(x,C,G,B,$))}j.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?function(G,re,ie,ae){const ce=G.context,pe=ce.gl,fe=G.transform,ge=Jt.disabled,xe=new Ai([pe.ONE,pe.ONE],u.b7.transparent,[!0,!0,!0,!0]);(function(_e,ke,Ye){const Ne=_e.gl;_e.activeTexture.set(Ne.TEXTURE1),_e.viewport.set([0,0,ke.width/4,ke.height/4]);let Ue=Ye.heatmapFbos.get(u.bW);Ue?(Ne.bindTexture(Ne.TEXTURE_2D,Ue.colorAttachment.get()),_e.bindFramebuffer.set(Ue.framebuffer)):(Ue=il(_e,ke.width/4,ke.height/4),Ye.heatmapFbos.set(u.bW,Ue))})(ce,G,ie),ce.clear({color:u.b7.transparent});for(let _e=0;_e<ae.length;_e++){const ke=ae[_e];if(re.hasRenderableParent(ke))continue;const Ye=re.getTile(ke),Ne=Ye.getBucket(ie);if(!Ne)continue;const Ue=Ne.programConfigurations.get(ie.id),$e=G.useProgram("heatmap",Ue),dt=fe.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ht=fe.getCircleRadiusCorrection();$e.draw(ce,pe.TRIANGLES,Ht.disabled,ge,xe,ai.backCCW,ya(Ye,fe.zoom,ie.paint.get("heatmap-intensity"),ht),null,dt,ie.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,ie.paint,fe.zoom,Ue)}ce.viewport.set([0,0,G.width,G.height])}(x,M,C,I):x.renderPass==="translucent"&&function(G,re){const ie=G.context,ae=ie.gl;ie.setColorMode(G.colorModeForRenderPass());const ce=re.heatmapFbos.get(u.bW);ce&&(ie.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,ce.colorAttachment.get()),ie.activeTexture.set(ae.TEXTURE1),Gl(ie,re).bind(ae.LINEAR,ae.CLAMP_TO_EDGE),G.useProgram("heatmapTexture").draw(ie,ae.TRIANGLES,Ht.disabled,Jt.disabled,G.colorModeForRenderPass(),ai.disabled,Pd(G,re,0,1),null,null,re.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments,re.paint,G.transform.zoom))}(x,C)}(e,r,l,h,m):u.c6(l)?function(x,M,C,I,k){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=k,B=C.paint.get("line-opacity"),$=C.paint.get("line-width");if(B.constantOr(1)===0||$.constantOr(1)===0)return;const G=x.getDepthModeForSublayer(0,Ht.ReadOnly),re=x.colorModeForRenderPass(),ie=C.paint.get("line-dasharray"),ae=C.paint.get("line-pattern"),ce=ae.constantOr(1),pe=C.paint.get("line-gradient"),fe=C.getCrossfadeParameters(),ge=ce?"linePattern":ie?"lineSDF":pe?"lineGradient":"line",xe=x.context,_e=xe.gl,ke=x.transform;let Ye=!0;for(const Ne of I){const Ue=M.getTile(Ne);if(ce&&!Ue.patternsLoaded())continue;const $e=Ue.getBucket(C);if(!$e)continue;const dt=$e.programConfigurations.get(C.id),ht=x.context.program.get(),it=x.useProgram(ge,dt),St=Ye||it.program!==ht,ei=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ne),oi=ae.constantOr(null);if(oi&&Ue.imageAtlas){const Ni=Ue.imageAtlas,xi=Ni.patternPositions[oi.to.toString()],Lr=Ni.patternPositions[oi.from.toString()];xi&&Lr&&dt.setConstantPatternPositions(xi,Lr)}const ar=ke.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),ki=ke.getPixelScale(),sr=ce?Nl(x,Ue,C,ki,fe):ie?Dd(x,Ue,C,ki,ie,fe):pe?Ul(x,Ue,C,ki,$e.lineClipsArray.length):Fl(x,Ue,C,ki);if(ce)xe.activeTexture.set(_e.TEXTURE0),Ue.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),dt.updatePaintBuffers(fe);else if(ie&&(St||x.lineAtlas.dirty))xe.activeTexture.set(_e.TEXTURE0),x.lineAtlas.bind(xe);else if(pe){const Ni=$e.gradients[C.id];let xi=Ni.texture;if(C.gradientVersion!==Ni.version){let Lr=256;if(C.stepInterpolant){const Xr=M.getSource().maxzoom,nn=Ne.canonical.z===Xr?Math.ceil(1<<x.transform.maxZoom-Ne.canonical.z):1;Lr=u.ae(u.bX($e.maxLineLength/u.Z*1024*nn),256,xe.maxTextureSize)}Ni.gradient=u.bY({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:Lr,image:Ni.gradient||void 0,clips:$e.lineClipsArray}),Ni.texture?Ni.texture.update(Ni.gradient):Ni.texture=new ti(xe,Ni.gradient,_e.RGBA),Ni.version=C.gradientVersion,xi=Ni.texture}xe.activeTexture.set(_e.TEXTURE0),xi.bind(C.stepInterpolant?_e.NEAREST:_e.LINEAR,_e.CLAMP_TO_EDGE)}const Ki=x.stencilModeForClipping(Ne);it.draw(xe,_e.TRIANGLES,G,Ki,re,ai.disabled,sr,ei,ar,C.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,C.paint,x.transform.zoom,dt,$e.layoutVertexBuffer2),Ye=!1}}(e,r,l,h,m):u.c7(l)?function(x,M,C,I,k){const j=C.paint.get("fill-color"),B=C.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const{isRenderingToTexture:$}=k,G=x.colorModeForRenderPass(),re=C.paint.get("fill-pattern"),ie=x.opaquePassEnabledForLayer()&&!re.constantOr(1)&&j.constantOr(u.b7.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===ie){const ae=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?Ht.ReadWrite:Ht.ReadOnly);yn(x,M,C,I,ae,G,!1,$)}if(x.renderPass==="translucent"&&C.paint.get("fill-antialias")){const ae=x.getDepthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Ht.ReadOnly);yn(x,M,C,I,ae,G,!0,$)}}(e,r,l,h,m):u.c8(l)?function(x,M,C,I,k){const j=C.paint.get("fill-extrusion-opacity");if(j===0)return;const{isRenderingToTexture:B}=k;if(x.renderPass==="translucent"){const $=new Ht(x.context.gl.LEQUAL,Ht.ReadWrite,x.depthRangeFor3D);if(j!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))za(x,M,C,I,$,Jt.disabled,Ai.disabled,B),za(x,M,C,I,$,x.stencilModeFor3D(),x.colorModeForRenderPass(),B);else{const G=x.colorModeForRenderPass();za(x,M,C,I,$,Jt.disabled,G,B)}}}(e,r,l,h,m):u.c9(l)?function(x,M,C,I,k){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=k,B=x.context,$=x.style.projection.useSubdivision,G=x.getDepthModeForSublayer(0,Ht.ReadOnly),re=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(ie,ae,ce,pe,fe,ge,xe){const _e=ie.context,ke=_e.gl;for(const Ye of ce){const Ne=ae.getTile(Ye),Ue=Ne.dem;if(!Ue||!Ue.data||!Ne.needsHillshadePrepare)continue;const $e=Ue.dim,dt=Ue.stride,ht=Ue.getPixels();if(_e.activeTexture.set(ke.TEXTURE1),_e.pixelStoreUnpackPremultiplyAlpha.set(!1),Ne.demTexture=Ne.demTexture||ie.getTileTexture(dt),Ne.demTexture){const St=Ne.demTexture;St.update(ht,{premultiply:!1}),St.bind(ke.NEAREST,ke.CLAMP_TO_EDGE)}else Ne.demTexture=new ti(_e,ht,ke.RGBA,{premultiply:!1}),Ne.demTexture.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);_e.activeTexture.set(ke.TEXTURE0);let it=Ne.fbo;if(!it){const St=new ti(_e,{width:$e,height:$e,data:null},ke.RGBA);St.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),it=Ne.fbo=_e.createFramebuffer($e,$e,!0,!1),it.colorAttachment.set(St.texture)}_e.bindFramebuffer.set(it.framebuffer),_e.viewport.set([0,0,$e,$e]),ie.useProgram("hillshadePrepare").draw(_e,ke.TRIANGLES,fe,ge,xe,ai.disabled,Qf(Ne.tileID,Ue),null,null,pe.id,ie.rasterBoundsBuffer,ie.quadTriangleIndexBuffer,ie.rasterBoundsSegments),Ne.needsHillshadePrepare=!1}})(x,M,I,C,G,Jt.disabled,re),B.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if($){const[ie,ae,ce]=x.stencilConfigForOverlapTwoPass(I);Pa(x,M,C,ce,ie,G,re,!1,j),Pa(x,M,C,ce,ae,G,re,!0,j)}else{const[ie,ae]=x.getStencilConfigForOverlapAndUpdateStencilID(I);Pa(x,M,C,ae,ie,G,re,!1,j)}}(e,r,l,h,m):u.ca(l)?function(x,M,C,I,k){if(x.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!I.length)return;const{isRenderingToTexture:j}=k,B=M.getSource(),$=x.style.projection.useSubdivision;if(B instanceof Fn)Wa(x,M,C,I,null,!1,!1,B.tileCoords,B.flippedWindingOrder,j);else if($){const[G,re,ie]=x.stencilConfigForOverlapTwoPass(I);Wa(x,M,C,ie,G,!1,!0,ra,!1,j),Wa(x,M,C,ie,re,!0,!0,ra,!1,j)}else{const[G,re]=x.getStencilConfigForOverlapAndUpdateStencilID(I);Wa(x,M,C,re,G,!1,!0,ra,!1,j)}}(e,r,l,h,m):u.cb(l)?function(x,M,C,I,k){const j=C.paint.get("background-color"),B=C.paint.get("background-opacity");if(B===0)return;const{isRenderingToTexture:$}=k,G=x.context,re=G.gl,ie=x.style.projection,ae=x.transform,ce=ae.tileSize,pe=C.paint.get("background-pattern");if(x.isPatternMissing(pe))return;const fe=!pe&&j.a===1&&B===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==fe)return;const ge=Jt.disabled,xe=x.getDepthModeForSublayer(0,fe==="opaque"?Ht.ReadWrite:Ht.ReadOnly),_e=x.colorModeForRenderPass(),ke=x.useProgram(pe?"backgroundPattern":"background"),Ye=I||Se(ae,{tileSize:ce,terrain:x.style.map.terrain});pe&&(G.activeTexture.set(re.TEXTURE0),x.imageManager.bind(x.context));const Ne=C.getCrossfadeParameters();for(const Ue of Ye){const $e=ae.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),dt=pe?Kf(B,x,pe,{tileID:Ue,tileSize:ce},Ne):Rd(B,j),ht=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ue),it=ie.getMeshFromTileID(G,Ue.canonical,!1,!0,"raster");ke.draw(G,re.TRIANGLES,xe,ge,_e,ai.backCCW,dt,ht,$e,C.id,it.vertexBuffer,it.indexBuffer,it.segments)}}(e,0,l,h,m):u.cc(l)&&function(x,M,C,I){const{isRenderingGlobe:k}=I,j=x.context,B=C.implementation,$=x.style.projection,G=x.transform,re=G.getProjectionDataForCustomLayer(k),ie={farZ:G.farZ,nearZ:G.nearZ,fov:G.fov*Math.PI/180,modelViewProjectionMatrix:G.modelViewProjectionMatrix,projectionMatrix:G.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:re},ae=B.renderingMode?B.renderingMode:"2d";if(x.renderPass==="offscreen"){const ce=B.prerender;ce&&(x.setCustomLayerDefaults(),j.setColorMode(x.colorModeForRenderPass()),ce.call(B,j.gl,ie),j.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),j.setColorMode(x.colorModeForRenderPass()),j.setStencilMode(Jt.disabled);const ce=ae==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,Ht.ReadOnly);j.setDepthMode(ce),B.render(j.gl,ie),j.setDirty(),x.setBaseState(),j.bindFramebuffer.set(null)}}(e,0,l,m))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!r||!l}useProgram(e,r,l=!1,h=[]){this.cache=this.cache||{};const m=!!this.style.map.terrain,x=this.style.projection,M=l?zn.projectionMercator:x.shaderPreludeCode,C=l?Oo:x.shaderDefine,I=e+(r?r.cacheKey:"")+`/${l?ui:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(m?"/terrain":"")+(h?`/${h.join("/")}`:"");return this.cache[I]||(this.cache[I]=new Su(this.context,zn[e],r,kd[e],this._showOverdrawInspector,m,M,C,h)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ti(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function zs(f,e){let r,l=!1,h=null,m=null;const x=()=>{h=null,l&&(f.apply(m,r),h=setTimeout(x,e),l=!1)};return(...M)=>(l=!0,m=this,r=M,h||x(),h)}class Ou{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(l=h)}),(l&&l[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const l=r.join("/");let h=l;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${l}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let x=window.location.href.replace(/(#.+)?$/,m);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=zs(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),x=Math.round(r.lng*m)/m,M=Math.round(r.lat*m)/m,C=this._map.getBearing(),I=this._map.getPitch();let k="";if(k+=e?`/${x}/${M}/${l}`:`${l}/${M}/${x}`,(C||I)&&(k+="/"+Math.round(10*C)/10),I&&(k+=`/${Math.round(I)}`),this._hashName){const j=this._hashName;let B=!1;const $=window.location.hash.slice(1).split("&").map(G=>{const re=G.split("=")[0];return re===j?(B=!0,`${re}=${k}`):G}).filter(G=>G);return B||$.push(`${j}=${k}`),`#${$.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new u.Q(+e[2],+e[1])}catch{return!1}const r=+e[0],l=+(e[3]||0),h=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&l>=-180&&l<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const $n={linearity:.3,easing:u.cd(0,0,.3,1)},Bc=u.e({deceleration:2500,maxSpeed:1400},$n),Da=u.e({deceleration:20,maxSpeed:1400},$n),Ra=u.e({deceleration:1e3,maxSpeed:360},$n),Ps=u.e({deceleration:1e3,maxSpeed:90},$n),es=u.e({deceleration:1e3,maxSpeed:360},$n);class Bu{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ee.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=Ee.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)r.zoom+=m.zoomDelta||0,r.bearing+=m.bearingDelta||0,r.pitch+=m.pitchDelta||0,r.roll+=m.rollDelta||0,m.panDelta&&r.pan._add(m.panDelta),m.around&&(r.around=m.around),m.pinchAround&&(r.pinchAround=m.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(r.pan.mag()){const m=ts(r.pan.mag(),l,u.e({},Bc,e||{})),x=r.pan.mult(m.amount/r.pan.mag()),M=this._map.cameraHelper.handlePanInertia(x,this._map.transform);h.center=M.easingCenter,h.offset=M.easingOffset,po(h,m)}if(r.zoom){const m=ts(r.zoom,l,Da);h.zoom=this._map.transform.zoom+m.amount,po(h,m)}if(r.bearing){const m=ts(r.bearing,l,Ra);h.bearing=this._map.transform.bearing+u.ae(m.amount,-179,179),po(h,m)}if(r.pitch){const m=ts(r.pitch,l,Ps);h.pitch=this._map.transform.pitch+m.amount,po(h,m)}if(r.roll){const m=ts(r.roll,l,es);h.roll=this._map.transform.roll+u.ae(m.amount,-179,179),po(h,m)}if(h.zoom||h.bearing){const m=r.pinchAround===void 0?r.around:r.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),u.e(h,{noMoveStart:!0})}}function po(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function ts(f,e,r){const{maxSpeed:l,linearity:h,deceleration:m}=r,x=u.ae(f*h/(e/1e3),-l,l),M=Math.abs(x)/(m*h);return{easing:r.easing,duration:1e3*M,amount:x*(M/2)}}class Er extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l,h={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const m=ne.mousePos(r.getCanvas(),l),x=r.unproject(m);super(e,u.e({point:m,lngLat:x,originalEvent:l},h)),this._defaultPrevented=!1,this.target=r}}class ba extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){const h=e==="touchend"?l.changedTouches:l.touches,m=ne.touchPos(r.getCanvasContainer(),h),x=m.map(C=>r.unproject(C)),M=m.reduce((C,I,k,j)=>C.add(I.div(j.length)),new u.P(0,0));super(e,{points:m,point:M,lngLats:x,lngLat:r.unproject(M),originalEvent:l}),this._defaultPrevented=!1}}class rn extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class jc{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new rn(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Er(e.type,this._map,e))}mouseup(e){this._map.fire(new Er(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Er(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Er(e.type,this._map,e))}mouseover(e){this._map.fire(new Er(e.type,this._map,e))}mouseout(e){this._map.fire(new Er(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ba(e.type,this._map,e))}touchmove(e){this._map.fire(new ba(e.type,this._map,e))}touchend(e){this._map.fire(new ba(e.type,this._map,e))}touchcancel(e){this._map.fire(new ba(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vh{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Er(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Er("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Er(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(u.P.convert(e),this._map.terrain)}}class Zh{constructor(e,r){this._map=e,this._tr=new Xl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(ne.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const l=r;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=ne.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(h.x,l.x),x=Math.max(h.x,l.x),M=Math.min(h.y,l.y),C=Math.max(h.y,l.y);ne.setTransform(this._box,`translate(${m}px,${M}px)`),this._box.style.width=x-m+"px",this._box.style.height=C-M+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const l=this._startPos,h=r;if(this.reset(),ne.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new u.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(l,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ne.remove(this._box),this._box=null),ne.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new u.l(e,{originalEvent:r}))}}function ju(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const r={};for(let l=0;l<f.length;l++)r[f[l].identifier]=e[l];return r}class Vr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const m=new u.P(0,0);for(const x of h)m._add(x);return m.div(h.length)}(r),this.touches=ju(l,r)))}touchmove(e,r,l){if(this.aborted||!this.centroid)return;const h=ju(l,r);for(const m in this.touches){const x=h[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,r,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class mo{constructor(e){this.singleTap=new Vr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,l){this.singleTap.touchstart(e,r,l)}touchmove(e,r,l){this.singleTap.touchmove(e,r,l)}touchend(e,r,l){const h=this.singleTap.touchend(e,r,l);if(h){const m=e.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(m&&x||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Yl{constructor(e){this._tr=new Xl(e),this._zoomIn=new mo({numTouches:1,numTaps:2}),this._zoomOut=new mo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,l){this._zoomIn.touchstart(e,r,l),this._zoomOut.touchstart(e,r,l)}touchmove(e,r,l){this._zoomIn.touchmove(e,r,l),this._zoomOut.touchmove(e,r,l)}touchend(e,r,l){const h=this._zoomIn.touchend(e,r,l),m=this._zoomOut.touchend(e,r,l),x=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(h)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=Array.isArray(r)?r[0]:r;return!this._moved&&h.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(l,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ne.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const na={0:1,2:2};class ka{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=ne.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,l){const h=na[l];return r.buttons===void 0||(r.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return ne.mouseButton(e)===this._eventButton}}class bn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Ql{constructor(e=new ka({checkCorrectEvent:()=>!0}),r=new bn){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,l){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const Fc=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class Wf{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,l){return this._calculateTransform(e,r,l)}touchmove(e,r,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,r,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,l){this._calculateTransform(e,r,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,l){l.length>0&&(this._active=!0);const h=ju(l,r),m=new u.P(0,0),x=new u.P(0,0);let M=0;for(const I in h){const k=h[I],j=this._touches[I];j&&(m._add(k),x._add(k.sub(j)),M++,h[I]=k)}if(this._touches=h,this._shouldBePrevented(M)||!x.mag())return;const C=x.div(M);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(M),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,l){if(!this._firstTwoTouches)return;e.preventDefault();const[h,m]=this._firstTwoTouches,x=is(l,r,h),M=is(l,r,m);if(!x||!M)return;const C=this._aroundCenter?null:x.add(M).div(2);return this._move([x,M],C,e)}touchend(e,r,l){if(!this._firstTwoTouches)return;const[h,m]=this._firstTwoTouches,x=is(l,r,h),M=is(l,r,m);x&&M||(this._active&&ne.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function is(f,e,r){for(let l=0;l<f.length;l++)if(f[l].identifier===r)return e[l]}function Uc(f,e){return Math.log(f/e)/Math.LN2}class Is extends Fu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Uc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Uc(this._distance,l),pinchAround:r}}}function La(f,e){return 180*f.angleWith(e)/Math.PI}class yt extends Fu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,l){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:La(this._vector,h),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,l=La(e,this._startVector);return Math.abs(l)<r}}function Nc(f){return Math.abs(f.y)>Math.abs(f.x)}class al extends Fu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,l){super.touchstart(e,r,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Nc(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,l){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,m=r.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const x=e.y>0==r.y>0;return Nc(e)&&Nc(r)&&x}}const Uu={panStep:100,bearingStep:15,pitchStep:10};class sl{constructor(e){this._tr=new Xl(e);const r=Uu;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,l=0,h=0,m=0,x=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),x=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:M=>{const C=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:go,zoom:r?Math.round(C.zoom)+r*(e.shiftKey?2:1):C.zoom,bearing:C.bearing+l*this._bearingStep,pitch:C.pitch+h*this._pitchStep,offset:[-m*this._panStep,-x*this._panStep],center:C.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function go(f){return f*(2-f)}const Nu=4.000244140625;class ii{constructor(e,r){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Xl(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=Ee.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%Nu==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=ne.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(u.Q.convert(l.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const M=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=M),typeof this._targetZoom=="number"&&(this._targetZoom+=M)}if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Nu?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&C!==0&&(C=1/C);const I=typeof this._targetZoom!="number"?e.scale:u.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),u.ah(I*C)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,h=this._easing;let m,x=!1;if(this._type==="wheel"&&l&&h){const M=Ee.now()-this._lastWheelEventTime,C=Math.min((M+5)/200,1),I=h(C);m=u.B.number(l,r,I),C<1?this._frameId||(this._frameId=!0):x=!0}else m=r,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!x,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=u.cf;if(this._prevEase){const l=this._prevEase,h=(Ee.now()-l.start)/l.duration,m=l.easing(h+.01)-l.easing(h),x=.27/Math.sqrt(m*m+1e-4)*.01,M=Math.sqrt(.0729-x*x);r=u.cd(x,M,.25,1)}return this._prevEase={start:Ee.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Vc{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class jd{constructor(e){this._tr=new Xl(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rs{constructor(){this._tap=new mo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,l){if(!this._swipePoint)if(this._tapTime){const h=r[0],m=e.timeStamp-this._tapTime<500,x=this._tapPoint.dist(h)<30;m&&x?l.length>0&&(this._swipePoint=h,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,r,l)}touchmove(e,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=r[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,r,l)}touchend(e,r,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const h=this._tap.touchend(e,r,l);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu{constructor(e,r,l){this._el=e,this._mousePan=r,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Zu{constructor(e,r,l,h){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=l,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ns{constructor(e,r,l,h){this._el=e,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Oa{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ne.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=r,this._container.appendChild(h);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=l,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ne.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new u.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ds=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class qh extends u.l{}function Kl(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class Zc{constructor(e,r){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=h.type==="renderFrame"?void 0:h,M={needsRenderFrame:!1},C={},I={};for(const{handlerName:B,handler:$,allowed:G}of this._handlers){if(!$.isEnabled())continue;let re;if(this._blockedByActive(I,G,B))$.reset();else if($[m||h.type]){if(u.cg(h,m||h.type)){const ie=ne.mousePos(this._map.getCanvas(),h);re=$[m||h.type](h,ie)}else if(u.ch(h,m||h.type)){const ie=this._getMapTouches(h.touches),ae=ne.touchPos(this._map.getCanvas(),ie);re=$[m||h.type](h,ae,ie)}else u.ci(m||h.type)||(re=$[m||h.type](h));this.mergeHandlerResult(M,C,re,B,x),re&&re.needsRenderFrame&&this._triggerRenderFrame()}(re||$.isActive())&&(I[B]=$)}const k={};for(const B in this._previousActiveHandlers)I[B]||(k[B]=x);this._previousActiveHandlers=I,(Object.keys(k).length||Kl(M))&&(this._changes.push([M,C,k]),this._triggerRenderFrame()),(Object.keys(I).length||Kl(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=M;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bu(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,m,x]of this._listeners)ne.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[e,r,l]of this._listeners)ne.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new jc(r,e));const h=r.boxZoom=new Zh(r,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const m=r.cooperativeGestures=new Oa(r,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const x=new Yl(r),M=new jd(r);r.doubleClickZoom=new Vc(M,x),this._add("tapZoom",x),this._add("clickZoom",M),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const C=new rs;this._add("tapDragZoom",C);const I=r.touchPitch=new al(r);this._add("touchPitch",I),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const k=()=>r.project(r.getCenter()),j=function({enable:fe,clickTolerance:ge,aroundCenter:xe=!0,minPixelCenterThreshold:_e=100,rotateDegreesPerPixelMoved:ke=.8},Ye){const Ne=new ka({checkCorrectEvent:Ue=>ne.mouseButton(Ue)===0&&Ue.ctrlKey||ne.mouseButton(Ue)===2&&!Ue.ctrlKey});return new Zr({clickTolerance:ge,move:(Ue,$e)=>{const dt=Ye();if(xe&&Math.abs(dt.y-Ue.y)>_e)return{bearingDelta:u.ce(new u.P(Ue.x,$e.y),$e,dt)};let ht=($e.x-Ue.x)*ke;return xe&&$e.y<dt.y&&(ht=-ht),{bearingDelta:ht}},moveStateManager:Ne,enable:fe,assignEvents:Fc})}(e,k),B=function({enable:fe,clickTolerance:ge,pitchDegreesPerPixelMoved:xe=-.5}){const _e=new ka({checkCorrectEvent:ke=>ne.mouseButton(ke)===0&&ke.ctrlKey||ne.mouseButton(ke)===2});return new Zr({clickTolerance:ge,move:(ke,Ye)=>({pitchDelta:(Ye.y-ke.y)*xe}),moveStateManager:_e,enable:fe,assignEvents:Fc})}(e),$=function({enable:fe,clickTolerance:ge,rollDegreesPerPixelMoved:xe=.3},_e){const ke=new ka({checkCorrectEvent:Ye=>ne.mouseButton(Ye)===2&&Ye.ctrlKey});return new Zr({clickTolerance:ge,move:(Ye,Ne)=>{const Ue=_e();let $e=(Ne.x-Ye.x)*xe;return Ne.y<Ue.y&&($e=-$e),{rollDelta:$e}},moveStateManager:ke,enable:fe,assignEvents:Fc})}(e,k);r.dragRotate=new Zu(e,j,B,$),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",B,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const G=function({enable:fe,clickTolerance:ge}){const xe=new ka({checkCorrectEvent:_e=>ne.mouseButton(_e)===0&&!_e.ctrlKey});return new Zr({clickTolerance:ge,move:(_e,ke)=>({around:ke,panDelta:ke.sub(_e)}),activateOnStart:!0,moveStateManager:xe,enable:fe,assignEvents:Fc})}(e),re=new Wf(e,r);r.dragPan=new Vu(l,G,re),this._add("mousePan",G),this._add("touchPan",re,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const ie=new yt,ae=new Is;r.touchZoomRotate=new ns(l,ae,ie,C),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const ce=r.scrollZoom=new ii(r,()=>this._triggerRenderFrame());this._add("scrollZoom",ce,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const pe=r.keyboard=new sl(r);this._add("keyboard",pe),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new Vh(r))}_add(e,r,l){this._handlers.push({handlerName:e,handler:r,allowed:l}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ds(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,l){for(const h in e)if(h!==l&&(!r||r.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const l of e)this._el.contains(l.target)&&r.push(l);return r}mergeHandlerResult(e,r,l,h,m){if(!l)return;u.e(e,l);const x={handlerName:h,originalEvent:l.originalEvent||m};l.zoomDelta!==void 0&&(r.zoom=x),l.panDelta!==void 0&&(r.drag=x),l.rollDelta!==void 0&&(r.roll=x),l.pitchDelta!==void 0&&(r.pitch=x),l.bearingDelta!==void 0&&(r.rotate=x)}_applyChanges(){const e={},r={},l={};for(const[h,m,x]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new u.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(e.rollDelta=(e.rollDelta||0)+h.rollDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),u.e(r,m),u.e(l,x);this._updateMapTransform(e,r,l),this._changes=[]}_updateMapTransform(e,r,l){const h=this._map,m=h._getTransformForUpdate(),x=h.terrain;if(!(Kl(e)||x&&this._terrainMovement))return this._fireEvents(r,l,!0);h._stop(!0);let{panDelta:M,zoomDelta:C,bearingDelta:I,pitchDelta:k,rollDelta:j,around:B,pinchAround:$}=e;$!==void 0&&(B=$),B=B||h.transform.centerPoint,x&&!m.isPointOnMapSurface(B)&&(B=m.centerPoint);const G={panDelta:M,zoomDelta:C,rollDelta:j,pitchDelta:k,bearingDelta:I,around:B};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(B)&&(B=m.centerPoint);const re=B.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(M?B.sub(M):B);x?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(G,m),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(M))):this._map.cameraHelper.handleMapControlsPan(G,m,re):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(G,m,re))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(G,m),this._map.cameraHelper.handleMapControlsPan(G,m,re)),h._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,l,!0)}_fireEvents(e,r,l){const h=Ds(this._eventsInProgress),m=Ds(e),x={};for(const j in e){const{originalEvent:B}=e[j];this._eventsInProgress[j]||(x[`${j}start`]=B),this._eventsInProgress[j]=e[j]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(const j in x)this._fireEvent(j,x[j]);m&&this._fireEvent("move",m.originalEvent);for(const j in e){const{originalEvent:B}=e[j];this._fireEvent(j,B)}const M={};let C;for(const j in this._eventsInProgress){const{handlerName:B,originalEvent:$}=this._eventsInProgress[j];this._handlersById[B].isActive()||(delete this._eventsInProgress[j],C=r[B]||$,M[`${j}end`]=C)}for(const j in M)this._fireEvent(j,M[j]);const I=Ds(this._eventsInProgress),k=(h||m)&&!I;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const j=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&j.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(j)}if(l&&k){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!j||!j.essential&&Ee.prefersReducedMotion?(this._map.fire(new u.l("moveend",{originalEvent:C})),B(this._map.getBearing())&&this._map.resetNorth()):(B(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new u.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new qh("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class qc extends u.E{constructor(e,r,l){super(),this._renderFrameCallback=()=>{const h=Math.min((Ee.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new u.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,l){return e=u.P.convert(e).mult(-1),this.panTo(this.transform.center,u.e({offset:e},r),l)}panTo(e,r,l){return this.easeTo(u.e({center:e},r),l)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,l){return this.easeTo(u.e({zoom:e},r),l)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new u.l("movestart",r)).fire(new u.l("move",r)).fire(new u.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,l){return this.easeTo(u.e({bearing:e},r),l)}resetNorth(e,r){return this.rotateTo(0,u.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(u.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=Ri.convert(e).adjustAntiMeridian();const l=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,r)}_cameraForBoxAndBearing(e,r,l,h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=u.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const I=h.padding;h.padding={top:I,bottom:I,right:I,left:I}}const x=u.e(m,h.padding);h.padding=x;const M=this.transform,C=new Ri(e,r);return this.cameraHelper.cameraForBoxAndBearing(h,x,C,l,M)}fitBounds(e,r,l){return this._fitInternal(this.cameraForBounds(e,r),r,l)}fitScreenCoordinates(e,r,l,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(u.P.convert(e)),this.transform.screenPointToLocation(u.P.convert(r)),l,h),h,m)}_fitInternal(e,r,l){return e?(delete(r=u.e(e,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(e,r){this.stop();const l=this._getTransformForUpdate();let h=!1,m=!1,x=!1;const M=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const C=l.zoom!==M;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(h=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(m=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(x=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new u.l("movestart",r)).fire(new u.l("move",r)),C&&this.fire(new u.l("zoomstart",r)).fire(new u.l("zoom",r)).fire(new u.l("zoomend",r)),h&&this.fire(new u.l("rotatestart",r)).fire(new u.l("rotate",r)).fire(new u.l("rotateend",r)),m&&this.fire(new u.l("pitchstart",r)).fire(new u.l("pitch",r)).fire(new u.l("pitchend",r)),x&&this.fire(new u.l("rollstart",r)).fire(new u.l("roll",r)).fire(new u.l("rollend",r)),this.fire(new u.l("moveend",r))}calculateCameraOptionsFromTo(e,r,l,h=0){const m=u.$.fromLngLat(e,r),x=u.$.fromLngLat(l,h),M=x.x-m.x,C=x.y-m.y,I=x.z-m.z,k=Math.hypot(M,C,I);if(k===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot(M,C),B=u.ah(this.transform.cameraToCenterDistance/k/this.transform.tileSize),$=180*Math.atan2(M,-C)/Math.PI;let G=180*Math.acos(j/k)/Math.PI;return G=I<0?90-G:90+G,{center:x.toLngLat(),elevation:h,zoom:B,pitch:G,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,l,h,m){const x=this.transform.calculateCenterFromCameraLngLatAlt(e,r,l,h);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:l,pitch:h,roll:m}}easeTo(e,r){this._stop(!1,e.easeId),((e=u.e({offset:[0,0],duration:500,easing:u.cf},e)).animate===!1||!e.essential&&Ee.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),h=this.getBearing(),m=l.pitch,x=l.roll,M="bearing"in e?this._normalizeBearing(e.bearing,h):h,C="pitch"in e?+e.pitch:m,I="roll"in e?this._normalizeBearing(e.roll,x):x,k="padding"in e?e.padding:l.padding,j=u.P.convert(e.offset);let B,$;e.around&&(B=u.Q.convert(e.around),$=l.locationToScreenPoint(B));const G={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},re=this.cameraHelper.handleEaseTo(l,{bearing:M,pitch:C,roll:I,padding:k,around:B,aroundPoint:$,offsetAsPoint:j,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||h!==M,this._pitching=this._pitching||C!==m,this._rolling=this._rolling||I!==x,this._padding=!l.isPaddingEqual(k),this._zooming=this._zooming||re.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,G),this.terrain&&this._prepareElevation(re.elevationCenter),this._ease(ie=>{re.easeFunc(ie),this.terrain&&!e.freezeElevation&&this._updateElevation(ie),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},ie=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,ie)},e),this}_prepareEase(e,r,l={}){this._moving=!0,r||l.moving||this.fire(new u.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new u.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new u.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new u.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new u.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(r-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(u.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),l=e.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(l<h){const m=this.calculateCameraOptionsFromTo(r,h,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&r.push(h=>this.transformCameraUpdate(h)),!r.length)return;const l=e.clone();for(const h of r){const m=l.clone(),{center:x,zoom:M,roll:C,pitch:I,bearing:k,elevation:j}=h(m);x&&m.setCenter(x),j!==void 0&&m.setElevation(j),M!==void 0&&m.setZoom(M),C!==void 0&&m.setRoll(C),I!==void 0&&m.setPitch(I),k!==void 0&&m.setBearing(k),l.apply(m)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new u.l("move",e)),this._zooming&&this.fire(new u.l("zoom",e)),this._rotating&&this.fire(new u.l("rotate",e)),this._pitching&&this.fire(new u.l("pitch",e)),this._rolling&&this.fire(new u.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const l=this._zooming,h=this._rotating,m=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new u.l("zoomend",e)),h&&this.fire(new u.l("rotateend",e)),m&&this.fire(new u.l("pitchend",e)),x&&this.fire(new u.l("rollend",e)),this.fire(new u.l("moveend",e))}flyTo(e,r){if(!e.essential&&Ee.prefersReducedMotion){const $e=u.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo($e,r)}this.stop(),e=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.cf},e);const l=this._getTransformForUpdate(),h=l.bearing,m=l.pitch,x=l.roll,M=l.padding,C="bearing"in e?this._normalizeBearing(e.bearing,h):h,I="pitch"in e?+e.pitch:m,k="roll"in e?this._normalizeBearing(e.roll,x):x,j="padding"in e?e.padding:l.padding,B=u.P.convert(e.offset);let $=l.centerPoint.add(B);const G=l.screenPointToLocation($),re=this.cameraHelper.handleFlyTo(l,{bearing:C,pitch:I,roll:k,padding:j,locationAtOffset:G,offsetAsPoint:B,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ie=e.curve;const ae=Math.max(l.width,l.height),ce=ae/re.scaleOfZoom,pe=re.pixelPathLength;typeof re.scaleOfMinZoom=="number"&&(ie=Math.sqrt(ae/re.scaleOfMinZoom/pe*2));const fe=ie*ie;function ge($e){const dt=(ce*ce-ae*ae+($e?-1:1)*fe*fe*pe*pe)/(2*($e?ce:ae)*fe*pe);return Math.log(Math.sqrt(dt*dt+1)-dt)}function xe($e){return(Math.exp($e)-Math.exp(-$e))/2}function _e($e){return(Math.exp($e)+Math.exp(-$e))/2}const ke=ge(!1);let Ye=function($e){return _e(ke)/_e(ke+ie*$e)},Ne=function($e){return ae*((_e(ke)*(xe(dt=ke+ie*$e)/_e(dt))-xe(ke))/fe)/pe;var dt},Ue=(ge(!0)-ke)/ie;if(Math.abs(pe)<2e-6||!isFinite(Ue)){if(Math.abs(ae-ce)<1e-6)return this.easeTo(e,r);const $e=ce<ae?-1:1;Ue=Math.abs(Math.log(ce/ae))/ie,Ne=()=>0,Ye=dt=>Math.exp($e*ie*dt)}return e.duration="duration"in e?+e.duration:1e3*Ue/("screenSpeed"in e?+e.screenSpeed/ie:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=h!==C,this._pitching=I!==m,this._rolling=k!==x,this._padding=!l.isPaddingEqual(j),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(re.targetCenter),this._ease($e=>{const dt=$e*Ue,ht=1/Ye(dt),it=Ne(dt);this._rotating&&l.setBearing(u.B.number(h,C,$e)),this._pitching&&l.setPitch(u.B.number(m,I,$e)),this._rolling&&l.setRoll(u.B.number(x,k,$e)),this._padding&&(l.interpolatePadding(M,j,$e),$=l.centerPoint.add(B)),re.easeFunc($e,ht,it,$),this.terrain&&!e.freezeElevation&&this._updateElevation($e),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,r)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,r,l){l.animate===!1||l.duration===0?(e(1),r()):(this._easeStart=Ee.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=u.aL(e,-180,180);const l=Math.abs(e-r);return Math.abs(e-360-r)<l&&(e-=360),Math.abs(e+360-r)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(u.Q.convert(e),this.transform.tileZoom):null}}const as={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Gi{constructor(e=as){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ne.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ne.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ne.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){const l=this._map._getUIString(`AttributionControl.${r}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const r=this._map.style.sourceCaches;for(const h in r){const m=r[h];if(m.used||m.usedForTerrain){const x=m.getSource();x.attribution&&e.indexOf(x.attribution)<0&&e.push(x.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,m)=>h.length-m.length),e=e.filter((h,m)=>{for(let x=m+1;x<e.length;x++)if(e[x].indexOf(h)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=ne.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ss{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ne.create("div","maplibregl-ctrl");const r=ne.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ne.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Wl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const h of l)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var $h=u.aG([{name:"a_pos3d",type:"Int16",components:3}]);class qu extends u.E{constructor(e){super(),this._lastTilesetChange=Ee.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const l={};for(const h of Se(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),u.bQ(h.terrainRttPosMatrix32f,0,u.Z,u.Z,0,0,1),this._tiles[h.key]=new kr(h,this.tileSize),this._lastTilesetChange=Ee.now());for(const h in this._tiles)l[h]||delete this._tiles[h]}freeRtt(e){for(const r in this._tiles){const l=this._tiles[r];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,r){return r?this._getTerrainCoordsForTileRanges(e,r):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID,m=e.clone(),x=u.b2();if(h.canonical.equals(e.canonical))u.bQ(x,0,u.Z,u.Z,0,0,1);else if(h.canonical.isChildOf(e.canonical)){const M=h.canonical.z-e.canonical.z,C=h.canonical.x-(h.canonical.x>>M<<M),I=h.canonical.y-(h.canonical.y>>M<<M),k=u.Z>>M;u.bQ(x,0,k,k,0,0,1),u.L(x,x,[-C*k,-I*k,0])}else{if(!e.canonical.isChildOf(h.canonical))continue;{const M=e.canonical.z-h.canonical.z,C=e.canonical.x-(e.canonical.x>>M<<M),I=e.canonical.y-(e.canonical.y>>M<<M),k=u.Z>>M;u.bQ(x,0,u.Z,u.Z,0,0,1),u.L(x,x,[C*k,I*k,0]),u.M(x,x,[1/2**M,1/2**M,0])}}m.terrainRttPosMatrix32f=new Float32Array(x),r[l]=m}return r}_getTerrainCoordsForTileRanges(e,r){const l={};for(const h of this._renderableTilesKeys){const m=this._tiles[h].tileID;if(!this._isWithinTileRanges(m,r))continue;const x=e.clone(),M=u.b2();if(m.canonical.z===e.canonical.z){const C=e.canonical.x-m.canonical.x,I=e.canonical.y-m.canonical.y;u.bQ(M,0,u.Z,u.Z,0,0,1),u.L(M,M,[C*u.Z,I*u.Z,0])}else if(m.canonical.z>e.canonical.z){const C=m.canonical.z-e.canonical.z,I=m.canonical.x-(m.canonical.x>>C<<C),k=m.canonical.y-(m.canonical.y>>C<<C),j=e.canonical.x-(m.canonical.x>>C),B=e.canonical.y-(m.canonical.y>>C),$=u.Z>>C;u.bQ(M,0,$,$,0,0,1),u.L(M,M,[-I*$+j*u.Z,-k*$+B*u.Z,0])}else{const C=e.canonical.z-m.canonical.z,I=e.canonical.x-(e.canonical.x>>C<<C),k=e.canonical.y-(e.canonical.y>>C<<C),j=(e.canonical.x>>C)-m.canonical.x,B=(e.canonical.y>>C)-m.canonical.y,$=u.Z<<C;u.bQ(M,0,$,$,0,0,1),u.L(M,M,[I*u.Z+j*$,k*u.Z+B*$,0])}x.terrainRttPosMatrix32f=new Float32Array(M),l[h]=x}return l}getSourceTile(e,r){const l=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&r)for(;h>=l.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(h--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,r){return r[e.canonical.z]&&e.canonical.x>=r[e.canonical.z].minTileX&&e.canonical.x<=r[e.canonical.z].maxTileX&&e.canonical.y>=r[e.canonical.z].minTileY&&e.canonical.y<=r[e.canonical.z].maxTileY}}class $u{constructor(e,r,l){this._meshCache={},this.painter=e,this.sourceCache=new qu(r),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,l,h=u.Z){var m;if(!(r>=0&&r<h&&l>=0&&l<h))return 0;const x=this.getTerrainData(e),M=(m=x.tile)===null||m===void 0?void 0:m.dem;if(!M)return 0;const C=u.cj([],[r/h*u.Z,l/h*u.Z],x.u_terrain_matrix),I=[C[0]*M.dim,C[1]*M.dim],k=Math.floor(I[0]),j=Math.floor(I[1]),B=I[0]-k,$=I[1]-j;return M.get(k,j)*(1-B)*(1-$)+M.get(k+1,j)*B*(1-$)+M.get(k,j+1)*(1-B)*$+M.get(k+1,j+1)*B*$}getElevationForLngLatZoom(e,r){if(!u.ck(r,e.wrap()))return 0;const{tileID:l,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(l,h%u.Z,m%u.Z,u.Z)}getElevation(e,r,l,h=u.Z){return this.getDEMElevation(e,r,l,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,m=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ti(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ti(h,new u.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.ad([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const h=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new ti(h,r.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),r.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const l=r&&r+r.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?m=e.canonical.z-h:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=e.canonical.x-(e.canonical.x>>m<<m),M=e.canonical.y-(e.canonical.y>>m<<m),C=u.cl(new Float64Array(16),[1/(u.Z<<m),1/(u.Z<<m),0]);u.L(C,C,[x*u.Z,M*u.Z,0]),this._demMatrixCache[e.key]={matrix:C,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,l=r.width/devicePixelRatio,h=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ti(r.context,{width:l,height:h,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ti(r.context,{width:l,height:h,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(l,h,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,x=0;m<this._coordsTextureSize;m++)for(let M=0;M<this._coordsTextureSize;M++,x+=4)r[x+0]=255&M,r[x+1]=255&m,r[x+2]=M>>8<<4|m>>8,r[x+3]=0;const l=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),h=new ti(e,l,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),l=this.painter.context,h=l.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),M=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,M-x-1,1,1,h.RGBA,h.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null);const C=r[0]+(r[2]>>4<<8),I=r[1]+((15&r[2])<<8),k=this.coordsIndex[255-r[3]],j=k&&this.sourceCache.getTileByID(k);if(!j)return null;const B=this._coordsTextureSize,$=(1<<j.tileID.canonical.z)*B;return new u.$((j.tileID.canonical.x*B+C)/$+j.tileID.wrap,(j.tileID.canonical.y*B+I)/$,this.getElevation(j.tileID,C,I,B))}depthAtPoint(e){const r=new Uint8Array(4),l=this.painter.context,h=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const l=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,h=l&&e.canonical.y===0,m=l&&e.canonical.y===(1<<e.canonical.z)-1,x=`m_${h?"n":""}_${m?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const M=this.painter.context,C=new u.cm,I=new u.aK,k=this.meshSize,j=u.Z/k,B=k*k;for(let _e=0;_e<=k;_e++)for(let ke=0;ke<=k;ke++)C.emplaceBack(ke*j,_e*j,0);for(let _e=0;_e<B;_e+=k+1)for(let ke=0;ke<k;ke++)I.emplaceBack(ke+_e,k+ke+_e+1,k+ke+_e+2),I.emplaceBack(ke+_e,k+ke+_e+2,ke+_e+1);const $=C.length,G=$+(k+1),re=(k+1)*k,ie=h?u.b9:0,ae=h?0:1,ce=m?u.ba:u.Z,pe=m?0:1;for(let _e=0;_e<=k;_e++)C.emplaceBack(_e*j,ie,ae);for(let _e=0;_e<=k;_e++)C.emplaceBack(_e*j,ce,pe);for(let _e=0;_e<k;_e++)I.emplaceBack(re+_e,G+_e,G+_e+1),I.emplaceBack(re+_e,G+_e+1,re+_e+1),I.emplaceBack(0+_e,$+_e+1,$+_e),I.emplaceBack(0+_e,0+_e+1,$+_e+1);const fe=C.length,ge=fe+2*(k+1);for(const _e of[0,1])for(let ke=0;ke<=k;ke++)for(const Ye of[0,1])C.emplaceBack(_e*u.Z,ke*j,Ye);for(let _e=0;_e<2*k;_e+=2)I.emplaceBack(fe+_e,fe+_e+1,fe+_e+3),I.emplaceBack(fe+_e,fe+_e+3,fe+_e+2),I.emplaceBack(ge+_e,ge+_e+3,ge+_e+1),I.emplaceBack(ge+_e,ge+_e+2,ge+_e+3);const xe=new Lo(M.createVertexBuffer(C,$h.members),M.createIndexBuffer(I),u.aJ.simpleSegment(0,0,C.length,I.length));return this._meshCache[x]=xe,xe}getMeshFrameDelta(e){return 2*Math.PI*u.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var l;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(l=this.getMinMaxElevation(h).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return r&&r.dem&&(l.minElevation=r.dem.min*this.exaggeration,l.maxElevation=r.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,r){const l=u.$.fromLngLat(e.wrap()),h=(1<<r)*u.Z,m=l.x*h,x=l.y*h,M=Math.floor(m/u.Z),C=Math.floor(x/u.Z);return{tileID:new u.Y(r,0,r,M,C),mercatorX:m,mercatorY:x}}}class _o{constructor(e,r,l){this._context=e,this._size=r,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new ti(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(l.texture),{id:e,fbo:r,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const $t={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class zi{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new _o(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(r)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const h=e.sourceCaches[l].getVisibleCoordinates(),m=e.sourceCaches[l].getSource(),x=m instanceof Fn?m.terrainTileRanges:null;for(const M of h){const C=this.terrain.sourceCache.getTerrainCoords(M,x);for(const I in C)this._coordsAscending[l][I]||(this._coordsAscending[l][I]=[]),this._coordsAscending[l][I].push(C[I])}}this._coordsAscendingStr={};for(const l of e._order){const h=e._layers[l],m=h.source;if($t[h.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const x in this._coordsAscending[m])this._coordsAscendingStr[m][x]=this._coordsAscending[m][x].map(M=>M.key).sort().join()}}for(const l of this._renderableTiles)for(const h in this._coordsAscendingStr){const m=this._coordsAscendingStr[h][l.tileID.key];m&&m!==l.rttCoords[h]&&(l.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),h=e.type,m=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if($t[h]&&(this._prevType&&$t[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(e.id),!x))return!0;if($t[this._prevType]||$t[h]&&x){this._prevType=h;const M=this._stacks.length-1,C=this._stacks[M]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(As(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[M]){const j=this.pool.getObjectForId(I.rtt[M].id);if(j.stamp===I.rtt[M].stamp){this.pool.useObject(j);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),I.rtt[M]={id:k.id,stamp:k.stamp},m.context.bindFramebuffer.set(k.fbo.framebuffer),m.context.clear({color:u.b7.transparent,stencil:0}),m.currentStencilSource=void 0;for(let j=0;j<C.length;j++){const B=m.style._layers[C[j]],$=B.source?this._coordsAscending[B.source][I.tileID.key]:[I.tileID];m.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),m._renderTileClippingMasks(B,$,!0),m.renderLayer(m,m.style.sourceCaches[B.source],B,$,l),B.source&&(I.rttCoords[B.source]=this._coordsAscendingStr[B.source][I.tileID.key])}}return As(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),$t[h]}return!1}}const mt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},jt=oe,os={hash:!1,interactive:!0,bearingSnap:7,attributionControl:as,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Rs={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Jl{constructor(e,r,l=!1){this.mousedown=m=>{this.startMove(m,ne.mousePos(this.element,m)),ne.addEventListener(window,"mousemove",this.mousemove),ne.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,ne.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHanlder.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ne.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),ne.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=ne.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const h=new Ql;this._rotatePitchHanlder=new Zr({clickTolerance:3,move:(m,x)=>{const M=r.getBoundingClientRect(),C=new u.P((M.bottom-M.top)/2,(M.right-M.left)/2);return{bearingDelta:u.ce(new u.P(m.x,x.y),x,C),pitchDelta:l?-.5*(x.y-m.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=e,ne.addEventListener(r,"mousedown",this.mousedown),ne.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),ne.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),ne.disableDrag()}move(e,r){const l=this.map,{bearingDelta:h,pitchDelta:m}=this._rotatePitchHanlder.dragMove(e,r)||{};h&&l.setBearing(l.getBearing()+h),m&&l.setPitch(l.getPitch()+m)}off(){const e=this.element;ne.removeEventListener(e,"mousedown",this.mousedown),ne.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ne.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.removeEventListener(window,"touchend",this.touchend),ne.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ne.enableDrag(),ne.removeEventListener(window,"mousemove",this.mousemove),ne.removeEventListener(window,"mouseup",this.mouseup),ne.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.removeEventListener(window,"touchend",this.touchend)}}let ur;function yo(f,e,r,l=!1){if(l||!r.getCoveringTilesDetailsProvider().allowWorldCopies())return f==null?void 0:f.wrap();const h=new u.Q(f.lng,f.lat);if(f=new u.Q(f.lng,f.lat),e){const m=new u.Q(f.lng-360,f.lat),x=new u.Q(f.lng+360,f.lat),M=r.locationToScreenPoint(f).distSqr(e);r.locationToScreenPoint(m).distSqr(e)<M?f=m:r.locationToScreenPoint(x).distSqr(e)<M&&(f=x)}for(;Math.abs(f.lng-r.center.lng)>180;){const m=r.locationToScreenPoint(f);if(m.x>=0&&m.y>=0&&m.x<=r.width&&m.y<=r.height)break;f.lng>r.center.lng?f.lng-=360:f.lng+=360}return f.lng!==h.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(f))?f:h}const xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Cr(f,e,r){const l=f.classList;for(const h in xa)l.remove(`maplibregl-${r}-anchor-${h}`);l.add(`maplibregl-${r}-anchor-${e}`)}class ks extends u.E{constructor(e){if(super(),this._onKeyPress=r=>{const l=r.code,h=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=r=>{const l=r.originalEvent.target,h=this._element;this._popup&&(l===h||h.contains(l))&&this.togglePopup()},this._update=r=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=yo(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(h=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),ne.setTransform(this._element,`${xa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${h}`),Ee.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.l("dragstart"))),this.fire(new u.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=u.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ne.create("div");const r=ne.createNS("http://www.w3.org/2000/svg","svg"),l=41,h=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${l}px`),r.setAttributeNS(null,"width",`${h}px`),r.setAttributeNS(null,"viewBox",`0 0 ${h} ${l}`);const m=ne.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const x=ne.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const M=ne.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ae of C){const ce=ne.createNS("http://www.w3.org/2000/svg","ellipse");ce.setAttributeNS(null,"opacity","0.04"),ce.setAttributeNS(null,"cx","10.5"),ce.setAttributeNS(null,"cy","5.80029008"),ce.setAttributeNS(null,"rx",ae.rx),ce.setAttributeNS(null,"ry",ae.ry),M.appendChild(ce)}const I=ne.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill",this._color);const k=ne.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),I.appendChild(k);const j=ne.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const B=ne.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(B);const $=ne.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const G=ne.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const re=ne.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#000000"),re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962");const ie=ne.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),G.appendChild(re),G.appendChild(ie),x.appendChild(M),x.appendChild(I),x.appendChild(j),x.appendChild($),x.appendChild(G),r.appendChild(x),r.setAttributeNS(null,"height",l*this._scale+"px"),r.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(r),this._offset=u.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Cr(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ne.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=u.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,l;const h=(r=this._map)===null||r===void 0?void 0:r.terrain,m=this._map.transform.isLocationOccluded(this._lngLat);if(!h||m){const $=m?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==$&&(this._element.style.opacity=$))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const x=this._map,M=x.terrain.depthAtPoint(this._pos),C=x.terrain.getElevationForLngLatZoom(this._lngLat,x.transform.tileZoom);if(x.transform.lngLatToCameraDepth(this._lngLat,C)-M<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/x.transform.pixelsPerMeter,k=Math.sin(x.getPitch()*Math.PI/180)*I,j=x.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),B=x.transform.lngLatToCameraDepth(this._lngLat,C+k)-j>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=u.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const ir={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let rr=0,ol=!1;const $c={maxWidth:100,unit:"metric"};function ll(f,e,r){const l=r&&r.maxWidth||100,h=f._container.clientHeight/2,m=f._container.clientWidth/2,x=f.unproject([m-l/2,h]),M=f.unproject([m+l/2,h]),C=Math.round(f.project(M).x-f.project(x).x),I=Math.min(l,C,f._container.clientWidth),k=x.distanceTo(M);if(r&&r.unit==="imperial"){const j=3.2808*k;j>5280?Ls(e,I,j/5280,f._getUIString("ScaleControl.Miles")):Ls(e,I,j,f._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?Ls(e,I,k/1852,f._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Ls(e,I,k/1e3,f._getUIString("ScaleControl.Kilometers")):Ls(e,I,k,f._getUIString("ScaleControl.Meters"))}function Ls(f,e,r,l){const h=function(m){const x=Math.pow(10,`${Math.floor(m)}`.length-1);let M=m/x;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(C){const I=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*I)/I}(M),x*M}(r);f.style.width=e*(h/r)+"px",f.innerHTML=`${h}&nbsp;${l}`}const Gc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},xn=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function nr(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,f),"top-left":new u.P(e,e),"top-right":new u.P(-e,e),bottom:new u.P(0,-f),"bottom-left":new u.P(e,-e),"bottom-right":new u.P(-e,-e),left:new u.P(f,0),right:new u.P(-f,0)}}if(f instanceof u.P||Array.isArray(f)){const e=u.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:u.P.convert(f.center||[0,0]),top:u.P.convert(f.top||[0,0]),"top-left":u.P.convert(f["top-left"]||[0,0]),"top-right":u.P.convert(f["top-right"]||[0,0]),bottom:u.P.convert(f.bottom||[0,0]),"bottom-left":u.P.convert(f["bottom-left"]||[0,0]),"bottom-right":u.P.convert(f["bottom-right"]||[0,0]),left:u.P.convert(f.left||[0,0]),right:u.P.convert(f.right||[0,0])}}return nr(new u.P(0,0))}const Hc=oe;z.AJAXError=u.cq,z.Event=u.l,z.Evented=u.E,z.LngLat=u.Q,z.MercatorCoordinate=u.$,z.Point=u.P,z.addProtocol=u.cr,z.config=u.a,z.removeProtocol=u.cs,z.AttributionControl=Gi,z.BoxZoomHandler=Zh,z.CanvasSource=Io,z.CooperativeGesturesHandler=Oa,z.DoubleClickZoomHandler=Vc,z.DragPanHandler=Vu,z.DragRotateHandler=Zu,z.EdgeInsets=Bo,z.FullscreenControl=class extends u.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ne.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=ne.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ne.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},z.GeoJSONSource=Ml,z.GeolocateControl=class extends u.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new u.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new u.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,h=this._map.getBearing(),m=u.e({bearing:h},this.options.fitBoundsOptions),x=Ri.fromLngLat(r,l);this._map.fitBounds(x,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new u.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ol)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=ne.create("button","maplibregl-ctrl-geolocate",this._container),ne.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ks({element:this._dotElement}),this._circleElement=ne.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ks({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.l("trackuserlocationend")),this.fire(new u.l("userlocationlostfocus")))})}},this.options=u.e({},ir,f)}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(e=!1){if(ur!==void 0&&!e)return ur;if(window.navigator.permissions===void 0)return ur=!!window.navigator.geolocation,ur;try{ur=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ur=!!window.navigator.geolocation}return ur})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ne.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,rr=0,ol=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),r=f.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),r=f.getNorthEast(),l=e.distanceTo(r),h=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":rr--,ol=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.l("trackuserlocationstart")),this.fire(new u.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),rr++,rr>1?(f={maximumAge:6e5,timeout:0},ol=!0):(f=this.options.positionOptions,ol=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},z.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ne.create("button","maplibregl-ctrl-globe",this._container),ne.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},z.Hash=Ou,z.ImageSource=Fn,z.KeyboardHandler=sl,z.LngLatBounds=Ri,z.LogoControl=ss,z.Map=class extends qc{constructor(f){var e,r;u.cn.mark(u.co.create);const l=Object.assign(Object.assign(Object.assign({},os),f),{canvasContextAttributes:Object.assign(Object.assign({},os.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new Ha,m=new ma;if(l.minZoom!==void 0&&h.setMinZoom(l.minZoom),l.maxZoom!==void 0&&h.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&h.setMinPitch(l.minPitch),l.maxPitch!==void 0&&h.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&h.setRenderWorldCopies(l.renderWorldCopies),super(h,m,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Wl,this._controls=[],this._mapId=u.a4(),this._contextLost=M=>{M.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.l("webglcontextlost",{originalEvent:M}))},this._contextRestored=M=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.l("webglcontextrestored",{originalEvent:M}))},this._onMapScroll=M=>{if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},mt),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=qt.addThrottleControl(()=>this.isMoving()),this._requestManager=new xt(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let M=!1;const C=zs(I=>{this._trackResize&&!this._removed&&(this.resize(I),this.redraw())},50);this._resizeObserver=new ResizeObserver(I=>{M?C(I):M=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Zc(this,l),this._hash=l.hash&&new Ou(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,u.e({},l.fitBoundsOptions,{duration:0}))));const x=typeof l.style=="string"||((r=(e=l.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Gi(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new ss,l.logoPosition),this.on("style.load",()=>{if(x||this._resizeTransform(),this.transform.unmodified){const M=u.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(M)}}),this.on("data",M=>{this._update(M.dataType==="style"),this.fire(new u.l(`${M.dataType}data`,M))}),this.on("dataloading",M=>{this.fire(new u.l(`${M.dataType}dataloading`,M))}),this.on("dataabort",M=>{this.fire(new u.l("sourcedataabort",M))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new u.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new u.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,r,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,r,l)}resize(f,e=!0){const[r,l]=this._containerDimensions(),h=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,h),this.painter.resize(r,l,h),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const M=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,M),this.painter.resize(r,l,M)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new u.l("movestart",f)).fire(new u.l("move",f))),this.fire(new u.l("resize",f)),m&&this.fire(new u.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[r,l]=this._containerDimensions();this.transform.resize(r,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,l,f)}_getClampedPixelRatio(f,e){const{0:r,1:l}=this._maxCanvasSize,h=this.getPixelRatio(),m=f*h,x=e*h;return Math.min(m>r?r/m:1,x>l?l/x:1)*h}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(Ri.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(u.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(u.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,r){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:m=>{const x=e.filter(C=>this.getLayer(C)),M=x.length!==0?this.queryRenderedFeatures(m.point,{layers:x}):[];M.length?l||(l=!0,r.call(this,new Er(f,this,m.originalEvent,{features:M}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:x=>{const M=e.filter(C=>this.getLayer(C));(M.length!==0?this.queryRenderedFeatures(x.point,{layers:M}):[]).length?l=!0:l&&(l=!1,r.call(this,new Er(f,this,x.originalEvent)))},mouseout:x=>{l&&(l=!1,r.call(this,new Er(f,this,x.originalEvent)))}}}}{const l=h=>{const m=e.filter(M=>this.getLayer(M)),x=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];x.length&&(h.features=x,r.call(this,h),delete h.features)};return{layers:e,listener:r,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,r){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let h=0;h<l.length;h++){const m=l[h];if(m.listener===r&&m.layers.length===e.length&&m.layers.every(x=>e.includes(x))){for(const x in m.delegates)this.off(x,m.delegates[x]);return void l.splice(h,1)}}}on(f,e,r){if(r===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(f,l,r);this._saveDelegatedListener(f,h);for(const m in h.delegates)this.on(m,h.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,r)}}}once(f,e,r){if(r===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(f,l,r);for(const m in h.delegates){const x=h.delegates[m];h.delegates[m]=(...M)=>{this._removeDelegatedListener(f,l,r),x(...M)}}this._saveDelegatedListener(f,h);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(f,e,r){return r===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let r;const l=f instanceof u.P||Array.isArray(f),h=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},h instanceof u.P||typeof h[0]=="number")r=[u.P.convert(h)];else{const m=u.P.convert(h[0]),x=u.P.convert(h[1]);r=[m,new u.P(x.x,m.y),x,new u.P(m.x,x.y),m]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var r,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const h=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Ah(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,h):this.style.loadJSON(f,e,h),this):((l=(r=this.style)===null||r===void 0?void 0:r.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ah(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const r=this._requestManager.transformRequest(f,"Style");u.j(r,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new u.k(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(r){u.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new u.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const l=this.style._layers[r];l.type==="hillshade"&&l.source===f.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new $u(this.painter,e,f),this.painter.renderToTexture=new zi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{var l;r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=r.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new u.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const r=f[e]._tiles;for(const l in r){const h=r[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}setSourceTileLodParams(f,e,r){if(r){const l=this.getSource(r);if(!l)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);l.calculateTileZoom=be(Math.max(1,f),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=be(Math.max(1,f),Math.max(1,e));return this._update(!0),this}refreshTiles(f,e){const r=this.style.sourceCaches[f];if(!r)throw new Error(`There is no source cache with ID "${f}", cannot refresh tile`);e===void 0?r.reload():r.refreshTiles(e.map(l=>new u.a1(l.z,l.x,l.y)))}addImage(f,e,r={}){const{pixelRatio:l=1,sdf:h=!1,stretchX:m,stretchY:x,content:M,textFitWidth:C,textFitHeight:I}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||u.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:j,data:B}=e,$=e;return this.style.addImage(f,{data:new u.R({width:k,height:j},new Uint8Array(B)),pixelRatio:l,stretchX:m,stretchY:x,content:M,textFitWidth:C,textFitHeight:I,sdf:h,version:0,userImage:$}),$.onAdd&&$.onAdd(this,f),this}}{const{width:k,height:j,data:B}=Ee.getImageData(e);this.style.addImage(f,{data:new u.R({width:k,height:j},B),pixelRatio:l,stretchX:m,stretchY:x,content:M,textFitWidth:C,textFitHeight:I,sdf:h,version:0})}}updateImage(f,e){const r=this.style.getImage(f);if(!r)return this.fire(new u.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||u.b(e)?Ee.getImageData(e):e,{width:h,height:m,data:x}=l;if(h===void 0||m===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==r.data.width||m!==r.data.height)return this.fire(new u.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(e instanceof HTMLImageElement||u.b(e));return r.data.replace(x,M),this.style.updateImage(f,r),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new u.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return qt.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,r){return this.style.setLayerZoomRange(f,e,r),this._update(!0)}setFilter(f,e,r={}){return this.style.setFilter(f,e,r),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,r,l={}){return this.style.setPaintProperty(f,e,r,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,r,l={}){return this.style.setLayoutProperty(f,e,r,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,r,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,r=>{r||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=ne.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ne.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),l=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],l);const h=this._controlContainer=ne.create("div","maplibregl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{m[x]=ne.create("div",`maplibregl-ctrl-${x} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,r){this._canvas.width=Math.floor(r*f),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!r){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new nl(r,this.transform),Pe.testSupport(r)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new u.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,r,l,h,m;const x=this._idleTriggered?this._fadeDuration:0,M=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,B=Ee.now();this.style.zoomHistory.update(j,B);const $=new u.C(j,{now:B,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),G=$.crossFadingFactor();G===1&&G===this._crossFadingFactor||(C=!0,this._crossFadingFactor=G),this.style.update($)}const I=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==M;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||I)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,I),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new u.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.cn.mark(u.co.load),this.fire(new u.l("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,u.cn.mark(u.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),qt.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ne.remove(this._canvasContainer),ne.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),u.cn.clearMetrics(),this._removed=!0,this.fire(new u.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Ee.frame(this._frameRequest,f=>{u.cn.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!u.cp(e)&&!function(r){return r.message===kc}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return jt}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},z.MapMouseEvent=Er,z.MapTouchEvent=ba,z.MapWheelEvent=rn,z.Marker=ks,z.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const l=this._map._getUIString(`NavigationControl.${r}`);e.title=l,e.setAttribute("aria-label",l)},this.options=u.e({},Rs,f),this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),ne.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),ne.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=ne.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Jl(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ne.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const r=ne.create("button",f,this._container);return r.type="button",r.addEventListener("click",e),r}},z.Popup=class extends u.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&ne.remove(this._content),this._container&&(ne.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ne.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ne.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=yo(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const r=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const h=nr(this.options.offset);if(!l){const x=this._container.offsetWidth,M=this._container.offsetHeight;let C;C=r.y+h.bottom.y<M?["top"]:r.y>this._map.transform.height-M?["bottom"]:[],r.x<x/2?C.push("left"):r.x>this._map.transform.width-x/2&&C.push("right"),l=C.length===0?"bottom":C.join("-")}let m=r.add(h[l]);this.options.subpixelPositioning||(m=m.round()),ne.setTransform(this._container,`${xa[l]} translate(${m.x}px,${m.y}px)`),Cr(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(Gc),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=u.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),r=document.createElement("body");let l;for(r.innerHTML=f;l=r.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ne.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=ne.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(xn);f&&f.focus()}},z.RasterDEMTileSource=wc,z.RasterTileSource=Rr,z.ScaleControl=class{constructor(f){this._onMove=()=>{ll(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ll(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},$c),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ne.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},z.ScrollZoomHandler=ii,z.Style=Ah,z.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ne.create("button","maplibregl-ctrl-terrain",this._container),ne.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ne.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},z.TwoFingersTouchPitchHandler=al,z.TwoFingersTouchRotateHandler=yt,z.TwoFingersTouchZoomHandler=Is,z.TwoFingersTouchZoomRotateHandler=ns,z.VectorTileSource=Ks,z.VideoSource=Qn,z.addSourceType=(f,e)=>u._(void 0,void 0,void 0,function*(){if(bs(f))throw new Error(`A source type called "${f}" already exists.`);((r,l)=>{Ws[r]=l})(f,e)}),z.clearPrewarmedResources=function(){const f=vt;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Ke),vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},z.createTileMesh=Ec,z.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},z.getRTLTextPluginStatus=function(){return mn().getRTLTextPluginStatus()},z.getVersion=function(){return Hc},z.getWorkerCount=function(){return lt.workerCount},z.getWorkerUrl=function(){return u.a.WORKER_URL},z.importScriptInWorkers=function(f){return li().broadcast("IS",f)},z.prewarm=function(){It().acquire(Ke)},z.setMaxParallelImageRequests=function(f){u.a.MAX_PARALLEL_IMAGE_REQUESTS=f},z.setRTLTextPlugin=function(f,e){return mn().setRTLTextPlugin(f,e)},z.setWorkerCount=function(f){lt.workerCount=f},z.setWorkerUrl=function(f){u.a.WORKER_URL=f}});var F=b;return F})}(Ym)),Ym.exports}C1();var Qs=Uint8Array,Lf=Uint16Array,A1=Int32Array,Rv=new Qs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kv=new Qs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),z1=new Qs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Lv=function(v,y){for(var b=new Lf(31),T=0;T<31;++T)b[T]=y+=1<<v[T-1];for(var R=new A1(b[30]),T=1;T<30;++T)for(var F=b[T];F<b[T+1];++F)R[F]=F-b[T]<<5|T;return{b,r:R}},Ov=Lv(Rv,2),Bv=Ov.b,P1=Ov.r;Bv[28]=258,P1[258]=28;var I1=Lv(kv,0),D1=I1.b,Gg=new Lf(32768);for(var Nr=0;Nr<32768;++Nr){var gh=(Nr&43690)>>1|(Nr&21845)<<1;gh=(gh&52428)>>2|(gh&13107)<<2,gh=(gh&61680)>>4|(gh&3855)<<4,Gg[Nr]=((gh&65280)>>8|(gh&255)<<8)>>1}var Gp=function(v,y,b){for(var T=v.length,R=0,F=new Lf(y);R<T;++R)v[R]&&++F[v[R]-1];var z=new Lf(y);for(R=1;R<y;++R)z[R]=z[R-1]+F[R-1]<<1;var u;if(b){u=new Lf(1<<y);var oe=15-y;for(R=0;R<T;++R)if(v[R])for(var Q=R<<4|v[R],ve=y-v[R],Te=z[v[R]-1]++<<ve,Ee=Te|(1<<ve)-1;Te<=Ee;++Te)u[Gg[Te]>>oe]=Q}else for(u=new Lf(T),R=0;R<T;++R)v[R]&&(u[R]=Gg[z[v[R]-1]++]>>15-v[R]);return u},dm=new Qs(288);for(var Nr=0;Nr<144;++Nr)dm[Nr]=8;for(var Nr=144;Nr<256;++Nr)dm[Nr]=9;for(var Nr=256;Nr<280;++Nr)dm[Nr]=7;for(var Nr=280;Nr<288;++Nr)dm[Nr]=8;var jv=new Qs(32);for(var Nr=0;Nr<32;++Nr)jv[Nr]=5;var R1=Gp(dm,9,1),k1=Gp(jv,5,1),jg=function(v){for(var y=v[0],b=1;b<v.length;++b)v[b]>y&&(y=v[b]);return y},wl=function(v,y,b){var T=y/8|0;return(v[T]|v[T+1]<<8)>>(y&7)&b},Fg=function(v,y){var b=y/8|0;return(v[b]|v[b+1]<<8|v[b+2]<<16)>>(y&7)},L1=function(v){return(v+7)/8|0},O1=function(v,y,b){return(b==null||b>v.length)&&(b=v.length),new Qs(v.subarray(y,b))},B1=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ys=function(v,y,b){var T=new Error(y||B1[v]);if(T.code=v,Error.captureStackTrace&&Error.captureStackTrace(T,Ys),!b)throw T;return T},l_=function(v,y,b,T){var R=v.length,F=0;if(!R||y.f&&!y.l)return b||new Qs(0);var z=!b,u=z||y.i!=2,oe=y.i;z&&(b=new Qs(R*3));var Q=function(Bi){var cr=b.length;if(Bi>cr){var tr=new Qs(Math.max(cr*2,Bi));tr.set(b),b=tr}},ve=y.f||0,Te=y.p||0,Ee=y.b||0,ne=y.l,Pe=y.d,Ze=y.m,bt=y.n,Vt=R*8;do{if(!ne){ve=wl(v,Te,1);var Ot=wl(v,Te+1,3);if(Te+=3,Ot)if(Ot==1)ne=R1,Pe=k1,Ze=9,bt=5;else if(Ot==2){var Bt=wl(v,Te,31)+257,Pi=wl(v,Te+10,15)+4,ti=Bt+wl(v,Te+5,31)+1;Te+=14;for(var Oi=new Qs(ti),Mi=new Qs(19),Ut=0;Ut<Pi;++Ut)Mi[z1[Ut]]=wl(v,Te+Ut*3,7);Te+=Pi*3;for(var wi=jg(Mi),xr=(1<<wi)-1,Et=Gp(Mi,wi,1),Ut=0;Ut<ti;){var pt=Et[wl(v,Te,xr)];Te+=pt&15;var Tt=pt>>4;if(Tt<16)Oi[Ut++]=Tt;else{var we=0,We=0;for(Tt==16?(We=3+wl(v,Te,3),Te+=2,we=Oi[Ut-1]):Tt==17?(We=3+wl(v,Te,7),Te+=3):Tt==18&&(We=11+wl(v,Te,127),Te+=7);We--;)Oi[Ut++]=we}}var Ge=Oi.subarray(0,Bt),gt=Oi.subarray(Bt);Ze=jg(Ge),bt=jg(gt),ne=Gp(Ge,Ze,1),Pe=Gp(gt,bt,1)}else Ys(1);else{var Tt=L1(Te)+4,qt=v[Tt-4]|v[Tt-3]<<8,xt=Tt+qt;if(xt>R){oe&&Ys(0);break}u&&Q(Ee+qt),b.set(v.subarray(Tt,xt),Ee),y.b=Ee+=qt,y.p=Te=xt*8,y.f=ve;continue}if(Te>Vt){oe&&Ys(0);break}}u&&Q(Ee+131072);for(var ue=(1<<Ze)-1,Ke=(1<<bt)-1,lt=Te;;lt=Te){var we=ne[Fg(v,Te)&ue],ut=we>>4;if(Te+=we&15,Te>Vt){oe&&Ys(0);break}if(we||Ys(2),ut<256)b[Ee++]=ut;else if(ut==256){lt=Te,ne=null;break}else{var vt=ut-254;if(ut>264){var Ut=ut-257,Ct=Rv[Ut];vt=wl(v,Te,(1<<Ct)-1)+Bv[Ut],Te+=Ct}var It=Pe[Fg(v,Te)&Ke],di=It>>4;It||Ys(3),Te+=It&15;var gt=D1[di];if(di>3){var Ct=kv[di];gt+=Fg(v,Te)&(1<<Ct)-1,Te+=Ct}if(Te>Vt){oe&&Ys(0);break}u&&Q(Ee+131072);var li=Ee+vt;if(Ee<gt){var er=F-gt,lr=Math.min(gt,li);for(er+Ee<0&&Ys(3);Ee<lr;++Ee)b[Ee]=T[er+Ee]}for(;Ee<li;++Ee)b[Ee]=b[Ee-gt]}}y.l=ne,y.p=lt,y.b=Ee,y.f=ve,ne&&(ve=1,y.m=Ze,y.d=Pe,y.n=bt)}while(!ve);return Ee!=b.length&&z?O1(b,0,Ee):b.subarray(0,Ee)},j1=new Qs(0),F1=function(v){(v[0]!=31||v[1]!=139||v[2]!=8)&&Ys(6,"invalid gzip data");var y=v[3],b=10;y&4&&(b+=(v[10]|v[11]<<8)+2);for(var T=(y>>3&1)+(y>>4&1);T>0;T-=!v[b++]);return b+(y&2)},U1=function(v){var y=v.length;return(v[y-4]|v[y-3]<<8|v[y-2]<<16|v[y-1]<<24)>>>0},N1=function(v,y){return((v[0]&15)!=8||v[0]>>4>7||(v[0]<<8|v[1])%31)&&Ys(6,"invalid zlib data"),(v[1]>>5&1)==1&&Ys(6,"invalid zlib data: "+(v[1]&32?"need":"unexpected")+" dictionary"),(v[1]>>3&4)+2};function V1(v,y){return l_(v,{i:2},y,y)}function Z1(v,y){var b=F1(v);return b+8>v.length&&Ys(6,"invalid gzip data"),l_(v.subarray(b,-8),{i:2},new Qs(U1(v)),y)}function q1(v,y){return l_(v.subarray(N1(v),-4),{i:2},y,y)}function $1(v,y){return v[0]==31&&v[1]==139&&v[2]==8?Z1(v,y):(v[0]&15)!=8||v[0]>>4>7||(v[0]<<8|v[1])%31?V1(v,y):q1(v,y)}var G1=typeof TextDecoder<"u"&&new TextDecoder,H1=0;try{G1.decode(j1,{stream:!0}),H1=1}catch{}var X1=Object.defineProperty,Hp=Math.pow,pr=(v,y)=>X1(v,"name",{value:y,configurable:!0}),Yn=(v,y,b)=>new Promise((T,R)=>{var F=oe=>{try{u(b.next(oe))}catch(Q){R(Q)}},z=oe=>{try{u(b.throw(oe))}catch(Q){R(Q)}},u=oe=>oe.done?T(oe.value):Promise.resolve(oe.value).then(F,z);u((b=b.apply(v,y)).next())});pr((v,y)=>{let b=!1,T="",R=L.GridLayer.extend({createTile:pr((F,z)=>{let u=document.createElement("img"),oe=new AbortController,Q=oe.signal;return u.cancel=()=>{oe.abort()},b||(v.getHeader().then(ve=>{ve.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):ve.tileType===2?T="image/png":ve.tileType===3?T="image/jpeg":ve.tileType===4?T="image/webp":ve.tileType===5&&(T="image/avif")}),b=!0),v.getZxy(F.z,F.x,F.y,Q).then(ve=>{if(ve){let Te=new Blob([ve.data],{type:T}),Ee=window.URL.createObjectURL(Te);u.src=Ee,u.cancel=void 0,z(void 0,u)}}).catch(ve=>{if(ve.name!=="AbortError")throw ve}),u},"createTile"),_removeTile:pr(function(F){let z=this._tiles[F];z&&(z.el.cancel&&z.el.cancel(),z.el.width=0,z.el.height=0,z.el.deleted=!0,L.DomUtil.remove(z.el),delete this._tiles[F],this.fire("tileunload",{tile:z.el,coords:this._keyToTileCoords(F)}))},"_removeTile")});return new R(y)},"leafletRasterLayer");var Y1=pr(v=>(y,b)=>{if(b instanceof AbortController)return v(y,b);let T=new AbortController;return v(y,T).then(R=>b(void 0,R.data,R.cacheControl||"",R.expires||""),R=>b(R)).catch(R=>b(R)),{cancel:pr(()=>T.abort(),"cancel")}},"v3compat"),Q1=class{constructor(y){this.tilev4=pr((b,T)=>Yn(this,null,function*(){if(b.type==="json"){let ne=b.url.substr(10),Pe=this.tiles.get(ne);if(Pe||(Pe=new ly(ne),this.tiles.set(ne,Pe)),this.metadata)return{data:yield Pe.getTileJson(b.url)};let Ze=yield Pe.getHeader();return(Ze.minLon>=Ze.maxLon||Ze.minLat>=Ze.maxLat)&&console.error(`Bounds of PMTiles archive ${Ze.minLon},${Ze.minLat},${Ze.maxLon},${Ze.maxLat} are not valid.`),{data:{tiles:[`${b.url}/{z}/{x}/{y}`],minzoom:Ze.minZoom,maxzoom:Ze.maxZoom,bounds:[Ze.minLon,Ze.minLat,Ze.maxLon,Ze.maxLat]}}}let R=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),F=b.url.match(R);if(!F)throw new Error("Invalid PMTiles protocol URL");let z=F[1],u=this.tiles.get(z);u||(u=new ly(z),this.tiles.set(z,u));let oe=F[2],Q=F[3],ve=F[4],Te=yield u.getHeader(),Ee=yield u==null?void 0:u.getZxy(+oe,+Q,+ve,T.signal);if(Ee)return{data:new Uint8Array(Ee.data),cacheControl:Ee.cacheControl,expires:Ee.expires};if(Te.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=Y1(this.tilev4),this.tiles=new Map,this.metadata=(y==null?void 0:y.metadata)||!1,this.errorOnMissingTile=(y==null?void 0:y.errorOnMissingTile)||!1}add(y){this.tiles.set(y.source.getKey(),y)}get(y){return this.tiles.get(y)}};pr(Q1,"Protocol");function Fv(v,y){return(y>>>0)*4294967296+(v>>>0)}pr(Fv,"toNum");function Uv(v,y){let b=y.buf,T=b[y.pos++],R=(T&112)>>4;if(T<128||(T=b[y.pos++],R|=(T&127)<<3,T<128)||(T=b[y.pos++],R|=(T&127)<<10,T<128)||(T=b[y.pos++],R|=(T&127)<<17,T<128)||(T=b[y.pos++],R|=(T&127)<<24,T<128)||(T=b[y.pos++],R|=(T&1)<<31,T<128))return Fv(v,R);throw new Error("Expected varint not more than 10 bytes")}pr(Uv,"readVarintRemainder");function kf(v){let y=v.buf,b=y[v.pos++],T=b&127;return b<128||(b=y[v.pos++],T|=(b&127)<<7,b<128)||(b=y[v.pos++],T|=(b&127)<<14,b<128)||(b=y[v.pos++],T|=(b&127)<<21,b<128)?T:(b=y[v.pos],T|=(b&15)<<28,Uv(T,v))}pr(kf,"readVarint");function c_(v,y,b,T){if(T===0){b===1&&(y[0]=v-1-y[0],y[1]=v-1-y[1]);let R=y[0];y[0]=y[1],y[1]=R}}pr(c_,"rotate");function Nv(v,y){let b=Hp(2,v),T=y,R=y,F=y,z=[0,0],u=1;for(;u<b;)T=1&F/2,R=1&(F^T),c_(u,z,T,R),z[0]+=u*T,z[1]+=u*R,F=F/4,u*=2;return[v,z[0],z[1]]}pr(Nv,"idOnLevel");var K1=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Vv(v,y,b){if(v>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(y>Hp(2,v)-1||b>Hp(2,v)-1)throw new Error("tile x/y outside zoom level bounds");let T=K1[v],R=Hp(2,v),F=0,z=0,u=0,oe=[y,b],Q=R/2;for(;Q>0;)F=(oe[0]&Q)>0?1:0,z=(oe[1]&Q)>0?1:0,u+=Q*Q*(3*F^z),c_(Q,oe,F,z),Q=Q/2;return T+u}pr(Vv,"zxyToTileId");function W1(v){let y=0;for(let b=0;b<27;b++){let T=(1<<b)*(1<<b);if(y+T>v)return Nv(b,v-y);y+=T}throw new Error("Tile zoom level exceeds max safe number limit (26)")}pr(W1,"tileIdToZxy");var J1=(v=>(v[v.Unknown=0]="Unknown",v[v.None=1]="None",v[v.Gzip=2]="Gzip",v[v.Brotli=3]="Brotli",v[v.Zstd=4]="Zstd",v))(J1||{});function dg(v,y){return Yn(this,null,function*(){if(y===1||y===0)return v;if(y===2){if(typeof globalThis.DecompressionStream>"u")return $1(new Uint8Array(v));let b=new Response(v).body;if(!b)throw new Error("Failed to read response stream");let T=b.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(T).arrayBuffer()}throw new Error("Compression method not supported")})}pr(dg,"defaultDecompress");var ew=(v=>(v[v.Unknown=0]="Unknown",v[v.Mvt=1]="Mvt",v[v.Png=2]="Png",v[v.Jpeg=3]="Jpeg",v[v.Webp=4]="Webp",v[v.Avif=5]="Avif",v))(ew||{});function Zv(v){return v===1?".mvt":v===2?".png":v===3?".jpg":v===4?".webp":v===5?".avif":""}pr(Zv,"tileTypeExt");var tw=127;function qv(v,y){let b=0,T=v.length-1;for(;b<=T;){let R=T+b>>1,F=y-v[R].tileId;if(F>0)b=R+1;else if(F<0)T=R-1;else return v[R]}return T>=0&&(v[T].runLength===0||y-v[T].tileId<v[T].runLength)?v[T]:null}pr(qv,"findTile");var iw=class{constructor(y){this.file=y}getKey(){return this.file.name}getBytes(y,b){return Yn(this,null,function*(){return{data:yield this.file.slice(y,y+b).arrayBuffer()}})}};pr(iw,"FileSource");var $v=class{constructor(y,b=new Headers){this.url=y,this.customHeaders=b,this.mustReload=!1;let T="";"navigator"in globalThis&&(T=globalThis.navigator.userAgent||"");let R=T.indexOf("Windows")>-1,F=/Chrome|Chromium|Edg|OPR|Brave/.test(T);this.chromeWindowsNoCache=!1,R&&F&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(y){this.customHeaders=y}getBytes(y,b,T,R){return Yn(this,null,function*(){let F,z;T?z=T:(F=new AbortController,z=F.signal);let u=new Headers(this.customHeaders);u.set("range",`bytes=${y}-${y+b-1}`);let oe;this.mustReload?oe="reload":this.chromeWindowsNoCache&&(oe="no-store");let Q=yield fetch(this.url,{signal:z,cache:oe,headers:u});if(y===0&&Q.status===416){let Ee=Q.headers.get("Content-Range");if(!Ee||!Ee.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let ne=+Ee.substr(8);Q=yield fetch(this.url,{signal:z,cache:"reload",headers:{range:`bytes=0-${ne-1}`}})}let ve=Q.headers.get("Etag");if(ve!=null&&ve.startsWith("W/")&&(ve=null),Q.status===416||R&&ve&&ve!==R)throw this.mustReload=!0,new Hg(`Server returned non-matching ETag ${R} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(Q.status>=300)throw new Error(`Bad response code: ${Q.status}`);let Te=Q.headers.get("Content-Length");if(Q.status===200&&(!Te||+Te>b))throw F&&F.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield Q.arrayBuffer(),etag:ve||void 0,cacheControl:Q.headers.get("Cache-Control")||void 0,expires:Q.headers.get("Expires")||void 0}})}};pr($v,"FetchSource");var rw=$v;function Ao(v,y){let b=v.getUint32(y+4,!0),T=v.getUint32(y+0,!0);return b*Hp(2,32)+T}pr(Ao,"getUint64");function Gv(v,y){let b=new DataView(v),T=b.getUint8(7);if(T>3)throw new Error(`Archive is spec version ${T} but this library supports up to spec version 3`);return{specVersion:T,rootDirectoryOffset:Ao(b,8),rootDirectoryLength:Ao(b,16),jsonMetadataOffset:Ao(b,24),jsonMetadataLength:Ao(b,32),leafDirectoryOffset:Ao(b,40),leafDirectoryLength:Ao(b,48),tileDataOffset:Ao(b,56),tileDataLength:Ao(b,64),numAddressedTiles:Ao(b,72),numTileEntries:Ao(b,80),numTileContents:Ao(b,88),clustered:b.getUint8(96)===1,internalCompression:b.getUint8(97),tileCompression:b.getUint8(98),tileType:b.getUint8(99),minZoom:b.getUint8(100),maxZoom:b.getUint8(101),minLon:b.getInt32(102,!0)/1e7,minLat:b.getInt32(106,!0)/1e7,maxLon:b.getInt32(110,!0)/1e7,maxLat:b.getInt32(114,!0)/1e7,centerZoom:b.getUint8(118),centerLon:b.getInt32(119,!0)/1e7,centerLat:b.getInt32(123,!0)/1e7,etag:y}}pr(Gv,"bytesToHeader");function u_(v){let y={buf:new Uint8Array(v),pos:0},b=kf(y),T=[],R=0;for(let F=0;F<b;F++){let z=kf(y);T.push({tileId:R+z,offset:0,length:0,runLength:1}),R+=z}for(let F=0;F<b;F++)T[F].runLength=kf(y);for(let F=0;F<b;F++)T[F].length=kf(y);for(let F=0;F<b;F++){let z=kf(y);z===0&&F>0?T[F].offset=T[F-1].offset+T[F-1].length:T[F].offset=z-1}return T}pr(u_,"deserializeIndex");var Hv=class extends Error{};pr(Hv,"EtagMismatch");var Hg=Hv;function h_(v,y){return Yn(this,null,function*(){let b=yield v.getBytes(0,16384);if(new DataView(b.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let T=b.data.slice(0,tw),R=Gv(T,b.etag),F=b.data.slice(R.rootDirectoryOffset,R.rootDirectoryOffset+R.rootDirectoryLength),z=`${v.getKey()}|${R.etag||""}|${R.rootDirectoryOffset}|${R.rootDirectoryLength}`,u=u_(yield y(F,R.internalCompression));return[R,[z,u.length,u]]})}pr(h_,"getHeaderAndRoot");function d_(v,y,b,T,R){return Yn(this,null,function*(){let F=yield v.getBytes(b,T,void 0,R.etag),z=yield y(F.data,R.internalCompression),u=u_(z);if(u.length===0)throw new Error("Empty directory is invalid");return u})}pr(d_,"getDirectory");var nw=class{constructor(y=100,b=!0,T=dg){this.cache=new Map,this.maxCacheEntries=y,this.counter=1,this.decompress=T}getHeader(y){return Yn(this,null,function*(){let b=y.getKey(),T=this.cache.get(b);if(T)return T.lastUsed=this.counter++,T.data;let R=yield h_(y,this.decompress);return R[1]&&this.cache.set(R[1][0],{lastUsed:this.counter++,data:R[1][2]}),this.cache.set(b,{lastUsed:this.counter++,data:R[0]}),this.prune(),R[0]})}getDirectory(y,b,T,R){return Yn(this,null,function*(){let F=`${y.getKey()}|${R.etag||""}|${b}|${T}`,z=this.cache.get(F);if(z)return z.lastUsed=this.counter++,z.data;let u=yield d_(y,this.decompress,b,T,R);return this.cache.set(F,{lastUsed:this.counter++,data:u}),this.prune(),u})}prune(){if(this.cache.size>this.maxCacheEntries){let y=1/0,b;this.cache.forEach((T,R)=>{T.lastUsed<y&&(y=T.lastUsed,b=R)}),b&&this.cache.delete(b)}}invalidate(y){return Yn(this,null,function*(){this.cache.delete(y.getKey())})}};pr(nw,"ResolvedValueCache");var Xv=class{constructor(y=100,b=!0,T=dg){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=y,this.counter=1,this.decompress=T}getHeader(y){return Yn(this,null,function*(){let b=y.getKey(),T=this.cache.get(b);if(T)return T.lastUsed=this.counter++,yield T.data;let R=new Promise((F,z)=>{h_(y,this.decompress).then(u=>{u[1]&&this.cache.set(u[1][0],{lastUsed:this.counter++,data:Promise.resolve(u[1][2])}),F(u[0]),this.prune()}).catch(u=>{z(u)})});return this.cache.set(b,{lastUsed:this.counter++,data:R}),R})}getDirectory(y,b,T,R){return Yn(this,null,function*(){let F=`${y.getKey()}|${R.etag||""}|${b}|${T}`,z=this.cache.get(F);if(z)return z.lastUsed=this.counter++,yield z.data;let u=new Promise((oe,Q)=>{d_(y,this.decompress,b,T,R).then(ve=>{oe(ve),this.prune()}).catch(ve=>{Q(ve)})});return this.cache.set(F,{lastUsed:this.counter++,data:u}),u})}prune(){if(this.cache.size>=this.maxCacheEntries){let y=1/0,b;this.cache.forEach((T,R)=>{T.lastUsed<y&&(y=T.lastUsed,b=R)}),b&&this.cache.delete(b)}}invalidate(y){return Yn(this,null,function*(){let b=y.getKey();if(this.invalidations.get(b))return yield this.invalidations.get(b);this.cache.delete(y.getKey());let T=new Promise((R,F)=>{this.getHeader(y).then(z=>{R(),this.invalidations.delete(b)}).catch(z=>{F(z)})});this.invalidations.set(b,T)})}};pr(Xv,"SharedPromiseCache");var aw=Xv,Yv=class{constructor(y,b,T){typeof y=="string"?this.source=new rw(y):this.source=y,T?this.decompress=T:this.decompress=dg,b?this.cache=b:this.cache=new aw}getHeader(){return Yn(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(y,b,T,R){return Yn(this,null,function*(){let F=Vv(y,b,T),z=yield this.cache.getHeader(this.source);if(y<z.minZoom||y>z.maxZoom)return;let u=z.rootDirectoryOffset,oe=z.rootDirectoryLength;for(let Q=0;Q<=3;Q++){let ve=yield this.cache.getDirectory(this.source,u,oe,z),Te=qv(ve,F);if(Te){if(Te.runLength>0){let Ee=yield this.source.getBytes(z.tileDataOffset+Te.offset,Te.length,R,z.etag);return{data:yield this.decompress(Ee.data,z.tileCompression),cacheControl:Ee.cacheControl,expires:Ee.expires}}u=z.leafDirectoryOffset+Te.offset,oe=Te.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(y,b,T,R){return Yn(this,null,function*(){try{return yield this.getZxyAttempt(y,b,T,R)}catch(F){if(F instanceof Hg)return this.cache.invalidate(this.source),yield this.getZxyAttempt(y,b,T,R);throw F}})}getMetadataAttempt(){return Yn(this,null,function*(){let y=yield this.cache.getHeader(this.source),b=yield this.source.getBytes(y.jsonMetadataOffset,y.jsonMetadataLength,void 0,y.etag),T=yield this.decompress(b.data,y.internalCompression),R=new TextDecoder("utf-8");return JSON.parse(R.decode(T))})}getMetadata(){return Yn(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(y){if(y instanceof Hg)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw y}})}getTileJson(y){return Yn(this,null,function*(){let b=yield this.getHeader(),T=yield this.getMetadata(),R=Zv(b.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${y}/{z}/{x}/{y}${R}`],vector_layers:T.vector_layers,attribution:T.attribution,description:T.description,name:T.name,version:T.version,bounds:[b.minLon,b.minLat,b.maxLon,b.maxLat],center:[b.centerLon,b.centerLat,b.centerZoom],minzoom:b.minZoom,maxzoom:b.maxZoom}})}};pr(Yv,"PMTiles");var ly=Yv,sw=Object.defineProperty,xc=(v,y)=>sw(v,"name",{value:y,configurable:!0});function ms(v,y){let b="script";return v==="name"?b="script":v==="name2"?b="script2":v==="name3"&&(b="script3"),[["coalesce",["get",`pgf:${v}`],["get",v]],{"text-font":["case",["==",["get",b],"Devanagari"],["literal",["Noto Sans Devanagari Regular v1"]],["literal",[y||"Noto Sans Regular"]]]}]}xc(ms,"get_name_block");function _c(v,y,b){let T="name";return b==="name"?T="":b==="name2"?T="2":b==="name3"&&(T="3"),y==="Latin"?["has",`script${T}`]:v==="ja"?["all",["!=",["get",`script${T}`],"Han"],["!=",["get",`script${T}`],"Hiragana"],["!=",["get",`script${T}`],"Katakana"],["!=",["get",`script${T}`],"Mixed-Japanese"]]:["!=",["get",`script${T}`],y]}xc(_c,"is_not_in_target_script");function Sl(v){return v==="Devanagari"?{"text-font":["literal",["Noto Sans Devanagari Regular v1"]]}:{}}xc(Sl,"get_font_formatting");function f_(v){let y=ow.find(b=>b.lang===v);return y===void 0?"Latin":y.script}xc(f_,"get_default_script");function Qv(v,y){let b=y||f_(v),T;return b==="Devanagari"?T="pgf:":T="",["format",["coalesce",["get",`${T}name:${v}`],["get","name:en"]],Sl(b)]}xc(Qv,"get_country_name");function Tl(v,y,b){let T=y||f_(v),R;return T==="Devanagari"?R="pgf:":R="",["case",["all",["any",["has","name"],["has","pgf:name"]],["!",["any",["has","name2"],["has","pgf:name2"]]],["!",["any",["has","name3"],["has","pgf:name3"]]]],["case",_c(v,T,"name"),["case",["any",["is-supported-script",["get","name"]],["has","pgf:name"]],["format",["coalesce",["get",`${R}name:${v}`],["get","name:en"]],Sl(T),`
`,{},["case",["all",["!",["has",`${R}name:${v}`]],["has","name:en"],["!",["has","script"]]],"",["coalesce",["get","pgf:name"],["get","name"]]],{"text-font":["case",["==",["get","script"],"Devanagari"],["literal",["Noto Sans Devanagari Regular v1"]],["literal",[b||"Noto Sans Regular"]]]}],["get","name:en"]],["format",["coalesce",["get",`${R}name:${v}`],["get","pgf:name"],["get","name"]],Sl(T)]],["all",["any",["has","name"],["has","pgf:name"]],["any",["has","name2"],["has","pgf:name2"]],["!",["any",["has","name3"],["has","pgf:name3"]]]],["case",["all",_c(v,T,"name"),_c(v,T,"name2")],["format",["get",`${R}name:${v}`],Sl(T),`
`,{},...ms("name",b),`
`,{},...ms("name2",b)],["case",_c(v,T,"name2"),["format",["coalesce",["get",`${R}name:${v}`],["get","pgf:name"],["get","name"]],Sl(T),`
`,{},...ms("name2",b)],["format",["coalesce",["get",`${R}name:${v}`],["get","pgf:name2"],["get","name2"]],Sl(T),`
`,{},...ms("name",b)]]],["case",["all",_c(v,T,"name"),_c(v,T,"name2"),_c(v,T,"name3")],["format",["get",`${R}name:${v}`],Sl(T),`
`,{},...ms("name",b),`
`,{},...ms("name2",b),`
`,{},...ms("name3",b)],["case",["!",_c(v,T,"name")],["format",["coalesce",["get",`${R}name:${v}`],["get","pgf:name"],["get","name"]],Sl(T),`
`,{},...ms("name2",b),`
`,{},...ms("name3",b)],["!",_c(v,T,"name2")],["format",["coalesce",["get",`${R}name:${v}`],["get","pgf:name2"],["get","name2"]],Sl(T),`
`,{},...ms("name",b),`
`,{},...ms("name3",b)],["format",["coalesce",["get",`${R}name:${v}`],["get","pgf:name3"],["get","name3"]],Sl(T),`
`,{},...ms("name",b),`
`,{},...ms("name2",b)]]]]}xc(Tl,"get_multiline_name");var ow=[{lang:"ar",full_name:"Arabic",script:"Arabic"},{lang:"cs",full_name:"Czech",script:"Latin"},{lang:"bg",full_name:"Bulgarian",script:"Cyrillic"},{lang:"da",full_name:"Danish",script:"Latin"},{lang:"de",full_name:"German",script:"Latin"},{lang:"el",full_name:"Greek",script:"Greek"},{lang:"en",full_name:"English",script:"Latin"},{lang:"es",full_name:"Spanish",script:"Latin"},{lang:"et",full_name:"Estonian",script:"Latin"},{lang:"fa",full_name:"Persian",script:"Arabic"},{lang:"fi",full_name:"Finnish",script:"Latin"},{lang:"fr",full_name:"French",script:"Latin"},{lang:"ga",full_name:"Irish",script:"Latin"},{lang:"he",full_name:"Hebrew",script:"Hebrew"},{lang:"hi",full_name:"Hindi",script:"Devanagari"},{lang:"hr",full_name:"Croatian",script:"Latin"},{lang:"hu",full_name:"Hungarian",script:"Latin"},{lang:"id",full_name:"Indonesian",script:"Latin"},{lang:"it",full_name:"Italian",script:"Latin"},{lang:"ja",full_name:"Japanese",script:""},{lang:"ko",full_name:"Korean",script:"Hangul"},{lang:"lt",full_name:"Lithuanian",script:"Latin"},{lang:"lv",full_name:"Latvian",script:"Latin"},{lang:"ne",full_name:"Nepali",script:"Devanagari"},{lang:"nl",full_name:"Dutch",script:"Latin"},{lang:"no",full_name:"Norwegian",script:"Latin"},{lang:"mr",full_name:"Marathi",script:"Devanagari"},{lang:"mt",full_name:"Maltese",script:"Latin"},{lang:"pl",full_name:"Polish",script:"Latin"},{lang:"pt",full_name:"Portuguese",script:"Latin"},{lang:"ro",full_name:"Romanian",script:"Latin"},{lang:"ru",full_name:"Russian",script:"Cyrillic"},{lang:"sk",full_name:"Slovak",script:"Latin"},{lang:"sl",full_name:"Slovenian",script:"Latin"},{lang:"sv",full_name:"Swedish",script:"Latin"},{lang:"tr",full_name:"Turkish",script:"Latin"},{lang:"uk",full_name:"Ukrainian",script:"Cyrillic"},{lang:"ur",full_name:"Urdu",script:"Arabic"},{lang:"vi",full_name:"Vietnamese",script:"Latin"},{lang:"zh-Hans",full_name:"Chinese (Simplified)",script:"Han"},{lang:"zh-Hant",full_name:"Chinese (Traditional)",script:"Han"}];function Kv(v,y){return[{id:"background",type:"background",paint:{"background-color":y.background}},{id:"earth",type:"fill",filter:["==","$type","Polygon"],source:v,"source-layer":"earth",paint:{"fill-color":y.earth}},...y.landcover?[{id:"landcover",type:"fill",source:v,"source-layer":"landcover",paint:{"fill-color":["match",["get","kind"],"grassland",y.landcover.grassland,"barren",y.landcover.barren,"urban_area",y.landcover.urban_area,"farmland",y.landcover.farmland,"glacier",y.landcover.glacier,"scrub",y.landcover.scrub,y.landcover.forest],"fill-opacity":["interpolate",["linear"],["zoom"],5,1,7,0]}}]:[],{id:"landuse_park",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course","wood","nature_reserve","forest","scrub","grassland","grass","military","naval_base","airfield"],paint:{"fill-opacity":["interpolate",["linear"],["zoom"],6,0,11,1],"fill-color":["case",["in",["get","kind"],["literal",["national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"]]],y.park_b,["in",["get","kind"],["literal",["wood","nature_reserve","forest"]]],y.wood_b,["in",["get","kind"],["literal",["scrub","grassland","grass"]]],y.scrub_b,["in",["get","kind"],["literal",["glacier"]]],y.glacier,["in",["get","kind"],["literal",["sand"]]],y.sand,["in",["get","kind"],["literal",["military","naval_base","airfield"]]],y.zoo,y.earth]}},{id:"landuse_urban_green",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","allotments","village_green","playground"],paint:{"fill-color":y.park_b,"fill-opacity":.7}},{id:"landuse_hospital",type:"fill",source:v,"source-layer":"landuse",filter:["==","kind","hospital"],paint:{"fill-color":y.hospital}},{id:"landuse_industrial",type:"fill",source:v,"source-layer":"landuse",filter:["==","kind","industrial"],paint:{"fill-color":y.industrial}},{id:"landuse_school",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","school","university","college"],paint:{"fill-color":y.school}},{id:"landuse_beach",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","beach"],paint:{"fill-color":y.beach}},{id:"landuse_zoo",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","zoo"],paint:{"fill-color":y.zoo}},{id:"landuse_aerodrome",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","aerodrome"],paint:{"fill-color":y.aerodrome}},{id:"roads_runway",type:"line",source:v,"source-layer":"roads",filter:["==","kind_detail","runway"],paint:{"line-color":y.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,12,4,18,30]}},{id:"roads_taxiway",type:"line",source:v,"source-layer":"roads",minzoom:13,filter:["==","kind_detail","taxiway"],paint:{"line-color":y.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,15,6]}},{id:"landuse_runway",type:"fill",source:v,"source-layer":"landuse",filter:["any",["in","kind","runway","taxiway"]],paint:{"fill-color":y.runway}},{id:"water",type:"fill",filter:["==","$type","Polygon"],source:v,"source-layer":"water",paint:{"fill-color":y.water}},{id:"water_stream",type:"line",source:v,"source-layer":"water",minzoom:14,filter:["in","kind","stream"],paint:{"line-color":y.water,"line-width":.5}},{id:"water_river",type:"line",source:v,"source-layer":"water",minzoom:9,filter:["in","kind","river"],paint:{"line-color":y.water,"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1,18,12]}},{id:"landuse_pedestrian",type:"fill",source:v,"source-layer":"landuse",filter:["in","kind","pedestrian","dam"],paint:{"fill-color":y.pedestrian}},{id:"landuse_pier",type:"fill",source:v,"source-layer":"landuse",filter:["==","kind","pier"],paint:{"fill-color":y.pier}},{id:"roads_tunnels_other_casing",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["in","kind","other","path"]],paint:{"line-color":y.tunnel_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor_casing",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","minor_road"]],paint:{"line-color":y.tunnel_minor_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_link_casing",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["has","is_link"]],paint:{"line-color":y.tunnel_link_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_major_casing",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":y.tunnel_major_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_tunnels_highway_casing",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":y.tunnel_highway_casing,"line-dasharray":[6,.5],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_tunnels_other",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["in","kind","other","path"]],paint:{"line-color":y.tunnel_other,"line-dasharray":[4.5,.5],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","minor_road"]],paint:{"line-color":y.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_tunnels_link",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["has","is_link"]],paint:{"line-color":y.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_tunnels_major",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","major_road"]],paint:{"line-color":y.tunnel_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_tunnels_highway",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==",["get","kind"],"highway"],["!",["has","is_link"]]],paint:{"line-color":y.tunnel_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"buildings",type:"fill",source:v,"source-layer":"buildings",filter:["in","kind","building","building_part"],paint:{"fill-color":y.buildings,"fill-opacity":.5}},{id:"roads_pier",type:"line",source:v,"source-layer":"roads",filter:["==","kind_detail","pier"],paint:{"line-color":y.pier,"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,16]}},{id:"roads_minor_service_casing",type:"line",source:v,"source-layer":"roads",minzoom:13,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["==","kind_detail","service"]],paint:{"line-color":y.minor_service_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_minor_casing",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["!=","kind_detail","service"]],paint:{"line-color":y.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_link_casing",type:"line",source:v,"source-layer":"roads",minzoom:13,filter:["has","is_link"],paint:{"line-color":y.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1.5]}},{id:"roads_major_casing_late",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":y.major_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_highway_casing_late",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":y.highway_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_other",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["in","kind","other","path"],["!=","kind_detail","pier"]],paint:{"line-color":y.other,"line-dasharray":[3,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_link",type:"line",source:v,"source-layer":"roads",filter:["has","is_link"],paint:{"line-color":y.link,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_minor_service",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["==","kind_detail","service"]],paint:{"line-color":y.minor_service,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8]}},{id:"roads_minor",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["!=","kind_detail","service"]],paint:{"line-color":["interpolate",["exponential",1.6],["zoom"],11,y.minor_a,16,y.minor_b],"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_major_casing_early",type:"line",source:v,"source-layer":"roads",maxzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":y.major_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_major",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":y.major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_highway_casing_early",type:"line",source:v,"source-layer":"roads",maxzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":y.highway_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_highway",type:"line",source:v,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":y.highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"roads_rail",type:"line",source:v,"source-layer":"roads",filter:["==","kind","rail"],paint:{"line-dasharray":[.3,.75],"line-opacity":.5,"line-color":y.railway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,.15,18,9]}},{id:"boundaries_country",type:"line",source:v,"source-layer":"boundaries",filter:["<=","kind_detail",2],paint:{"line-color":y.boundaries,"line-width":.7,"line-dasharray":["step",["zoom"],["literal",[2]],4,["literal",[2,1]]]}},{id:"boundaries",type:"line",source:v,"source-layer":"boundaries",filter:[">","kind_detail",2],paint:{"line-color":y.boundaries,"line-width":.4,"line-dasharray":["step",["zoom"],["literal",[2]],4,["literal",[2,1]]]}},{id:"roads_bridges_other_casing",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["in","kind","other","path"]],paint:{"line-color":y.bridges_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_link_casing",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["has","is_link"]],paint:{"line-color":y.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1.5]}},{id:"roads_bridges_minor_casing",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","minor_road"]],paint:{"line-color":y.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_bridges_major_casing",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":y.bridges_major_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,10],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1.5]}},{id:"roads_bridges_other",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["in","kind","other","path"]],paint:{"line-color":y.bridges_other,"line-dasharray":[2,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_minor",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","minor_road"]],paint:{"line-color":y.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_bridges_link",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["has","is_link"]],paint:{"line-color":y.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_bridges_major",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":y.bridges_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_bridges_highway_casing",type:"line",source:v,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":y.bridges_highway_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_bridges_highway",type:"line",source:v,"source-layer":"roads",filter:["all",["has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":y.bridges_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}}]}xc(Kv,"nolabels_layers");function Wv(v,y,b,T){return[{id:"address_label",type:"symbol",source:v,"source-layer":"buildings",minzoom:18,filter:["==","kind","address"],layout:{"symbol-placement":"point","text-font":[y.italic||"Noto Sans Italic"],"text-field":["get","addr_housenumber"],"text-size":12},paint:{"text-color":y.address_label,"text-halo-color":y.address_label_halo,"text-halo-width":1}},{id:"water_waterway_label",type:"symbol",source:v,"source-layer":"water",minzoom:13,filter:["in","kind","river","stream"],layout:{"symbol-placement":"line","text-font":[y.italic||"Noto Sans Italic"],"text-field":Tl(b,T,y.regular),"text-size":12,"text-letter-spacing":.2},paint:{"text-color":y.ocean_label,"text-halo-color":y.water,"text-halo-width":1}},{id:"roads_labels_minor",type:"symbol",source:v,"source-layer":"roads",minzoom:15,filter:["in","kind","minor_road","other","path"],layout:{"symbol-sort-key":["get","min_zoom"],"symbol-placement":"line","text-font":[y.regular||"Noto Sans Regular"],"text-field":Tl(b,T,y.regular),"text-size":12},paint:{"text-color":y.roads_label_minor,"text-halo-color":y.roads_label_minor_halo,"text-halo-width":1}},{id:"water_label_ocean",type:"symbol",source:v,"source-layer":"water",filter:["in","kind","sea","ocean","bay","strait","fjord"],layout:{"text-font":[y.italic||"Noto Sans Italic"],"text-field":Tl(b,T,y.regular),"text-size":["interpolate",["linear"],["zoom"],3,10,10,12],"text-letter-spacing":.1,"text-max-width":9,"text-transform":"uppercase"},paint:{"text-color":y.ocean_label,"text-halo-width":1,"text-halo-color":y.water}},{id:"earth_label_islands",type:"symbol",source:v,"source-layer":"earth",filter:["in","kind","island"],layout:{"text-font":[y.italic||"Noto Sans Italic"],"text-field":Tl(b,T,y.regular),"text-size":10,"text-letter-spacing":.1,"text-max-width":8},paint:{"text-color":y.subplace_label,"text-halo-color":y.subplace_label_halo,"text-halo-width":1}},{id:"water_label_lakes",type:"symbol",source:v,"source-layer":"water",filter:["in","kind","lake","water"],layout:{"text-font":[y.italic||"Noto Sans Italic"],"text-field":Tl(b,T,y.regular),"text-size":["interpolate",["linear"],["zoom"],3,10,6,12,10,12],"text-letter-spacing":.1,"text-max-width":9},paint:{"text-color":y.ocean_label,"text-halo-color":y.water,"text-halo-width":1}},{id:"roads_labels_major",type:"symbol",source:v,"source-layer":"roads",minzoom:11,filter:["in","kind","highway","major_road"],layout:{"symbol-sort-key":["get","min_zoom"],"symbol-placement":"line","text-font":[y.regular||"Noto Sans Regular"],"text-field":Tl(b,T,y.regular),"text-size":12},paint:{"text-color":y.roads_label_major,"text-halo-color":y.roads_label_major_halo,"text-halo-width":1}},...y.pois?[{id:"pois",type:"symbol",source:v,"source-layer":"pois",filter:["all",["in",["get","kind"],["literal",["beach","forest","marina","park","peak","zoo","garden","bench","aerodrome","station","bus_stop","ferry_terminal","stadium","university","library","school","animal","toilets","drinking_water"]]],[">=",["zoom"],["+",["get","min_zoom"],0]]],layout:{"icon-image":["match",["get","kind"],"station","train_station",["get","kind"]],"text-font":[y.regular||"Noto Sans Regular"],"text-justify":"auto","text-field":Tl(b,T,y.regular),"text-size":["interpolate",["linear"],["zoom"],17,10,19,16],"text-max-width":8,"text-offset":[1.1,0],"text-variable-anchor":["left","right"]},paint:{"text-color":["case",["in",["get","kind"],["literal",["beach","forest","marina","park","peak","zoo","garden","bench"]]],y.pois.green,["in",["get","kind"],["literal",["aerodrome","station","bus_stop","ferry_terminal"]]],y.pois.lapis,["in",["get","kind"],["literal",["stadium","university","library","school","animal","toilets","drinking_water"]]],y.pois.slategray,y.earth],"text-halo-color":y.earth,"text-halo-width":1}}]:[],{id:"places_subplace",type:"symbol",source:v,"source-layer":"places",filter:["==","kind","neighbourhood"],layout:{"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-field":Tl(b,T,y.regular),"text-font":[y.regular||"Noto Sans Regular"],"text-max-width":7,"text-letter-spacing":.1,"text-padding":["interpolate",["linear"],["zoom"],5,2,8,4,12,18,15,20],"text-size":["interpolate",["exponential",1.2],["zoom"],11,8,14,14,18,24],"text-transform":"uppercase"},paint:{"text-color":y.subplace_label,"text-halo-color":y.subplace_label_halo,"text-halo-width":1}},{id:"places_region",type:"symbol",source:v,"source-layer":"places",filter:["==","kind","region"],layout:{"symbol-sort-key":["get","sort_key"],"text-field":["step",["zoom"],["coalesce",["get","ref:en"],["get","ref"]],6,Tl(b,T,y.regular)],"text-font":[y.regular||"Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],3,11,7,16],"text-radial-offset":.2,"text-anchor":"center","text-transform":"uppercase"},paint:{"text-color":y.state_label,"text-halo-color":y.state_label_halo,"text-halo-width":1}},{id:"places_locality",type:"symbol",source:v,"source-layer":"places",filter:["==","kind","locality"],layout:{"icon-image":["step",["zoom"],"townspot",8,""],"icon-size":.7,"text-field":Tl(b,T,y.regular),"text-font":["case",["<=",["get","min_zoom"],5],["literal",[y.bold||"Noto Sans Medium"]],["literal",[y.regular||"Noto Sans Regular"]]],"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-padding":["interpolate",["linear"],["zoom"],5,3,8,7,12,11],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","population_rank"],13],8,[">=",["get","population_rank"],13],13,0],4,["case",["<",["get","population_rank"],13],10,[">=",["get","population_rank"],13],15,0],6,["case",["<",["get","population_rank"],12],11,[">=",["get","population_rank"],12],17,0],8,["case",["<",["get","population_rank"],11],11,[">=",["get","population_rank"],11],18,0],10,["case",["<",["get","population_rank"],9],12,[">=",["get","population_rank"],9],20,0],15,["case",["<",["get","population_rank"],8],12,[">=",["get","population_rank"],8],22,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,0,8,4,10,8,12,6,22,2],"text-justify":"auto","text-variable-anchor":["step",["zoom"],["literal",["bottom","left","right","top"]],8,["literal",["center"]]],"text-radial-offset":.3},paint:{"text-color":y.city_label,"text-halo-color":y.city_label_halo,"text-halo-width":1}},{id:"places_country",type:"symbol",source:v,"source-layer":"places",filter:["==","kind","country"],layout:{"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-field":Qv(b,T),"text-font":[y.bold||"Noto Sans Medium"],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","population_rank"],10],8,[">=",["get","population_rank"],10],12,0],6,["case",["<",["get","population_rank"],8],10,[">=",["get","population_rank"],8],18,0],8,["case",["<",["get","population_rank"],7],11,[">=",["get","population_rank"],7],20,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,2,14,2,16,20,17,2,22,2],"text-transform":"uppercase"},paint:{"text-color":y.country_label,"text-halo-color":y.earth,"text-halo-width":1}}]}xc(Wv,"labels_layers");var lw={background:"#cccccc",earth:"#e2dfda",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#728dd4",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3",address_label:"#91888b",address_label_halo:"#ffffff",pois:{blue:"#1A8CBD",green:"#20834D",lapis:"#315BCF",pink:"#EF56BA",red:"#F2567A",slategray:"#6A5B8F",tangerine:"#CB6704",turquoise:"#00C3D4"},landcover:{grassland:"rgba(210, 239, 207, 1)",barren:"rgba(255, 243, 215, 1)",urban_area:"rgba(230, 230, 230, 1)",farmland:"rgba(216, 239, 210, 1)",glacier:"rgba(255, 255, 255, 1)",scrub:"rgba(234, 239, 210, 1)",forest:"rgba(196, 231, 210, 1)"}},cw={background:"#34373d",earth:"#1f1f1f",park_a:"#1c2421",park_b:"#192a24",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#31353f",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c",address_label:"#525252",address_label_halo:"#1f1f1f",pois:{blue:"#4299BB",green:"#30C573",lapis:"#2B5CEA",pink:"#EF56BA",red:"#F2567A",slategray:"#93939F",tangerine:"#F19B6E",turquoise:"#00C3D4"},landcover:{grassland:"rgba(30, 41, 31, 1)",barren:"rgba(38, 38, 36, 1)",urban_area:"rgba(28, 28, 28, 1)",farmland:"rgba(31, 36, 32, 1)",glacier:"rgba(43, 43, 43, 1)",scrub:"rgba(34, 36, 30, 1)",forest:"rgba(28, 41, 37, 1)"}},uw={background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8",address_label:"#adadad",address_label_halo:"#ffffff"},hw={background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585",address_label:"#999999",address_label_halo:"#e0e0e0"},dw={background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070",address_label:"#525252",address_label_halo:"#141414"};function fw(v){switch(v){case"light":return lw;case"dark":return cw;case"white":return uw;case"grayscale":return hw;case"black":return dw}throw new Error("Flavor not found")}xc(fw,"namedFlavor");function pw(v,y,b){let T=[];return b!=null&&b.labelsOnly||(T=Kv(v,y)),b!=null&&b.lang&&(T=T.concat(Wv(v,y,b.lang))),T}xc(pw,"layers");h0.createRoot(document.getElementById("root")).render(Si.jsxs(Ug.StrictMode,{children:[Si.jsx("h1",{children:"Napkin Ratings"}),Si.jsx(M1,{})]}));export{_w as C,t0 as g,qy as i};
