(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const H of document.querySelectorAll('link[rel="modulepreload"]'))R(H);new MutationObserver(H=>{for(const ae of H)if(ae.type==="childList")for(const P of ae.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&R(P)}).observe(document,{childList:!0,subtree:!0});function O(H){const ae={};return H.integrity&&(ae.integrity=H.integrity),H.referrerPolicy&&(ae.referrerPolicy=H.referrerPolicy),H.crossOrigin==="use-credentials"?ae.credentials="include":H.crossOrigin==="anonymous"?ae.credentials="omit":ae.credentials="same-origin",ae}function R(H){if(H.ep)return;H.ep=!0;const ae=O(H);fetch(H.href,ae)}})();function Wm(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}var rm={exports:{}},$f={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im;function Ng(){if(Im)return $f;Im=1;var E=Symbol.for("react.transitional.element"),D=Symbol.for("react.fragment");function O(R,H,ae){var P=null;if(ae!==void 0&&(P=""+ae),H.key!==void 0&&(P=""+H.key),"key"in H){ae={};for(var d in H)d!=="key"&&(ae[d]=H[d])}else ae=H;return H=ae.ref,{$$typeof:E,type:R,key:P,ref:H!==void 0?H:null,props:ae}}return $f.Fragment=D,$f.jsx=O,$f.jsxs=O,$f}var Rm;function Ug(){return Rm||(Rm=1,rm.exports=Ng()),rm.exports}var Yi=Ug(),sm={exports:{}},mi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var km;function Vg(){if(km)return mi;km=1;var E=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),P=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),re=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Ne=Symbol.iterator;function Se(le){return le===null||typeof le!="object"?null:(le=Ne&&le[Ne]||le["@@iterator"],typeof le=="function"?le:null)}var pe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pe=Object.assign,ht={};function Tt(le,Ye,ot){this.props=le,this.context=Ye,this.refs=ht,this.updater=ot||pe}Tt.prototype.isReactComponent={},Tt.prototype.setState=function(le,Ye){if(typeof le!="object"&&typeof le!="function"&&le!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,le,Ye,"setState")},Tt.prototype.forceUpdate=function(le){this.updater.enqueueForceUpdate(this,le,"forceUpdate")};function pt(){}pt.prototype=Tt.prototype;function St(le,Ye,ot){this.props=le,this.context=Ye,this.refs=ht,this.updater=ot||pe}var Pt=St.prototype=new pt;Pt.constructor=St,Pe(Pt,Tt.prototype),Pt.isPureReactComponent=!0;var qt=Array.isArray,bt={H:null,A:null,T:null,S:null,V:null},Zt=Object.prototype.hasOwnProperty;function di(le,Ye,ot,ct,xt,At){return ot=At.ref,{$$typeof:E,type:le,key:Ye,ref:ot!==void 0?ot:null,props:At}}function Xt(le,Ye){return di(le.type,Ye,void 0,void 0,void 0,le.props)}function li(le){return typeof le=="object"&&le!==null&&le.$$typeof===E}function ni(le){var Ye={"=":"=0",":":"=2"};return"$"+le.replace(/[=:]/g,function(ot){return Ye[ot]})}var Bt=/\/+/g;function wi(le,Ye){return typeof le=="object"&&le!==null&&le.key!=null?ni(""+le.key):Ye.toString(36)}function _n(){}function Ct(le){switch(le.status){case"fulfilled":return le.value;case"rejected":throw le.reason;default:switch(typeof le.status=="string"?le.then(_n,_n):(le.status="pending",le.then(function(Ye){le.status==="pending"&&(le.status="fulfilled",le.value=Ye)},function(Ye){le.status==="pending"&&(le.status="rejected",le.reason=Ye)})),le.status){case"fulfilled":return le.value;case"rejected":throw le.reason}}throw le}function mt(le,Ye,ot,ct,xt){var At=typeof le;(At==="undefined"||At==="boolean")&&(le=null);var Rt=!1;if(le===null)Rt=!0;else switch(At){case"bigint":case"string":case"number":Rt=!0;break;case"object":switch(le.$$typeof){case E:case D:Rt=!0;break;case Ce:return Rt=le._init,mt(Rt(le._payload),Ye,ot,ct,xt)}}if(Rt)return xt=xt(le),Rt=ct===""?"."+wi(le,0):ct,qt(xt)?(ot="",Rt!=null&&(ot=Rt.replace(Bt,"$&/")+"/"),mt(xt,Ye,ot,"",function(Ki){return Ki})):xt!=null&&(li(xt)&&(xt=Xt(xt,ot+(xt.key==null||le&&le.key===xt.key?"":(""+xt.key).replace(Bt,"$&/")+"/")+Rt)),Ye.push(xt)),1;Rt=0;var fi=ct===""?".":ct+":";if(qt(le))for(var ci=0;ci<le.length;ci++)ct=le[ci],At=fi+wi(ct,ci),Rt+=mt(ct,Ye,ot,At,xt);else if(ci=Se(le),typeof ci=="function")for(le=ci.call(le),ci=0;!(ct=le.next()).done;)ct=ct.value,At=fi+wi(ct,ci++),Rt+=mt(ct,Ye,ot,At,xt);else if(At==="object"){if(typeof le.then=="function")return mt(Ct(le),Ye,ot,ct,xt);throw Ye=String(le),Error("Objects are not valid as a React child (found: "+(Ye==="[object Object]"?"object with keys {"+Object.keys(le).join(", ")+"}":Ye)+"). If you meant to render a collection of children, use an array instead.")}return Rt}function be(le,Ye,ot){if(le==null)return le;var ct=[],xt=0;return mt(le,ct,"","",function(At){return Ye.call(ot,At,xt++)}),ct}function Ke(le){if(le._status===-1){var Ye=le._result;Ye=Ye(),Ye.then(function(ot){(le._status===0||le._status===-1)&&(le._status=1,le._result=ot)},function(ot){(le._status===0||le._status===-1)&&(le._status=2,le._result=ot)}),le._status===-1&&(le._status=0,le._result=Ye)}if(le._status===1)return le._result.default;throw le._result}var Ge=typeof reportError=="function"?reportError:function(le){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ye=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof le=="object"&&le!==null&&typeof le.message=="string"?String(le.message):String(le),error:le});if(!window.dispatchEvent(Ye))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",le);return}console.error(le)};function _t(){}return mi.Children={map:be,forEach:function(le,Ye,ot){be(le,function(){Ye.apply(this,arguments)},ot)},count:function(le){var Ye=0;return be(le,function(){Ye++}),Ye},toArray:function(le){return be(le,function(Ye){return Ye})||[]},only:function(le){if(!li(le))throw Error("React.Children.only expected to receive a single React element child.");return le}},mi.Component=Tt,mi.Fragment=O,mi.Profiler=H,mi.PureComponent=St,mi.StrictMode=R,mi.Suspense=ge,mi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=bt,mi.__COMPILER_RUNTIME={__proto__:null,c:function(le){return bt.H.useMemoCache(le)}},mi.cache=function(le){return function(){return le.apply(null,arguments)}},mi.cloneElement=function(le,Ye,ot){if(le==null)throw Error("The argument must be a React element, but you passed "+le+".");var ct=Pe({},le.props),xt=le.key,At=void 0;if(Ye!=null)for(Rt in Ye.ref!==void 0&&(At=void 0),Ye.key!==void 0&&(xt=""+Ye.key),Ye)!Zt.call(Ye,Rt)||Rt==="key"||Rt==="__self"||Rt==="__source"||Rt==="ref"&&Ye.ref===void 0||(ct[Rt]=Ye[Rt]);var Rt=arguments.length-2;if(Rt===1)ct.children=ot;else if(1<Rt){for(var fi=Array(Rt),ci=0;ci<Rt;ci++)fi[ci]=arguments[ci+2];ct.children=fi}return di(le.type,xt,void 0,void 0,At,ct)},mi.createContext=function(le){return le={$$typeof:P,_currentValue:le,_currentValue2:le,_threadCount:0,Provider:null,Consumer:null},le.Provider=le,le.Consumer={$$typeof:ae,_context:le},le},mi.createElement=function(le,Ye,ot){var ct,xt={},At=null;if(Ye!=null)for(ct in Ye.key!==void 0&&(At=""+Ye.key),Ye)Zt.call(Ye,ct)&&ct!=="key"&&ct!=="__self"&&ct!=="__source"&&(xt[ct]=Ye[ct]);var Rt=arguments.length-2;if(Rt===1)xt.children=ot;else if(1<Rt){for(var fi=Array(Rt),ci=0;ci<Rt;ci++)fi[ci]=arguments[ci+2];xt.children=fi}if(le&&le.defaultProps)for(ct in Rt=le.defaultProps,Rt)xt[ct]===void 0&&(xt[ct]=Rt[ct]);return di(le,At,void 0,void 0,null,xt)},mi.createRef=function(){return{current:null}},mi.forwardRef=function(le){return{$$typeof:d,render:le}},mi.isValidElement=li,mi.lazy=function(le){return{$$typeof:Ce,_payload:{_status:-1,_result:le},_init:Ke}},mi.memo=function(le,Ye){return{$$typeof:re,type:le,compare:Ye===void 0?null:Ye}},mi.startTransition=function(le){var Ye=bt.T,ot={};bt.T=ot;try{var ct=le(),xt=bt.S;xt!==null&&xt(ot,ct),typeof ct=="object"&&ct!==null&&typeof ct.then=="function"&&ct.then(_t,Ge)}catch(At){Ge(At)}finally{bt.T=Ye}},mi.unstable_useCacheRefresh=function(){return bt.H.useCacheRefresh()},mi.use=function(le){return bt.H.use(le)},mi.useActionState=function(le,Ye,ot){return bt.H.useActionState(le,Ye,ot)},mi.useCallback=function(le,Ye){return bt.H.useCallback(le,Ye)},mi.useContext=function(le){return bt.H.useContext(le)},mi.useDebugValue=function(){},mi.useDeferredValue=function(le,Ye){return bt.H.useDeferredValue(le,Ye)},mi.useEffect=function(le,Ye,ot){var ct=bt.H;if(typeof ot=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ct.useEffect(le,Ye)},mi.useId=function(){return bt.H.useId()},mi.useImperativeHandle=function(le,Ye,ot){return bt.H.useImperativeHandle(le,Ye,ot)},mi.useInsertionEffect=function(le,Ye){return bt.H.useInsertionEffect(le,Ye)},mi.useLayoutEffect=function(le,Ye){return bt.H.useLayoutEffect(le,Ye)},mi.useMemo=function(le,Ye){return bt.H.useMemo(le,Ye)},mi.useOptimistic=function(le,Ye){return bt.H.useOptimistic(le,Ye)},mi.useReducer=function(le,Ye,ot){return bt.H.useReducer(le,Ye,ot)},mi.useRef=function(le){return bt.H.useRef(le)},mi.useState=function(le){return bt.H.useState(le)},mi.useSyncExternalStore=function(le,Ye,ot){return bt.H.useSyncExternalStore(le,Ye,ot)},mi.useTransition=function(){return bt.H.useTransition()},mi.version="19.1.0",mi}var Lm;function xm(){return Lm||(Lm=1,sm.exports=Vg()),sm.exports}var st=xm(),om={exports:{}},Xf={},lm={exports:{}},cm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bm;function Zg(){return Bm||(Bm=1,function(E){function D(be,Ke){var Ge=be.length;be.push(Ke);e:for(;0<Ge;){var _t=Ge-1>>>1,le=be[_t];if(0<H(le,Ke))be[_t]=Ke,be[Ge]=le,Ge=_t;else break e}}function O(be){return be.length===0?null:be[0]}function R(be){if(be.length===0)return null;var Ke=be[0],Ge=be.pop();if(Ge!==Ke){be[0]=Ge;e:for(var _t=0,le=be.length,Ye=le>>>1;_t<Ye;){var ot=2*(_t+1)-1,ct=be[ot],xt=ot+1,At=be[xt];if(0>H(ct,Ge))xt<le&&0>H(At,ct)?(be[_t]=At,be[xt]=Ge,_t=xt):(be[_t]=ct,be[ot]=Ge,_t=ot);else if(xt<le&&0>H(At,Ge))be[_t]=At,be[xt]=Ge,_t=xt;else break e}}return Ke}function H(be,Ke){var Ge=be.sortIndex-Ke.sortIndex;return Ge!==0?Ge:be.id-Ke.id}if(E.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var ae=performance;E.unstable_now=function(){return ae.now()}}else{var P=Date,d=P.now();E.unstable_now=function(){return P.now()-d}}var ge=[],re=[],Ce=1,Ne=null,Se=3,pe=!1,Pe=!1,ht=!1,Tt=!1,pt=typeof setTimeout=="function"?setTimeout:null,St=typeof clearTimeout=="function"?clearTimeout:null,Pt=typeof setImmediate<"u"?setImmediate:null;function qt(be){for(var Ke=O(re);Ke!==null;){if(Ke.callback===null)R(re);else if(Ke.startTime<=be)R(re),Ke.sortIndex=Ke.expirationTime,D(ge,Ke);else break;Ke=O(re)}}function bt(be){if(ht=!1,qt(be),!Pe)if(O(ge)!==null)Pe=!0,Zt||(Zt=!0,wi());else{var Ke=O(re);Ke!==null&&mt(bt,Ke.startTime-be)}}var Zt=!1,di=-1,Xt=5,li=-1;function ni(){return Tt?!0:!(E.unstable_now()-li<Xt)}function Bt(){if(Tt=!1,Zt){var be=E.unstable_now();li=be;var Ke=!0;try{e:{Pe=!1,ht&&(ht=!1,St(di),di=-1),pe=!0;var Ge=Se;try{t:{for(qt(be),Ne=O(ge);Ne!==null&&!(Ne.expirationTime>be&&ni());){var _t=Ne.callback;if(typeof _t=="function"){Ne.callback=null,Se=Ne.priorityLevel;var le=_t(Ne.expirationTime<=be);if(be=E.unstable_now(),typeof le=="function"){Ne.callback=le,qt(be),Ke=!0;break t}Ne===O(ge)&&R(ge),qt(be)}else R(ge);Ne=O(ge)}if(Ne!==null)Ke=!0;else{var Ye=O(re);Ye!==null&&mt(bt,Ye.startTime-be),Ke=!1}}break e}finally{Ne=null,Se=Ge,pe=!1}Ke=void 0}}finally{Ke?wi():Zt=!1}}}var wi;if(typeof Pt=="function")wi=function(){Pt(Bt)};else if(typeof MessageChannel<"u"){var _n=new MessageChannel,Ct=_n.port2;_n.port1.onmessage=Bt,wi=function(){Ct.postMessage(null)}}else wi=function(){pt(Bt,0)};function mt(be,Ke){di=pt(function(){be(E.unstable_now())},Ke)}E.unstable_IdlePriority=5,E.unstable_ImmediatePriority=1,E.unstable_LowPriority=4,E.unstable_NormalPriority=3,E.unstable_Profiling=null,E.unstable_UserBlockingPriority=2,E.unstable_cancelCallback=function(be){be.callback=null},E.unstable_forceFrameRate=function(be){0>be||125<be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Xt=0<be?Math.floor(1e3/be):5},E.unstable_getCurrentPriorityLevel=function(){return Se},E.unstable_next=function(be){switch(Se){case 1:case 2:case 3:var Ke=3;break;default:Ke=Se}var Ge=Se;Se=Ke;try{return be()}finally{Se=Ge}},E.unstable_requestPaint=function(){Tt=!0},E.unstable_runWithPriority=function(be,Ke){switch(be){case 1:case 2:case 3:case 4:case 5:break;default:be=3}var Ge=Se;Se=be;try{return Ke()}finally{Se=Ge}},E.unstable_scheduleCallback=function(be,Ke,Ge){var _t=E.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?_t+Ge:_t):Ge=_t,be){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Ge+le,be={id:Ce++,callback:Ke,priorityLevel:be,startTime:Ge,expirationTime:le,sortIndex:-1},Ge>_t?(be.sortIndex=Ge,D(re,be),O(ge)===null&&be===O(re)&&(ht?(St(di),di=-1):ht=!0,mt(bt,Ge-_t))):(be.sortIndex=le,D(ge,be),Pe||pe||(Pe=!0,Zt||(Zt=!0,wi()))),be},E.unstable_shouldYield=ni,E.unstable_wrapCallback=function(be){var Ke=Se;return function(){var Ge=Se;Se=Ke;try{return be.apply(this,arguments)}finally{Se=Ge}}}}(cm)),cm}var Om;function Gg(){return Om||(Om=1,lm.exports=Zg()),lm.exports}var um={exports:{}},yr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm;function qg(){if(Fm)return yr;Fm=1;var E=xm();function D(ge){var re="https://react.dev/errors/"+ge;if(1<arguments.length){re+="?args[]="+encodeURIComponent(arguments[1]);for(var Ce=2;Ce<arguments.length;Ce++)re+="&args[]="+encodeURIComponent(arguments[Ce])}return"Minified React error #"+ge+"; visit "+re+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function O(){}var R={d:{f:O,r:function(){throw Error(D(522))},D:O,C:O,L:O,m:O,X:O,S:O,M:O},p:0,findDOMNode:null},H=Symbol.for("react.portal");function ae(ge,re,Ce){var Ne=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:Ne==null?null:""+Ne,children:ge,containerInfo:re,implementation:Ce}}var P=E.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(ge,re){if(ge==="font")return"";if(typeof re=="string")return re==="use-credentials"?re:""}return yr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,yr.createPortal=function(ge,re){var Ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!re||re.nodeType!==1&&re.nodeType!==9&&re.nodeType!==11)throw Error(D(299));return ae(ge,re,null,Ce)},yr.flushSync=function(ge){var re=P.T,Ce=R.p;try{if(P.T=null,R.p=2,ge)return ge()}finally{P.T=re,R.p=Ce,R.d.f()}},yr.preconnect=function(ge,re){typeof ge=="string"&&(re?(re=re.crossOrigin,re=typeof re=="string"?re==="use-credentials"?re:"":void 0):re=null,R.d.C(ge,re))},yr.prefetchDNS=function(ge){typeof ge=="string"&&R.d.D(ge)},yr.preinit=function(ge,re){if(typeof ge=="string"&&re&&typeof re.as=="string"){var Ce=re.as,Ne=d(Ce,re.crossOrigin),Se=typeof re.integrity=="string"?re.integrity:void 0,pe=typeof re.fetchPriority=="string"?re.fetchPriority:void 0;Ce==="style"?R.d.S(ge,typeof re.precedence=="string"?re.precedence:void 0,{crossOrigin:Ne,integrity:Se,fetchPriority:pe}):Ce==="script"&&R.d.X(ge,{crossOrigin:Ne,integrity:Se,fetchPriority:pe,nonce:typeof re.nonce=="string"?re.nonce:void 0})}},yr.preinitModule=function(ge,re){if(typeof ge=="string")if(typeof re=="object"&&re!==null){if(re.as==null||re.as==="script"){var Ce=d(re.as,re.crossOrigin);R.d.M(ge,{crossOrigin:Ce,integrity:typeof re.integrity=="string"?re.integrity:void 0,nonce:typeof re.nonce=="string"?re.nonce:void 0})}}else re==null&&R.d.M(ge)},yr.preload=function(ge,re){if(typeof ge=="string"&&typeof re=="object"&&re!==null&&typeof re.as=="string"){var Ce=re.as,Ne=d(Ce,re.crossOrigin);R.d.L(ge,Ce,{crossOrigin:Ne,integrity:typeof re.integrity=="string"?re.integrity:void 0,nonce:typeof re.nonce=="string"?re.nonce:void 0,type:typeof re.type=="string"?re.type:void 0,fetchPriority:typeof re.fetchPriority=="string"?re.fetchPriority:void 0,referrerPolicy:typeof re.referrerPolicy=="string"?re.referrerPolicy:void 0,imageSrcSet:typeof re.imageSrcSet=="string"?re.imageSrcSet:void 0,imageSizes:typeof re.imageSizes=="string"?re.imageSizes:void 0,media:typeof re.media=="string"?re.media:void 0})}},yr.preloadModule=function(ge,re){if(typeof ge=="string")if(re){var Ce=d(re.as,re.crossOrigin);R.d.m(ge,{as:typeof re.as=="string"&&re.as!=="script"?re.as:void 0,crossOrigin:Ce,integrity:typeof re.integrity=="string"?re.integrity:void 0})}else R.d.m(ge)},yr.requestFormReset=function(ge){R.d.r(ge)},yr.unstable_batchedUpdates=function(ge,re){return ge(re)},yr.useFormState=function(ge,re,Ce){return P.H.useFormState(ge,re,Ce)},yr.useFormStatus=function(){return P.H.useHostTransitionStatus()},yr.version="19.1.0",yr}var jm;function Hg(){if(jm)return um.exports;jm=1;function E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E)}catch(D){console.error(D)}}return E(),um.exports=qg(),um.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm;function $g(){if(Nm)return Xf;Nm=1;var E=Gg(),D=xm(),O=Hg();function R(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function H(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function ae(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function P(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(ae(i)!==i)throw Error(R(188))}function ge(i){var s=i.alternate;if(!s){if(s=ae(i),s===null)throw Error(R(188));return s!==i?null:i}for(var c=i,p=s;;){var x=c.return;if(x===null)break;var S=x.alternate;if(S===null){if(p=x.return,p!==null){c=p;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===c)return d(x),i;if(S===p)return d(x),s;S=S.sibling}throw Error(R(188))}if(c.return!==p.return)c=x,p=S;else{for(var U=!1,Y=x.child;Y;){if(Y===c){U=!0,c=x,p=S;break}if(Y===p){U=!0,p=x,c=S;break}Y=Y.sibling}if(!U){for(Y=S.child;Y;){if(Y===c){U=!0,c=S,p=x;break}if(Y===p){U=!0,p=S,c=x;break}Y=Y.sibling}if(!U)throw Error(R(189))}}if(c.alternate!==p)throw Error(R(190))}if(c.tag!==3)throw Error(R(188));return c.stateNode.current===c?i:s}function re(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=re(i),s!==null)return s;i=i.sibling}return null}var Ce=Object.assign,Ne=Symbol.for("react.element"),Se=Symbol.for("react.transitional.element"),pe=Symbol.for("react.portal"),Pe=Symbol.for("react.fragment"),ht=Symbol.for("react.strict_mode"),Tt=Symbol.for("react.profiler"),pt=Symbol.for("react.provider"),St=Symbol.for("react.consumer"),Pt=Symbol.for("react.context"),qt=Symbol.for("react.forward_ref"),bt=Symbol.for("react.suspense"),Zt=Symbol.for("react.suspense_list"),di=Symbol.for("react.memo"),Xt=Symbol.for("react.lazy"),li=Symbol.for("react.activity"),ni=Symbol.for("react.memo_cache_sentinel"),Bt=Symbol.iterator;function wi(i){return i===null||typeof i!="object"?null:(i=Bt&&i[Bt]||i["@@iterator"],typeof i=="function"?i:null)}var _n=Symbol.for("react.client.reference");function Ct(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===_n?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Pe:return"Fragment";case Tt:return"Profiler";case ht:return"StrictMode";case bt:return"Suspense";case Zt:return"SuspenseList";case li:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case pe:return"Portal";case Pt:return(i.displayName||"Context")+".Provider";case St:return(i._context.displayName||"Context")+".Consumer";case qt:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case di:return s=i.displayName||null,s!==null?s:Ct(i.type)||"Memo";case Xt:s=i._payload,i=i._init;try{return Ct(i(s))}catch{}}return null}var mt=Array.isArray,be=D.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ke=O.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ge={pending:!1,data:null,method:null,action:null},_t=[],le=-1;function Ye(i){return{current:i}}function ot(i){0>le||(i.current=_t[le],_t[le]=null,le--)}function ct(i,s){le++,_t[le]=i.current,i.current=s}var xt=Ye(null),At=Ye(null),Rt=Ye(null),fi=Ye(null);function ci(i,s){switch(ct(Rt,s),ct(At,i),ct(xt,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Uf(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Uf(s),i=Vf(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}ot(xt),ct(xt,i)}function Ki(){ot(xt),ot(At),ot(Rt)}function rn(i){i.memoizedState!==null&&ct(fi,i);var s=xt.current,c=Vf(s,i.type);s!==c&&(ct(At,i),ct(xt,c))}function Ii(i){At.current===i&&(ot(xt),ot(At)),fi.current===i&&(ot(fi),se._currentValue=Ge)}var sn=Object.prototype.hasOwnProperty,Qi=E.unstable_scheduleCallback,zi=E.unstable_cancelCallback,kr=E.unstable_shouldYield,Os=E.unstable_requestPaint,An=E.unstable_now,rc=E.unstable_getCurrentPriorityLevel,cl=E.unstable_ImmediatePriority,Da=E.unstable_UserBlockingPriority,Va=E.unstable_NormalPriority,mo=E.unstable_LowPriority,Fs=E.unstable_IdlePriority,ss=E.log,ul=E.unstable_setDisableYieldValue,Lr=null,$n=null;function oa(i){if(typeof ss=="function"&&ul(i),$n&&typeof $n.setStrictMode=="function")try{$n.setStrictMode(Lr,i)}catch{}}var zn=Math.clz32?Math.clz32:sr,js=Math.log,hl=Math.LN2;function sr(i){return i>>>=0,i===0?32:31-(js(i)/hl|0)|0}var ta=256,Za=4194304;function Me(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function $(i,s,c){var p=i.pendingLanes;if(p===0)return 0;var x=0,S=i.suspendedLanes,U=i.pingedLanes;i=i.warmLanes;var Y=p&134217727;return Y!==0?(p=Y&~S,p!==0?x=Me(p):(U&=Y,U!==0?x=Me(U):c||(c=Y&~i,c!==0&&(x=Me(c))))):(Y=p&~S,Y!==0?x=Me(Y):U!==0?x=Me(U):c||(c=p&~i,c!==0&&(x=Me(c)))),x===0?0:s!==0&&s!==x&&(s&S)===0&&(S=x&-x,c=s&-s,S>=c||S===32&&(c&4194048)!==0)?s:x}function X(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function J(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ce(){var i=ta;return ta<<=1,(ta&4194048)===0&&(ta=256),i}function ve(){var i=Za;return Za<<=1,(Za&62914560)===0&&(Za=4194304),i}function W(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function De(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function we(i,s,c,p,x,S){var U=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var Y=i.entanglements,fe=i.expirationTimes,Le=i.hiddenUpdates;for(c=U&~c;0<c;){var Je=31-zn(c),it=1<<Je;Y[Je]=0,fe[Je]=-1;var Ue=Le[Je];if(Ue!==null)for(Le[Je]=null,Je=0;Je<Ue.length;Je++){var qe=Ue[Je];qe!==null&&(qe.lane&=-536870913)}c&=~it}p!==0&&ze(i,p,0),S!==0&&x===0&&i.tag!==0&&(i.suspendedLanes|=S&~(U&~s))}function ze(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var p=31-zn(s);i.entangledLanes|=s,i.entanglements[p]=i.entanglements[p]|1073741824|c&4194090}function Be(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var p=31-zn(c),x=1<<p;x&s|i[p]&s&&(i[p]|=s),c&=~x}}function Ee(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function We(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ft(){var i=Ke.p;return i!==0?i:(i=window.event,i===void 0?32:Et(i.type))}function yt(i,s){var c=Ke.p;try{return Ke.p=i,s()}finally{Ke.p=c}}var zt=Math.random().toString(36).slice(2),Ot="__reactFiber$"+zt,Dt="__reactProps$"+zt,Ve="__reactContainer$"+zt,yi="__reactEvents$"+zt,ui="__reactListeners$"+zt,vi="__reactHandles$"+zt,Vt="__reactResources$"+zt,Qe="__reactMarker$"+zt;function Nt(i){delete i[Ot],delete i[Dt],delete i[yi],delete i[ui],delete i[vi]}function Ht(i){var s=i[Ot];if(s)return s;for(var c=i.parentNode;c;){if(s=c[Ve]||c[Ot]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=al(i);i!==null;){if(c=i[Ot])return c;i=al(i)}return s}i=c,c=i.parentNode}return null}function Ri(i){if(i=i[Ot]||i[Ve]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function ji(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(R(33))}function jn(i){var s=i[Vt];return s||(s=i[Vt]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ft(i){i[Qe]=!0}var go=new Set,dl={};function Ga(i,s){Br(i,s),Br(i+"Capture",s)}function Br(i,s){for(dl[i]=s,i=0;i<s.length;i++)go.add(s[i])}var os=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ns={},yn={};function qa(i){return sn.call(yn,i)?!0:sn.call(Ns,i)?!1:os.test(i)?yn[i]=!0:(Ns[i]=!0,!1)}function ki(i,s,c){if(qa(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var p=s.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Us(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Ia(i,s,c,p){if(p===null)i.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+p)}}var sc,Vs;function Ra(i){if(sc===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);sc=s&&s[1]||"",Vs=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sc+i+Vs}var Xc=!1;function oc(i,s){if(!i||Xc)return"";Xc=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(s){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(qe){var Ue=qe}Reflect.construct(i,[],it)}else{try{it.call()}catch(qe){Ue=qe}i.call(it.prototype)}}else{try{throw Error()}catch(qe){Ue=qe}(it=i())&&typeof it.catch=="function"&&it.catch(function(){})}}catch(qe){if(qe&&Ue&&typeof qe.stack=="string")return[qe.stack,Ue.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=p.DetermineComponentFrameRoot(),U=S[0],Y=S[1];if(U&&Y){var fe=U.split(`
`),Le=Y.split(`
`);for(x=p=0;p<fe.length&&!fe[p].includes("DetermineComponentFrameRoot");)p++;for(;x<Le.length&&!Le[x].includes("DetermineComponentFrameRoot");)x++;if(p===fe.length||x===Le.length)for(p=fe.length-1,x=Le.length-1;1<=p&&0<=x&&fe[p]!==Le[x];)x--;for(;1<=p&&0<=x;p--,x--)if(fe[p]!==Le[x]){if(p!==1||x!==1)do if(p--,x--,0>x||fe[p]!==Le[x]){var Je=`
`+fe[p].replace(" at new "," at ");return i.displayName&&Je.includes("<anonymous>")&&(Je=Je.replace("<anonymous>",i.displayName)),Je}while(1<=p&&0<=x);break}}}finally{Xc=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Ra(c):""}function Fh(i){switch(i.tag){case 26:case 27:case 5:return Ra(i.type);case 16:return Ra("Lazy");case 13:return Ra("Suspense");case 19:return Ra("SuspenseList");case 0:case 15:return oc(i.type,!1);case 11:return oc(i.type.render,!1);case 1:return oc(i.type,!0);case 31:return Ra("Activity");default:return""}}function _o(i){try{var s="";do s+=Fh(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Ha(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function jh(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Qd(i){var s=jh(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),p=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,S=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return x.call(this)},set:function(U){p=""+U,S.call(this,U)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(U){p=""+U},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Yc(i){i._valueTracker||(i._valueTracker=Qd(i))}function Xu(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),p="";return i&&(p=jh(i)?i.checked?"true":"false":i.value),i=p,i!==c?(s.setValue(i),!0):!1}function fl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var yo=/[\n"\\]/g;function ka(i){return i.replace(yo,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Kc(i,s,c,p,x,S,U,Y){i.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.type=U:i.removeAttribute("type"),s!=null?U==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Ha(s)):i.value!==""+Ha(s)&&(i.value=""+Ha(s)):U!=="submit"&&U!=="reset"||i.removeAttribute("value"),s!=null?lc(i,U,Ha(s)):c!=null?lc(i,U,Ha(c)):p!=null&&i.removeAttribute("value"),x==null&&S!=null&&(i.defaultChecked=!!S),x!=null&&(i.checked=x&&typeof x!="function"&&typeof x!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?i.name=""+Ha(Y):i.removeAttribute("name")}function Zs(i,s,c,p,x,S,U,Y){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.type=S),s!=null||c!=null){if(!(S!=="submit"&&S!=="reset"||s!=null))return;c=c!=null?""+Ha(c):"",s=s!=null?""+Ha(s):c,Y||s===i.value||(i.value=s),i.defaultValue=s}p=p??x,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=Y?i.checked:!!p,i.defaultChecked=!!p,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(i.name=U)}function lc(i,s,c){s==="number"&&fl(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function pl(i,s,c,p){if(i=i.options,s){s={};for(var x=0;x<c.length;x++)s["$"+c[x]]=!0;for(c=0;c<i.length;c++)x=s.hasOwnProperty("$"+i[c].value),i[c].selected!==x&&(i[c].selected=x),x&&p&&(i[c].defaultSelected=!0)}else{for(c=""+Ha(c),s=null,x=0;x<i.length;x++){if(i[x].value===c){i[x].selected=!0,p&&(i[x].defaultSelected=!0);return}s!==null||i[x].disabled||(s=i[x])}s!==null&&(s.selected=!0)}}function ml(i,s,c){if(s!=null&&(s=""+Ha(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+Ha(c):""}function gl(i,s,c,p){if(s==null){if(p!=null){if(c!=null)throw Error(R(92));if(mt(p)){if(1<p.length)throw Error(R(93));p=p[0]}c=p}c==null&&(c=""),s=c}c=Ha(s),i.defaultValue=c,p=i.textContent,p===c&&p!==""&&p!==null&&(i.value=p)}function Gs(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var ba=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pi(i,s,c){var p=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?p?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":p?i.setProperty(s,c):typeof c!="number"||c===0||ba.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function vo(i,s,c){if(s!=null&&typeof s!="object")throw Error(R(62));if(i=i.style,c!=null){for(var p in c)!c.hasOwnProperty(p)||s!=null&&s.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var x in s)p=s[x],s.hasOwnProperty(x)&&c[x]!==p&&pi(i,x,p)}else for(var S in s)s.hasOwnProperty(S)&&pi(i,S,s[S])}function ia(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qs(i){return hi.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var bo=null;function Hs(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Nn=null,vn=null;function xn(i){var s=Ri(i);if(s&&(i=s.stateNode)){var c=i[Dt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Kc(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ka(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var p=c[s];if(p!==i&&p.form===i.form){var x=p[Dt]||null;if(!x)throw Error(R(90));Kc(p,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(s=0;s<c.length;s++)p=c[s],p.form===i.form&&Xu(p)}break e;case"textarea":ml(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&pl(i,!!c.multiple,s,!1)}}}var Un=!1;function Ni(i,s,c){if(Un)return i(s,c);Un=!0;try{var p=i(s);return p}finally{if(Un=!1,(Nn!==null||vn!==null)&&(ya(),Nn&&(s=Nn,i=vn,vn=Nn=null,xn(s),i)))for(s=0;s<i.length;s++)xn(i[s])}}function Or(i,s){var c=i.stateNode;if(c===null)return null;var p=c[Dt]||null;if(p===null)return null;c=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(R(231,s,typeof c));return c}var dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wa=!1;if(dn)try{var Xn={};Object.defineProperty(Xn,"passive",{get:function(){wa=!0}}),window.addEventListener("test",Xn,Xn),window.removeEventListener("test",Xn,Xn)}catch{wa=!1}var or=null,Mi=null,qi=null;function ri(){if(qi)return qi;var i,s=Mi,c=s.length,p,x="value"in or?or.value:or.textContent,S=x.length;for(i=0;i<c&&s[i]===x[i];i++);var U=c-i;for(p=1;p<=U&&s[c-p]===x[S-p];p++);return qi=x.slice(i,1<p?1-p:void 0)}function $t(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function ls(){return!0}function Jt(){return!1}function na(i){function s(c,p,x,S,U){this._reactName=c,this._targetInst=x,this.type=p,this.nativeEvent=S,this.target=U,this.currentTarget=null;for(var Y in i)i.hasOwnProperty(Y)&&(c=i[Y],this[Y]=c?c(S):S[Y]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?ls:Jt,this.isPropagationStopped=Jt,this}return Ce(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){},isPersistent:ls}),s}var bn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_l=na(bn),wo=Ce({},bn,{view:0,detail:0}),cc=na(wo),$s,To,So,Mo=Ce({},wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Po,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==So&&(So&&i.type==="mousemove"?($s=i.screenX-So.screenX,To=i.screenY-So.screenY):To=$s=0,So=i),$s)},movementY:function(i){return"movementY"in i?i.movementY:To}}),yl=na(Mo),Eo=Ce({},Mo,{dataTransfer:0}),Yn=na(Eo),Co=Ce({},wo,{relatedTarget:0}),Ao=na(Co),Xs=Ce({},bn,{animationName:0,elapsedTime:0,pseudoElement:0}),Kn=na(Xs),Qc=Ce({},bn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Wc=na(Qc),Nh=Ce({},bn,{data:0}),Uh=na(Nh),la={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zo(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Fr[i])?!!s[i]:!1}function Po(){return zo}var lr=Ce({},wo,{key:function(i){if(i.key){var s=la[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=$t(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?uc[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Po,charCode:function(i){return i.type==="keypress"?$t(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?$t(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Do=na(lr),Jc=Ce({},Mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vh=na(Jc),Yu=Ce({},wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Po}),Wd=na(Yu),Jd=Ce({},bn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ef=na(Jd),eu=Ce({},Mo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),vl=na(eu),tu=Ce({},bn,{newState:0,oldState:0}),iu=na(tu),nu=[9,13,27,32],cr=dn&&"CompositionEvent"in window,xl=null;dn&&"documentMode"in document&&(xl=document.documentMode);var Ku=dn&&"TextEvent"in window&&!xl,bl=dn&&(!cr||xl&&8<xl&&11>=xl),wl=" ",Zh=!1;function hc(i,s){switch(i){case"keyup":return nu.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qu(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ur=!1;function Gh(i,s){switch(i){case"compositionend":return Qu(s);case"keypress":return s.which!==32?null:(Zh=!0,wl);case"textInput":return i=s.data,i===wl&&Zh?null:i;default:return null}}function qh(i,s){if(ur)return i==="compositionend"||!cr&&hc(i,s)?(i=ri(),qi=Mi=or=null,ur=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return bl&&s.locale!=="ko"?null:s.data;default:return null}}var tf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wu(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!tf[i.type]:s==="textarea"}function Tl(i,s,c,p){Nn?vn?vn.push(p):vn=[p]:Nn=p,s=Ql(s,"onChange"),0<s.length&&(c=new _l("onChange","change",null,c,p),i.push({event:c,listeners:s}))}var Sl=null,Ml=null;function Hh(i){il(i,0)}function El(i){var s=ji(i);if(Xu(s))return i}function cs(i,s){if(i==="change")return s}var Ju=!1;if(dn){var au;if(dn){var Ys="oninput"in document;if(!Ys){var eh=document.createElement("div");eh.setAttribute("oninput","return;"),Ys=typeof eh.oninput=="function"}au=Ys}else au=!1;Ju=au&&(!document.documentMode||9<document.documentMode)}function dc(){Sl&&(Sl.detachEvent("onpropertychange",$h),Ml=Sl=null)}function $h(i){if(i.propertyName==="value"&&El(Ml)){var s=[];Tl(s,Ml,i,Hs(i)),Ni(Hh,s)}}function nf(i,s,c){i==="focusin"?(dc(),Sl=s,Ml=c,Sl.attachEvent("onpropertychange",$h)):i==="focusout"&&dc()}function th(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return El(Ml)}function Xh(i,s){if(i==="click")return El(s)}function Yh(i,s){if(i==="input"||i==="change")return El(s)}function ih(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var La=typeof Object.is=="function"?Object.is:ih;function si(i,s){if(La(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),p=Object.keys(s);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var x=c[p];if(!sn.call(s,x)||!La(i[x],s[x]))return!1}return!0}function jr(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ru(i,s){var c=jr(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=s&&p>=s)return{node:c,offset:s-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=jr(c)}}function su(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?su(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function ou(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=fl(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=fl(i.document)}return s}function lu(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var nh=dn&&"documentMode"in document&&11>=document.documentMode,hr=null,fc=null,pc=null,ah=!1;function Kh(i,s,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ah||hr==null||hr!==fl(p)||(p=hr,"selectionStart"in p&&lu(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),pc&&si(pc,p)||(pc=p,p=Ql(fc,"onSelect"),0<p.length&&(s=new _l("onSelect","select",null,s,c),i.push({event:s,listeners:p}),s.target=hr)))}function Io(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var Ro={animationend:Io("Animation","AnimationEnd"),animationiteration:Io("Animation","AnimationIteration"),animationstart:Io("Animation","AnimationStart"),transitionrun:Io("Transition","TransitionRun"),transitionstart:Io("Transition","TransitionStart"),transitioncancel:Io("Transition","TransitionCancel"),transitionend:Io("Transition","TransitionEnd")},rh={},sh={};dn&&(sh=document.createElement("div").style,"AnimationEvent"in window||(delete Ro.animationend.animation,delete Ro.animationiteration.animation,delete Ro.animationstart.animation),"TransitionEvent"in window||delete Ro.transitionend.transition);function Nr(i){if(rh[i])return rh[i];if(!Ro[i])return i;var s=Ro[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in sh)return rh[i]=s[c];return i}var mc=Nr("animationend"),gc=Nr("animationiteration"),cu=Nr("animationstart"),ko=Nr("transitionrun"),uu=Nr("transitionstart"),Cl=Nr("transitioncancel"),$a=Nr("transitionend"),oh=new Map,hu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hu.push("scrollEnd");function Xa(i,s){oh.set(i,s),Ga(s,[i])}var Ks=new WeakMap;function Ta(i,s){if(typeof i=="object"&&i!==null){var c=Ks.get(i);return c!==void 0?c:(s={value:i,source:s,stack:_o(s)},Ks.set(i,s),s)}return{value:i,source:s,stack:_o(s)}}var Sa=[],Ur=0,Al=0;function Lo(){for(var i=Ur,s=Al=Ur=0;s<i;){var c=Sa[s];Sa[s++]=null;var p=Sa[s];Sa[s++]=null;var x=Sa[s];Sa[s++]=null;var S=Sa[s];if(Sa[s++]=null,p!==null&&x!==null){var U=p.pending;U===null?x.next=x:(x.next=U.next,U.next=x),p.pending=x}S!==0&&_c(c,x,S)}}function us(i,s,c,p){Sa[Ur++]=i,Sa[Ur++]=s,Sa[Ur++]=c,Sa[Ur++]=p,Al|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Qs(i,s,c,p){return us(i,s,c,p),ii(i)}function Bo(i,s){return us(i,null,null,s),ii(i)}function _c(i,s,c){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c);for(var x=!1,S=i.return;S!==null;)S.childLanes|=c,p=S.alternate,p!==null&&(p.childLanes|=c),S.tag===22&&(i=S.stateNode,i===null||i._visibility&1||(x=!0)),i=S,S=S.return;return i.tag===3?(S=i.stateNode,x&&s!==null&&(x=31-zn(c),i=S.hiddenUpdates,p=i[x],p===null?i[x]=[s]:p.push(s),s.lane=c|536870912),S):null}function ii(i){if(50<Sh)throw Sh=0,bd=null,Error(R(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var hs={};function du(i,s,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ma(i,s,c,p){return new du(i,s,c,p)}function Oo(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ds(i,s){var c=i.alternate;return c===null?(c=Ma(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Qh(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function yc(i,s,c,p,x,S){var U=0;if(p=i,typeof i=="function")Oo(i)&&(U=1);else if(typeof i=="string")U=M(i,c,xt.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case li:return i=Ma(31,c,s,x),i.elementType=li,i.lanes=S,i;case Pe:return Fo(c.children,x,S,s);case ht:U=8,x|=24;break;case Tt:return i=Ma(12,c,s,x|2),i.elementType=Tt,i.lanes=S,i;case bt:return i=Ma(13,c,s,x),i.elementType=bt,i.lanes=S,i;case Zt:return i=Ma(19,c,s,x),i.elementType=Zt,i.lanes=S,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case pt:case Pt:U=10;break e;case St:U=9;break e;case qt:U=11;break e;case di:U=14;break e;case Xt:U=16,p=null;break e}U=29,c=Error(R(130,i===null?"null":typeof i,"")),p=null}return s=Ma(U,c,s,x),s.elementType=i,s.type=p,s.lanes=S,s}function Fo(i,s,c,p){return i=Ma(7,i,p,s),i.lanes=c,i}function zl(i,s,c){return i=Ma(6,i,null,s),i.lanes=c,i}function jo(i,s,c){return s=Ma(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var fs=[],Ws=0,No=null,Pl=0,ca=[],ua=0,vr=null,xr=1,Ya="";function Vr(i,s){fs[Ws++]=Pl,fs[Ws++]=No,No=i,Pl=s}function lh(i,s,c){ca[ua++]=xr,ca[ua++]=Ya,ca[ua++]=vr,vr=i;var p=xr;i=Ya;var x=32-zn(p)-1;p&=~(1<<x),c+=1;var S=32-zn(s)+x;if(30<S){var U=x-x%5;S=(p&(1<<U)-1).toString(32),p>>=U,x-=U,xr=1<<32-zn(s)+x|c<<x|p,Ya=S+i}else xr=1<<S|c<<x|p,Ya=i}function Dl(i){i.return!==null&&(Vr(i,1),lh(i,1,0))}function vc(i){for(;i===No;)No=fs[--Ws],fs[Ws]=null,Pl=fs[--Ws],fs[Ws]=null;for(;i===vr;)vr=ca[--ua],ca[ua]=null,Ya=ca[--ua],ca[ua]=null,xr=ca[--ua],ca[ua]=null}var ha=null,fn=null,xi=!1,Zr=null,br=!1,Uo=Error(R(519));function Li(i){var s=Error(R(418,""));throw Oa(Ta(s,i)),Uo}function ps(i){var s=i.stateNode,c=i.type,p=i.memoizedProps;switch(s[Ot]=i,s[Dt]=p,c){case"dialog":_i("cancel",s),_i("close",s);break;case"iframe":case"object":case"embed":_i("load",s);break;case"video":case"audio":for(c=0;c<zh.length;c++)_i(zh[c],s);break;case"source":_i("error",s);break;case"img":case"image":case"link":_i("error",s),_i("load",s);break;case"details":_i("toggle",s);break;case"input":_i("invalid",s),Zs(s,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Yc(s);break;case"select":_i("invalid",s);break;case"textarea":_i("invalid",s),gl(s,p.value,p.defaultValue,p.children),Yc(s)}c=p.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||p.suppressHydrationWarning===!0||jf(s.textContent,c)?(p.popover!=null&&(_i("beforetoggle",s),_i("toggle",s)),p.onScroll!=null&&_i("scroll",s),p.onScrollEnd!=null&&_i("scrollend",s),p.onClick!=null&&(s.onclick=Ih),s=!0):s=!1,s||Li(i)}function Ba(i){for(ha=i.return;ha;)switch(ha.tag){case 5:case 13:br=!1;return;case 27:case 3:br=!0;return;default:ha=ha.return}}function Vo(i){if(i!==ha)return!1;if(!xi)return Ba(i),xi=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Bd(i.type,i.memoizedProps)),c=!c),c&&fn&&Li(i),Ba(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){fn=ja(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}fn=null}}else s===27?(s=fn,nl(i.type)?(i=ea,ea=null,fn=i):fn=s):fn=ha?ja(i.stateNode.nextSibling):null;return!0}function ms(){fn=ha=null,xi=!1}function fu(){var i=Zr;return i!==null&&(nr===null?nr=i:nr.push.apply(nr,i),Zr=null),i}function Oa(i){Zr===null?Zr=[i]:Zr.push(i)}var xc=Ye(null),wr=null,Tr=null;function gs(i,s,c){ct(xc,s._currentValue),s._currentValue=c}function Gr(i){i._currentValue=xc.current,ot(xc)}function pu(i,s,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),i===c)break;i=i.return}}function Js(i,s,c,p){var x=i.child;for(x!==null&&(x.return=i);x!==null;){var S=x.dependencies;if(S!==null){var U=x.child;S=S.firstContext;e:for(;S!==null;){var Y=S;S=x;for(var fe=0;fe<s.length;fe++)if(Y.context===s[fe]){S.lanes|=c,Y=S.alternate,Y!==null&&(Y.lanes|=c),pu(S.return,c,i),p||(U=null);break e}S=Y.next}}else if(x.tag===18){if(U=x.return,U===null)throw Error(R(341));U.lanes|=c,S=U.alternate,S!==null&&(S.lanes|=c),pu(U,c,i),U=null}else U=x.child;if(U!==null)U.return=x;else for(U=x;U!==null;){if(U===i){U=null;break}if(x=U.sibling,x!==null){x.return=U.return,U=x;break}U=U.return}x=U}}function qr(i,s,c,p){i=null;for(var x=s,S=!1;x!==null;){if(!S){if((x.flags&524288)!==0)S=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var U=x.alternate;if(U===null)throw Error(R(387));if(U=U.memoizedProps,U!==null){var Y=x.type;La(x.pendingProps.value,U.value)||(i!==null?i.push(Y):i=[Y])}}else if(x===fi.current){if(U=x.alternate,U===null)throw Error(R(387));U.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(i!==null?i.push(se):i=[se])}x=x.return}i!==null&&Js(s,i,c,p),s.flags|=262144}function wn(i){for(i=i.firstContext;i!==null;){if(!La(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function dr(i){wr=i,Tr=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Qn(i){return ch(wr,i)}function bc(i,s){return wr===null&&dr(i),ch(i,s)}function ch(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Tr===null){if(i===null)throw Error(R(308));Tr=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Tr=Tr.next=s;return c}var Il=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,p){i.push(p)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},uh=E.unstable_scheduleCallback,mu=E.unstable_NormalPriority,On={$$typeof:Pt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eo(){return{controller:new Il,data:new Map,refCount:0}}function Rl(i){i.refCount--,i.refCount===0&&uh(mu,function(){i.controller.abort()})}var Fn=null,Ka=0,Sr=0,da=null;function kl(i,s){if(Fn===null){var c=Fn=[];Ka=0,Sr=Pd(),da={status:"pending",value:void 0,then:function(p){c.push(p)}}}return Ka++,s.then(wc,wc),s}function wc(){if(--Ka===0&&Fn!==null){da!==null&&(da.status="fulfilled");var i=Fn;Fn=null,Sr=0,da=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function af(i,s){var c=[],p={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return i.then(function(){p.status="fulfilled",p.value=s;for(var x=0;x<c.length;x++)(0,c[x])(s)},function(x){for(p.status="rejected",p.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),p}var gu=be.S;be.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&kl(i,s),gu!==null&&gu(i,s)};var Hr=Ye(null);function Tc(){var i=Hr.current;return i!==null?i:Oi.pooledCache}function _s(i,s){s===null?ct(Hr,Hr.current):ct(Hr,s.pool)}function Mr(){var i=Tc();return i===null?null:{parent:On._currentValue,pool:i}}var vt=Error(R(460)),Sc=Error(R(474)),Zo=Error(R(542)),_u={then:function(){}};function Go(i){return i=i.status,i==="fulfilled"||i==="rejected"}function to(){}function yu(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(to,to),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Wh(i),i;default:if(typeof s.status=="string")s.then(to,to);else{if(i=Oi,i!==null&&100<i.shellSuspendCounter)throw Error(R(482));i=s,i.status="pending",i.then(function(p){if(s.status==="pending"){var x=s;x.status="fulfilled",x.value=p}},function(p){if(s.status==="pending"){var x=s;x.status="rejected",x.reason=p}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Wh(i),i}throw ti=s,vt}}var ti=null;function Mc(){if(ti===null)throw Error(R(459));var i=ti;return ti=null,i}function Wh(i){if(i===vt||i===Zo)throw Error(R(483))}var $r=!1;function vu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xu(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Xr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Er(i,s,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Vi&2)!==0){var x=p.pending;return x===null?s.next=s:(s.next=x.next,x.next=s),p.pending=s,s=ii(i),_c(i,null,c),s}return us(i,p,s,c),ii(i)}function ys(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,Be(i,c)}}function hh(i,s){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var x=null,S=null;if(c=c.firstBaseUpdate,c!==null){do{var U={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};S===null?x=S=U:S=S.next=U,c=c.next}while(c!==null);S===null?x=S=s:S=S.next=s}else x=S=s;c={baseState:p.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:p.shared,callbacks:p.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var Ll=!1;function Ec(){if(Ll){var i=da;if(i!==null)throw i}}function Cc(i,s,c,p){Ll=!1;var x=i.updateQueue;$r=!1;var S=x.firstBaseUpdate,U=x.lastBaseUpdate,Y=x.shared.pending;if(Y!==null){x.shared.pending=null;var fe=Y,Le=fe.next;fe.next=null,U===null?S=Le:U.next=Le,U=fe;var Je=i.alternate;Je!==null&&(Je=Je.updateQueue,Y=Je.lastBaseUpdate,Y!==U&&(Y===null?Je.firstBaseUpdate=Le:Y.next=Le,Je.lastBaseUpdate=fe))}if(S!==null){var it=x.baseState;U=0,Je=Le=fe=null,Y=S;do{var Ue=Y.lane&-536870913,qe=Ue!==Y.lane;if(qe?(Si&Ue)===Ue:(p&Ue)===Ue){Ue!==0&&Ue===Sr&&(Ll=!0),Je!==null&&(Je=Je.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});e:{var Qt=i,Yt=Y;Ue=s;var Xi=c;switch(Yt.tag){case 1:if(Qt=Yt.payload,typeof Qt=="function"){it=Qt.call(Xi,it,Ue);break e}it=Qt;break e;case 3:Qt.flags=Qt.flags&-65537|128;case 0:if(Qt=Yt.payload,Ue=typeof Qt=="function"?Qt.call(Xi,it,Ue):Qt,Ue==null)break e;it=Ce({},it,Ue);break e;case 2:$r=!0}}Ue=Y.callback,Ue!==null&&(i.flags|=64,qe&&(i.flags|=8192),qe=x.callbacks,qe===null?x.callbacks=[Ue]:qe.push(Ue))}else qe={lane:Ue,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Je===null?(Le=Je=qe,fe=it):Je=Je.next=qe,U|=Ue;if(Y=Y.next,Y===null){if(Y=x.shared.pending,Y===null)break;qe=Y,Y=qe.next,qe.next=null,x.lastBaseUpdate=qe,x.shared.pending=null}}while(!0);Je===null&&(fe=it),x.baseState=fe,x.firstBaseUpdate=Le,x.lastBaseUpdate=Je,S===null&&(x.shared.lanes=0),Wo|=U,i.lanes=U,i.memoizedState=it}}function Yr(i,s){if(typeof i!="function")throw Error(R(191,i));i.call(s)}function Ui(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Yr(c[i],s)}var Kr=Ye(null),Bl=Ye(0);function dh(i,s){i=uo,ct(Bl,i),ct(Kr,s),uo=i|s.baseLanes}function bu(){ct(Bl,uo),ct(Kr,Kr.current)}function wu(){uo=Bl.current,ot(Kr),ot(Bl)}var io=0,Gt=null,Ei=null,gt=null,jt=!1,Qr=!1,vs=!1,Ol=0,on=0,no=null,fr=0;function Tn(){throw Error(R(321))}function xs(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!La(i[c],s[c]))return!1;return!0}function Wi(i,s,c,p,x,S){return io=S,Gt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,be.H=i===null||i.memoizedState===null?Dc:fh,vs=!1,S=c(p,x),vs=!1,Qr&&(S=qo(s,c,p,x)),Ji(i),S}function Ji(i){be.H=Di;var s=Ei!==null&&Ei.next!==null;if(io=0,gt=Ei=Gt=null,jt=!1,on=0,no=null,s)throw Error(R(300));i===null||aa||(i=i.dependencies,i!==null&&wn(i)&&(aa=!0))}function qo(i,s,c,p){Gt=i;var x=0;do{if(Qr&&(no=null),on=0,Qr=!1,25<=x)throw Error(R(301));if(x+=1,gt=Ei=null,i.updateQueue!=null){var S=i.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}be.H=Jh,S=s(c,p)}while(Qr);return S}function Ac(){var i=be.H,s=i.useState()[0];return s=typeof s.then=="function"?f(s):s,i=i.useState()[0],(Ei!==null?Ei.memoizedState:null)!==i&&(Gt.flags|=1024),s}function Ho(){var i=Ol!==0;return Ol=0,i}function bs(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function zc(i){if(jt){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}jt=!1}io=0,gt=Ei=Gt=null,Qr=!1,on=Ol=0,no=null}function fa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Gt.memoizedState=gt=i:gt=gt.next=i,gt}function en(){if(Ei===null){var i=Gt.alternate;i=i!==null?i.memoizedState:null}else i=Ei.next;var s=gt===null?Gt.memoizedState:gt.next;if(s!==null)gt=s,Ei=i;else{if(i===null)throw Gt.alternate===null?Error(R(467)):Error(R(310));Ei=i,i={memoizedState:Ei.memoizedState,baseState:Ei.baseState,baseQueue:Ei.baseQueue,queue:Ei.queue,next:null},gt===null?Gt.memoizedState=gt=i:gt=gt.next=i}return gt}function Pc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function f(i){var s=on;return on+=1,no===null&&(no=[]),i=yu(no,i,s),s=Gt,(gt===null?s.memoizedState:gt.next)===null&&(s=s.alternate,be.H=s===null||s.memoizedState===null?Dc:fh),i}function e(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return f(i);if(i.$$typeof===Pt)return Qn(i)}throw Error(R(438,String(i)))}function n(i){var s=null,c=Gt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var p=Gt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(s={data:p.data.map(function(x){return x.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Pc(),Gt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),p=0;p<i;p++)c[p]=ni;return s.index++,c}function l(i,s){return typeof s=="function"?s(i):s}function u(i){var s=en();return m(s,Ei,i)}function m(i,s,c){var p=i.queue;if(p===null)throw Error(R(311));p.lastRenderedReducer=c;var x=i.baseQueue,S=p.pending;if(S!==null){if(x!==null){var U=x.next;x.next=S.next,S.next=U}s.baseQueue=x=S,p.pending=null}if(S=i.baseState,x===null)i.memoizedState=S;else{s=x.next;var Y=U=null,fe=null,Le=s,Je=!1;do{var it=Le.lane&-536870913;if(it!==Le.lane?(Si&it)===it:(io&it)===it){var Ue=Le.revertLane;if(Ue===0)fe!==null&&(fe=fe.next={lane:0,revertLane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),it===Sr&&(Je=!0);else if((io&Ue)===Ue){Le=Le.next,Ue===Sr&&(Je=!0);continue}else it={lane:0,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},fe===null?(Y=fe=it,U=S):fe=fe.next=it,Gt.lanes|=Ue,Wo|=Ue;it=Le.action,vs&&c(S,it),S=Le.hasEagerState?Le.eagerState:c(S,it)}else Ue={lane:it,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},fe===null?(Y=fe=Ue,U=S):fe=fe.next=Ue,Gt.lanes|=it,Wo|=it;Le=Le.next}while(Le!==null&&Le!==s);if(fe===null?U=S:fe.next=Y,!La(S,i.memoizedState)&&(aa=!0,Je&&(c=da,c!==null)))throw c;i.memoizedState=S,i.baseState=U,i.baseQueue=fe,p.lastRenderedState=S}return x===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function y(i){var s=en(),c=s.queue;if(c===null)throw Error(R(311));c.lastRenderedReducer=i;var p=c.dispatch,x=c.pending,S=s.memoizedState;if(x!==null){c.pending=null;var U=x=x.next;do S=i(S,U.action),U=U.next;while(U!==x);La(S,s.memoizedState)||(aa=!0),s.memoizedState=S,s.baseQueue===null&&(s.baseState=S),c.lastRenderedState=S}return[S,p]}function b(i,s,c){var p=Gt,x=en(),S=xi;if(S){if(c===void 0)throw Error(R(407));c=c()}else c=s();var U=!La((Ei||x).memoizedState,c);U&&(x.memoizedState=c,aa=!0),x=x.queue;var Y=z.bind(null,p,x,i);if(et(2048,8,Y,[i]),x.getSnapshot!==s||U||gt!==null&&gt.memoizedState.tag&1){if(p.flags|=2048,Fe(9,Ze(),C.bind(null,p,x,c,s),null),Oi===null)throw Error(R(349));S||(io&124)!==0||T(p,s,c)}return c}function T(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Gt.updateQueue,s===null?(s=Pc(),Gt.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function C(i,s,c,p){s.value=c,s.getSnapshot=p,B(s)&&k(i)}function z(i,s,c){return c(function(){B(s)&&k(i)})}function B(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!La(i,c)}catch{return!0}}function k(i){var s=Bo(i,2);s!==null&&Dr(s,i,2)}function Z(i){var s=fa();if(typeof i=="function"){var c=i;if(i=c(),vs){oa(!0);try{c()}finally{oa(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:i},s}function G(i,s,c,p){return i.baseState=c,m(i,Ei,typeof p=="function"?p:l)}function te(i,s,c,p,x){if(pn(i))throw Error(R(485));if(i=s.action,i!==null){var S={payload:x,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){S.listeners.push(U)}};be.T!==null?c(!0):S.isTransition=!1,p(S),c=s.pending,c===null?(S.next=s.pending=S,ee(s,S)):(S.next=c.next,s.pending=c.next=S)}}function ee(i,s){var c=s.action,p=s.payload,x=i.state;if(s.isTransition){var S=be.T,U={};be.T=U;try{var Y=c(x,p),fe=be.S;fe!==null&&fe(U,Y),ie(i,s,Y)}catch(Le){de(i,s,Le)}finally{be.T=S}}else try{S=c(x,p),ie(i,s,S)}catch(Le){de(i,s,Le)}}function ie(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(p){oe(i,s,p)},function(p){return de(i,s,p)}):oe(i,s,c)}function oe(i,s,c){s.status="fulfilled",s.value=c,he(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,ee(i,c)))}function de(i,s,c){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do s.status="rejected",s.reason=c,he(s),s=s.next;while(s!==p)}i.action=null}function he(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function me(i,s){return s}function xe(i,s){if(xi){var c=Oi.formState;if(c!==null){e:{var p=Gt;if(xi){if(fn){t:{for(var x=fn,S=br;x.nodeType!==8;){if(!S){x=null;break t}if(x=ja(x.nextSibling),x===null){x=null;break t}}S=x.data,x=S==="F!"||S==="F"?x:null}if(x){fn=ja(x.nextSibling),p=x.data==="F!";break e}}Li(p)}p=!1}p&&(s=c[0])}}return c=fa(),c.memoizedState=c.baseState=s,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:me,lastRenderedState:s},c.queue=p,c=Ms.bind(null,Gt,p),p.dispatch=c,p=Z(!1),S=Jr.bind(null,Gt,!1,p.queue),p=fa(),x={state:s,dispatch:null,action:i,pending:null},p.queue=x,c=te.bind(null,Gt,x,S,c),x.dispatch=c,p.memoizedState=i,[s,c,!1]}function _e(i){var s=en();return Ie(s,Ei,i)}function Ie(i,s,c){if(s=m(i,s,me)[0],i=u(l)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var p=f(s)}catch(U){throw U===vt?Zo:U}else p=s;s=en();var x=s.queue,S=x.dispatch;return c!==s.memoizedState&&(Gt.flags|=2048,Fe(9,Ze(),$e.bind(null,x,c),null)),[p,S,i]}function $e(i,s){i.action=s}function je(i){var s=en(),c=Ei;if(c!==null)return Ie(s,c,i);en(),s=s.memoizedState,c=en();var p=c.queue.dispatch;return c.memoizedState=i,[s,p,!1]}function Fe(i,s,c,p){return i={tag:i,create:c,deps:p,inst:s,next:null},s=Gt.updateQueue,s===null&&(s=Pc(),Gt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,s.lastEffect=i),i}function Ze(){return{destroy:void 0,resource:void 0}}function dt(){return en().memoizedState}function ut(i,s,c,p){var x=fa();p=p===void 0?null:p,Gt.flags|=i,x.memoizedState=Fe(1|s,Ze(),c,p)}function et(i,s,c,p){var x=en();p=p===void 0?null:p;var S=x.memoizedState.inst;Ei!==null&&p!==null&&xs(p,Ei.memoizedState.deps)?x.memoizedState=Fe(s,S,c,p):(Gt.flags|=i,x.memoizedState=Fe(1|s,S,c,p))}function Mt(i,s){ut(8390656,8,i,s)}function ei(i,s){et(2048,8,i,s)}function oi(i,s){return et(4,2,i,s)}function tn(i,s){return et(4,4,i,s)}function Pi(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function nn(i,s,c){c=c!=null?c.concat([i]):null,et(4,4,Pi.bind(null,s,i),c)}function Hi(){}function Bi(i,s){var c=en();s=s===void 0?null:s;var p=c.memoizedState;return s!==null&&xs(s,p[1])?p[0]:(c.memoizedState=[i,s],i)}function bi(i,s){var c=en();s=s===void 0?null:s;var p=c.memoizedState;if(s!==null&&xs(s,p[1]))return p[0];if(p=i(),vs){oa(!0);try{i()}finally{oa(!1)}}return c.memoizedState=[p,s],p}function Pn(i,s,c){return c===void 0||(io&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=wd(),Gt.lanes|=i,Wo|=i,c)}function Vn(i,s,c,p){return La(c,s)?c:Kr.current!==null?(i=Pn(i,c,p),La(i,s)||(aa=!0),i):(io&42)===0?(aa=!0,i.memoizedState=c):(i=wd(),Gt.lanes|=i,Wo|=i,s)}function Wn(i,s,c,p,x){var S=Ke.p;Ke.p=S!==0&&8>S?S:8;var U=be.T,Y={};be.T=Y,Jr(i,!1,s,c);try{var fe=x(),Le=be.S;if(Le!==null&&Le(Y,fe),fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Je=af(fe,p);Wa(i,s,Je,ar(i))}else Wa(i,s,p,ar(i))}catch(it){Wa(i,s,{then:function(){},status:"rejected",reason:it},ar())}finally{Ke.p=S,be.T=U}}function Ti(){}function Wr(i,s,c,p){if(i.tag!==5)throw Error(R(476));var x=Cr(i).queue;Wn(i,x,s,Ge,c===null?Ti:function(){return ws(i),c(p)})}function Cr(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ge,baseState:Ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:Ge},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function ws(i){var s=Cr(i).next.queue;Wa(i,s,{},ar())}function Ts(){return Qn(se)}function Fl(){return en().memoizedState}function Ss(){return en().memoizedState}function $o(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=ar();i=Xr(c);var p=Er(s,i,c);p!==null&&(Dr(p,s,c),ys(p,s,c)),s={cache:eo()},i.payload=s;return}s=s.return}}function Qa(i,s,c){var p=ar();c={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},pn(i)?Dn(s,c):(c=Qs(i,s,c,p),c!==null&&(Dr(c,i,p),pa(c,s,p)))}function Ms(i,s,c){var p=ar();Wa(i,s,c,p)}function Wa(i,s,c,p){var x={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(pn(i))Dn(s,x);else{var S=i.alternate;if(i.lanes===0&&(S===null||S.lanes===0)&&(S=s.lastRenderedReducer,S!==null))try{var U=s.lastRenderedState,Y=S(U,c);if(x.hasEagerState=!0,x.eagerState=Y,La(Y,U))return us(i,s,x,0),Oi===null&&Lo(),!1}catch{}finally{}if(c=Qs(i,s,x,p),c!==null)return Dr(c,i,p),pa(c,s,p),!0}return!1}function Jr(i,s,c,p){if(p={lane:2,revertLane:Pd(),action:p,hasEagerState:!1,eagerState:null,next:null},pn(i)){if(s)throw Error(R(479))}else s=Qs(i,c,p,2),s!==null&&Dr(s,i,2)}function pn(i){var s=i.alternate;return i===Gt||s!==null&&s===Gt}function Dn(i,s){Qr=jt=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function pa(i,s,c){if((c&4194048)!==0){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,Be(i,c)}}var Di={readContext:Qn,use:e,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn},Dc={readContext:Qn,use:e,useCallback:function(i,s){return fa().memoizedState=[i,s===void 0?null:s],i},useContext:Qn,useEffect:Mt,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,ut(4194308,4,Pi.bind(null,s,i),c)},useLayoutEffect:function(i,s){return ut(4194308,4,i,s)},useInsertionEffect:function(i,s){ut(4,2,i,s)},useMemo:function(i,s){var c=fa();s=s===void 0?null:s;var p=i();if(vs){oa(!0);try{i()}finally{oa(!1)}}return c.memoizedState=[p,s],p},useReducer:function(i,s,c){var p=fa();if(c!==void 0){var x=c(s);if(vs){oa(!0);try{c(s)}finally{oa(!1)}}}else x=s;return p.memoizedState=p.baseState=x,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:x},p.queue=i,i=i.dispatch=Qa.bind(null,Gt,i),[p.memoizedState,i]},useRef:function(i){var s=fa();return i={current:i},s.memoizedState=i},useState:function(i){i=Z(i);var s=i.queue,c=Ms.bind(null,Gt,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:Hi,useDeferredValue:function(i,s){var c=fa();return Pn(c,i,s)},useTransition:function(){var i=Z(!1);return i=Wn.bind(null,Gt,i.queue,!0,!1),fa().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var p=Gt,x=fa();if(xi){if(c===void 0)throw Error(R(407));c=c()}else{if(c=s(),Oi===null)throw Error(R(349));(Si&124)!==0||T(p,s,c)}x.memoizedState=c;var S={value:c,getSnapshot:s};return x.queue=S,Mt(z.bind(null,p,S,i),[i]),p.flags|=2048,Fe(9,Ze(),C.bind(null,p,S,c,s),null),c},useId:function(){var i=fa(),s=Oi.identifierPrefix;if(xi){var c=Ya,p=xr;c=(p&~(1<<32-zn(p)-1)).toString(32)+c,s=""+s+"R"+c,c=Ol++,0<c&&(s+="H"+c.toString(32)),s+=""}else c=fr++,s=""+s+"r"+c.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Ts,useFormState:xe,useActionState:xe,useOptimistic:function(i){var s=fa();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Jr.bind(null,Gt,!0,c),c.dispatch=s,[i,s]},useMemoCache:n,useCacheRefresh:function(){return fa().memoizedState=$o.bind(null,Gt)}},fh={readContext:Qn,use:e,useCallback:Bi,useContext:Qn,useEffect:ei,useImperativeHandle:nn,useInsertionEffect:oi,useLayoutEffect:tn,useMemo:bi,useReducer:u,useRef:dt,useState:function(){return u(l)},useDebugValue:Hi,useDeferredValue:function(i,s){var c=en();return Vn(c,Ei.memoizedState,i,s)},useTransition:function(){var i=u(l)[0],s=en().memoizedState;return[typeof i=="boolean"?i:f(i),s]},useSyncExternalStore:b,useId:Fl,useHostTransitionStatus:Ts,useFormState:_e,useActionState:_e,useOptimistic:function(i,s){var c=en();return G(c,Ei,i,s)},useMemoCache:n,useCacheRefresh:Ss},Jh={readContext:Qn,use:e,useCallback:Bi,useContext:Qn,useEffect:ei,useImperativeHandle:nn,useInsertionEffect:oi,useLayoutEffect:tn,useMemo:bi,useReducer:y,useRef:dt,useState:function(){return y(l)},useDebugValue:Hi,useDeferredValue:function(i,s){var c=en();return Ei===null?Pn(c,i,s):Vn(c,Ei.memoizedState,i,s)},useTransition:function(){var i=y(l)[0],s=en().memoizedState;return[typeof i=="boolean"?i:f(i),s]},useSyncExternalStore:b,useId:Fl,useHostTransitionStatus:Ts,useFormState:je,useActionState:je,useOptimistic:function(i,s){var c=en();return Ei!==null?G(c,Ei,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:n,useCacheRefresh:Ss},jl=null,Xo=0;function ao(i){var s=Xo;return Xo+=1,jl===null&&(jl=[]),yu(jl,i,s)}function ma(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Ja(i,s){throw s.$$typeof===Ne?Error(R(525)):(i=Object.prototype.toString.call(s),Error(R(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function er(i){var s=i._init;return s(i._payload)}function es(i){function s(Ae,Te){if(i){var ke=Ae.deletions;ke===null?(Ae.deletions=[Te],Ae.flags|=16):ke.push(Te)}}function c(Ae,Te){if(!i)return null;for(;Te!==null;)s(Ae,Te),Te=Te.sibling;return null}function p(Ae){for(var Te=new Map;Ae!==null;)Ae.key!==null?Te.set(Ae.key,Ae):Te.set(Ae.index,Ae),Ae=Ae.sibling;return Te}function x(Ae,Te){return Ae=ds(Ae,Te),Ae.index=0,Ae.sibling=null,Ae}function S(Ae,Te,ke){return Ae.index=ke,i?(ke=Ae.alternate,ke!==null?(ke=ke.index,ke<Te?(Ae.flags|=67108866,Te):ke):(Ae.flags|=67108866,Te)):(Ae.flags|=1048576,Te)}function U(Ae){return i&&Ae.alternate===null&&(Ae.flags|=67108866),Ae}function Y(Ae,Te,ke,at){return Te===null||Te.tag!==6?(Te=zl(ke,Ae.mode,at),Te.return=Ae,Te):(Te=x(Te,ke),Te.return=Ae,Te)}function fe(Ae,Te,ke,at){var Lt=ke.type;return Lt===Pe?Je(Ae,Te,ke.props.children,at,ke.key):Te!==null&&(Te.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===Xt&&er(Lt)===Te.type)?(Te=x(Te,ke.props),ma(Te,ke),Te.return=Ae,Te):(Te=yc(ke.type,ke.key,ke.props,null,Ae.mode,at),ma(Te,ke),Te.return=Ae,Te)}function Le(Ae,Te,ke,at){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==ke.containerInfo||Te.stateNode.implementation!==ke.implementation?(Te=jo(ke,Ae.mode,at),Te.return=Ae,Te):(Te=x(Te,ke.children||[]),Te.return=Ae,Te)}function Je(Ae,Te,ke,at,Lt){return Te===null||Te.tag!==7?(Te=Fo(ke,Ae.mode,at,Lt),Te.return=Ae,Te):(Te=x(Te,ke),Te.return=Ae,Te)}function it(Ae,Te,ke){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=zl(""+Te,Ae.mode,ke),Te.return=Ae,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case Se:return ke=yc(Te.type,Te.key,Te.props,null,Ae.mode,ke),ma(ke,Te),ke.return=Ae,ke;case pe:return Te=jo(Te,Ae.mode,ke),Te.return=Ae,Te;case Xt:var at=Te._init;return Te=at(Te._payload),it(Ae,Te,ke)}if(mt(Te)||wi(Te))return Te=Fo(Te,Ae.mode,ke,null),Te.return=Ae,Te;if(typeof Te.then=="function")return it(Ae,ao(Te),ke);if(Te.$$typeof===Pt)return it(Ae,bc(Ae,Te),ke);Ja(Ae,Te)}return null}function Ue(Ae,Te,ke,at){var Lt=Te!==null?Te.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return Lt!==null?null:Y(Ae,Te,""+ke,at);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case Se:return ke.key===Lt?fe(Ae,Te,ke,at):null;case pe:return ke.key===Lt?Le(Ae,Te,ke,at):null;case Xt:return Lt=ke._init,ke=Lt(ke._payload),Ue(Ae,Te,ke,at)}if(mt(ke)||wi(ke))return Lt!==null?null:Je(Ae,Te,ke,at,null);if(typeof ke.then=="function")return Ue(Ae,Te,ao(ke),at);if(ke.$$typeof===Pt)return Ue(Ae,Te,bc(Ae,ke),at);Ja(Ae,ke)}return null}function qe(Ae,Te,ke,at,Lt){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Ae=Ae.get(ke)||null,Y(Te,Ae,""+at,Lt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case Se:return Ae=Ae.get(at.key===null?ke:at.key)||null,fe(Te,Ae,at,Lt);case pe:return Ae=Ae.get(at.key===null?ke:at.key)||null,Le(Te,Ae,at,Lt);case Xt:var Wt=at._init;return at=Wt(at._payload),qe(Ae,Te,ke,at,Lt)}if(mt(at)||wi(at))return Ae=Ae.get(ke)||null,Je(Te,Ae,at,Lt,null);if(typeof at.then=="function")return qe(Ae,Te,ke,ao(at),Lt);if(at.$$typeof===Pt)return qe(Ae,Te,ke,bc(Te,at),Lt);Ja(Te,at)}return null}function Qt(Ae,Te,ke,at){for(var Lt=null,Wt=null,Ut=Te,Kt=Te=0,xa=null;Ut!==null&&Kt<ke.length;Kt++){Ut.index>Kt?(xa=Ut,Ut=null):xa=Ut.sibling;var Ai=Ue(Ae,Ut,ke[Kt],at);if(Ai===null){Ut===null&&(Ut=xa);break}i&&Ut&&Ai.alternate===null&&s(Ae,Ut),Te=S(Ai,Te,Kt),Wt===null?Lt=Ai:Wt.sibling=Ai,Wt=Ai,Ut=xa}if(Kt===ke.length)return c(Ae,Ut),xi&&Vr(Ae,Kt),Lt;if(Ut===null){for(;Kt<ke.length;Kt++)Ut=it(Ae,ke[Kt],at),Ut!==null&&(Te=S(Ut,Te,Kt),Wt===null?Lt=Ut:Wt.sibling=Ut,Wt=Ut);return xi&&Vr(Ae,Kt),Lt}for(Ut=p(Ut);Kt<ke.length;Kt++)xa=qe(Ut,Ae,Kt,ke[Kt],at),xa!==null&&(i&&xa.alternate!==null&&Ut.delete(xa.key===null?Kt:xa.key),Te=S(xa,Te,Kt),Wt===null?Lt=xa:Wt.sibling=xa,Wt=xa);return i&&Ut.forEach(function(Jl){return s(Ae,Jl)}),xi&&Vr(Ae,Kt),Lt}function Yt(Ae,Te,ke,at){if(ke==null)throw Error(R(151));for(var Lt=null,Wt=null,Ut=Te,Kt=Te=0,xa=null,Ai=ke.next();Ut!==null&&!Ai.done;Kt++,Ai=ke.next()){Ut.index>Kt?(xa=Ut,Ut=null):xa=Ut.sibling;var Jl=Ue(Ae,Ut,Ai.value,at);if(Jl===null){Ut===null&&(Ut=xa);break}i&&Ut&&Jl.alternate===null&&s(Ae,Ut),Te=S(Jl,Te,Kt),Wt===null?Lt=Jl:Wt.sibling=Jl,Wt=Jl,Ut=xa}if(Ai.done)return c(Ae,Ut),xi&&Vr(Ae,Kt),Lt;if(Ut===null){for(;!Ai.done;Kt++,Ai=ke.next())Ai=it(Ae,Ai.value,at),Ai!==null&&(Te=S(Ai,Te,Kt),Wt===null?Lt=Ai:Wt.sibling=Ai,Wt=Ai);return xi&&Vr(Ae,Kt),Lt}for(Ut=p(Ut);!Ai.done;Kt++,Ai=ke.next())Ai=qe(Ut,Ae,Kt,Ai.value,at),Ai!==null&&(i&&Ai.alternate!==null&&Ut.delete(Ai.key===null?Kt:Ai.key),Te=S(Ai,Te,Kt),Wt===null?Lt=Ai:Wt.sibling=Ai,Wt=Ai);return i&&Ut.forEach(function(Pa){return s(Ae,Pa)}),xi&&Vr(Ae,Kt),Lt}function Xi(Ae,Te,ke,at){if(typeof ke=="object"&&ke!==null&&ke.type===Pe&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case Se:e:{for(var Lt=ke.key;Te!==null;){if(Te.key===Lt){if(Lt=ke.type,Lt===Pe){if(Te.tag===7){c(Ae,Te.sibling),at=x(Te,ke.props.children),at.return=Ae,Ae=at;break e}}else if(Te.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===Xt&&er(Lt)===Te.type){c(Ae,Te.sibling),at=x(Te,ke.props),ma(at,ke),at.return=Ae,Ae=at;break e}c(Ae,Te);break}else s(Ae,Te);Te=Te.sibling}ke.type===Pe?(at=Fo(ke.props.children,Ae.mode,at,ke.key),at.return=Ae,Ae=at):(at=yc(ke.type,ke.key,ke.props,null,Ae.mode,at),ma(at,ke),at.return=Ae,Ae=at)}return U(Ae);case pe:e:{for(Lt=ke.key;Te!==null;){if(Te.key===Lt)if(Te.tag===4&&Te.stateNode.containerInfo===ke.containerInfo&&Te.stateNode.implementation===ke.implementation){c(Ae,Te.sibling),at=x(Te,ke.children||[]),at.return=Ae,Ae=at;break e}else{c(Ae,Te);break}else s(Ae,Te);Te=Te.sibling}at=jo(ke,Ae.mode,at),at.return=Ae,Ae=at}return U(Ae);case Xt:return Lt=ke._init,ke=Lt(ke._payload),Xi(Ae,Te,ke,at)}if(mt(ke))return Qt(Ae,Te,ke,at);if(wi(ke)){if(Lt=wi(ke),typeof Lt!="function")throw Error(R(150));return ke=Lt.call(ke),Yt(Ae,Te,ke,at)}if(typeof ke.then=="function")return Xi(Ae,Te,ao(ke),at);if(ke.$$typeof===Pt)return Xi(Ae,Te,bc(Ae,ke),at);Ja(Ae,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint"?(ke=""+ke,Te!==null&&Te.tag===6?(c(Ae,Te.sibling),at=x(Te,ke),at.return=Ae,Ae=at):(c(Ae,Te),at=zl(ke,Ae.mode,at),at.return=Ae,Ae=at),U(Ae)):c(Ae,Te)}return function(Ae,Te,ke,at){try{Xo=0;var Lt=Xi(Ae,Te,ke,at);return jl=null,Lt}catch(Ut){if(Ut===vt||Ut===Zo)throw Ut;var Wt=Ma(29,Ut,null,Ae.mode);return Wt.lanes=at,Wt.return=Ae,Wt}finally{}}}var Es=es(!0),Cs=es(!1),Fa=Ye(null),As=null;function ro(i){var s=i.alternate;ct(Jn,Jn.current&1),ct(Fa,i),As===null&&(s===null||Kr.current!==null||s.memoizedState!==null)&&(As=i)}function rf(i){if(i.tag===22){if(ct(Jn,Jn.current),ct(Fa,i),As===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(As=i)}}else pr()}function pr(){ct(Jn,Jn.current),ct(Fa,Fa.current)}function tr(i){ot(Fa),As===i&&(As=null),ot(Jn)}var Jn=Ye(0);function ed(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Zf(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function ph(i,s,c,p){s=i.memoizedState,c=c(p,s),c=c==null?s:Ce({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var td={enqueueSetState:function(i,s,c){i=i._reactInternals;var p=ar(),x=Xr(p);x.payload=s,c!=null&&(x.callback=c),s=Er(i,x,p),s!==null&&(Dr(s,i,p),ys(s,i,p))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var p=ar(),x=Xr(p);x.tag=1,x.payload=s,c!=null&&(x.callback=c),s=Er(i,x,p),s!==null&&(Dr(s,i,p),ys(s,i,p))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=ar(),p=Xr(c);p.tag=2,s!=null&&(p.callback=s),s=Er(i,p,c),s!==null&&(Dr(s,i,c),ys(s,i,c))}};function ap(i,s,c,p,x,S,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,S,U):s.prototype&&s.prototype.isPureReactComponent?!si(c,p)||!si(x,S):!0}function sf(i,s,c,p){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,p),s.state!==i&&td.enqueueReplaceState(s,s.state,null)}function Ic(i,s){var c=s;if("ref"in s){c={};for(var p in s)p!=="ref"&&(c[p]=s[p])}if(i=i.defaultProps){c===s&&(c=Ce({},c));for(var x in i)c[x]===void 0&&(c[x]=i[x])}return c}var Tu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function rp(i){Tu(i)}function id(i){console.error(i)}function of(i){Tu(i)}function mh(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(p){setTimeout(function(){throw p})}}function Nl(i,s,c){try{var p=i.onCaughtError;p(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function lf(i,s,c){return c=Xr(c),c.tag=3,c.payload={element:null},c.callback=function(){mh(i,s)},c}function Su(i){return i=Xr(i),i.tag=3,i}function gh(i,s,c,p){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var S=p.value;i.payload=function(){return x(S)},i.callback=function(){Nl(s,c,p)}}var U=c.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(i.callback=function(){Nl(s,c,p),typeof x!="function"&&($l===null?$l=new Set([this]):$l.add(this));var Y=p.stack;this.componentDidCatch(p.value,{componentStack:Y!==null?Y:""})})}function nd(i,s,c,p,x){if(c.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(s=c.alternate,s!==null&&qr(s,c,x,!0),c=Fa.current,c!==null){switch(c.tag){case 13:return As===null?Yl():c.alternate===null&&En===0&&(En=3),c.flags&=-257,c.flags|=65536,c.lanes=x,p===_u?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([p]):s.add(p),Cd(i,p,x)),!1;case 22:return c.flags|=65536,p===_u?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([p])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([p]):c.add(p)),Cd(i,p,x)),!1}throw Error(R(435,c.tag))}return Cd(i,p,x),Yl(),!1}if(xi)return s=Fa.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=x,p!==Uo&&(i=Error(R(422),{cause:p}),Oa(Ta(i,c)))):(p!==Uo&&(s=Error(R(423),{cause:p}),Oa(Ta(s,c))),i=i.current.alternate,i.flags|=65536,x&=-x,i.lanes|=x,p=Ta(p,c),x=lf(i.stateNode,p,x),hh(i,x),En!==4&&(En=2)),!1;var S=Error(R(520),{cause:p});if(S=Ta(S,c),wh===null?wh=[S]:wh.push(S),En!==4&&(En=2),s===null)return!0;p=Ta(p,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=x&-x,c.lanes|=i,i=lf(c.stateNode,p,i),hh(c,i),!1;case 1:if(s=c.type,S=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&($l===null||!$l.has(S))))return c.flags|=65536,x&=-x,c.lanes|=x,x=Su(x),gh(x,i,c,p),hh(c,x),!1}c=c.return}while(c!==null);return!1}var cf=Error(R(461)),aa=!1;function Ea(i,s,c,p){s.child=i===null?Cs(s,null,c,p):Es(s,i.child,c,p)}function sp(i,s,c,p,x){c=c.render;var S=s.ref;if("ref"in p){var U={};for(var Y in p)Y!=="ref"&&(U[Y]=p[Y])}else U=p;return dr(s),p=Wi(i,s,c,U,S,x),Y=Ho(),i!==null&&!aa?(bs(i,s,x),so(i,s,x)):(xi&&Y&&Dl(s),s.flags|=1,Ea(i,s,p,x),s.child)}function uf(i,s,c,p,x){if(i===null){var S=c.type;return typeof S=="function"&&!Oo(S)&&S.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=S,hf(i,s,S,p,x)):(i=yc(c.type,null,p,s,s.mode,x),i.ref=s.ref,i.return=s,s.child=i)}if(S=i.child,!Yo(i,x)){var U=S.memoizedProps;if(c=c.compare,c=c!==null?c:si,c(U,p)&&i.ref===s.ref)return so(i,s,x)}return s.flags|=1,i=ds(S,p),i.ref=s.ref,i.return=s,s.child=i}function hf(i,s,c,p,x){if(i!==null){var S=i.memoizedProps;if(si(S,p)&&i.ref===s.ref)if(aa=!1,s.pendingProps=p=S,Yo(i,x))(i.flags&131072)!==0&&(aa=!0);else return s.lanes=i.lanes,so(i,s,x)}return ad(i,s,c,p,x)}function df(i,s,c){var p=s.pendingProps,x=p.children,S=i!==null?i.memoizedState:null;if(p.mode==="hidden"){if((s.flags&128)!==0){if(p=S!==null?S.baseLanes|c:c,i!==null){for(x=s.child=i.child,S=0;x!==null;)S=S|x.lanes|x.childLanes,x=x.sibling;s.childLanes=S&~p}else s.childLanes=0,s.child=null;return op(i,s,p,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&_s(s,S!==null?S.cachePool:null),S!==null?dh(s,S):bu(),rf(s);else return s.lanes=s.childLanes=536870912,op(i,s,S!==null?S.baseLanes|c:c,c)}else S!==null?(_s(s,S.cachePool),dh(s,S),pr(),s.memoizedState=null):(i!==null&&_s(s,null),bu(),pr());return Ea(i,s,x,c),s.child}function op(i,s,c,p){var x=Tc();return x=x===null?null:{parent:On._currentValue,pool:x},s.memoizedState={baseLanes:c,cachePool:x},i!==null&&_s(s,null),bu(),rf(s),i!==null&&qr(i,s,p,!0),null}function Mu(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(R(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function ad(i,s,c,p,x){return dr(s),c=Wi(i,s,c,p,void 0,x),p=Ho(),i!==null&&!aa?(bs(i,s,x),so(i,s,x)):(xi&&p&&Dl(s),s.flags|=1,Ea(i,s,c,x),s.child)}function rd(i,s,c,p,x,S){return dr(s),s.updateQueue=null,c=qo(s,p,c,x),Ji(i),p=Ho(),i!==null&&!aa?(bs(i,s,S),so(i,s,S)):(xi&&p&&Dl(s),s.flags|=1,Ea(i,s,c,S),s.child)}function Eu(i,s,c,p,x){if(dr(s),s.stateNode===null){var S=hs,U=c.contextType;typeof U=="object"&&U!==null&&(S=Qn(U)),S=new c(p,S),s.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=td,s.stateNode=S,S._reactInternals=s,S=s.stateNode,S.props=p,S.state=s.memoizedState,S.refs={},vu(s),U=c.contextType,S.context=typeof U=="object"&&U!==null?Qn(U):hs,S.state=s.memoizedState,U=c.getDerivedStateFromProps,typeof U=="function"&&(ph(s,c,U,p),S.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(U=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),U!==S.state&&td.enqueueReplaceState(S,S.state,null),Cc(s,p,S,x),Ec(),S.state=s.memoizedState),typeof S.componentDidMount=="function"&&(s.flags|=4194308),p=!0}else if(i===null){S=s.stateNode;var Y=s.memoizedProps,fe=Ic(c,Y);S.props=fe;var Le=S.context,Je=c.contextType;U=hs,typeof Je=="object"&&Je!==null&&(U=Qn(Je));var it=c.getDerivedStateFromProps;Je=typeof it=="function"||typeof S.getSnapshotBeforeUpdate=="function",Y=s.pendingProps!==Y,Je||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(Y||Le!==U)&&sf(s,S,p,U),$r=!1;var Ue=s.memoizedState;S.state=Ue,Cc(s,p,S,x),Ec(),Le=s.memoizedState,Y||Ue!==Le||$r?(typeof it=="function"&&(ph(s,c,it,p),Le=s.memoizedState),(fe=$r||ap(s,c,fe,p,Ue,Le,U))?(Je||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(s.flags|=4194308)):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=Le),S.props=p,S.state=Le,S.context=U,p=fe):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{S=s.stateNode,xu(i,s),U=s.memoizedProps,Je=Ic(c,U),S.props=Je,it=s.pendingProps,Ue=S.context,Le=c.contextType,fe=hs,typeof Le=="object"&&Le!==null&&(fe=Qn(Le)),Y=c.getDerivedStateFromProps,(Le=typeof Y=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(U!==it||Ue!==fe)&&sf(s,S,p,fe),$r=!1,Ue=s.memoizedState,S.state=Ue,Cc(s,p,S,x),Ec();var qe=s.memoizedState;U!==it||Ue!==qe||$r||i!==null&&i.dependencies!==null&&wn(i.dependencies)?(typeof Y=="function"&&(ph(s,c,Y,p),qe=s.memoizedState),(Je=$r||ap(s,c,Je,p,Ue,qe,fe)||i!==null&&i.dependencies!==null&&wn(i.dependencies))?(Le||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(p,qe,fe),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(p,qe,fe)),typeof S.componentDidUpdate=="function"&&(s.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof S.componentDidUpdate!="function"||U===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=qe),S.props=p,S.state=qe,S.context=fe,p=Je):(typeof S.componentDidUpdate!="function"||U===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=1024),p=!1)}return S=p,Mu(i,s),p=(s.flags&128)!==0,S||p?(S=s.stateNode,c=p&&typeof c.getDerivedStateFromError!="function"?null:S.render(),s.flags|=1,i!==null&&p?(s.child=Es(s,i.child,null,x),s.child=Es(s,null,c,x)):Ea(i,s,c,x),s.memoizedState=S.state,i=s.child):i=so(i,s,x),i}function mr(i,s,c,p){return ms(),s.flags|=256,Ea(i,s,c,p),s.child}var sd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _h(i){return{baseLanes:i,cachePool:Mr()}}function ff(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=is),i}function pf(i,s,c){var p=s.pendingProps,x=!1,S=(s.flags&128)!==0,U;if((U=S)||(U=i!==null&&i.memoizedState===null?!1:(Jn.current&2)!==0),U&&(x=!0,s.flags&=-129),U=(s.flags&32)!==0,s.flags&=-33,i===null){if(xi){if(x?ro(s):pr(),xi){var Y=fn,fe;if(fe=Y){e:{for(fe=Y,Y=br;fe.nodeType!==8;){if(!Y){Y=null;break e}if(fe=ja(fe.nextSibling),fe===null){Y=null;break e}}Y=fe}Y!==null?(s.memoizedState={dehydrated:Y,treeContext:vr!==null?{id:xr,overflow:Ya}:null,retryLane:536870912,hydrationErrors:null},fe=Ma(18,null,null,0),fe.stateNode=Y,fe.return=s,s.child=fe,ha=s,fn=null,fe=!0):fe=!1}fe||Li(s)}if(Y=s.memoizedState,Y!==null&&(Y=Y.dehydrated,Y!==null))return Zf(Y)?s.lanes=32:s.lanes=536870912,null;tr(s)}return Y=p.children,p=p.fallback,x?(pr(),x=s.mode,Y=od({mode:"hidden",children:Y},x),p=Fo(p,x,c,null),Y.return=s,p.return=s,Y.sibling=p,s.child=Y,x=s.child,x.memoizedState=_h(c),x.childLanes=ff(i,U,c),s.memoizedState=sd,p):(ro(s),mf(s,Y))}if(fe=i.memoizedState,fe!==null&&(Y=fe.dehydrated,Y!==null)){if(S)s.flags&256?(ro(s),s.flags&=-257,s=gf(i,s,c)):s.memoizedState!==null?(pr(),s.child=i.child,s.flags|=128,s=null):(pr(),x=p.fallback,Y=s.mode,p=od({mode:"visible",children:p.children},Y),x=Fo(x,Y,c,null),x.flags|=2,p.return=s,x.return=s,p.sibling=x,s.child=p,Es(s,i.child,null,c),p=s.child,p.memoizedState=_h(c),p.childLanes=ff(i,U,c),s.memoizedState=sd,s=x);else if(ro(s),Zf(Y)){if(U=Y.nextSibling&&Y.nextSibling.dataset,U)var Le=U.dgst;U=Le,p=Error(R(419)),p.stack="",p.digest=U,Oa({value:p,source:null,stack:null}),s=gf(i,s,c)}else if(aa||qr(i,s,c,!1),U=(c&i.childLanes)!==0,aa||U){if(U=Oi,U!==null&&(p=c&-c,p=(p&42)!==0?1:Ee(p),p=(p&(U.suspendedLanes|c))!==0?0:p,p!==0&&p!==fe.retryLane))throw fe.retryLane=p,Bo(i,p),Dr(U,i,p),cf;Y.data==="$?"||Yl(),s=gf(i,s,c)}else Y.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=fe.treeContext,fn=ja(Y.nextSibling),ha=s,xi=!0,Zr=null,br=!1,i!==null&&(ca[ua++]=xr,ca[ua++]=Ya,ca[ua++]=vr,xr=i.id,Ya=i.overflow,vr=s),s=mf(s,p.children),s.flags|=4096);return s}return x?(pr(),x=p.fallback,Y=s.mode,fe=i.child,Le=fe.sibling,p=ds(fe,{mode:"hidden",children:p.children}),p.subtreeFlags=fe.subtreeFlags&65011712,Le!==null?x=ds(Le,x):(x=Fo(x,Y,c,null),x.flags|=2),x.return=s,p.return=s,p.sibling=x,s.child=p,p=x,x=s.child,Y=i.child.memoizedState,Y===null?Y=_h(c):(fe=Y.cachePool,fe!==null?(Le=On._currentValue,fe=fe.parent!==Le?{parent:Le,pool:Le}:fe):fe=Mr(),Y={baseLanes:Y.baseLanes|c,cachePool:fe}),x.memoizedState=Y,x.childLanes=ff(i,U,c),s.memoizedState=sd,p):(ro(s),c=i.child,i=c.sibling,c=ds(c,{mode:"visible",children:p.children}),c.return=s,c.sibling=null,i!==null&&(U=s.deletions,U===null?(s.deletions=[i],s.flags|=16):U.push(i)),s.child=c,s.memoizedState=null,c)}function mf(i,s){return s=od({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function od(i,s){return i=Ma(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function gf(i,s,c){return Es(s,i.child,null,c),i=mf(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function lp(i,s,c){i.lanes|=s;var p=i.alternate;p!==null&&(p.lanes|=s),pu(i.return,s,c)}function yh(i,s,c,p,x){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:x}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=p,S.tail=c,S.tailMode=x)}function ld(i,s,c){var p=s.pendingProps,x=p.revealOrder,S=p.tail;if(Ea(i,s,p.children,c),p=Jn.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&lp(i,c,s);else if(i.tag===19)lp(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(ct(Jn,p),x){case"forwards":for(c=s.child,x=null;c!==null;)i=c.alternate,i!==null&&ed(i)===null&&(x=c),c=c.sibling;c=x,c===null?(x=s.child,s.child=null):(x=c.sibling,c.sibling=null),yh(s,!1,x,c,S);break;case"backwards":for(c=null,x=s.child,s.child=null;x!==null;){if(i=x.alternate,i!==null&&ed(i)===null){s.child=x;break}i=x.sibling,x.sibling=c,c=x,x=i}yh(s,!0,c,null,S);break;case"together":yh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function so(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Wo|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(qr(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(R(153));if(s.child!==null){for(i=s.child,c=ds(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=ds(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Yo(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&wn(i)))}function vh(i,s,c){switch(s.tag){case 3:ci(s,s.stateNode.containerInfo),gs(s,On,i.memoizedState.cache),ms();break;case 27:case 5:rn(s);break;case 4:ci(s,s.stateNode.containerInfo);break;case 10:gs(s,s.type,s.memoizedProps.value);break;case 13:var p=s.memoizedState;if(p!==null)return p.dehydrated!==null?(ro(s),s.flags|=128,null):(c&s.child.childLanes)!==0?pf(i,s,c):(ro(s),i=so(i,s,c),i!==null?i.sibling:null);ro(s);break;case 19:var x=(i.flags&128)!==0;if(p=(c&s.childLanes)!==0,p||(qr(i,s,c,!1),p=(c&s.childLanes)!==0),x){if(p)return ld(i,s,c);s.flags|=128}if(x=s.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ct(Jn,Jn.current),p)break;return null;case 22:case 23:return s.lanes=0,df(i,s,c);case 24:gs(s,On,i.memoizedState.cache)}return so(i,s,c)}function cp(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)aa=!0;else{if(!Yo(i,c)&&(s.flags&128)===0)return aa=!1,vh(i,s,c);aa=(i.flags&131072)!==0}else aa=!1,xi&&(s.flags&1048576)!==0&&lh(s,Pl,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var p=s.elementType,x=p._init;if(p=x(p._payload),s.type=p,typeof p=="function")Oo(p)?(i=Ic(p,i),s.tag=1,s=Eu(null,s,p,i,c)):(s.tag=0,s=ad(null,s,p,i,c));else{if(p!=null){if(x=p.$$typeof,x===qt){s.tag=11,s=sp(null,s,p,i,c);break e}else if(x===di){s.tag=14,s=uf(null,s,p,i,c);break e}}throw s=Ct(p)||p,Error(R(306,s,""))}}return s;case 0:return ad(i,s,s.type,s.pendingProps,c);case 1:return p=s.type,x=Ic(p,s.pendingProps),Eu(i,s,p,x,c);case 3:e:{if(ci(s,s.stateNode.containerInfo),i===null)throw Error(R(387));p=s.pendingProps;var S=s.memoizedState;x=S.element,xu(i,s),Cc(s,p,null,c);var U=s.memoizedState;if(p=U.cache,gs(s,On,p),p!==S.cache&&Js(s,[On],c,!0),Ec(),p=U.element,S.isDehydrated)if(S={element:p,isDehydrated:!1,cache:U.cache},s.updateQueue.baseState=S,s.memoizedState=S,s.flags&256){s=mr(i,s,p,c);break e}else if(p!==x){x=Ta(Error(R(424)),s),Oa(x),s=mr(i,s,p,c);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(fn=ja(i.firstChild),ha=s,xi=!0,Zr=null,br=!0,c=Cs(s,null,p,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(ms(),p===x){s=so(i,s,c);break e}Ea(i,s,p,c)}s=s.child}return s;case 26:return Mu(i,s),i===null?(c=Hu(s.type,null,s.pendingProps,null))?s.memoizedState=c:xi||(c=s.type,i=s.pendingProps,p=Is(Rt.current).createElement(c),p[Ot]=s,p[Dt]=i,va(p,c,i),Ft(p),s.stateNode=p):s.memoizedState=Hu(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return rn(s),i===null&&xi&&(p=s.stateNode=Nd(s.type,s.pendingProps,Rt.current),ha=s,br=!0,x=fn,nl(s.type)?(ea=x,fn=ja(p.firstChild)):fn=x),Ea(i,s,s.pendingProps.children,c),Mu(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&xi&&((x=p=fn)&&(p=jd(p,s.type,s.pendingProps,br),p!==null?(s.stateNode=p,ha=s,fn=ja(p.firstChild),br=!1,x=!0):x=!1),x||Li(s)),rn(s),x=s.type,S=s.pendingProps,U=i!==null?i.memoizedProps:null,p=S.children,Bd(x,S)?p=null:U!==null&&Bd(x,U)&&(s.flags|=32),s.memoizedState!==null&&(x=Wi(i,s,Ac,null,null,c),se._currentValue=x),Mu(i,s),Ea(i,s,p,c),s.child;case 6:return i===null&&xi&&((i=c=fn)&&(c=tm(c,s.pendingProps,br),c!==null?(s.stateNode=c,ha=s,fn=null,i=!0):i=!1),i||Li(s)),null;case 13:return pf(i,s,c);case 4:return ci(s,s.stateNode.containerInfo),p=s.pendingProps,i===null?s.child=Es(s,null,p,c):Ea(i,s,p,c),s.child;case 11:return sp(i,s,s.type,s.pendingProps,c);case 7:return Ea(i,s,s.pendingProps,c),s.child;case 8:return Ea(i,s,s.pendingProps.children,c),s.child;case 12:return Ea(i,s,s.pendingProps.children,c),s.child;case 10:return p=s.pendingProps,gs(s,s.type,p.value),Ea(i,s,p.children,c),s.child;case 9:return x=s.type._context,p=s.pendingProps.children,dr(s),x=Qn(x),p=p(x),s.flags|=1,Ea(i,s,p,c),s.child;case 14:return uf(i,s,s.type,s.pendingProps,c);case 15:return hf(i,s,s.type,s.pendingProps,c);case 19:return ld(i,s,c);case 31:return p=s.pendingProps,c=s.mode,p={mode:p.mode,children:p.children},i===null?(c=od(p,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=ds(i.child,p),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return df(i,s,c);case 24:return dr(s),p=Qn(On),i===null?(x=Tc(),x===null&&(x=Oi,S=eo(),x.pooledCache=S,S.refCount++,S!==null&&(x.pooledCacheLanes|=c),x=S),s.memoizedState={parent:p,cache:x},vu(s),gs(s,On,x)):((i.lanes&c)!==0&&(xu(i,s),Cc(s,null,null,c),Ec()),x=i.memoizedState,S=s.memoizedState,x.parent!==p?(x={parent:p,cache:p},s.memoizedState=x,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=x),gs(s,On,p)):(p=S.cache,gs(s,On,p),p!==x.cache&&Js(s,[On],c,!0))),Ea(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(R(156,s.tag))}function Ko(i){i.flags|=4}function up(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!A(s)){if(s=Fa.current,s!==null&&((Si&4194048)===Si?As!==null:(Si&62914560)!==Si&&(Si&536870912)===0||s!==As))throw ti=_u,Sc;i.flags|=8192}}function cd(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?ve():536870912,i.lanes|=s,Jo|=s)}function xh(i,s){if(!xi)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function In(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(s)for(var x=i.child;x!==null;)c|=x.lanes|x.childLanes,p|=x.subtreeFlags&65011712,p|=x.flags&65011712,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)c|=x.lanes|x.childLanes,p|=x.subtreeFlags,p|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=p,i.childLanes=c,s}function Hp(i,s,c){var p=s.pendingProps;switch(vc(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(s),null;case 1:return In(s),null;case 3:return c=s.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),s.memoizedState.cache!==p&&(s.flags|=2048),Gr(On),Ki(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Vo(s)?Ko(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,fu())),In(s),null;case 26:return c=s.memoizedState,i===null?(Ko(s),c!==null?(In(s),up(s,c)):(In(s),s.flags&=-16777217)):c?c!==i.memoizedState?(Ko(s),In(s),up(s,c)):(In(s),s.flags&=-16777217):(i.memoizedProps!==p&&Ko(s),In(s),s.flags&=-16777217),null;case 27:Ii(s),c=Rt.current;var x=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==p&&Ko(s);else{if(!p){if(s.stateNode===null)throw Error(R(166));return In(s),null}i=xt.current,Vo(s)?ps(s):(i=Nd(x,p,c),s.stateNode=i,Ko(s))}return In(s),null;case 5:if(Ii(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==p&&Ko(s);else{if(!p){if(s.stateNode===null)throw Error(R(166));return In(s),null}if(i=xt.current,Vo(s))ps(s);else{switch(x=Is(Rt.current),i){case 1:i=x.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=x.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=x.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?x.createElement("select",{is:p.is}):x.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?x.createElement(c,{is:p.is}):x.createElement(c)}}i[Ot]=s,i[Dt]=p;e:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)i.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break e;for(;x.sibling===null;){if(x.return===null||x.return===s)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=i;e:switch(va(i,c,p),c){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ko(s)}}return In(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==p&&Ko(s);else{if(typeof p!="string"&&s.stateNode===null)throw Error(R(166));if(i=Rt.current,Vo(s)){if(i=s.stateNode,c=s.memoizedProps,p=null,x=ha,x!==null)switch(x.tag){case 27:case 5:p=x.memoizedProps}i[Ot]=s,i=!!(i.nodeValue===c||p!==null&&p.suppressHydrationWarning===!0||jf(i.nodeValue,c)),i||Li(s)}else i=Is(i).createTextNode(p),i[Ot]=s,s.stateNode=i}return In(s),null;case 13:if(p=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(x=Vo(s),p!==null&&p.dehydrated!==null){if(i===null){if(!x)throw Error(R(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(R(317));x[Ot]=s}else ms(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;In(s),x=!1}else x=fu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=x),x=!0;if(!x)return s.flags&256?(tr(s),s):(tr(s),null)}if(tr(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=p!==null,i=i!==null&&i.memoizedState!==null,c){p=s.child,x=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(x=p.alternate.memoizedState.cachePool.pool);var S=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),S!==x&&(p.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),cd(s,s.updateQueue),In(s),null;case 4:return Ki(),i===null&&Id(s.stateNode.containerInfo),In(s),null;case 10:return Gr(s.type),In(s),null;case 19:if(ot(Jn),x=s.memoizedState,x===null)return In(s),null;if(p=(s.flags&128)!==0,S=x.rendering,S===null)if(p)xh(x,!1);else{if(En!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(S=ed(i),S!==null){for(s.flags|=128,xh(x,!1),i=S.updateQueue,s.updateQueue=i,cd(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Qh(c,i),c=c.sibling;return ct(Jn,Jn.current&1|2),s.child}i=i.sibling}x.tail!==null&&An()>yd&&(s.flags|=128,p=!0,xh(x,!1),s.lanes=4194304)}else{if(!p)if(i=ed(S),i!==null){if(s.flags|=128,p=!0,i=i.updateQueue,s.updateQueue=i,cd(s,i),xh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!S.alternate&&!xi)return In(s),null}else 2*An()-x.renderingStartTime>yd&&c!==536870912&&(s.flags|=128,p=!0,xh(x,!1),s.lanes=4194304);x.isBackwards?(S.sibling=s.child,s.child=S):(i=x.last,i!==null?i.sibling=S:s.child=S,x.last=S)}return x.tail!==null?(s=x.tail,x.rendering=s,x.tail=s.sibling,x.renderingStartTime=An(),s.sibling=null,i=Jn.current,ct(Jn,p?i&1|2:i&1),s):(In(s),null);case 22:case 23:return tr(s),wu(),p=s.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(s.flags|=8192):p&&(s.flags|=8192),p?(c&536870912)!==0&&(s.flags&128)===0&&(In(s),s.subtreeFlags&6&&(s.flags|=8192)):In(s),c=s.updateQueue,c!==null&&cd(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),p=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),p!==c&&(s.flags|=2048),i!==null&&ot(Hr),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Gr(On),In(s),null;case 25:return null;case 30:return null}throw Error(R(156,s.tag))}function _f(i,s){switch(vc(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Gr(On),Ki(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Ii(s),null;case 13:if(tr(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(R(340));ms()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return ot(Jn),null;case 4:return Ki(),null;case 10:return Gr(s.type),null;case 22:case 23:return tr(s),wu(),i!==null&&ot(Hr),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Gr(On),null;case 25:return null;default:return null}}function hp(i,s){switch(vc(s),s.tag){case 3:Gr(On),Ki();break;case 26:case 27:case 5:Ii(s);break;case 4:Ki();break;case 13:tr(s);break;case 19:ot(Jn);break;case 10:Gr(s.type);break;case 22:case 23:tr(s),wu(),i!==null&&ot(Hr);break;case 24:Gr(On)}}function Cu(i,s){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var x=p.next;c=x;do{if((c.tag&i)===i){p=void 0;var S=c.create,U=c.inst;p=S(),U.destroy=p}c=c.next}while(c!==x)}}catch(Y){an(s,s.return,Y)}}function ts(i,s,c){try{var p=s.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var S=x.next;p=S;do{if((p.tag&i)===i){var U=p.inst,Y=U.destroy;if(Y!==void 0){U.destroy=void 0,x=s;var fe=c,Le=Y;try{Le()}catch(Je){an(x,fe,Je)}}}p=p.next}while(p!==S)}}catch(Je){an(s,s.return,Je)}}function dp(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{Ui(s,c)}catch(p){an(i,i.return,p)}}}function Sn(i,s,c){c.props=Ic(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(p){an(i,s,p)}}function oo(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof c=="function"?i.refCleanup=c(p):c.current=p}}catch(x){an(i,s,x)}}function zs(i,s){var c=i.ref,p=i.refCleanup;if(c!==null)if(typeof p=="function")try{p()}catch(x){an(i,s,x)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){an(i,s,x)}else c.current=null}function bh(i){var s=i.type,c=i.memoizedProps,p=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&p.focus();break e;case"img":c.src?p.src=c.src:c.srcSet&&(p.srcset=c.srcSet)}}catch(x){an(i,i.return,x)}}function Au(i,s,c){try{var p=i.stateNode;Pp(p,i.type,c,s),p[Dt]=s}catch(x){an(i,i.return,x)}}function zu(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&nl(i.type)||i.tag===4}function ud(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||zu(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&nl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function hd(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Ih));else if(p!==4&&(p===27&&nl(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(hd(i,s,c),i=i.sibling;i!==null;)hd(i,s,c),i=i.sibling}function Ul(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(p!==4&&(p===27&&nl(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Ul(i,s,c),i=i.sibling;i!==null;)Ul(i,s,c),i=i.sibling}function dd(i){var s=i.stateNode,c=i.memoizedProps;try{for(var p=i.type,x=s.attributes;x.length;)s.removeAttributeNode(x[0]);va(s,p,c),s[Ot]=i,s[Dt]=c}catch(S){an(i,i.return,S)}}var gr=!1,Mn=!1,Vl=!1,Pu=typeof WeakSet=="function"?WeakSet:Set,ga=null;function fp(i,s){if(i=i.containerInfo,Nf=rt,i=ou(i),lu(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var x=p.anchorOffset,S=p.focusNode;p=p.focusOffset;try{c.nodeType,S.nodeType}catch{c=null;break e}var U=0,Y=-1,fe=-1,Le=0,Je=0,it=i,Ue=null;t:for(;;){for(var qe;it!==c||x!==0&&it.nodeType!==3||(Y=U+x),it!==S||p!==0&&it.nodeType!==3||(fe=U+p),it.nodeType===3&&(U+=it.nodeValue.length),(qe=it.firstChild)!==null;)Ue=it,it=qe;for(;;){if(it===i)break t;if(Ue===c&&++Le===x&&(Y=U),Ue===S&&++Je===p&&(fe=U),(qe=it.nextSibling)!==null)break;it=Ue,Ue=it.parentNode}it=qe}c=Y===-1||fe===-1?null:{start:Y,end:fe}}else c=null}c=c||{start:0,end:0}}else c=null;for(Ld={focusedElem:i,selectionRange:c},rt=!1,ga=s;ga!==null;)if(s=ga,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,ga=i;else for(;ga!==null;){switch(s=ga,S=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&S!==null){i=void 0,c=s,x=S.memoizedProps,S=S.memoizedState,p=c.stateNode;try{var Qt=Ic(c.type,x,c.elementType===c.type);i=p.getSnapshotBeforeUpdate(Qt,S),p.__reactInternalSnapshotBeforeUpdate=i}catch(Yt){an(c,c.return,Yt)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)Gu(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Gu(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(R(163))}if(i=s.sibling,i!==null){i.return=s.return,ga=i;break}ga=s.return}}function Zl(i,s,c){var p=c.flags;switch(c.tag){case 0:case 11:case 15:lo(i,c),p&4&&Cu(5,c);break;case 1:if(lo(i,c),p&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(U){an(c,c.return,U)}else{var x=Ic(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(x,s,i.__reactInternalSnapshotBeforeUpdate)}catch(U){an(c,c.return,U)}}p&64&&dp(c),p&512&&oo(c,c.return);break;case 3:if(lo(i,c),p&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Ui(i,s)}catch(U){an(c,c.return,U)}}break;case 27:s===null&&p&4&&dd(c);case 26:case 5:lo(i,c),s===null&&p&4&&bh(c),p&512&&oo(c,c.return);break;case 12:lo(i,c);break;case 13:lo(i,c),p&4&&vf(i,c),p&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=ho.bind(null,c),im(i,c))));break;case 22:if(p=c.memoizedState!==null||gr,!p){s=s!==null&&s.memoizedState!==null||Mn,x=gr;var S=Mn;gr=p,(Mn=s)&&!S?co(i,c,(c.subtreeFlags&8772)!==0):lo(i,c),gr=x,Mn=S}break;case 30:break;default:lo(i,c)}}function pp(i){var s=i.alternate;s!==null&&(i.alternate=null,pp(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Nt(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var mn=null,_a=!1;function Ps(i,s,c){for(c=c.child;c!==null;)yf(i,s,c),c=c.sibling}function yf(i,s,c){if($n&&typeof $n.onCommitFiberUnmount=="function")try{$n.onCommitFiberUnmount(Lr,c)}catch{}switch(c.tag){case 26:Mn||zs(c,s),Ps(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Mn||zs(c,s);var p=mn,x=_a;nl(c.type)&&(mn=c.stateNode,_a=!1),Ps(i,s,c),qu(c.stateNode),mn=p,_a=x;break;case 5:Mn||zs(c,s);case 6:if(p=mn,x=_a,mn=null,Ps(i,s,c),mn=p,_a=x,mn!==null)if(_a)try{(mn.nodeType===9?mn.body:mn.nodeName==="HTML"?mn.ownerDocument.body:mn).removeChild(c.stateNode)}catch(S){an(c,s,S)}else try{mn.removeChild(c.stateNode)}catch(S){an(c,s,S)}break;case 18:mn!==null&&(_a?(i=mn,Rh(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),un(i)):Rh(mn,c.stateNode));break;case 4:p=mn,x=_a,mn=c.stateNode.containerInfo,_a=!0,Ps(i,s,c),mn=p,_a=x;break;case 0:case 11:case 14:case 15:Mn||ts(2,c,s),Mn||ts(4,c,s),Ps(i,s,c);break;case 1:Mn||(zs(c,s),p=c.stateNode,typeof p.componentWillUnmount=="function"&&Sn(c,s,p)),Ps(i,s,c);break;case 21:Ps(i,s,c);break;case 22:Mn=(p=Mn)||c.memoizedState!==null,Ps(i,s,c),Mn=p;break;default:Ps(i,s,c)}}function vf(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{un(i)}catch(c){an(s,s.return,c)}}function $p(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Pu),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Pu),s;default:throw Error(R(435,i.tag))}}function xf(i,s){var c=$p(i);s.forEach(function(p){var x=Kl.bind(null,i,p);c.has(p)||(c.add(p),p.then(x,x))})}function Ar(i,s){var c=s.deletions;if(c!==null)for(var p=0;p<c.length;p++){var x=c[p],S=i,U=s,Y=U;e:for(;Y!==null;){switch(Y.tag){case 27:if(nl(Y.type)){mn=Y.stateNode,_a=!1;break e}break;case 5:mn=Y.stateNode,_a=!1;break e;case 3:case 4:mn=Y.stateNode.containerInfo,_a=!0;break e}Y=Y.return}if(mn===null)throw Error(R(160));yf(S,U,x),mn=null,_a=!1,S=x.alternate,S!==null&&(S.return=null),x.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)mp(s,i),s=s.sibling}var Ds=null;function mp(i,s){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ar(s,i),ir(i),p&4&&(ts(3,i,i.return),Cu(3,i),ts(5,i,i.return));break;case 1:Ar(s,i),ir(i),p&512&&(Mn||c===null||zs(c,c.return)),p&64&&gr&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?p:c.concat(p))));break;case 26:var x=Ds;if(Ar(s,i),ir(i),p&512&&(Mn||c===null||zs(c,c.return)),p&4){var S=c!==null?c.memoizedState:null;if(p=i.memoizedState,c===null)if(p===null)if(i.stateNode===null){e:{p=i.type,c=i.memoizedProps,x=x.ownerDocument||x;t:switch(p){case"title":S=x.getElementsByTagName("title")[0],(!S||S[Qe]||S[Ot]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=x.createElement(p),x.head.insertBefore(S,x.querySelector("head > title"))),va(S,p,c),S[Ot]=i,Ft(S),p=S;break e;case"link":var U=v("link","href",x).get(p+(c.href||""));if(U){for(var Y=0;Y<U.length;Y++)if(S=U[Y],S.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&S.getAttribute("rel")===(c.rel==null?null:c.rel)&&S.getAttribute("title")===(c.title==null?null:c.title)&&S.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){U.splice(Y,1);break t}}S=x.createElement(p),va(S,p,c),x.head.appendChild(S);break;case"meta":if(U=v("meta","content",x).get(p+(c.content||""))){for(Y=0;Y<U.length;Y++)if(S=U[Y],S.getAttribute("content")===(c.content==null?null:""+c.content)&&S.getAttribute("name")===(c.name==null?null:c.name)&&S.getAttribute("property")===(c.property==null?null:c.property)&&S.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&S.getAttribute("charset")===(c.charSet==null?null:c.charSet)){U.splice(Y,1);break t}}S=x.createElement(p),va(S,p,c),x.head.appendChild(S);break;default:throw Error(R(468,p))}S[Ot]=i,Ft(S),p=S}i.stateNode=p}else w(x,i.type,i.stateNode);else i.stateNode=a(x,p,i.memoizedProps);else S!==p?(S===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):S.count--,p===null?w(x,i.type,i.stateNode):a(x,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Au(i,i.memoizedProps,c.memoizedProps)}break;case 27:Ar(s,i),ir(i),p&512&&(Mn||c===null||zs(c,c.return)),c!==null&&p&4&&Au(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Ar(s,i),ir(i),p&512&&(Mn||c===null||zs(c,c.return)),i.flags&32){x=i.stateNode;try{Gs(x,"")}catch(qe){an(i,i.return,qe)}}p&4&&i.stateNode!=null&&(x=i.memoizedProps,Au(i,x,c!==null?c.memoizedProps:x)),p&1024&&(Vl=!0);break;case 6:if(Ar(s,i),ir(i),p&4){if(i.stateNode===null)throw Error(R(162));p=i.memoizedProps,c=i.stateNode;try{c.nodeValue=p}catch(qe){an(i,i.return,qe)}}break;case 3:if(_=null,x=Ds,Ds=Vd(s.containerInfo),Ar(s,i),Ds=x,ir(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{un(s.containerInfo)}catch(qe){an(i,i.return,qe)}Vl&&(Vl=!1,bf(i));break;case 4:p=Ds,Ds=Vd(i.stateNode.containerInfo),Ar(s,i),ir(i),Ds=p;break;case 12:Ar(s,i),ir(i);break;case 13:Ar(s,i),ir(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Ef=An()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,xf(i,p)));break;case 22:x=i.memoizedState!==null;var fe=c!==null&&c.memoizedState!==null,Le=gr,Je=Mn;if(gr=Le||x,Mn=Je||fe,Ar(s,i),Mn=Je,gr=Le,ir(i),p&8192)e:for(s=i.stateNode,s._visibility=x?s._visibility&-2:s._visibility|1,x&&(c===null||fe||gr||Mn||Gl(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){fe=c=s;try{if(S=fe.stateNode,x)U=S.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{Y=fe.stateNode;var it=fe.memoizedProps.style,Ue=it!=null&&it.hasOwnProperty("display")?it.display:null;Y.style.display=Ue==null||typeof Ue=="boolean"?"":(""+Ue).trim()}}catch(qe){an(fe,fe.return,qe)}}}else if(s.tag===6){if(c===null){fe=s;try{fe.stateNode.nodeValue=x?"":fe.memoizedProps}catch(qe){an(fe,fe.return,qe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}p&4&&(p=i.updateQueue,p!==null&&(c=p.retryQueue,c!==null&&(p.retryQueue=null,xf(i,c))));break;case 19:Ar(s,i),ir(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,xf(i,p)));break;case 30:break;case 21:break;default:Ar(s,i),ir(i)}}function ir(i){var s=i.flags;if(s&2){try{for(var c,p=i.return;p!==null;){if(zu(p)){c=p;break}p=p.return}if(c==null)throw Error(R(160));switch(c.tag){case 27:var x=c.stateNode,S=ud(i);Ul(i,S,x);break;case 5:var U=c.stateNode;c.flags&32&&(Gs(U,""),c.flags&=-33);var Y=ud(i);Ul(i,Y,U);break;case 3:case 4:var fe=c.stateNode.containerInfo,Le=ud(i);hd(i,Le,fe);break;default:throw Error(R(161))}}catch(Je){an(i,i.return,Je)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function bf(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;bf(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function lo(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Zl(i,s.alternate,s),s=s.sibling}function Gl(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ts(4,s,s.return),Gl(s);break;case 1:zs(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&Sn(s,s.return,c),Gl(s);break;case 27:qu(s.stateNode);case 26:case 5:zs(s,s.return),Gl(s);break;case 22:s.memoizedState===null&&Gl(s);break;case 30:Gl(s);break;default:Gl(s)}i=i.sibling}}function co(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var p=s.alternate,x=i,S=s,U=S.flags;switch(S.tag){case 0:case 11:case 15:co(x,S,c),Cu(4,S);break;case 1:if(co(x,S,c),p=S,x=p.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Le){an(p,p.return,Le)}if(p=S,x=p.updateQueue,x!==null){var Y=p.stateNode;try{var fe=x.shared.hiddenCallbacks;if(fe!==null)for(x.shared.hiddenCallbacks=null,x=0;x<fe.length;x++)Yr(fe[x],Y)}catch(Le){an(p,p.return,Le)}}c&&U&64&&dp(S),oo(S,S.return);break;case 27:dd(S);case 26:case 5:co(x,S,c),c&&p===null&&U&4&&bh(S),oo(S,S.return);break;case 12:co(x,S,c);break;case 13:co(x,S,c),c&&U&4&&vf(x,S);break;case 22:S.memoizedState===null&&co(x,S,c),oo(S,S.return);break;case 30:break;default:co(x,S,c)}s=s.sibling}}function fd(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Rl(c))}function pd(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Rl(i))}function zr(i,s,c,p){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)wf(i,s,c,p),s=s.sibling}function wf(i,s,c,p){var x=s.flags;switch(s.tag){case 0:case 11:case 15:zr(i,s,c,p),x&2048&&Cu(9,s);break;case 1:zr(i,s,c,p);break;case 3:zr(i,s,c,p),x&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Rl(i)));break;case 12:if(x&2048){zr(i,s,c,p),i=s.stateNode;try{var S=s.memoizedProps,U=S.id,Y=S.onPostCommit;typeof Y=="function"&&Y(U,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(fe){an(s,s.return,fe)}}else zr(i,s,c,p);break;case 13:zr(i,s,c,p);break;case 23:break;case 22:S=s.stateNode,U=s.alternate,s.memoizedState!==null?S._visibility&2?zr(i,s,c,p):Du(i,s):S._visibility&2?zr(i,s,c,p):(S._visibility|=2,Rc(i,s,c,p,(s.subtreeFlags&10256)!==0)),x&2048&&fd(U,s);break;case 24:zr(i,s,c,p),x&2048&&pd(s.alternate,s);break;default:zr(i,s,c,p)}}function Rc(i,s,c,p,x){for(x=x&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var S=i,U=s,Y=c,fe=p,Le=U.flags;switch(U.tag){case 0:case 11:case 15:Rc(S,U,Y,fe,x),Cu(8,U);break;case 23:break;case 22:var Je=U.stateNode;U.memoizedState!==null?Je._visibility&2?Rc(S,U,Y,fe,x):Du(S,U):(Je._visibility|=2,Rc(S,U,Y,fe,x)),x&&Le&2048&&fd(U.alternate,U);break;case 24:Rc(S,U,Y,fe,x),x&&Le&2048&&pd(U.alternate,U);break;default:Rc(S,U,Y,fe,x)}s=s.sibling}}function Du(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,p=s,x=p.flags;switch(p.tag){case 22:Du(c,p),x&2048&&fd(p.alternate,p);break;case 24:Du(c,p),x&2048&&pd(p.alternate,p);break;default:Du(c,p)}s=s.sibling}}var Qo=8192;function Iu(i){if(i.subtreeFlags&Qo)for(i=i.child;i!==null;)md(i),i=i.sibling}function md(i){switch(i.tag){case 26:Iu(i),i.flags&Qo&&i.memoizedState!==null&&N(Ds,i.memoizedState,i.memoizedProps);break;case 5:Iu(i);break;case 3:case 4:var s=Ds;Ds=Vd(i.stateNode.containerInfo),Iu(i),Ds=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=Qo,Qo=16777216,Iu(i),Qo=s):Iu(i));break;default:Iu(i)}}function Ru(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function kc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];ga=p,Tf(p,i)}Ru(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)gp(i),i=i.sibling}function gp(i){switch(i.tag){case 0:case 11:case 15:kc(i),i.flags&2048&&ts(9,i,i.return);break;case 3:kc(i);break;case 12:kc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,gd(i)):kc(i);break;default:kc(i)}}function gd(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];ga=p,Tf(p,i)}Ru(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ts(8,s,s.return),gd(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,gd(s));break;default:gd(s)}i=i.sibling}}function Tf(i,s){for(;ga!==null;){var c=ga;switch(c.tag){case 0:case 11:case 15:ts(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var p=c.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Rl(c.memoizedState.cache)}if(p=c.child,p!==null)p.return=c,ga=p;else e:for(c=i;ga!==null;){p=ga;var x=p.sibling,S=p.return;if(pp(p),p===c){ga=null;break e}if(x!==null){x.return=S,ga=x;break e}ga=S}}}var _p={getCacheForType:function(i){var s=Qn(On),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},Xp=typeof WeakMap=="function"?WeakMap:Map,Vi=0,Oi=null,gi=null,Si=0,Zi=0,Pr=null,ql=!1,ku=!1,Sf=!1,uo=0,En=0,Wo=0,Hl=0,_d=0,is=0,Jo=0,wh=null,nr=null,Mf=!1,Ef=0,yd=1/0,Th=null,$l=null,Ca=0,ns=null,Lc=null,Xl=0,vd=0,Rn=null,xd=null,Sh=0,bd=null;function ar(){if((Vi&2)!==0&&Si!==0)return Si&-Si;if(be.T!==null){var i=Sr;return i!==0?i:Pd()}return ft()}function wd(){is===0&&(is=(Si&536870912)===0||xi?ce():536870912);var i=Fa.current;return i!==null&&(i.flags|=32),is}function Dr(i,s,c){(i===Oi&&(Zi===2||Zi===9)||i.cancelPendingCommit!==null)&&(Bc(i,0),el(i,Si,is,!1)),De(i,c),((Vi&2)===0||i!==Oi)&&(i===Oi&&((Vi&2)===0&&(Hl|=c),En===4&&el(i,Si,is,!1)),as(i))}function yp(i,s,c){if((Vi&6)!==0)throw Error(R(327));var p=!c&&(s&124)===0&&(s&i.expiredLanes)===0||X(i,s),x=p?Kp(i,s):Bu(i,s,!0),S=p;do{if(x===0){ku&&!p&&el(i,s,0,!1);break}else{if(c=i.current.alternate,S&&!Yp(c)){x=Bu(i,s,!1),S=!1;continue}if(x===2){if(S=s,i.errorRecoveryDisabledLanes&S)var U=0;else U=i.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){s=U;e:{var Y=i;x=wh;var fe=Y.current.memoizedState.isDehydrated;if(fe&&(Bc(Y,U).flags|=256),U=Bu(Y,U,!1),U!==2){if(Sf&&!fe){Y.errorRecoveryDisabledLanes|=S,Hl|=S,x=4;break e}S=nr,nr=x,S!==null&&(nr===null?nr=S:nr.push.apply(nr,S))}x=U}if(S=!1,x!==2)continue}}if(x===1){Bc(i,0),el(i,s,0,!0);break}e:{switch(p=i,S=x,S){case 0:case 1:throw Error(R(345));case 4:if((s&4194048)!==s)break;case 6:el(p,s,is,!ql);break e;case 2:nr=null;break;case 3:case 5:break;default:throw Error(R(329))}if((s&62914560)===s&&(x=Ef+300-An(),10<x)){if(el(p,s,is,!ql),$(p,0,!0)!==0)break e;p.timeoutHandle=Dp(vp.bind(null,p,c,nr,Th,Mf,s,is,Hl,Jo,ql,S,2,-0,0),x);break e}vp(p,c,nr,Th,Mf,s,is,Hl,Jo,ql,S,0,-0,0)}}break}while(!0);as(i)}function vp(i,s,c,p,x,S,U,Y,fe,Le,Je,it,Ue,qe){if(i.timeoutHandle=-1,it=s.subtreeFlags,(it&8192||(it&16785408)===16785408)&&(I={stylesheets:null,count:0,unsuspend:F},md(s),it=V(),it!==null)){i.cancelPendingCommit=it(Sd.bind(null,i,s,S,c,p,x,U,Y,fe,Je,1,Ue,qe)),el(i,S,U,!Le);return}Sd(i,s,S,c,p,x,U,Y,fe)}function Yp(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var p=0;p<c.length;p++){var x=c[p],S=x.getSnapshot;x=x.value;try{if(!La(S(),x))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function el(i,s,c,p){s&=~_d,s&=~Hl,i.suspendedLanes|=s,i.pingedLanes&=~s,p&&(i.warmLanes|=s),p=i.expirationTimes;for(var x=s;0<x;){var S=31-zn(x),U=1<<S;p[S]=-1,x&=~U}c!==0&&ze(i,c,s)}function ya(){return(Vi&6)===0?(jc(0),!1):!0}function Mh(){if(gi!==null){if(Zi===0)var i=gi.return;else i=gi,Tr=wr=null,zc(i),jl=null,Xo=0,i=gi;for(;i!==null;)hp(i.alternate,i),i=i.return;gi=null}}function Bc(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,Ip(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),Mh(),Oi=i,gi=c=ds(i.current,null),Si=s,Zi=0,Pr=null,ql=!1,ku=X(i,s),Sf=!1,Jo=is=_d=Hl=Wo=En=0,nr=wh=null,Mf=!1,(s&8)!==0&&(s|=s&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=s;0<p;){var x=31-zn(p),S=1<<x;s|=i[x],p&=~S}return uo=s,Lo(),c}function tl(i,s){Gt=null,be.H=Di,s===vt||s===Zo?(s=Mc(),Zi=3):s===Sc?(s=Mc(),Zi=4):Zi=s===cf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Pr=s,gi===null&&(En=1,mh(i,Ta(s,i.current)))}function Eh(){var i=be.H;return be.H=Di,i===null?Di:i}function Lu(){var i=be.A;return be.A=_p,i}function Yl(){En=4,ql||(Si&4194048)!==Si&&Fa.current!==null||(ku=!0),(Wo&134217727)===0&&(Hl&134217727)===0||Oi===null||el(Oi,Si,is,!1)}function Bu(i,s,c){var p=Vi;Vi|=2;var x=Eh(),S=Lu();(Oi!==i||Si!==s)&&(Th=null,Bc(i,s)),s=!1;var U=En;e:do try{if(Zi!==0&&gi!==null){var Y=gi,fe=Pr;switch(Zi){case 8:Mh(),U=6;break e;case 3:case 2:case 9:case 6:Fa.current===null&&(s=!0);var Le=Zi;if(Zi=0,Pr=null,Ou(i,Y,fe,Le),c&&ku){U=0;break e}break;default:Le=Zi,Zi=0,Pr=null,Ou(i,Y,fe,Le)}}Td(),U=En;break}catch(Je){tl(i,Je)}while(!0);return s&&i.shellSuspendCounter++,Tr=wr=null,Vi=p,be.H=x,be.A=S,gi===null&&(Oi=null,Si=0,Lo()),U}function Td(){for(;gi!==null;)Cf(gi)}function Kp(i,s){var c=Vi;Vi|=2;var p=Eh(),x=Lu();Oi!==i||Si!==s?(Th=null,yd=An()+500,Bc(i,s)):ku=X(i,s);e:do try{if(Zi!==0&&gi!==null){s=gi;var S=Pr;t:switch(Zi){case 1:Zi=0,Pr=null,Ou(i,s,S,1);break;case 2:case 9:if(Go(S)){Zi=0,Pr=null,Af(s);break}s=function(){Zi!==2&&Zi!==9||Oi!==i||(Zi=7),as(i)},S.then(s,s);break e;case 3:Zi=7;break e;case 4:Zi=5;break e;case 7:Go(S)?(Zi=0,Pr=null,Af(s)):(Zi=0,Pr=null,Ou(i,s,S,7));break;case 5:var U=null;switch(gi.tag){case 26:U=gi.memoizedState;case 5:case 27:var Y=gi;if(!U||A(U)){Zi=0,Pr=null;var fe=Y.sibling;if(fe!==null)gi=fe;else{var Le=Y.return;Le!==null?(gi=Le,Ch(Le)):gi=null}break t}}Zi=0,Pr=null,Ou(i,s,S,5);break;case 6:Zi=0,Pr=null,Ou(i,s,S,6);break;case 8:Mh(),En=6;break e;default:throw Error(R(462))}}Qp();break}catch(Je){tl(i,Je)}while(!0);return Tr=wr=null,be.H=p,be.A=x,Vi=c,gi!==null?0:(Oi=null,Si=0,Lo(),En)}function Qp(){for(;gi!==null&&!kr();)Cf(gi)}function Cf(i){var s=cp(i.alternate,i,uo);i.memoizedProps=i.pendingProps,s===null?Ch(i):gi=s}function Af(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=rd(c,s,s.pendingProps,s.type,void 0,Si);break;case 11:s=rd(c,s,s.pendingProps,s.type.render,s.ref,Si);break;case 5:zc(s);default:hp(c,s),s=gi=Qh(s,uo),s=cp(c,s,uo)}i.memoizedProps=i.pendingProps,s===null?Ch(i):gi=s}function Ou(i,s,c,p){Tr=wr=null,zc(s),jl=null,Xo=0;var x=s.return;try{if(nd(i,x,s,c,Si)){En=1,mh(i,Ta(c,i.current)),gi=null;return}}catch(S){if(x!==null)throw gi=x,S;En=1,mh(i,Ta(c,i.current)),gi=null;return}s.flags&32768?(xi||p===1?i=!0:ku||(Si&536870912)!==0?i=!1:(ql=i=!0,(p===2||p===9||p===3||p===6)&&(p=Fa.current,p!==null&&p.tag===13&&(p.flags|=16384))),zf(s,i)):Ch(s)}function Ch(i){var s=i;do{if((s.flags&32768)!==0){zf(s,ql);return}i=s.return;var c=Hp(s.alternate,s,uo);if(c!==null){gi=c;return}if(s=s.sibling,s!==null){gi=s;return}gi=s=i}while(s!==null);En===0&&(En=5)}function zf(i,s){do{var c=_f(i.alternate,i);if(c!==null){c.flags&=32767,gi=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){gi=i;return}gi=i=c}while(i!==null);En=6,gi=null}function Sd(i,s,c,p,x,S,U,Y,fe){i.cancelPendingCommit=null;do Ed();while(Ca!==0);if((Vi&6)!==0)throw Error(R(327));if(s!==null){if(s===i.current)throw Error(R(177));if(S=s.lanes|s.childLanes,S|=Al,we(i,c,S,U,Y,fe),i===Oi&&(gi=Oi=null,Si=0),Lc=s,ns=i,Xl=c,vd=S,Rn=x,xd=p,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Mp(Va,function(){return wp(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||p){p=be.T,be.T=null,x=Ke.p,Ke.p=2,U=Vi,Vi|=4;try{fp(i,s,c)}finally{Vi=U,Ke.p=x,be.T=p}}Ca=1,Md(),xp(),Pf()}}function Md(){if(Ca===1){Ca=0;var i=ns,s=Lc,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=be.T,be.T=null;var p=Ke.p;Ke.p=2;var x=Vi;Vi|=4;try{mp(s,i);var S=Ld,U=ou(i.containerInfo),Y=S.focusedElem,fe=S.selectionRange;if(U!==Y&&Y&&Y.ownerDocument&&su(Y.ownerDocument.documentElement,Y)){if(fe!==null&&lu(Y)){var Le=fe.start,Je=fe.end;if(Je===void 0&&(Je=Le),"selectionStart"in Y)Y.selectionStart=Le,Y.selectionEnd=Math.min(Je,Y.value.length);else{var it=Y.ownerDocument||document,Ue=it&&it.defaultView||window;if(Ue.getSelection){var qe=Ue.getSelection(),Qt=Y.textContent.length,Yt=Math.min(fe.start,Qt),Xi=fe.end===void 0?Yt:Math.min(fe.end,Qt);!qe.extend&&Yt>Xi&&(U=Xi,Xi=Yt,Yt=U);var Ae=ru(Y,Yt),Te=ru(Y,Xi);if(Ae&&Te&&(qe.rangeCount!==1||qe.anchorNode!==Ae.node||qe.anchorOffset!==Ae.offset||qe.focusNode!==Te.node||qe.focusOffset!==Te.offset)){var ke=it.createRange();ke.setStart(Ae.node,Ae.offset),qe.removeAllRanges(),Yt>Xi?(qe.addRange(ke),qe.extend(Te.node,Te.offset)):(ke.setEnd(Te.node,Te.offset),qe.addRange(ke))}}}}for(it=[],qe=Y;qe=qe.parentNode;)qe.nodeType===1&&it.push({element:qe,left:qe.scrollLeft,top:qe.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<it.length;Y++){var at=it[Y];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}rt=!!Nf,Ld=Nf=null}finally{Vi=x,Ke.p=p,be.T=c}}i.current=s,Ca=2}}function xp(){if(Ca===2){Ca=0;var i=ns,s=Lc,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=be.T,be.T=null;var p=Ke.p;Ke.p=2;var x=Vi;Vi|=4;try{Zl(i,s.alternate,s)}finally{Vi=x,Ke.p=p,be.T=c}}Ca=3}}function Pf(){if(Ca===4||Ca===3){Ca=0,Os();var i=ns,s=Lc,c=Xl,p=xd;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Ca=5:(Ca=0,Lc=ns=null,bp(i,i.pendingLanes));var x=i.pendingLanes;if(x===0&&($l=null),We(c),s=s.stateNode,$n&&typeof $n.onCommitFiberRoot=="function")try{$n.onCommitFiberRoot(Lr,s,void 0,(s.current.flags&128)===128)}catch{}if(p!==null){s=be.T,x=Ke.p,Ke.p=2,be.T=null;try{for(var S=i.onRecoverableError,U=0;U<p.length;U++){var Y=p[U];S(Y.value,{componentStack:Y.stack})}}finally{be.T=s,Ke.p=x}}(Xl&3)!==0&&Ed(),as(i),x=i.pendingLanes,(c&4194090)!==0&&(x&42)!==0?i===bd?Sh++:(Sh=0,bd=i):Sh=0,jc(0)}}function bp(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Rl(s)))}function Ed(i){return Md(),xp(),Pf(),wp()}function wp(){if(Ca!==5)return!1;var i=ns,s=vd;vd=0;var c=We(Xl),p=be.T,x=Ke.p;try{Ke.p=32>c?32:c,be.T=null,c=Rn,Rn=null;var S=ns,U=Xl;if(Ca=0,Lc=ns=null,Xl=0,(Vi&6)!==0)throw Error(R(331));var Y=Vi;if(Vi|=4,gp(S.current),wf(S,S.current,U,c),Vi=Y,jc(0,!1),$n&&typeof $n.onPostCommitFiberRoot=="function")try{$n.onPostCommitFiberRoot(Lr,S)}catch{}return!0}finally{Ke.p=x,be.T=p,bp(i,s)}}function Tp(i,s,c){s=Ta(c,s),s=lf(i.stateNode,s,2),i=Er(i,s,2),i!==null&&(De(i,2),as(i))}function an(i,s,c){if(i.tag===3)Tp(i,i,c);else for(;s!==null;){if(s.tag===3){Tp(s,i,c);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&($l===null||!$l.has(p))){i=Ta(c,i),c=Su(2),p=Er(s,c,2),p!==null&&(gh(c,p,s,i),De(p,2),as(p));break}}s=s.return}}function Cd(i,s,c){var p=i.pingCache;if(p===null){p=i.pingCache=new Xp;var x=new Set;p.set(s,x)}else x=p.get(s),x===void 0&&(x=new Set,p.set(s,x));x.has(c)||(Sf=!0,x.add(c),i=Sp.bind(null,i,s,c),s.then(i,i))}function Sp(i,s,c){var p=i.pingCache;p!==null&&p.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Oi===i&&(Si&c)===c&&(En===4||En===3&&(Si&62914560)===Si&&300>An()-Ef?(Vi&2)===0&&Bc(i,0):_d|=c,Jo===Si&&(Jo=0)),as(i)}function Fu(i,s){s===0&&(s=ve()),i=Bo(i,s),i!==null&&(De(i,s),as(i))}function ho(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),Fu(i,c)}function Kl(i,s){var c=0;switch(i.tag){case 13:var p=i.stateNode,x=i.memoizedState;x!==null&&(c=x.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(R(314))}p!==null&&p.delete(s),Fu(i,c)}function Mp(i,s){return Qi(i,s)}var ju=null,Nu=null,Df=!1,Oc=!1,Ah=!1,Fc=0;function as(i){i!==Nu&&i.next===null&&(Nu===null?ju=Nu=i:Nu=Nu.next=i),Oc=!0,Df||(Df=!0,zd())}function jc(i,s){if(!Ah&&Oc){Ah=!0;do for(var c=!1,p=ju;p!==null;){if(i!==0){var x=p.pendingLanes;if(x===0)var S=0;else{var U=p.suspendedLanes,Y=p.pingedLanes;S=(1<<31-zn(42|i)+1)-1,S&=x&~(U&~Y),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(c=!0,kf(p,S))}else S=Si,S=$(p,p===Oi?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(S&3)===0||X(p,S)||(c=!0,kf(p,S));p=p.next}while(c);Ah=!1}}function Uu(){If()}function If(){Oc=Df=!1;var i=0;Fc!==0&&(em()&&(i=Fc),Fc=0);for(var s=An(),c=null,p=ju;p!==null;){var x=p.next,S=Rf(p,s);S===0?(p.next=null,c===null?ju=x:c.next=x,x===null&&(Nu=c)):(c=p,(i!==0||(S&3)!==0)&&(Oc=!0)),p=x}jc(i)}function Rf(i,s){for(var c=i.suspendedLanes,p=i.pingedLanes,x=i.expirationTimes,S=i.pendingLanes&-62914561;0<S;){var U=31-zn(S),Y=1<<U,fe=x[U];fe===-1?((Y&c)===0||(Y&p)!==0)&&(x[U]=J(Y,s)):fe<=s&&(i.expiredLanes|=Y),S&=~Y}if(s=Oi,c=Si,c=$(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,c===0||i===s&&(Zi===2||Zi===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&zi(p),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||X(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(p!==null&&zi(p),We(c)){case 2:case 8:c=Da;break;case 32:c=Va;break;case 268435456:c=Fs;break;default:c=Va}return p=Ad.bind(null,i),c=Qi(c,p),i.callbackPriority=s,i.callbackNode=c,s}return p!==null&&p!==null&&zi(p),i.callbackPriority=2,i.callbackNode=null,2}function Ad(i,s){if(Ca!==0&&Ca!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Ed()&&i.callbackNode!==c)return null;var p=Si;return p=$(i,i===Oi?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(yp(i,p,s),Rf(i,An()),i.callbackNode!=null&&i.callbackNode===c?Ad.bind(null,i):null)}function kf(i,s){if(Ed())return null;yp(i,s,!0)}function zd(){Rp(function(){(Vi&6)!==0?Qi(cl,Uu):If()})}function Pd(){return Fc===0&&(Fc=ce()),Fc}function Ep(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:qs(""+i)}function Cp(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function Ap(i,s,c,p,x){if(s==="submit"&&c&&c.stateNode===x){var S=Ep((x[Dt]||null).action),U=p.submitter;U&&(s=(s=U[Dt]||null)?Ep(s.formAction):U.getAttribute("formAction"),s!==null&&(S=s,U=null));var Y=new _l("action","action",null,p,x);i.push({event:Y,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Fc!==0){var fe=U?Cp(x,U):new FormData(x);Wr(c,{pending:!0,data:fe,method:x.method,action:S},null,fe)}}else typeof S=="function"&&(Y.preventDefault(),fe=U?Cp(x,U):new FormData(x),Wr(c,{pending:!0,data:fe,method:x.method,action:S},S,fe))},currentTarget:x}]})}}for(var Lf=0;Lf<hu.length;Lf++){var Bf=hu[Lf],Wp=Bf.toLowerCase(),Jp=Bf[0].toUpperCase()+Bf.slice(1);Xa(Wp,"on"+Jp)}Xa(mc,"onAnimationEnd"),Xa(gc,"onAnimationIteration"),Xa(cu,"onAnimationStart"),Xa("dblclick","onDoubleClick"),Xa("focusin","onFocus"),Xa("focusout","onBlur"),Xa(ko,"onTransitionRun"),Xa(uu,"onTransitionStart"),Xa(Cl,"onTransitionCancel"),Xa($a,"onTransitionEnd"),Br("onMouseEnter",["mouseout","mouseover"]),Br("onMouseLeave",["mouseout","mouseover"]),Br("onPointerEnter",["pointerout","pointerover"]),Br("onPointerLeave",["pointerout","pointerover"]),Ga("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ga("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ga("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ga("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ga("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ga("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Of=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zh));function il(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],x=p.event;p=p.listeners;e:{var S=void 0;if(s)for(var U=p.length-1;0<=U;U--){var Y=p[U],fe=Y.instance,Le=Y.currentTarget;if(Y=Y.listener,fe!==S&&x.isPropagationStopped())break e;S=Y,x.currentTarget=Le;try{S(x)}catch(Je){Tu(Je)}x.currentTarget=null,S=fe}else for(U=0;U<p.length;U++){if(Y=p[U],fe=Y.instance,Le=Y.currentTarget,Y=Y.listener,fe!==S&&x.isPropagationStopped())break e;S=Y,x.currentTarget=Le;try{S(x)}catch(Je){Tu(Je)}x.currentTarget=null,S=fe}}}}function _i(i,s){var c=s[yi];c===void 0&&(c=s[yi]=new Set);var p=i+"__bubble";c.has(p)||(Ff(s,i,2,!1),c.add(p))}function Dd(i,s,c){var p=0;s&&(p|=4),Ff(c,i,p,s)}var Ph="_reactListening"+Math.random().toString(36).slice(2);function Id(i){if(!i[Ph]){i[Ph]=!0,go.forEach(function(c){c!=="selectionchange"&&(Of.has(c)||Dd(c,!1,i),Dd(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Ph]||(s[Ph]=!0,Dd("selectionchange",!1,s))}}function Ff(i,s,c,p){switch(Et(s)){case 2:var x=nt;break;case 8:x=lt;break;default:x=Xe}c=x.bind(null,s,c,i),x=void 0,!wa||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(x=!0),p?x!==void 0?i.addEventListener(s,c,{capture:!0,passive:x}):i.addEventListener(s,c,!0):x!==void 0?i.addEventListener(s,c,{passive:x}):i.addEventListener(s,c,!1)}function Dh(i,s,c,p,x){var S=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var U=p.tag;if(U===3||U===4){var Y=p.stateNode.containerInfo;if(Y===x)break;if(U===4)for(U=p.return;U!==null;){var fe=U.tag;if((fe===3||fe===4)&&U.stateNode.containerInfo===x)return;U=U.return}for(;Y!==null;){if(U=Ht(Y),U===null)return;if(fe=U.tag,fe===5||fe===6||fe===26||fe===27){p=S=U;continue e}Y=Y.parentNode}}p=p.return}Ni(function(){var Le=S,Je=Hs(c),it=[];e:{var Ue=oh.get(i);if(Ue!==void 0){var qe=_l,Qt=i;switch(i){case"keypress":if($t(c)===0)break e;case"keydown":case"keyup":qe=Do;break;case"focusin":Qt="focus",qe=Ao;break;case"focusout":Qt="blur",qe=Ao;break;case"beforeblur":case"afterblur":qe=Ao;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=yl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=Yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=Wd;break;case mc:case gc:case cu:qe=Kn;break;case $a:qe=ef;break;case"scroll":case"scrollend":qe=cc;break;case"wheel":qe=vl;break;case"copy":case"cut":case"paste":qe=Wc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=Vh;break;case"toggle":case"beforetoggle":qe=iu}var Yt=(s&4)!==0,Xi=!Yt&&(i==="scroll"||i==="scrollend"),Ae=Yt?Ue!==null?Ue+"Capture":null:Ue;Yt=[];for(var Te=Le,ke;Te!==null;){var at=Te;if(ke=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||ke===null||Ae===null||(at=Or(Te,Ae),at!=null&&Yt.push(Vu(Te,at,ke))),Xi)break;Te=Te.return}0<Yt.length&&(Ue=new qe(Ue,Qt,null,c,Je),it.push({event:Ue,listeners:Yt}))}}if((s&7)===0){e:{if(Ue=i==="mouseover"||i==="pointerover",qe=i==="mouseout"||i==="pointerout",Ue&&c!==bo&&(Qt=c.relatedTarget||c.fromElement)&&(Ht(Qt)||Qt[Ve]))break e;if((qe||Ue)&&(Ue=Je.window===Je?Je:(Ue=Je.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,qe?(Qt=c.relatedTarget||c.toElement,qe=Le,Qt=Qt?Ht(Qt):null,Qt!==null&&(Xi=ae(Qt),Yt=Qt.tag,Qt!==Xi||Yt!==5&&Yt!==27&&Yt!==6)&&(Qt=null)):(qe=null,Qt=Le),qe!==Qt)){if(Yt=yl,at="onMouseLeave",Ae="onMouseEnter",Te="mouse",(i==="pointerout"||i==="pointerover")&&(Yt=Vh,at="onPointerLeave",Ae="onPointerEnter",Te="pointer"),Xi=qe==null?Ue:ji(qe),ke=Qt==null?Ue:ji(Qt),Ue=new Yt(at,Te+"leave",qe,c,Je),Ue.target=Xi,Ue.relatedTarget=ke,at=null,Ht(Je)===Le&&(Yt=new Yt(Ae,Te+"enter",Qt,c,Je),Yt.target=ke,Yt.relatedTarget=Xi,at=Yt),Xi=at,qe&&Qt)t:{for(Yt=qe,Ae=Qt,Te=0,ke=Yt;ke;ke=Nc(ke))Te++;for(ke=0,at=Ae;at;at=Nc(at))ke++;for(;0<Te-ke;)Yt=Nc(Yt),Te--;for(;0<ke-Te;)Ae=Nc(Ae),ke--;for(;Te--;){if(Yt===Ae||Ae!==null&&Yt===Ae.alternate)break t;Yt=Nc(Yt),Ae=Nc(Ae)}Yt=null}else Yt=null;qe!==null&&Rd(it,Ue,qe,Yt,!1),Qt!==null&&Xi!==null&&Rd(it,Xi,Qt,Yt,!0)}}e:{if(Ue=Le?ji(Le):window,qe=Ue.nodeName&&Ue.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Ue.type==="file")var Lt=cs;else if(Wu(Ue))if(Ju)Lt=Yh;else{Lt=th;var Wt=nf}else qe=Ue.nodeName,!qe||qe.toLowerCase()!=="input"||Ue.type!=="checkbox"&&Ue.type!=="radio"?Le&&ia(Le.elementType)&&(Lt=cs):Lt=Xh;if(Lt&&(Lt=Lt(i,Le))){Tl(it,Lt,c,Je);break e}Wt&&Wt(i,Ue,Le),i==="focusout"&&Le&&Ue.type==="number"&&Le.memoizedProps.value!=null&&lc(Ue,"number",Ue.value)}switch(Wt=Le?ji(Le):window,i){case"focusin":(Wu(Wt)||Wt.contentEditable==="true")&&(hr=Wt,fc=Le,pc=null);break;case"focusout":pc=fc=hr=null;break;case"mousedown":ah=!0;break;case"contextmenu":case"mouseup":case"dragend":ah=!1,Kh(it,c,Je);break;case"selectionchange":if(nh)break;case"keydown":case"keyup":Kh(it,c,Je)}var Ut;if(cr)e:{switch(i){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else ur?hc(i,c)&&(Kt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Kt="onCompositionStart");Kt&&(bl&&c.locale!=="ko"&&(ur||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&ur&&(Ut=ri()):(or=Je,Mi="value"in or?or.value:or.textContent,ur=!0)),Wt=Ql(Le,Kt),0<Wt.length&&(Kt=new Uh(Kt,i,null,c,Je),it.push({event:Kt,listeners:Wt}),Ut?Kt.data=Ut:(Ut=Qu(c),Ut!==null&&(Kt.data=Ut)))),(Ut=Ku?Gh(i,c):qh(i,c))&&(Kt=Ql(Le,"onBeforeInput"),0<Kt.length&&(Wt=new Uh("onBeforeInput","beforeinput",null,c,Je),it.push({event:Wt,listeners:Kt}),Wt.data=Ut)),Ap(it,i,Le,c,Je)}il(it,s)})}function Vu(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Ql(i,s){for(var c=s+"Capture",p=[];i!==null;){var x=i,S=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||S===null||(x=Or(i,c),x!=null&&p.unshift(Vu(i,x,S)),x=Or(i,s),x!=null&&p.push(Vu(i,x,S))),i.tag===3)return p;i=i.return}return[]}function Nc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Rd(i,s,c,p,x){for(var S=s._reactName,U=[];c!==null&&c!==p;){var Y=c,fe=Y.alternate,Le=Y.stateNode;if(Y=Y.tag,fe!==null&&fe===p)break;Y!==5&&Y!==26&&Y!==27||Le===null||(fe=Le,x?(Le=Or(c,S),Le!=null&&U.unshift(Vu(c,Le,fe))):x||(Le=Or(c,S),Le!=null&&U.push(Vu(c,Le,fe)))),c=c.return}U.length!==0&&i.push({event:s,listeners:U})}var zp=/\r\n?/g,Ir=/\u0000|\uFFFD/g;function Uc(i){return(typeof i=="string"?i:""+i).replace(zp,`
`).replace(Ir,"")}function jf(i,s){return s=Uc(s),Uc(i)===s}function Ih(){}function Gi(i,s,c,p,x,S){switch(c){case"children":typeof p=="string"?s==="body"||s==="textarea"&&p===""||Gs(i,p):(typeof p=="number"||typeof p=="bigint")&&s!=="body"&&Gs(i,""+p);break;case"className":Us(i,"class",p);break;case"tabIndex":Us(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Us(i,c,p);break;case"style":vo(i,p,S);break;case"data":if(s!=="object"){Us(i,"data",p);break}case"src":case"href":if(p===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=qs(""+p),i.setAttribute(c,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(c==="formAction"?(s!=="input"&&Gi(i,s,"name",x.name,x,null),Gi(i,s,"formEncType",x.formEncType,x,null),Gi(i,s,"formMethod",x.formMethod,x,null),Gi(i,s,"formTarget",x.formTarget,x,null)):(Gi(i,s,"encType",x.encType,x,null),Gi(i,s,"method",x.method,x,null),Gi(i,s,"target",x.target,x,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=qs(""+p),i.setAttribute(c,p);break;case"onClick":p!=null&&(i.onclick=Ih);break;case"onScroll":p!=null&&_i("scroll",i);break;case"onScrollEnd":p!=null&&_i("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(R(61));if(c=p.__html,c!=null){if(x.children!=null)throw Error(R(60));i.innerHTML=c}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}c=qs(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""+p):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":p===!0?i.setAttribute(c,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,p):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(c,p):i.removeAttribute(c);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(c):i.setAttribute(c,p);break;case"popover":_i("beforetoggle",i),_i("toggle",i),ki(i,"popover",p);break;case"xlinkActuate":Ia(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ia(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ia(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ia(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ia(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ia(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ia(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ia(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ia(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ki(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=xo.get(c)||c,ki(i,c,p))}}function kd(i,s,c,p,x,S){switch(c){case"style":vo(i,p,S);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(R(61));if(c=p.__html,c!=null){if(x.children!=null)throw Error(R(60));i.innerHTML=c}}break;case"children":typeof p=="string"?Gs(i,p):(typeof p=="number"||typeof p=="bigint")&&Gs(i,""+p);break;case"onScroll":p!=null&&_i("scroll",i);break;case"onScrollEnd":p!=null&&_i("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Ih);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dl.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),s=c.slice(2,x?c.length-7:void 0),S=i[Dt]||null,S=S!=null?S[c]:null,typeof S=="function"&&i.removeEventListener(s,S,x),typeof p=="function")){typeof S!="function"&&S!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,p,x);break e}c in i?i[c]=p:p===!0?i.setAttribute(c,""):ki(i,c,p)}}}function va(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_i("error",i),_i("load",i);var p=!1,x=!1,S;for(S in c)if(c.hasOwnProperty(S)){var U=c[S];if(U!=null)switch(S){case"src":p=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(R(137,s));default:Gi(i,s,S,U,c,null)}}x&&Gi(i,s,"srcSet",c.srcSet,c,null),p&&Gi(i,s,"src",c.src,c,null);return;case"input":_i("invalid",i);var Y=S=U=x=null,fe=null,Le=null;for(p in c)if(c.hasOwnProperty(p)){var Je=c[p];if(Je!=null)switch(p){case"name":x=Je;break;case"type":U=Je;break;case"checked":fe=Je;break;case"defaultChecked":Le=Je;break;case"value":S=Je;break;case"defaultValue":Y=Je;break;case"children":case"dangerouslySetInnerHTML":if(Je!=null)throw Error(R(137,s));break;default:Gi(i,s,p,Je,c,null)}}Zs(i,S,Y,fe,Le,U,x,!1),Yc(i);return;case"select":_i("invalid",i),p=U=S=null;for(x in c)if(c.hasOwnProperty(x)&&(Y=c[x],Y!=null))switch(x){case"value":S=Y;break;case"defaultValue":U=Y;break;case"multiple":p=Y;default:Gi(i,s,x,Y,c,null)}s=S,c=U,i.multiple=!!p,s!=null?pl(i,!!p,s,!1):c!=null&&pl(i,!!p,c,!0);return;case"textarea":_i("invalid",i),S=x=p=null;for(U in c)if(c.hasOwnProperty(U)&&(Y=c[U],Y!=null))switch(U){case"value":p=Y;break;case"defaultValue":x=Y;break;case"children":S=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(R(91));break;default:Gi(i,s,U,Y,c,null)}gl(i,p,x,S),Yc(i);return;case"option":for(fe in c)if(c.hasOwnProperty(fe)&&(p=c[fe],p!=null))switch(fe){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Gi(i,s,fe,p,c,null)}return;case"dialog":_i("beforetoggle",i),_i("toggle",i),_i("cancel",i),_i("close",i);break;case"iframe":case"object":_i("load",i);break;case"video":case"audio":for(p=0;p<zh.length;p++)_i(zh[p],i);break;case"image":_i("error",i),_i("load",i);break;case"details":_i("toggle",i);break;case"embed":case"source":case"link":_i("error",i),_i("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in c)if(c.hasOwnProperty(Le)&&(p=c[Le],p!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(R(137,s));default:Gi(i,s,Le,p,c,null)}return;default:if(ia(s)){for(Je in c)c.hasOwnProperty(Je)&&(p=c[Je],p!==void 0&&kd(i,s,Je,p,c,void 0));return}}for(Y in c)c.hasOwnProperty(Y)&&(p=c[Y],p!=null&&Gi(i,s,Y,p,c,null))}function Pp(i,s,c,p){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,S=null,U=null,Y=null,fe=null,Le=null,Je=null;for(qe in c){var it=c[qe];if(c.hasOwnProperty(qe)&&it!=null)switch(qe){case"checked":break;case"value":break;case"defaultValue":fe=it;default:p.hasOwnProperty(qe)||Gi(i,s,qe,null,p,it)}}for(var Ue in p){var qe=p[Ue];if(it=c[Ue],p.hasOwnProperty(Ue)&&(qe!=null||it!=null))switch(Ue){case"type":S=qe;break;case"name":x=qe;break;case"checked":Le=qe;break;case"defaultChecked":Je=qe;break;case"value":U=qe;break;case"defaultValue":Y=qe;break;case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(R(137,s));break;default:qe!==it&&Gi(i,s,Ue,qe,p,it)}}Kc(i,U,Y,fe,Le,Je,S,x);return;case"select":qe=U=Y=Ue=null;for(S in c)if(fe=c[S],c.hasOwnProperty(S)&&fe!=null)switch(S){case"value":break;case"multiple":qe=fe;default:p.hasOwnProperty(S)||Gi(i,s,S,null,p,fe)}for(x in p)if(S=p[x],fe=c[x],p.hasOwnProperty(x)&&(S!=null||fe!=null))switch(x){case"value":Ue=S;break;case"defaultValue":Y=S;break;case"multiple":U=S;default:S!==fe&&Gi(i,s,x,S,p,fe)}s=Y,c=U,p=qe,Ue!=null?pl(i,!!c,Ue,!1):!!p!=!!c&&(s!=null?pl(i,!!c,s,!0):pl(i,!!c,c?[]:"",!1));return;case"textarea":qe=Ue=null;for(Y in c)if(x=c[Y],c.hasOwnProperty(Y)&&x!=null&&!p.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:Gi(i,s,Y,null,p,x)}for(U in p)if(x=p[U],S=c[U],p.hasOwnProperty(U)&&(x!=null||S!=null))switch(U){case"value":Ue=x;break;case"defaultValue":qe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(R(91));break;default:x!==S&&Gi(i,s,U,x,p,S)}ml(i,Ue,qe);return;case"option":for(var Qt in c)if(Ue=c[Qt],c.hasOwnProperty(Qt)&&Ue!=null&&!p.hasOwnProperty(Qt))switch(Qt){case"selected":i.selected=!1;break;default:Gi(i,s,Qt,null,p,Ue)}for(fe in p)if(Ue=p[fe],qe=c[fe],p.hasOwnProperty(fe)&&Ue!==qe&&(Ue!=null||qe!=null))switch(fe){case"selected":i.selected=Ue&&typeof Ue!="function"&&typeof Ue!="symbol";break;default:Gi(i,s,fe,Ue,p,qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yt in c)Ue=c[Yt],c.hasOwnProperty(Yt)&&Ue!=null&&!p.hasOwnProperty(Yt)&&Gi(i,s,Yt,null,p,Ue);for(Le in p)if(Ue=p[Le],qe=c[Le],p.hasOwnProperty(Le)&&Ue!==qe&&(Ue!=null||qe!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(R(137,s));break;default:Gi(i,s,Le,Ue,p,qe)}return;default:if(ia(s)){for(var Xi in c)Ue=c[Xi],c.hasOwnProperty(Xi)&&Ue!==void 0&&!p.hasOwnProperty(Xi)&&kd(i,s,Xi,void 0,p,Ue);for(Je in p)Ue=p[Je],qe=c[Je],!p.hasOwnProperty(Je)||Ue===qe||Ue===void 0&&qe===void 0||kd(i,s,Je,Ue,p,qe);return}}for(var Ae in c)Ue=c[Ae],c.hasOwnProperty(Ae)&&Ue!=null&&!p.hasOwnProperty(Ae)&&Gi(i,s,Ae,null,p,Ue);for(it in p)Ue=p[it],qe=c[it],!p.hasOwnProperty(it)||Ue===qe||Ue==null&&qe==null||Gi(i,s,it,Ue,p,qe)}var Nf=null,Ld=null;function Is(i){return i.nodeType===9?i:i.ownerDocument}function Uf(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vf(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Bd(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Od=null;function em(){var i=window.event;return i&&i.type==="popstate"?i===Od?!1:(Od=i,!0):(Od=null,!1)}var Dp=typeof setTimeout=="function"?setTimeout:void 0,Ip=typeof clearTimeout=="function"?clearTimeout:void 0,Zu=typeof Promise=="function"?Promise:void 0,Rp=typeof queueMicrotask=="function"?queueMicrotask:typeof Zu<"u"?function(i){return Zu.resolve(null).then(i).catch(Fd)}:Dp;function Fd(i){setTimeout(function(){throw i})}function nl(i){return i==="head"}function Rh(i,s){var c=s,p=0,x=0;do{var S=c.nextSibling;if(i.removeChild(c),S&&S.nodeType===8)if(c=S.data,c==="/$"){if(0<p&&8>p){c=p;var U=i.ownerDocument;if(c&1&&qu(U.documentElement),c&2&&qu(U.body),c&4)for(c=U.head,qu(c),U=c.firstChild;U;){var Y=U.nextSibling,fe=U.nodeName;U[Qe]||fe==="SCRIPT"||fe==="STYLE"||fe==="LINK"&&U.rel.toLowerCase()==="stylesheet"||c.removeChild(U),U=Y}}if(x===0){i.removeChild(S),un(s);return}x--}else c==="$"||c==="$?"||c==="$!"?x++:p=c.charCodeAt(0)-48;else p=0;c=S}while(c);un(s)}function Gu(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Gu(c),Nt(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function jd(i,s,c,p){for(;i.nodeType===1;){var x=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Qe])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(S=i.getAttribute("rel"),S==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(S!==x.rel||i.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||i.getAttribute("title")!==(x.title==null?null:x.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(S=i.getAttribute("src"),(S!==(x.src==null?null:x.src)||i.getAttribute("type")!==(x.type==null?null:x.type)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&S&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var S=x.name==null?null:""+x.name;if(x.type==="hidden"&&i.getAttribute("name")===S)return i}else return i;if(i=ja(i.nextSibling),i===null)break}return null}function tm(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=ja(i.nextSibling),i===null))return null;return i}function Zf(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function im(i,s){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")s();else{var p=function(){s(),c.removeEventListener("DOMContentLoaded",p)};c.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function ja(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var ea=null;function al(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function Nd(i,s,c){switch(s=Is(c),i){case"html":if(i=s.documentElement,!i)throw Error(R(452));return i;case"head":if(i=s.head,!i)throw Error(R(453));return i;case"body":if(i=s.body,!i)throw Error(R(454));return i;default:throw Error(R(451))}}function qu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Nt(i)}var Rr=new Map,Ud=new Set;function Vd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var fo=Ke.d;Ke.d={f:kp,r:nm,D:Gf,C:Lp,L:kh,m:qf,X:Hf,S:Bp,M:Gd};function kp(){var i=fo.f(),s=ya();return i||s}function nm(i){var s=Ri(i);s!==null&&s.tag===5&&s.type==="form"?ws(s):fo.r(i)}var Vc=typeof document>"u"?null:document;function Zd(i,s,c){var p=Vc;if(p&&typeof s=="string"&&s){var x=ka(s);x='link[rel="'+i+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),Ud.has(x)||(Ud.add(x),i={rel:i,crossOrigin:c,href:s},p.querySelector(x)===null&&(s=p.createElement("link"),va(s,"link",i),Ft(s),p.head.appendChild(s)))}}function Gf(i){fo.D(i),Zd("dns-prefetch",i,null)}function Lp(i,s){fo.C(i,s),Zd("preconnect",i,s)}function kh(i,s,c){fo.L(i,s,c);var p=Vc;if(p&&i&&s){var x='link[rel="preload"][as="'+ka(s)+'"]';s==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+ka(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+ka(c.imageSizes)+'"]')):x+='[href="'+ka(i)+'"]';var S=x;switch(s){case"style":S=Wl(i);break;case"script":S=r(i)}Rr.has(S)||(i=Ce({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Rr.set(S,i),p.querySelector(x)!==null||s==="style"&&p.querySelector(Zc(S))||s==="script"&&p.querySelector(t(S))||(s=p.createElement("link"),va(s,"link",i),Ft(s),p.head.appendChild(s)))}}function qf(i,s){fo.m(i,s);var c=Vc;if(c&&i){var p=s&&typeof s.as=="string"?s.as:"script",x='link[rel="modulepreload"][as="'+ka(p)+'"][href="'+ka(i)+'"]',S=x;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=r(i)}if(!Rr.has(S)&&(i=Ce({rel:"modulepreload",href:i},s),Rr.set(S,i),c.querySelector(x)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(t(S)))return}p=c.createElement("link"),va(p,"link",i),Ft(p),c.head.appendChild(p)}}}function Bp(i,s,c){fo.S(i,s,c);var p=Vc;if(p&&i){var x=jn(p).hoistableStyles,S=Wl(i);s=s||"default";var U=x.get(S);if(!U){var Y={loading:0,preload:null};if(U=p.querySelector(Zc(S)))Y.loading=5;else{i=Ce({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Rr.get(S))&&h(i,c);var fe=U=p.createElement("link");Ft(fe),va(fe,"link",i),fe._p=new Promise(function(Le,Je){fe.onload=Le,fe.onerror=Je}),fe.addEventListener("load",function(){Y.loading|=1}),fe.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,o(U,s,p)}U={type:"stylesheet",instance:U,count:1,state:Y},x.set(S,U)}}}function Hf(i,s){fo.X(i,s);var c=Vc;if(c&&i){var p=jn(c).hoistableScripts,x=r(i),S=p.get(x);S||(S=c.querySelector(t(x)),S||(i=Ce({src:i,async:!0},s),(s=Rr.get(x))&&g(i,s),S=c.createElement("script"),Ft(S),va(S,"link",i),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(x,S))}}function Gd(i,s){fo.M(i,s);var c=Vc;if(c&&i){var p=jn(c).hoistableScripts,x=r(i),S=p.get(x);S||(S=c.querySelector(t(x)),S||(i=Ce({src:i,async:!0,type:"module"},s),(s=Rr.get(x))&&g(i,s),S=c.createElement("script"),Ft(S),va(S,"link",i),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(x,S))}}function Hu(i,s,c,p){var x=(x=Rt.current)?Vd(x):null;if(!x)throw Error(R(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Wl(c.href),c=jn(x).hoistableStyles,p=c.get(s),p||(p={type:"style",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Wl(c.href);var S=jn(x).hoistableStyles,U=S.get(i);if(U||(x=x.ownerDocument||x,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(i,U),(S=x.querySelector(Zc(i)))&&!S._p&&(U.instance=S,U.state.loading=5),Rr.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Rr.set(i,c),S||am(x,i,c,U.state))),s&&p===null)throw Error(R(528,""));return U}if(s&&p!==null)throw Error(R(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=r(c),c=jn(x).hoistableScripts,p=c.get(s),p||(p={type:"script",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(R(444,i))}}function Wl(i){return'href="'+ka(i)+'"'}function Zc(i){return'link[rel="stylesheet"]['+i+"]"}function qd(i){return Ce({},i,{"data-precedence":i.precedence,precedence:null})}function am(i,s,c,p){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?p.loading=1:(s=i.createElement("link"),p.preload=s,s.addEventListener("load",function(){return p.loading|=1}),s.addEventListener("error",function(){return p.loading|=2}),va(s,"link",c),Ft(s),i.head.appendChild(s))}function r(i){return'[src="'+ka(i)+'"]'}function t(i){return"script[async]"+i}function a(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var p=i.querySelector('style[data-href~="'+ka(c.href)+'"]');if(p)return s.instance=p,Ft(p),p;var x=Ce({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Ft(p),va(p,"style",x),o(p,c.precedence,i),s.instance=p;case"stylesheet":x=Wl(c.href);var S=i.querySelector(Zc(x));if(S)return s.state.loading|=4,s.instance=S,Ft(S),S;p=qd(c),(x=Rr.get(x))&&h(p,x),S=(i.ownerDocument||i).createElement("link"),Ft(S);var U=S;return U._p=new Promise(function(Y,fe){U.onload=Y,U.onerror=fe}),va(S,"link",p),s.state.loading|=4,o(S,c.precedence,i),s.instance=S;case"script":return S=r(c.src),(x=i.querySelector(t(S)))?(s.instance=x,Ft(x),x):(p=c,(x=Rr.get(S))&&(p=Ce({},c),g(p,x)),i=i.ownerDocument||i,x=i.createElement("script"),Ft(x),va(x,"link",p),i.head.appendChild(x),s.instance=x);case"void":return null;default:throw Error(R(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(p=s.instance,s.state.loading|=4,o(p,c.precedence,i));return s.instance}function o(i,s,c){for(var p=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=p.length?p[p.length-1]:null,S=x,U=0;U<p.length;U++){var Y=p[U];if(Y.dataset.precedence===s)S=Y;else if(S!==x)break}S?S.parentNode.insertBefore(i,S.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function h(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function g(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var _=null;function v(i,s,c){if(_===null){var p=new Map,x=_=new Map;x.set(c,p)}else x=_,p=x.get(c),p||(p=new Map,x.set(c,p));if(p.has(i))return p;for(p.set(i,null),c=c.getElementsByTagName(i),x=0;x<c.length;x++){var S=c[x];if(!(S[Qe]||S[Ot]||i==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var U=S.getAttribute(s)||"";U=i+U;var Y=p.get(U);Y?Y.push(S):p.set(U,[S])}}return p}function w(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function M(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function A(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var I=null;function F(){}function N(i,s,c){if(I===null)throw Error(R(475));var p=I;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var x=Wl(c.href),S=i.querySelector(Zc(x));if(S){i=S._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=q.bind(p),i.then(p,p)),s.state.loading|=4,s.instance=S,Ft(S);return}S=i.ownerDocument||i,c=qd(c),(x=Rr.get(x))&&h(c,x),S=S.createElement("link"),Ft(S);var U=S;U._p=new Promise(function(Y,fe){U.onload=Y,U.onerror=fe}),va(S,"link",c),s.instance=S}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(p.count++,s=q.bind(p),i.addEventListener("load",s),i.addEventListener("error",s))}}function V(){if(I===null)throw Error(R(475));var i=I;return i.stylesheets&&i.count===0&&ne(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&ne(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function q(){if(this.count--,this.count===0){if(this.stylesheets)ne(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Q=null;function ne(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Q=new Map,s.forEach(ye,i),Q=null,q.call(i))}function ye(i,s){if(!(s.state.loading&4)){var c=Q.get(i);if(c)var p=c.get(null);else{c=new Map,Q.set(i,c);for(var x=i.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<x.length;S++){var U=x[S];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(c.set(U.dataset.precedence,U),p=U)}p&&c.set(null,p)}x=s.instance,U=x.getAttribute("data-precedence"),S=c.get(U)||p,S===p&&c.set(null,x),c.set(U,x),this.count++,p=q.bind(this),x.addEventListener("load",p),x.addEventListener("error",p),S?S.parentNode.insertBefore(x,S.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(x,i.firstChild)),s.state.loading|=4}}var se={$$typeof:Pt,Provider:null,Consumer:null,_currentValue:Ge,_currentValue2:Ge,_threadCount:0};function j(i,s,c,p,x,S,U,Y){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=W(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W(0),this.hiddenUpdates=W(null),this.identifierPrefix=p,this.onUncaughtError=x,this.onCaughtError=S,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function K(i,s,c,p,x,S,U,Y,fe,Le,Je,it){return i=new j(i,s,c,U,Y,fe,Le,it),s=1,S===!0&&(s|=24),S=Ma(3,null,null,s),i.current=S,S.stateNode=i,s=eo(),s.refCount++,i.pooledCache=s,s.refCount++,S.memoizedState={element:p,isDehydrated:c,cache:s},vu(S),i}function ue(i){return i?(i=hs,i):hs}function Re(i,s,c,p,x,S){x=ue(x),p.context===null?p.context=x:p.pendingContext=x,p=Xr(s),p.payload={element:c},S=S===void 0?null:S,S!==null&&(p.callback=S),c=Er(i,p,s),c!==null&&(Dr(c,i,s),ys(c,i,s))}function tt(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Oe(i,s){tt(i,s),(i=i.alternate)&&tt(i,s)}function He(i){if(i.tag===13){var s=Bo(i,67108864);s!==null&&Dr(s,i,67108864),Oe(i,67108864)}}var rt=!0;function nt(i,s,c,p){var x=be.T;be.T=null;var S=Ke.p;try{Ke.p=2,Xe(i,s,c,p)}finally{Ke.p=S,be.T=x}}function lt(i,s,c,p){var x=be.T;be.T=null;var S=Ke.p;try{Ke.p=8,Xe(i,s,c,p)}finally{Ke.p=S,be.T=x}}function Xe(i,s,c,p){if(rt){var x=wt(p);if(x===null)Dh(i,s,p,kt,c),Zn(i,p);else if(sa(x,i,s,c,p))p.stopPropagation();else if(Zn(i,p),s&4&&-1<cn.indexOf(i)){for(;x!==null;){var S=Ri(x);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var U=Me(S.pendingLanes);if(U!==0){var Y=S;for(Y.pendingLanes|=2,Y.entangledLanes|=2;U;){var fe=1<<31-zn(U);Y.entanglements[1]|=fe,U&=~fe}as(S),(Vi&6)===0&&(yd=An()+500,jc(0))}}break;case 13:Y=Bo(S,2),Y!==null&&Dr(Y,S,2),ya(),Oe(S,2)}if(S=wt(p),S===null&&Dh(i,s,p,kt,c),S===x)break;x=S}x!==null&&p.stopPropagation()}else Dh(i,s,p,null,c)}}function wt(i){return i=Hs(i),It(i)}var kt=null;function It(i){if(kt=null,i=Ht(i),i!==null){var s=ae(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=P(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return kt=i,null}function Et(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rc()){case cl:return 2;case Da:return 8;case Va:case mo:return 32;case Fs:return 268435456;default:return 32}default:return 32}}var ai=!1,Ci=null,$i=null,gn=null,Aa=new Map,ra=new Map,ln=[],cn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zn(i,s){switch(i){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":gn=null;break;case"pointerover":case"pointerout":Aa.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ra.delete(s.pointerId)}}function kn(i,s,c,p,x,S){return i===null||i.nativeEvent!==S?(i={blockedOn:s,domEventName:c,eventSystemFlags:p,nativeEvent:S,targetContainers:[x]},s!==null&&(s=Ri(s),s!==null&&He(s)),i):(i.eventSystemFlags|=p,s=i.targetContainers,x!==null&&s.indexOf(x)===-1&&s.push(x),i)}function sa(i,s,c,p,x){switch(s){case"focusin":return Ci=kn(Ci,i,s,c,p,x),!0;case"dragenter":return $i=kn($i,i,s,c,p,x),!0;case"mouseover":return gn=kn(gn,i,s,c,p,x),!0;case"pointerover":var S=x.pointerId;return Aa.set(S,kn(Aa.get(S)||null,i,s,c,p,x)),!0;case"gotpointercapture":return S=x.pointerId,ra.set(S,kn(ra.get(S)||null,i,s,c,p,x)),!0}return!1}function za(i){var s=Ht(i.target);if(s!==null){var c=ae(s);if(c!==null){if(s=c.tag,s===13){if(s=P(c),s!==null){i.blockedOn=s,yt(i.priority,function(){if(c.tag===13){var p=ar();p=Ee(p);var x=Bo(c,p);x!==null&&Dr(x,c,p),Oe(c,p)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Na(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=wt(i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);bo=p,c.target.dispatchEvent(p),bo=null}else return s=Ri(c),s!==null&&He(s),i.blockedOn=c,!1;s.shift()}return!0}function Gn(i,s,c){Na(i)&&c.delete(s)}function rr(){ai=!1,Ci!==null&&Na(Ci)&&(Ci=null),$i!==null&&Na($i)&&($i=null),gn!==null&&Na(gn)&&(gn=null),Aa.forEach(Gn),ra.forEach(Gn)}function Cn(i,s){i.blockedOn===s&&(i.blockedOn=null,ai||(ai=!0,E.unstable_scheduleCallback(E.unstable_NormalPriority,rr)))}var Ln=null;function qn(i){Ln!==i&&(Ln=i,E.unstable_scheduleCallback(E.unstable_NormalPriority,function(){Ln===i&&(Ln=null);for(var s=0;s<i.length;s+=3){var c=i[s],p=i[s+1],x=i[s+2];if(typeof p!="function"){if(It(p||c)===null)continue;break}var S=Ri(c);S!==null&&(i.splice(s,3),s-=3,Wr(S,{pending:!0,data:x,method:c.method,action:p},p,x))}}))}function un(i){function s(fe){return Cn(fe,i)}Ci!==null&&Cn(Ci,i),$i!==null&&Cn($i,i),gn!==null&&Cn(gn,i),Aa.forEach(s),ra.forEach(s);for(var c=0;c<ln.length;c++){var p=ln[c];p.blockedOn===i&&(p.blockedOn=null)}for(;0<ln.length&&(c=ln[0],c.blockedOn===null);)za(c),c.blockedOn===null&&ln.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(p=0;p<c.length;p+=3){var x=c[p],S=c[p+1],U=x[Dt]||null;if(typeof S=="function")U||qn(c);else if(U){var Y=null;if(S&&S.hasAttribute("formAction")){if(x=S,U=S[Dt]||null)Y=U.formAction;else if(It(x)!==null)continue}else Y=U.action;typeof Y=="function"?c[p+1]=Y:(c.splice(p,3),p-=3),qn(c)}}}function Fi(i){this._internalRoot=i}_r.prototype.render=Fi.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(R(409));var c=s.current,p=ar();Re(c,p,i,s,null,null)},_r.prototype.unmount=Fi.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Re(i.current,2,null,i,null,null),ya(),s[Ve]=null}};function _r(i){this._internalRoot=i}_r.prototype.unstable_scheduleHydration=function(i){if(i){var s=ft();i={blockedOn:null,target:i,priority:s};for(var c=0;c<ln.length&&s!==0&&s<ln[c].priority;c++);ln.splice(c,0,i),c===0&&za(i)}};var Gc=D.version;if(Gc!=="19.1.0")throw Error(R(527,Gc,"19.1.0"));Ke.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(R(188)):(i=Object.keys(i).join(","),Error(R(268,i)));return i=ge(s),i=i!==null?re(i):null,i=i===null?null:i.stateNode,i};var Rs={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:be,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hd.isDisabled&&Hd.supportsFiber)try{Lr=Hd.inject(Rs),$n=Hd}catch{}}return Xf.createRoot=function(i,s){if(!H(i))throw Error(R(299));var c=!1,p="",x=rp,S=id,U=of,Y=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onUncaughtError!==void 0&&(x=s.onUncaughtError),s.onCaughtError!==void 0&&(S=s.onCaughtError),s.onRecoverableError!==void 0&&(U=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(Y=s.unstable_transitionCallbacks)),s=K(i,1,!1,null,null,c,p,x,S,U,Y,null),i[Ve]=s.current,Id(i),new Fi(s)},Xf.hydrateRoot=function(i,s,c){if(!H(i))throw Error(R(299));var p=!1,x="",S=rp,U=id,Y=of,fe=null,Le=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(S=c.onUncaughtError),c.onCaughtError!==void 0&&(U=c.onCaughtError),c.onRecoverableError!==void 0&&(Y=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(fe=c.unstable_transitionCallbacks),c.formState!==void 0&&(Le=c.formState)),s=K(i,1,!0,s,c??null,p,x,S,U,Y,fe,Le),s.context=ue(null),c=s.current,p=ar(),p=Ee(p),x=Xr(p),x.callback=null,Er(c,x,p),c=p,s.current.lanes=c,De(s,c),as(s),i[Ve]=s.current,Id(i),new _r(s)},Xf.version="19.1.0",Xf}var Um;function Xg(){if(Um)return om.exports;Um=1;function E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E)}catch(D){console.error(D)}}return E(),om.exports=$g(),om.exports}var Yg=Xg(),Yf={},Vm;function Kg(){if(Vm)return Yf;Vm=1,Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.parse=P,Yf.serialize=re;const E=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,D=/^[\u0021-\u003A\u003C-\u007E]*$/,O=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,R=/^[\u0020-\u003A\u003D-\u007E]*$/,H=Object.prototype.toString,ae=(()=>{const Se=function(){};return Se.prototype=Object.create(null),Se})();function P(Se,pe){const Pe=new ae,ht=Se.length;if(ht<2)return Pe;const Tt=(pe==null?void 0:pe.decode)||Ce;let pt=0;do{const St=Se.indexOf("=",pt);if(St===-1)break;const Pt=Se.indexOf(";",pt),qt=Pt===-1?ht:Pt;if(St>qt){pt=Se.lastIndexOf(";",St-1)+1;continue}const bt=d(Se,pt,St),Zt=ge(Se,St,bt),di=Se.slice(bt,Zt);if(Pe[di]===void 0){let Xt=d(Se,St+1,qt),li=ge(Se,qt,Xt);const ni=Tt(Se.slice(Xt,li));Pe[di]=ni}pt=qt+1}while(pt<ht);return Pe}function d(Se,pe,Pe){do{const ht=Se.charCodeAt(pe);if(ht!==32&&ht!==9)return pe}while(++pe<Pe);return Pe}function ge(Se,pe,Pe){for(;pe>Pe;){const ht=Se.charCodeAt(--pe);if(ht!==32&&ht!==9)return pe+1}return Pe}function re(Se,pe,Pe){const ht=(Pe==null?void 0:Pe.encode)||encodeURIComponent;if(!E.test(Se))throw new TypeError(`argument name is invalid: ${Se}`);const Tt=ht(pe);if(!D.test(Tt))throw new TypeError(`argument val is invalid: ${pe}`);let pt=Se+"="+Tt;if(!Pe)return pt;if(Pe.maxAge!==void 0){if(!Number.isInteger(Pe.maxAge))throw new TypeError(`option maxAge is invalid: ${Pe.maxAge}`);pt+="; Max-Age="+Pe.maxAge}if(Pe.domain){if(!O.test(Pe.domain))throw new TypeError(`option domain is invalid: ${Pe.domain}`);pt+="; Domain="+Pe.domain}if(Pe.path){if(!R.test(Pe.path))throw new TypeError(`option path is invalid: ${Pe.path}`);pt+="; Path="+Pe.path}if(Pe.expires){if(!Ne(Pe.expires)||!Number.isFinite(Pe.expires.valueOf()))throw new TypeError(`option expires is invalid: ${Pe.expires}`);pt+="; Expires="+Pe.expires.toUTCString()}if(Pe.httpOnly&&(pt+="; HttpOnly"),Pe.secure&&(pt+="; Secure"),Pe.partitioned&&(pt+="; Partitioned"),Pe.priority)switch(typeof Pe.priority=="string"?Pe.priority.toLowerCase():void 0){case"low":pt+="; Priority=Low";break;case"medium":pt+="; Priority=Medium";break;case"high":pt+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${Pe.priority}`)}if(Pe.sameSite)switch(typeof Pe.sameSite=="string"?Pe.sameSite.toLowerCase():Pe.sameSite){case!0:case"strict":pt+="; SameSite=Strict";break;case"lax":pt+="; SameSite=Lax";break;case"none":pt+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${Pe.sameSite}`)}return pt}function Ce(Se){if(Se.indexOf("%")===-1)return Se;try{return decodeURIComponent(Se)}catch{return Se}}function Ne(Se){return H.call(Se)==="[object Date]"}return Yf}Kg();var Zm="popstate";function Qg(E={}){function D(R,H){let{pathname:ae,search:P,hash:d}=R.location;return mm("",{pathname:ae,search:P,hash:d},H.state&&H.state.usr||null,H.state&&H.state.key||"default")}function O(R,H){return typeof H=="string"?H:Jf(H)}return Jg(D,O,null,E)}function Hn(E,D){if(E===!1||E===null||typeof E>"u")throw new Error(D)}function ic(E,D){if(!E){typeof console<"u"&&console.warn(D);try{throw new Error(D)}catch{}}}function Wg(){return Math.random().toString(36).substring(2,10)}function Gm(E,D){return{usr:E.state,key:E.key,idx:D}}function mm(E,D,O=null,R){return{pathname:typeof E=="string"?E:E.pathname,search:"",hash:"",...typeof D=="string"?Yd(D):D,state:O,key:D&&D.key||R||Wg()}}function Jf({pathname:E="/",search:D="",hash:O=""}){return D&&D!=="?"&&(E+=D.charAt(0)==="?"?D:"?"+D),O&&O!=="#"&&(E+=O.charAt(0)==="#"?O:"#"+O),E}function Yd(E){let D={};if(E){let O=E.indexOf("#");O>=0&&(D.hash=E.substring(O),E=E.substring(0,O));let R=E.indexOf("?");R>=0&&(D.search=E.substring(R),E=E.substring(0,R)),E&&(D.pathname=E)}return D}function Jg(E,D,O,R={}){let{window:H=document.defaultView,v5Compat:ae=!1}=R,P=H.history,d="POP",ge=null,re=Ce();re==null&&(re=0,P.replaceState({...P.state,idx:re},""));function Ce(){return(P.state||{idx:null}).idx}function Ne(){d="POP";let Tt=Ce(),pt=Tt==null?null:Tt-re;re=Tt,ge&&ge({action:d,location:ht.location,delta:pt})}function Se(Tt,pt){d="PUSH";let St=mm(ht.location,Tt,pt);re=Ce()+1;let Pt=Gm(St,re),qt=ht.createHref(St);try{P.pushState(Pt,"",qt)}catch(bt){if(bt instanceof DOMException&&bt.name==="DataCloneError")throw bt;H.location.assign(qt)}ae&&ge&&ge({action:d,location:ht.location,delta:1})}function pe(Tt,pt){d="REPLACE";let St=mm(ht.location,Tt,pt);re=Ce();let Pt=Gm(St,re),qt=ht.createHref(St);P.replaceState(Pt,"",qt),ae&&ge&&ge({action:d,location:ht.location,delta:0})}function Pe(Tt){return e_(Tt)}let ht={get action(){return d},get location(){return E(H,P)},listen(Tt){if(ge)throw new Error("A history only accepts one active listener");return H.addEventListener(Zm,Ne),ge=Tt,()=>{H.removeEventListener(Zm,Ne),ge=null}},createHref(Tt){return D(H,Tt)},createURL:Pe,encodeLocation(Tt){let pt=Pe(Tt);return{pathname:pt.pathname,search:pt.search,hash:pt.hash}},push:Se,replace:pe,go(Tt){return P.go(Tt)}};return ht}function e_(E,D=!1){let O="http://localhost";typeof window<"u"&&(O=window.location.origin!=="null"?window.location.origin:window.location.href),Hn(O,"No window.location.(origin|href) available to create URL");let R=typeof E=="string"?E:Jf(E);return R=R.replace(/ $/,"%20"),!D&&R.startsWith("//")&&(R=O+R),new URL(R,O)}function Jm(E,D,O="/"){return t_(E,D,O,!1)}function t_(E,D,O,R){let H=typeof D=="string"?Yd(D):D,ae=Hc(H.pathname||"/",O);if(ae==null)return null;let P=eg(E);i_(P);let d=null;for(let ge=0;d==null&&ge<P.length;++ge){let re=f_(ae);d=h_(P[ge],re,R)}return d}function eg(E,D=[],O=[],R=""){let H=(ae,P,d)=>{let ge={relativePath:d===void 0?ae.path||"":d,caseSensitive:ae.caseSensitive===!0,childrenIndex:P,route:ae};ge.relativePath.startsWith("/")&&(Hn(ge.relativePath.startsWith(R),`Absolute route path "${ge.relativePath}" nested under path "${R}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),ge.relativePath=ge.relativePath.slice(R.length));let re=qc([R,ge.relativePath]),Ce=O.concat(ge);ae.children&&ae.children.length>0&&(Hn(ae.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${re}".`),eg(ae.children,D,Ce,re)),!(ae.path==null&&!ae.index)&&D.push({path:re,score:c_(re,ae.index),routesMeta:Ce})};return E.forEach((ae,P)=>{var d;if(ae.path===""||!((d=ae.path)!=null&&d.includes("?")))H(ae,P);else for(let ge of tg(ae.path))H(ae,P,ge)}),D}function tg(E){let D=E.split("/");if(D.length===0)return[];let[O,...R]=D,H=O.endsWith("?"),ae=O.replace(/\?$/,"");if(R.length===0)return H?[ae,""]:[ae];let P=tg(R.join("/")),d=[];return d.push(...P.map(ge=>ge===""?ae:[ae,ge].join("/"))),H&&d.push(...P),d.map(ge=>E.startsWith("/")&&ge===""?"/":ge)}function i_(E){E.sort((D,O)=>D.score!==O.score?O.score-D.score:u_(D.routesMeta.map(R=>R.childrenIndex),O.routesMeta.map(R=>R.childrenIndex)))}var n_=/^:[\w-]+$/,a_=3,r_=2,s_=1,o_=10,l_=-2,qm=E=>E==="*";function c_(E,D){let O=E.split("/"),R=O.length;return O.some(qm)&&(R+=l_),D&&(R+=r_),O.filter(H=>!qm(H)).reduce((H,ae)=>H+(n_.test(ae)?a_:ae===""?s_:o_),R)}function u_(E,D){return E.length===D.length&&E.slice(0,-1).every((R,H)=>R===D[H])?E[E.length-1]-D[D.length-1]:0}function h_(E,D,O=!1){let{routesMeta:R}=E,H={},ae="/",P=[];for(let d=0;d<R.length;++d){let ge=R[d],re=d===R.length-1,Ce=ae==="/"?D:D.slice(ae.length)||"/",Ne=Vp({path:ge.relativePath,caseSensitive:ge.caseSensitive,end:re},Ce),Se=ge.route;if(!Ne&&re&&O&&!R[R.length-1].route.index&&(Ne=Vp({path:ge.relativePath,caseSensitive:ge.caseSensitive,end:!1},Ce)),!Ne)return null;Object.assign(H,Ne.params),P.push({params:H,pathname:qc([ae,Ne.pathname]),pathnameBase:__(qc([ae,Ne.pathnameBase])),route:Se}),Ne.pathnameBase!=="/"&&(ae=qc([ae,Ne.pathnameBase]))}return P}function Vp(E,D){typeof E=="string"&&(E={path:E,caseSensitive:!1,end:!0});let[O,R]=d_(E.path,E.caseSensitive,E.end),H=D.match(O);if(!H)return null;let ae=H[0],P=ae.replace(/(.)\/+$/,"$1"),d=H.slice(1);return{params:R.reduce((re,{paramName:Ce,isOptional:Ne},Se)=>{if(Ce==="*"){let Pe=d[Se]||"";P=ae.slice(0,ae.length-Pe.length).replace(/(.)\/+$/,"$1")}const pe=d[Se];return Ne&&!pe?re[Ce]=void 0:re[Ce]=(pe||"").replace(/%2F/g,"/"),re},{}),pathname:ae,pathnameBase:P,pattern:E}}function d_(E,D=!1,O=!0){ic(E==="*"||!E.endsWith("*")||E.endsWith("/*"),`Route path "${E}" will be treated as if it were "${E.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${E.replace(/\*$/,"/*")}".`);let R=[],H="^"+E.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(P,d,ge)=>(R.push({paramName:d,isOptional:ge!=null}),ge?"/?([^\\/]+)?":"/([^\\/]+)"));return E.endsWith("*")?(R.push({paramName:"*"}),H+=E==="*"||E==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):O?H+="\\/*$":E!==""&&E!=="/"&&(H+="(?:(?=\\/|$))"),[new RegExp(H,D?void 0:"i"),R]}function f_(E){try{return E.split("/").map(D=>decodeURIComponent(D).replace(/\//g,"%2F")).join("/")}catch(D){return ic(!1,`The URL path "${E}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${D}).`),E}}function Hc(E,D){if(D==="/")return E;if(!E.toLowerCase().startsWith(D.toLowerCase()))return null;let O=D.endsWith("/")?D.length-1:D.length,R=E.charAt(O);return R&&R!=="/"?null:E.slice(O)||"/"}function p_(E,D="/"){let{pathname:O,search:R="",hash:H=""}=typeof E=="string"?Yd(E):E;return{pathname:O?O.startsWith("/")?O:m_(O,D):D,search:y_(R),hash:v_(H)}}function m_(E,D){let O=D.replace(/\/+$/,"").split("/");return E.split("/").forEach(H=>{H===".."?O.length>1&&O.pop():H!=="."&&O.push(H)}),O.length>1?O.join("/"):"/"}function hm(E,D,O,R){return`Cannot include a '${E}' character in a manually specified \`to.${D}\` field [${JSON.stringify(R)}].  Please separate it out to the \`to.${O}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function g_(E){return E.filter((D,O)=>O===0||D.route.path&&D.route.path.length>0)}function ig(E){let D=g_(E);return D.map((O,R)=>R===D.length-1?O.pathname:O.pathnameBase)}function ng(E,D,O,R=!1){let H;typeof E=="string"?H=Yd(E):(H={...E},Hn(!H.pathname||!H.pathname.includes("?"),hm("?","pathname","search",H)),Hn(!H.pathname||!H.pathname.includes("#"),hm("#","pathname","hash",H)),Hn(!H.search||!H.search.includes("#"),hm("#","search","hash",H)));let ae=E===""||H.pathname==="",P=ae?"/":H.pathname,d;if(P==null)d=O;else{let Ne=D.length-1;if(!R&&P.startsWith("..")){let Se=P.split("/");for(;Se[0]==="..";)Se.shift(),Ne-=1;H.pathname=Se.join("/")}d=Ne>=0?D[Ne]:"/"}let ge=p_(H,d),re=P&&P!=="/"&&P.endsWith("/"),Ce=(ae||P===".")&&O.endsWith("/");return!ge.pathname.endsWith("/")&&(re||Ce)&&(ge.pathname+="/"),ge}var qc=E=>E.join("/").replace(/\/\/+/g,"/"),__=E=>E.replace(/\/+$/,"").replace(/^\/*/,"/"),y_=E=>!E||E==="?"?"":E.startsWith("?")?E:"?"+E,v_=E=>!E||E==="#"?"":E.startsWith("#")?E:"#"+E;function x_(E){return E!=null&&typeof E.status=="number"&&typeof E.statusText=="string"&&typeof E.internal=="boolean"&&"data"in E}var ag=["POST","PUT","PATCH","DELETE"];new Set(ag);var b_=["GET",...ag];new Set(b_);var Kd=st.createContext(null);Kd.displayName="DataRouter";var Zp=st.createContext(null);Zp.displayName="DataRouterState";var rg=st.createContext({isTransitioning:!1});rg.displayName="ViewTransition";var w_=st.createContext(new Map);w_.displayName="Fetchers";var T_=st.createContext(null);T_.displayName="Await";var nc=st.createContext(null);nc.displayName="Navigation";var ep=st.createContext(null);ep.displayName="Location";var $c=st.createContext({outlet:null,matches:[],isDataRoute:!1});$c.displayName="Route";var bm=st.createContext(null);bm.displayName="RouteError";function S_(E,{relative:D}={}){Hn(tp(),"useHref() may be used only in the context of a <Router> component.");let{basename:O,navigator:R}=st.useContext(nc),{hash:H,pathname:ae,search:P}=ip(E,{relative:D}),d=ae;return O!=="/"&&(d=ae==="/"?O:qc([O,ae])),R.createHref({pathname:d,search:P,hash:H})}function tp(){return st.useContext(ep)!=null}function Oh(){return Hn(tp(),"useLocation() may be used only in the context of a <Router> component."),st.useContext(ep).location}var sg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function og(E){st.useContext(nc).static||st.useLayoutEffect(E)}function M_(){let{isDataRoute:E}=st.useContext($c);return E?F_():E_()}function E_(){Hn(tp(),"useNavigate() may be used only in the context of a <Router> component.");let E=st.useContext(Kd),{basename:D,navigator:O}=st.useContext(nc),{matches:R}=st.useContext($c),{pathname:H}=Oh(),ae=JSON.stringify(ig(R)),P=st.useRef(!1);return og(()=>{P.current=!0}),st.useCallback((ge,re={})=>{if(ic(P.current,sg),!P.current)return;if(typeof ge=="number"){O.go(ge);return}let Ce=ng(ge,JSON.parse(ae),H,re.relative==="path");E==null&&D!=="/"&&(Ce.pathname=Ce.pathname==="/"?D:qc([D,Ce.pathname])),(re.replace?O.replace:O.push)(Ce,re.state,re)},[D,O,ae,H,E])}st.createContext(null);function ip(E,{relative:D}={}){let{matches:O}=st.useContext($c),{pathname:R}=Oh(),H=JSON.stringify(ig(O));return st.useMemo(()=>ng(E,JSON.parse(H),R,D==="path"),[E,H,R,D])}function C_(E,D){return lg(E,D)}function lg(E,D,O,R){var pt;Hn(tp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:H}=st.useContext(nc),{matches:ae}=st.useContext($c),P=ae[ae.length-1],d=P?P.params:{},ge=P?P.pathname:"/",re=P?P.pathnameBase:"/",Ce=P&&P.route;{let St=Ce&&Ce.path||"";cg(ge,!Ce||St.endsWith("*")||St.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${ge}" (under <Route path="${St}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${St}"> to <Route path="${St==="/"?"*":`${St}/*`}">.`)}let Ne=Oh(),Se;if(D){let St=typeof D=="string"?Yd(D):D;Hn(re==="/"||((pt=St.pathname)==null?void 0:pt.startsWith(re)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${re}" but pathname "${St.pathname}" was given in the \`location\` prop.`),Se=St}else Se=Ne;let pe=Se.pathname||"/",Pe=pe;if(re!=="/"){let St=re.replace(/^\//,"").split("/");Pe="/"+pe.replace(/^\//,"").split("/").slice(St.length).join("/")}let ht=Jm(E,{pathname:Pe});ic(Ce||ht!=null,`No routes matched location "${Se.pathname}${Se.search}${Se.hash}" `),ic(ht==null||ht[ht.length-1].route.element!==void 0||ht[ht.length-1].route.Component!==void 0||ht[ht.length-1].route.lazy!==void 0,`Matched leaf route at location "${Se.pathname}${Se.search}${Se.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Tt=I_(ht&&ht.map(St=>Object.assign({},St,{params:Object.assign({},d,St.params),pathname:qc([re,H.encodeLocation?H.encodeLocation(St.pathname).pathname:St.pathname]),pathnameBase:St.pathnameBase==="/"?re:qc([re,H.encodeLocation?H.encodeLocation(St.pathnameBase).pathname:St.pathnameBase])})),ae,O,R);return D&&Tt?st.createElement(ep.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Se},navigationType:"POP"}},Tt):Tt}function A_(){let E=O_(),D=x_(E)?`${E.status} ${E.statusText}`:E instanceof Error?E.message:JSON.stringify(E),O=E instanceof Error?E.stack:null,R="rgba(200,200,200, 0.5)",H={padding:"0.5rem",backgroundColor:R},ae={padding:"2px 4px",backgroundColor:R},P=null;return console.error("Error handled by React Router default ErrorBoundary:",E),P=st.createElement(st.Fragment,null,st.createElement("p",null," Hey developer "),st.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",st.createElement("code",{style:ae},"ErrorBoundary")," or"," ",st.createElement("code",{style:ae},"errorElement")," prop on your route.")),st.createElement(st.Fragment,null,st.createElement("h2",null,"Unexpected Application Error!"),st.createElement("h3",{style:{fontStyle:"italic"}},D),O?st.createElement("pre",{style:H},O):null,P)}var z_=st.createElement(A_,null),P_=class extends st.Component{constructor(E){super(E),this.state={location:E.location,revalidation:E.revalidation,error:E.error}}static getDerivedStateFromError(E){return{error:E}}static getDerivedStateFromProps(E,D){return D.location!==E.location||D.revalidation!=="idle"&&E.revalidation==="idle"?{error:E.error,location:E.location,revalidation:E.revalidation}:{error:E.error!==void 0?E.error:D.error,location:D.location,revalidation:E.revalidation||D.revalidation}}componentDidCatch(E,D){console.error("React Router caught the following error during render",E,D)}render(){return this.state.error!==void 0?st.createElement($c.Provider,{value:this.props.routeContext},st.createElement(bm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function D_({routeContext:E,match:D,children:O}){let R=st.useContext(Kd);return R&&R.static&&R.staticContext&&(D.route.errorElement||D.route.ErrorBoundary)&&(R.staticContext._deepestRenderedBoundaryId=D.route.id),st.createElement($c.Provider,{value:E},O)}function I_(E,D=[],O=null,R=null){if(E==null){if(!O)return null;if(O.errors)E=O.matches;else if(D.length===0&&!O.initialized&&O.matches.length>0)E=O.matches;else return null}let H=E,ae=O==null?void 0:O.errors;if(ae!=null){let ge=H.findIndex(re=>re.route.id&&(ae==null?void 0:ae[re.route.id])!==void 0);Hn(ge>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(ae).join(",")}`),H=H.slice(0,Math.min(H.length,ge+1))}let P=!1,d=-1;if(O)for(let ge=0;ge<H.length;ge++){let re=H[ge];if((re.route.HydrateFallback||re.route.hydrateFallbackElement)&&(d=ge),re.route.id){let{loaderData:Ce,errors:Ne}=O,Se=re.route.loader&&!Ce.hasOwnProperty(re.route.id)&&(!Ne||Ne[re.route.id]===void 0);if(re.route.lazy||Se){P=!0,d>=0?H=H.slice(0,d+1):H=[H[0]];break}}}return H.reduceRight((ge,re,Ce)=>{let Ne,Se=!1,pe=null,Pe=null;O&&(Ne=ae&&re.route.id?ae[re.route.id]:void 0,pe=re.route.errorElement||z_,P&&(d<0&&Ce===0?(cg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Se=!0,Pe=null):d===Ce&&(Se=!0,Pe=re.route.hydrateFallbackElement||null)));let ht=D.concat(H.slice(0,Ce+1)),Tt=()=>{let pt;return Ne?pt=pe:Se?pt=Pe:re.route.Component?pt=st.createElement(re.route.Component,null):re.route.element?pt=re.route.element:pt=ge,st.createElement(D_,{match:re,routeContext:{outlet:ge,matches:ht,isDataRoute:O!=null},children:pt})};return O&&(re.route.ErrorBoundary||re.route.errorElement||Ce===0)?st.createElement(P_,{location:O.location,revalidation:O.revalidation,component:pe,error:Ne,children:Tt(),routeContext:{outlet:null,matches:ht,isDataRoute:!0}}):Tt()},null)}function wm(E){return`${E} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function R_(E){let D=st.useContext(Kd);return Hn(D,wm(E)),D}function k_(E){let D=st.useContext(Zp);return Hn(D,wm(E)),D}function L_(E){let D=st.useContext($c);return Hn(D,wm(E)),D}function Tm(E){let D=L_(E),O=D.matches[D.matches.length-1];return Hn(O.route.id,`${E} can only be used on routes that contain a unique "id"`),O.route.id}function B_(){return Tm("useRouteId")}function O_(){var R;let E=st.useContext(bm),D=k_("useRouteError"),O=Tm("useRouteError");return E!==void 0?E:(R=D.errors)==null?void 0:R[O]}function F_(){let{router:E}=R_("useNavigate"),D=Tm("useNavigate"),O=st.useRef(!1);return og(()=>{O.current=!0}),st.useCallback(async(H,ae={})=>{ic(O.current,sg),O.current&&(typeof H=="number"?E.navigate(H):await E.navigate(H,{fromRouteId:D,...ae}))},[E,D])}var Hm={};function cg(E,D,O){!D&&!Hm[E]&&(Hm[E]=!0,ic(!1,O))}st.memo(j_);function j_({routes:E,future:D,state:O}){return lg(E,void 0,O,D)}function gm(E){Hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function N_({basename:E="/",children:D=null,location:O,navigationType:R="POP",navigator:H,static:ae=!1}){Hn(!tp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let P=E.replace(/^\/*/,"/"),d=st.useMemo(()=>({basename:P,navigator:H,static:ae,future:{}}),[P,H,ae]);typeof O=="string"&&(O=Yd(O));let{pathname:ge="/",search:re="",hash:Ce="",state:Ne=null,key:Se="default"}=O,pe=st.useMemo(()=>{let Pe=Hc(ge,P);return Pe==null?null:{location:{pathname:Pe,search:re,hash:Ce,state:Ne,key:Se},navigationType:R}},[P,ge,re,Ce,Ne,Se,R]);return ic(pe!=null,`<Router basename="${P}"> is not able to match the URL "${ge}${re}${Ce}" because it does not start with the basename, so the <Router> won't render anything.`),pe==null?null:st.createElement(nc.Provider,{value:d},st.createElement(ep.Provider,{children:D,value:pe}))}function U_({children:E,location:D}){return C_(_m(E),D)}function _m(E,D=[]){let O=[];return st.Children.forEach(E,(R,H)=>{if(!st.isValidElement(R))return;let ae=[...D,H];if(R.type===st.Fragment){O.push.apply(O,_m(R.props.children,ae));return}Hn(R.type===gm,`[${typeof R.type=="string"?R.type:R.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Hn(!R.props.index||!R.props.children,"An index route cannot have child routes.");let P={id:R.props.id||ae.join("-"),caseSensitive:R.props.caseSensitive,element:R.props.element,Component:R.props.Component,index:R.props.index,path:R.props.path,loader:R.props.loader,action:R.props.action,hydrateFallbackElement:R.props.hydrateFallbackElement,HydrateFallback:R.props.HydrateFallback,errorElement:R.props.errorElement,ErrorBoundary:R.props.ErrorBoundary,hasErrorBoundary:R.props.hasErrorBoundary===!0||R.props.ErrorBoundary!=null||R.props.errorElement!=null,shouldRevalidate:R.props.shouldRevalidate,handle:R.props.handle,lazy:R.props.lazy};R.props.children&&(P.children=_m(R.props.children,ae)),O.push(P)}),O}var Fp="get",jp="application/x-www-form-urlencoded";function Gp(E){return E!=null&&typeof E.tagName=="string"}function V_(E){return Gp(E)&&E.tagName.toLowerCase()==="button"}function Z_(E){return Gp(E)&&E.tagName.toLowerCase()==="form"}function G_(E){return Gp(E)&&E.tagName.toLowerCase()==="input"}function q_(E){return!!(E.metaKey||E.altKey||E.ctrlKey||E.shiftKey)}function H_(E,D){return E.button===0&&(!D||D==="_self")&&!q_(E)}var Op=null;function $_(){if(Op===null)try{new FormData(document.createElement("form"),0),Op=!1}catch{Op=!0}return Op}var X_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function dm(E){return E!=null&&!X_.has(E)?(ic(!1,`"${E}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${jp}"`),null):E}function Y_(E,D){let O,R,H,ae,P;if(Z_(E)){let d=E.getAttribute("action");R=d?Hc(d,D):null,O=E.getAttribute("method")||Fp,H=dm(E.getAttribute("enctype"))||jp,ae=new FormData(E)}else if(V_(E)||G_(E)&&(E.type==="submit"||E.type==="image")){let d=E.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let ge=E.getAttribute("formaction")||d.getAttribute("action");if(R=ge?Hc(ge,D):null,O=E.getAttribute("formmethod")||d.getAttribute("method")||Fp,H=dm(E.getAttribute("formenctype"))||dm(d.getAttribute("enctype"))||jp,ae=new FormData(d,E),!$_()){let{name:re,type:Ce,value:Ne}=E;if(Ce==="image"){let Se=re?`${re}.`:"";ae.append(`${Se}x`,"0"),ae.append(`${Se}y`,"0")}else re&&ae.append(re,Ne)}}else{if(Gp(E))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');O=Fp,R=null,H=jp,P=E}return ae&&H==="text/plain"&&(P=ae,ae=void 0),{action:R,method:O.toLowerCase(),encType:H,formData:ae,body:P}}function Sm(E,D){if(E===!1||E===null||typeof E>"u")throw new Error(D)}async function K_(E,D){if(E.id in D)return D[E.id];try{let O=await import(E.module);return D[E.id]=O,O}catch(O){return console.error(`Error loading route module \`${E.module}\`, reloading page...`),console.error(O),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Q_(E){return E==null?!1:E.href==null?E.rel==="preload"&&typeof E.imageSrcSet=="string"&&typeof E.imageSizes=="string":typeof E.rel=="string"&&typeof E.href=="string"}async function W_(E,D,O){let R=await Promise.all(E.map(async H=>{let ae=D.routes[H.route.id];if(ae){let P=await K_(ae,O);return P.links?P.links():[]}return[]}));return iy(R.flat(1).filter(Q_).filter(H=>H.rel==="stylesheet"||H.rel==="preload").map(H=>H.rel==="stylesheet"?{...H,rel:"prefetch",as:"style"}:{...H,rel:"prefetch"}))}function $m(E,D,O,R,H,ae){let P=(ge,re)=>O[re]?ge.route.id!==O[re].route.id:!0,d=(ge,re)=>{var Ce;return O[re].pathname!==ge.pathname||((Ce=O[re].route.path)==null?void 0:Ce.endsWith("*"))&&O[re].params["*"]!==ge.params["*"]};return ae==="assets"?D.filter((ge,re)=>P(ge,re)||d(ge,re)):ae==="data"?D.filter((ge,re)=>{var Ne;let Ce=R.routes[ge.route.id];if(!Ce||!Ce.hasLoader)return!1;if(P(ge,re)||d(ge,re))return!0;if(ge.route.shouldRevalidate){let Se=ge.route.shouldRevalidate({currentUrl:new URL(H.pathname+H.search+H.hash,window.origin),currentParams:((Ne=O[0])==null?void 0:Ne.params)||{},nextUrl:new URL(E,window.origin),nextParams:ge.params,defaultShouldRevalidate:!0});if(typeof Se=="boolean")return Se}return!0}):[]}function J_(E,D,{includeHydrateFallback:O}={}){return ey(E.map(R=>{let H=D.routes[R.route.id];if(!H)return[];let ae=[H.module];return H.clientActionModule&&(ae=ae.concat(H.clientActionModule)),H.clientLoaderModule&&(ae=ae.concat(H.clientLoaderModule)),O&&H.hydrateFallbackModule&&(ae=ae.concat(H.hydrateFallbackModule)),H.imports&&(ae=ae.concat(H.imports)),ae}).flat(1))}function ey(E){return[...new Set(E)]}function ty(E){let D={},O=Object.keys(E).sort();for(let R of O)D[R]=E[R];return D}function iy(E,D){let O=new Set;return new Set(D),E.reduce((R,H)=>{let ae=JSON.stringify(ty(H));return O.has(ae)||(O.add(ae),R.push({key:ae,link:H})),R},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ny=new Set([100,101,204,205]);function ay(E,D){let O=typeof E=="string"?new URL(E,typeof window>"u"?"server://singlefetch/":window.location.origin):E;return O.pathname==="/"?O.pathname="_root.data":D&&Hc(O.pathname,D)==="/"?O.pathname=`${D.replace(/\/$/,"")}/_root.data`:O.pathname=`${O.pathname.replace(/\/$/,"")}.data`,O}function ug(){let E=st.useContext(Kd);return Sm(E,"You must render this element inside a <DataRouterContext.Provider> element"),E}function ry(){let E=st.useContext(Zp);return Sm(E,"You must render this element inside a <DataRouterStateContext.Provider> element"),E}var Mm=st.createContext(void 0);Mm.displayName="FrameworkContext";function hg(){let E=st.useContext(Mm);return Sm(E,"You must render this element inside a <HydratedRouter> element"),E}function sy(E,D){let O=st.useContext(Mm),[R,H]=st.useState(!1),[ae,P]=st.useState(!1),{onFocus:d,onBlur:ge,onMouseEnter:re,onMouseLeave:Ce,onTouchStart:Ne}=D,Se=st.useRef(null);st.useEffect(()=>{if(E==="render"&&P(!0),E==="viewport"){let ht=pt=>{pt.forEach(St=>{P(St.isIntersecting)})},Tt=new IntersectionObserver(ht,{threshold:.5});return Se.current&&Tt.observe(Se.current),()=>{Tt.disconnect()}}},[E]),st.useEffect(()=>{if(R){let ht=setTimeout(()=>{P(!0)},100);return()=>{clearTimeout(ht)}}},[R]);let pe=()=>{H(!0)},Pe=()=>{H(!1),P(!1)};return O?E!=="intent"?[ae,Se,{}]:[ae,Se,{onFocus:Kf(d,pe),onBlur:Kf(ge,Pe),onMouseEnter:Kf(re,pe),onMouseLeave:Kf(Ce,Pe),onTouchStart:Kf(Ne,pe)}]:[!1,Se,{}]}function Kf(E,D){return O=>{E&&E(O),O.defaultPrevented||D(O)}}function oy({page:E,...D}){let{router:O}=ug(),R=st.useMemo(()=>Jm(O.routes,E,O.basename),[O.routes,E,O.basename]);return R?st.createElement(cy,{page:E,matches:R,...D}):null}function ly(E){let{manifest:D,routeModules:O}=hg(),[R,H]=st.useState([]);return st.useEffect(()=>{let ae=!1;return W_(E,D,O).then(P=>{ae||H(P)}),()=>{ae=!0}},[E,D,O]),R}function cy({page:E,matches:D,...O}){let R=Oh(),{manifest:H,routeModules:ae}=hg(),{basename:P}=ug(),{loaderData:d,matches:ge}=ry(),re=st.useMemo(()=>$m(E,D,ge,H,R,"data"),[E,D,ge,H,R]),Ce=st.useMemo(()=>$m(E,D,ge,H,R,"assets"),[E,D,ge,H,R]),Ne=st.useMemo(()=>{if(E===R.pathname+R.search+R.hash)return[];let Pe=new Set,ht=!1;if(D.forEach(pt=>{var Pt;let St=H.routes[pt.route.id];!St||!St.hasLoader||(!re.some(qt=>qt.route.id===pt.route.id)&&pt.route.id in d&&((Pt=ae[pt.route.id])!=null&&Pt.shouldRevalidate)||St.hasClientLoader?ht=!0:Pe.add(pt.route.id))}),Pe.size===0)return[];let Tt=ay(E,P);return ht&&Pe.size>0&&Tt.searchParams.set("_routes",D.filter(pt=>Pe.has(pt.route.id)).map(pt=>pt.route.id).join(",")),[Tt.pathname+Tt.search]},[P,d,R,H,re,D,E,ae]),Se=st.useMemo(()=>J_(Ce,H),[Ce,H]),pe=ly(Ce);return st.createElement(st.Fragment,null,Ne.map(Pe=>st.createElement("link",{key:Pe,rel:"prefetch",as:"fetch",href:Pe,...O})),Se.map(Pe=>st.createElement("link",{key:Pe,rel:"modulepreload",href:Pe,...O})),pe.map(({key:Pe,link:ht})=>st.createElement("link",{key:Pe,...ht})))}function uy(...E){return D=>{E.forEach(O=>{typeof O=="function"?O(D):O!=null&&(O.current=D)})}}var dg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dg&&(window.__reactRouterVersion="7.6.2")}catch{}function hy({basename:E,children:D,window:O}){let R=st.useRef();R.current==null&&(R.current=Qg({window:O,v5Compat:!0}));let H=R.current,[ae,P]=st.useState({action:H.action,location:H.location}),d=st.useCallback(ge=>{st.startTransition(()=>P(ge))},[P]);return st.useLayoutEffect(()=>H.listen(d),[H,d]),st.createElement(N_,{basename:E,children:D,location:ae.location,navigationType:ae.action,navigator:H})}var fg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pg=st.forwardRef(function({onClick:D,discover:O="render",prefetch:R="none",relative:H,reloadDocument:ae,replace:P,state:d,target:ge,to:re,preventScrollReset:Ce,viewTransition:Ne,...Se},pe){let{basename:Pe}=st.useContext(nc),ht=typeof re=="string"&&fg.test(re),Tt,pt=!1;if(typeof re=="string"&&ht&&(Tt=re,dg))try{let li=new URL(window.location.href),ni=re.startsWith("//")?new URL(li.protocol+re):new URL(re),Bt=Hc(ni.pathname,Pe);ni.origin===li.origin&&Bt!=null?re=Bt+ni.search+ni.hash:pt=!0}catch{ic(!1,`<Link to="${re}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let St=S_(re,{relative:H}),[Pt,qt,bt]=sy(R,Se),Zt=my(re,{replace:P,state:d,target:ge,preventScrollReset:Ce,relative:H,viewTransition:Ne});function di(li){D&&D(li),li.defaultPrevented||Zt(li)}let Xt=st.createElement("a",{...Se,...bt,href:Tt||St,onClick:pt||ae?D:di,ref:uy(pe,qt),target:ge,"data-discover":!ht&&O==="render"?"true":void 0});return Pt&&!ht?st.createElement(st.Fragment,null,Xt,st.createElement(oy,{page:St})):Xt});pg.displayName="Link";var dy=st.forwardRef(function({"aria-current":D="page",caseSensitive:O=!1,className:R="",end:H=!1,style:ae,to:P,viewTransition:d,children:ge,...re},Ce){let Ne=ip(P,{relative:re.relative}),Se=Oh(),pe=st.useContext(Zp),{navigator:Pe,basename:ht}=st.useContext(nc),Tt=pe!=null&&xy(Ne)&&d===!0,pt=Pe.encodeLocation?Pe.encodeLocation(Ne).pathname:Ne.pathname,St=Se.pathname,Pt=pe&&pe.navigation&&pe.navigation.location?pe.navigation.location.pathname:null;O||(St=St.toLowerCase(),Pt=Pt?Pt.toLowerCase():null,pt=pt.toLowerCase()),Pt&&ht&&(Pt=Hc(Pt,ht)||Pt);const qt=pt!=="/"&&pt.endsWith("/")?pt.length-1:pt.length;let bt=St===pt||!H&&St.startsWith(pt)&&St.charAt(qt)==="/",Zt=Pt!=null&&(Pt===pt||!H&&Pt.startsWith(pt)&&Pt.charAt(pt.length)==="/"),di={isActive:bt,isPending:Zt,isTransitioning:Tt},Xt=bt?D:void 0,li;typeof R=="function"?li=R(di):li=[R,bt?"active":null,Zt?"pending":null,Tt?"transitioning":null].filter(Boolean).join(" ");let ni=typeof ae=="function"?ae(di):ae;return st.createElement(pg,{...re,"aria-current":Xt,className:li,ref:Ce,style:ni,to:P,viewTransition:d},typeof ge=="function"?ge(di):ge)});dy.displayName="NavLink";var fy=st.forwardRef(({discover:E="render",fetcherKey:D,navigate:O,reloadDocument:R,replace:H,state:ae,method:P=Fp,action:d,onSubmit:ge,relative:re,preventScrollReset:Ce,viewTransition:Ne,...Se},pe)=>{let Pe=yy(),ht=vy(d,{relative:re}),Tt=P.toLowerCase()==="get"?"get":"post",pt=typeof d=="string"&&fg.test(d),St=Pt=>{if(ge&&ge(Pt),Pt.defaultPrevented)return;Pt.preventDefault();let qt=Pt.nativeEvent.submitter,bt=(qt==null?void 0:qt.getAttribute("formmethod"))||P;Pe(qt||Pt.currentTarget,{fetcherKey:D,method:bt,navigate:O,replace:H,state:ae,relative:re,preventScrollReset:Ce,viewTransition:Ne})};return st.createElement("form",{ref:pe,method:Tt,action:ht,onSubmit:R?ge:St,...Se,"data-discover":!pt&&E==="render"?"true":void 0})});fy.displayName="Form";function py(E){return`${E} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function mg(E){let D=st.useContext(Kd);return Hn(D,py(E)),D}function my(E,{target:D,replace:O,state:R,preventScrollReset:H,relative:ae,viewTransition:P}={}){let d=M_(),ge=Oh(),re=ip(E,{relative:ae});return st.useCallback(Ce=>{if(H_(Ce,D)){Ce.preventDefault();let Ne=O!==void 0?O:Jf(ge)===Jf(re);d(E,{replace:Ne,state:R,preventScrollReset:H,relative:ae,viewTransition:P})}},[ge,d,re,O,R,D,E,H,ae,P])}var gy=0,_y=()=>`__${String(++gy)}__`;function yy(){let{router:E}=mg("useSubmit"),{basename:D}=st.useContext(nc),O=B_();return st.useCallback(async(R,H={})=>{let{action:ae,method:P,encType:d,formData:ge,body:re}=Y_(R,D);if(H.navigate===!1){let Ce=H.fetcherKey||_y();await E.fetch(Ce,O,H.action||ae,{preventScrollReset:H.preventScrollReset,formData:ge,body:re,formMethod:H.method||P,formEncType:H.encType||d,flushSync:H.flushSync})}else await E.navigate(H.action||ae,{preventScrollReset:H.preventScrollReset,formData:ge,body:re,formMethod:H.method||P,formEncType:H.encType||d,replace:H.replace,state:H.state,fromRouteId:O,flushSync:H.flushSync,viewTransition:H.viewTransition})},[E,D,O])}function vy(E,{relative:D}={}){let{basename:O}=st.useContext(nc),R=st.useContext($c);Hn(R,"useFormAction must be used inside a RouteContext");let[H]=R.matches.slice(-1),ae={...ip(E||".",{relative:D})},P=Oh();if(E==null){ae.search=P.search;let d=new URLSearchParams(ae.search),ge=d.getAll("index");if(ge.some(Ce=>Ce==="")){d.delete("index"),ge.filter(Ne=>Ne).forEach(Ne=>d.append("index",Ne));let Ce=d.toString();ae.search=Ce?`?${Ce}`:""}}return(!E||E===".")&&H.route.index&&(ae.search=ae.search?ae.search.replace(/^\?/,"?index&"):"?index"),O!=="/"&&(ae.pathname=ae.pathname==="/"?O:qc([O,ae.pathname])),Jf(ae)}function xy(E,D={}){let O=st.useContext(rg);Hn(O!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:R}=mg("useViewTransitionState"),H=ip(E,{relative:D.relative});if(!O.isTransitioning)return!1;let ae=Hc(O.currentLocation.pathname,R)||O.currentLocation.pathname,P=Hc(O.nextLocation.pathname,R)||O.nextLocation.pathname;return Vp(H.pathname,P)!=null||Vp(H.pathname,ae)!=null}[...ny];const by=[{absorbency:2,appearance:2,date:"2025-06-14",description:"Upon my most recent visit to see the Durham Bulls baseball game I had the chance to use and examine the standard concession stand napkin. Lets talk about it that for a brief moment. It was not great. In fact the only interesting thing about it was the texture, it seemed to have a beaded feel to it that may lead the user to believe that it could wipe away mustard and ketchup. Dont be fooled, it would remove some goop from your hands but likely leave a layer behind you can smell long after the game is over. It was, however, better than nothing. So theres that. The best part of the experience was that they won! Two home runs and a final score of Durham 3 and Charlotte 1.",durability:2,effectiveness:1,imageUrl:"https://cdn.sanity.io/images/c1ywbxqh/production/cdafa3af783a2a7c4cbe12d166b59ef7dbc250d1-4284x5712.jpg",location:"https://www.google.com/maps/place/Durham+Bulls+Athletic+Park,+409+Blackwell+St,+Durham,+NC+27701/@35.991542,-78.9049079,17z/data=!4m6!3m5!1s0x89ace46c9b224cef:0xe914be78d7e7e3d!8m2!3d35.991542!4d-78.9049079!16zL20vMDV2OG15?g_ep=Eg1tbF8yMDI1MDYxMV8wIJvbDyoASAJQAg%3D%3D",name:"Durham Bulls Athletic Park",notes:null,ratingId:"e7tn4",size:1,texture:3},{absorbency:4,appearance:3,date:"2025-04-04",description:"These napkins were high quality but hard to get ahold of!",durability:5,effectiveness:3,imageUrl:"https://cdn.sanity.io/images/c1ywbxqh/production/b0d99368bf3fde9f61ace0c026ff0c5cfc6c375c-607x505.webp",location:"https://www.google.com/maps/place/Paragon+Theaters+-+Fenton+%2B+Axis15+Extreme/@35.7815984,-78.7698752,15z/data=!4m6!3m5!1s0x89acf3f9a1cbf7cf:0xd9003b799d2228ef!8m2!3d35.7815981!4d-78.759576!16s%2Fg%2F11qbcr7w3t!5m1!1e2?entry=ttu&g_ep=EgoyMDI1MDYxMS4wIKXMDSoASAFQAw%3D%3D",name:"Paragon Theater Cary",notes:"Additional notes?",ratingId:"xj1x4",size:5,texture:4}];var Np={exports:{}},wy=Np.exports,Xm;function Ty(){return Xm||(Xm=1,function(E,D){(function(O,R){E.exports=R()})(wy,function(){var O=1e3,R=6e4,H=36e5,ae="millisecond",P="second",d="minute",ge="hour",re="day",Ce="week",Ne="month",Se="quarter",pe="year",Pe="date",ht="Invalid Date",Tt=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,pt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,St={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ct){var mt=["th","st","nd","rd"],be=Ct%100;return"["+Ct+(mt[(be-20)%10]||mt[be]||mt[0])+"]"}},Pt=function(Ct,mt,be){var Ke=String(Ct);return!Ke||Ke.length>=mt?Ct:""+Array(mt+1-Ke.length).join(be)+Ct},qt={s:Pt,z:function(Ct){var mt=-Ct.utcOffset(),be=Math.abs(mt),Ke=Math.floor(be/60),Ge=be%60;return(mt<=0?"+":"-")+Pt(Ke,2,"0")+":"+Pt(Ge,2,"0")},m:function Ct(mt,be){if(mt.date()<be.date())return-Ct(be,mt);var Ke=12*(be.year()-mt.year())+(be.month()-mt.month()),Ge=mt.clone().add(Ke,Ne),_t=be-Ge<0,le=mt.clone().add(Ke+(_t?-1:1),Ne);return+(-(Ke+(be-Ge)/(_t?Ge-le:le-Ge))||0)},a:function(Ct){return Ct<0?Math.ceil(Ct)||0:Math.floor(Ct)},p:function(Ct){return{M:Ne,y:pe,w:Ce,d:re,D:Pe,h:ge,m:d,s:P,ms:ae,Q:Se}[Ct]||String(Ct||"").toLowerCase().replace(/s$/,"")},u:function(Ct){return Ct===void 0}},bt="en",Zt={};Zt[bt]=St;var di="$isDayjsObject",Xt=function(Ct){return Ct instanceof wi||!(!Ct||!Ct[di])},li=function Ct(mt,be,Ke){var Ge;if(!mt)return bt;if(typeof mt=="string"){var _t=mt.toLowerCase();Zt[_t]&&(Ge=_t),be&&(Zt[_t]=be,Ge=_t);var le=mt.split("-");if(!Ge&&le.length>1)return Ct(le[0])}else{var Ye=mt.name;Zt[Ye]=mt,Ge=Ye}return!Ke&&Ge&&(bt=Ge),Ge||!Ke&&bt},ni=function(Ct,mt){if(Xt(Ct))return Ct.clone();var be=typeof mt=="object"?mt:{};return be.date=Ct,be.args=arguments,new wi(be)},Bt=qt;Bt.l=li,Bt.i=Xt,Bt.w=function(Ct,mt){return ni(Ct,{locale:mt.$L,utc:mt.$u,x:mt.$x,$offset:mt.$offset})};var wi=function(){function Ct(be){this.$L=li(be.locale,null,!0),this.parse(be),this.$x=this.$x||be.x||{},this[di]=!0}var mt=Ct.prototype;return mt.parse=function(be){this.$d=function(Ke){var Ge=Ke.date,_t=Ke.utc;if(Ge===null)return new Date(NaN);if(Bt.u(Ge))return new Date;if(Ge instanceof Date)return new Date(Ge);if(typeof Ge=="string"&&!/Z$/i.test(Ge)){var le=Ge.match(Tt);if(le){var Ye=le[2]-1||0,ot=(le[7]||"0").substring(0,3);return _t?new Date(Date.UTC(le[1],Ye,le[3]||1,le[4]||0,le[5]||0,le[6]||0,ot)):new Date(le[1],Ye,le[3]||1,le[4]||0,le[5]||0,le[6]||0,ot)}}return new Date(Ge)}(be),this.init()},mt.init=function(){var be=this.$d;this.$y=be.getFullYear(),this.$M=be.getMonth(),this.$D=be.getDate(),this.$W=be.getDay(),this.$H=be.getHours(),this.$m=be.getMinutes(),this.$s=be.getSeconds(),this.$ms=be.getMilliseconds()},mt.$utils=function(){return Bt},mt.isValid=function(){return this.$d.toString()!==ht},mt.isSame=function(be,Ke){var Ge=ni(be);return this.startOf(Ke)<=Ge&&Ge<=this.endOf(Ke)},mt.isAfter=function(be,Ke){return ni(be)<this.startOf(Ke)},mt.isBefore=function(be,Ke){return this.endOf(Ke)<ni(be)},mt.$g=function(be,Ke,Ge){return Bt.u(be)?this[Ke]:this.set(Ge,be)},mt.unix=function(){return Math.floor(this.valueOf()/1e3)},mt.valueOf=function(){return this.$d.getTime()},mt.startOf=function(be,Ke){var Ge=this,_t=!!Bt.u(Ke)||Ke,le=Bt.p(be),Ye=function(Ki,rn){var Ii=Bt.w(Ge.$u?Date.UTC(Ge.$y,rn,Ki):new Date(Ge.$y,rn,Ki),Ge);return _t?Ii:Ii.endOf(re)},ot=function(Ki,rn){return Bt.w(Ge.toDate()[Ki].apply(Ge.toDate("s"),(_t?[0,0,0,0]:[23,59,59,999]).slice(rn)),Ge)},ct=this.$W,xt=this.$M,At=this.$D,Rt="set"+(this.$u?"UTC":"");switch(le){case pe:return _t?Ye(1,0):Ye(31,11);case Ne:return _t?Ye(1,xt):Ye(0,xt+1);case Ce:var fi=this.$locale().weekStart||0,ci=(ct<fi?ct+7:ct)-fi;return Ye(_t?At-ci:At+(6-ci),xt);case re:case Pe:return ot(Rt+"Hours",0);case ge:return ot(Rt+"Minutes",1);case d:return ot(Rt+"Seconds",2);case P:return ot(Rt+"Milliseconds",3);default:return this.clone()}},mt.endOf=function(be){return this.startOf(be,!1)},mt.$set=function(be,Ke){var Ge,_t=Bt.p(be),le="set"+(this.$u?"UTC":""),Ye=(Ge={},Ge[re]=le+"Date",Ge[Pe]=le+"Date",Ge[Ne]=le+"Month",Ge[pe]=le+"FullYear",Ge[ge]=le+"Hours",Ge[d]=le+"Minutes",Ge[P]=le+"Seconds",Ge[ae]=le+"Milliseconds",Ge)[_t],ot=_t===re?this.$D+(Ke-this.$W):Ke;if(_t===Ne||_t===pe){var ct=this.clone().set(Pe,1);ct.$d[Ye](ot),ct.init(),this.$d=ct.set(Pe,Math.min(this.$D,ct.daysInMonth())).$d}else Ye&&this.$d[Ye](ot);return this.init(),this},mt.set=function(be,Ke){return this.clone().$set(be,Ke)},mt.get=function(be){return this[Bt.p(be)]()},mt.add=function(be,Ke){var Ge,_t=this;be=Number(be);var le=Bt.p(Ke),Ye=function(xt){var At=ni(_t);return Bt.w(At.date(At.date()+Math.round(xt*be)),_t)};if(le===Ne)return this.set(Ne,this.$M+be);if(le===pe)return this.set(pe,this.$y+be);if(le===re)return Ye(1);if(le===Ce)return Ye(7);var ot=(Ge={},Ge[d]=R,Ge[ge]=H,Ge[P]=O,Ge)[le]||1,ct=this.$d.getTime()+be*ot;return Bt.w(ct,this)},mt.subtract=function(be,Ke){return this.add(-1*be,Ke)},mt.format=function(be){var Ke=this,Ge=this.$locale();if(!this.isValid())return Ge.invalidDate||ht;var _t=be||"YYYY-MM-DDTHH:mm:ssZ",le=Bt.z(this),Ye=this.$H,ot=this.$m,ct=this.$M,xt=Ge.weekdays,At=Ge.months,Rt=Ge.meridiem,fi=function(rn,Ii,sn,Qi){return rn&&(rn[Ii]||rn(Ke,_t))||sn[Ii].slice(0,Qi)},ci=function(rn){return Bt.s(Ye%12||12,rn,"0")},Ki=Rt||function(rn,Ii,sn){var Qi=rn<12?"AM":"PM";return sn?Qi.toLowerCase():Qi};return _t.replace(pt,function(rn,Ii){return Ii||function(sn){switch(sn){case"YY":return String(Ke.$y).slice(-2);case"YYYY":return Bt.s(Ke.$y,4,"0");case"M":return ct+1;case"MM":return Bt.s(ct+1,2,"0");case"MMM":return fi(Ge.monthsShort,ct,At,3);case"MMMM":return fi(At,ct);case"D":return Ke.$D;case"DD":return Bt.s(Ke.$D,2,"0");case"d":return String(Ke.$W);case"dd":return fi(Ge.weekdaysMin,Ke.$W,xt,2);case"ddd":return fi(Ge.weekdaysShort,Ke.$W,xt,3);case"dddd":return xt[Ke.$W];case"H":return String(Ye);case"HH":return Bt.s(Ye,2,"0");case"h":return ci(1);case"hh":return ci(2);case"a":return Ki(Ye,ot,!0);case"A":return Ki(Ye,ot,!1);case"m":return String(ot);case"mm":return Bt.s(ot,2,"0");case"s":return String(Ke.$s);case"ss":return Bt.s(Ke.$s,2,"0");case"SSS":return Bt.s(Ke.$ms,3,"0");case"Z":return le}return null}(rn)||le.replace(":","")})},mt.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},mt.diff=function(be,Ke,Ge){var _t,le=this,Ye=Bt.p(Ke),ot=ni(be),ct=(ot.utcOffset()-this.utcOffset())*R,xt=this-ot,At=function(){return Bt.m(le,ot)};switch(Ye){case pe:_t=At()/12;break;case Ne:_t=At();break;case Se:_t=At()/3;break;case Ce:_t=(xt-ct)/6048e5;break;case re:_t=(xt-ct)/864e5;break;case ge:_t=xt/H;break;case d:_t=xt/R;break;case P:_t=xt/O;break;default:_t=xt}return Ge?_t:Bt.a(_t)},mt.daysInMonth=function(){return this.endOf(Ne).$D},mt.$locale=function(){return Zt[this.$L]},mt.locale=function(be,Ke){if(!be)return this.$L;var Ge=this.clone(),_t=li(be,Ke,!0);return _t&&(Ge.$L=_t),Ge},mt.clone=function(){return Bt.w(this.$d,this)},mt.toDate=function(){return new Date(this.valueOf())},mt.toJSON=function(){return this.isValid()?this.toISOString():null},mt.toISOString=function(){return this.$d.toISOString()},mt.toString=function(){return this.$d.toUTCString()},Ct}(),_n=wi.prototype;return ni.prototype=_n,[["$ms",ae],["$s",P],["$m",d],["$H",ge],["$W",re],["$M",Ne],["$y",pe],["$D",Pe]].forEach(function(Ct){_n[Ct[1]]=function(mt){return this.$g(mt,Ct[0],Ct[1])}}),ni.extend=function(Ct,mt){return Ct.$i||(Ct(mt,wi,ni),Ct.$i=!0),ni},ni.locale=li,ni.isDayjs=Xt,ni.unix=function(Ct){return ni(1e3*Ct)},ni.en=Zt[bt],ni.Ls=Zt,ni.p={},ni})}(Np)),Np.exports}var Sy=Ty();const My=Wm(Sy);function Ey({data:E}){const D=["durability","absorbency","texture","size","effectiveness","appearance"],O=({item:H})=>{let ae=0;return D.forEach(P=>{ae+=H[P]}),Yi.jsxs("p",{children:["(",(ae/D.length).toFixed(2),")",Array.from({length:5}).map((P,d)=>Yi.jsx("span",{children:d<Math.round(ae/D.length)?"":""},d))]})},R=({item:H})=>Yi.jsx("div",{children:D.map(ae=>Yi.jsxs("div",{className:"sublist",children:[Yi.jsxs("div",{children:[ae.charAt(0).toUpperCase()+ae.slice(1),": "]}),Yi.jsx("div",{children:Array.from({length:5}).map((P,d)=>Yi.jsx("span",{children:d<H[ae]?"":""},d))})]},ae))});return E.sort(function(H,ae){return new Date(ae.date)-new Date(H.date)}),Yi.jsxs(Yi.Fragment,{children:[Yi.jsx("h3",{children:"Latest"}),Yi.jsx("div",{className:"list",children:E.map((H,ae)=>Yi.jsxs("div",{className:"card",children:[Yi.jsx("p",{children:Yi.jsx("a",{href:H.location,children:H.name})}),Yi.jsx("p",{children:My(H.date).format("MMMM D, YYYY")}),Yi.jsx(O,{item:H}),Yi.jsx("hr",{}),Yi.jsx(R,{item:H}),Yi.jsx("p",{children:H.description}),Yi.jsx("img",{src:H.imageUrl})]},ae))})]})}var Up={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.5.0/LICENSE.txt
 */var Cy=Up.exports,Ym;function Ay(){return Ym||(Ym=1,function(E,D){(function(O,R){E.exports=R()})(Cy,function(){var O={},R={};function H(P,d,ge){if(R[P]=ge,P==="index"){var re="var sharedModule = {}; ("+R.shared+")(sharedModule); ("+R.worker+")(sharedModule);",Ce={};return R.shared(Ce),R.index(O,Ce),typeof window<"u"&&O.setWorkerUrl(window.URL.createObjectURL(new Blob([re],{type:"text/javascript"}))),O}}H("shared",["exports"],function(P){function d(r,t,a,o){return new(a||(a=Promise))(function(h,g){function _(M){try{w(o.next(M))}catch(A){g(A)}}function v(M){try{w(o.throw(M))}catch(A){g(A)}}function w(M){var A;M.done?h(M.value):(A=M.value,A instanceof a?A:new a(function(I){I(A)})).then(_,v)}w((o=o.apply(r,t||[])).next())})}function ge(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var re,Ce;function Ne(){if(Ce)return re;function r(t,a){this.x=t,this.y=a}return Ce=1,re=r,r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,a){return this.clone()._rotateAround(t,a)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var a=t.x-this.x,o=t.y-this.y;return a*a+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,a){return Math.atan2(this.x*a-this.y*t,this.x*t+this.y*a)},_matMult:function(t){var a=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=a,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var a=Math.cos(t),o=Math.sin(t),h=o*this.x+a*this.y;return this.x=a*this.x-o*this.y,this.y=h,this},_rotateAround:function(t,a){var o=Math.cos(t),h=Math.sin(t),g=a.y+h*(this.x-a.x)+o*(this.y-a.y);return this.x=a.x+o*(this.x-a.x)-h*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t},re}typeof SuppressedError=="function"&&SuppressedError;var Se,pe,Pe=ge(Ne()),ht=function(){if(pe)return Se;function r(t,a,o,h){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(h-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=o,this.p2y=h}return pe=1,Se=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,h=0;h<8;h++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<a)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var v=0,w=1;for(o=t,h=0;h<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<a));h++)t>g?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},Se}(),Tt=ge(ht);let pt,St;function Pt(){return pt==null&&(pt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),pt}function qt(){if(St==null&&(St=!1,Pt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let o=0;o<5*5;o++){const h=4*o;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(o%5,Math.floor(o/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let o=0;o<5*5*4;o++)if(o%4!=3&&a[o]!==o){St=!0;break}}}return St||!1}var bt=1e-6,Zt=typeof Float32Array<"u"?Float32Array:Array;function di(){var r=new Zt(9);return Zt!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Xt(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function li(){var r=new Zt(3);return Zt!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function ni(r){return Math.hypot(r[0],r[1],r[2])}function Bt(r,t,a){var o=new Zt(3);return o[0]=r,o[1]=t,o[2]=a,o}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var wi,_n=ni;function Ct(r,t,a){var o=t[0],h=t[1],g=t[2],_=t[3];return r[0]=a[0]*o+a[4]*h+a[8]*g+a[12]*_,r[1]=a[1]*o+a[5]*h+a[9]*g+a[13]*_,r[2]=a[2]*o+a[6]*h+a[10]*g+a[14]*_,r[3]=a[3]*o+a[7]*h+a[11]*g+a[15]*_,r}function mt(){var r=new Zt(4);return Zt!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function be(){var r=new Zt(2);return Zt!=Float32Array&&(r[0]=0,r[1]=0),r}function Ke(r,t){var a=new Zt(2);return a[0]=r,a[1]=t,a}li(),wi=new Zt(4),Zt!=Float32Array&&(wi[0]=0,wi[1]=0,wi[2]=0,wi[3]=0),li(),Bt(1,0,0),Bt(0,1,0),mt(),mt(),di(),be();const Ge=8192;function _t(r,t,a){return t*(Ge/(r.tileSize*Math.pow(2,a-r.tileID.overscaledZ)))}function le(r,t){return(r%t+t)%t}function Ye(r,t,a){return r*(1-a)+t*a}function ot(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,a=t*r;return 4*(r<.5?a:3*(r-t)+a-.75)}function ct(r,t,a,o){const h=new Tt(r,t,a,o);return g=>h.solve(g)}const xt=ct(.25,.1,.25,1);function At(r,t,a){return Math.min(a,Math.max(t,r))}function Rt(r,t,a){const o=a-t,h=((r-t)%o+o)%o+t;return h===t?a:h}function fi(r,...t){for(const a of t)for(const o in a)r[o]=a[o];return r}let ci=1;function Ki(r,t,a){const o={};for(const h in r)o[h]=t.call(this,r[h],h,r);return o}function rn(r,t,a){const o={};for(const h in r)t.call(this,r[h],h,r)&&(o[h]=r[h]);return o}function Ii(r){return Array.isArray(r)?r.map(Ii):typeof r=="object"&&r?Ki(r,Ii):r}const sn={};function Qi(r){sn[r]||(typeof console<"u"&&console.warn(r),sn[r]=!0)}function zi(r,t,a){return(a.y-r.y)*(t.x-r.x)>(t.y-r.y)*(a.x-r.x)}function kr(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Os=null;function An(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const rc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function cl(r,t,a,o,h){return d(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(r,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const v=_.startsWith("BGR"),w=new Uint8ClampedArray(o*h*4);if(yield g.copyTo(w,function(M,A,I,F,N){const V=4*Math.max(1,0),q=(Math.max(0,I)-I)*F*4+V,Q=4*F,ne=Math.max(0,A),ye=Math.max(0,I);return{rect:{x:ne,y:ye,width:Math.min(M.width,A+F)-ne,height:Math.min(M.height,I+N)-ye},layout:[{offset:q,stride:Q}]}}(r,t,a,o,h)),v)for(let M=0;M<w.length;M+=4){const A=w[M];w[M]=w[M+2],w[M+2]=A}return w}finally{g.close()}})}let Da,Va;function mo(r,t,a,o){return r.addEventListener(t,a,o),{unsubscribe:()=>{r.removeEventListener(t,a,o)}}}function Fs(r){return r*Math.PI/180}function ss(r){return r/Math.PI*180}const ul={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Lr={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},$n="AbortError";function oa(){return new Error($n)}const zn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function js(r){return zn.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const hl="global-dispatcher";class sr extends Error{constructor(t,a,o,h){super(`AJAXError: ${a} (${t}): ${o}`),this.status=t,this.statusText=a,this.url=o,this.body=h}}const ta=()=>kr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Za=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const o=js(r.url);if(o)return o(r,t);if(kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:hl},t)}if(!(/^file:/.test(a=r.url)||/^file:/.test(ta())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(o,h){return d(this,void 0,void 0,function*(){const g=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:ta(),signal:h.signal});let _,v;o.type!=="json"||g.headers.has("Accept")||g.headers.set("Accept","application/json");try{_=yield fetch(g)}catch(M){throw new sr(0,M.message,o.url,new Blob)}if(!_.ok){const M=yield _.blob();throw new sr(_.status,_.statusText,o.url,M)}v=o.type==="arrayBuffer"||o.type==="image"?_.arrayBuffer():o.type==="json"?_.json():_.text();const w=yield v;if(h.signal.aborted)throw oa();return{data:w,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(r,t);if(kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:hl},t)}var a;return function(o,h){return new Promise((g,_)=>{var v;const w=new XMLHttpRequest;w.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(w.responseType="arraybuffer");for(const M in o.headers)w.setRequestHeader(M,o.headers[M]);o.type==="json"&&(w.responseType="text",!((v=o.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=o.credentials==="include",w.onerror=()=>{_(new Error(w.statusText))},w.onload=()=>{if(!h.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let M=w.response;if(o.type==="json")try{M=JSON.parse(w.response)}catch(A){return void _(A)}g({data:M,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const M=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});_(new sr(w.status,w.statusText,o.url,M))}},h.signal.addEventListener("abort",()=>{w.abort(),_(oa())}),w.send(o.body)})}(r,t)};function Me(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function $(r,t,a){a[r]&&a[r].indexOf(t)!==-1||(a[r]=a[r]||[],a[r].push(t))}function X(r,t,a){if(a&&a[r]){const o=a[r].indexOf(t);o!==-1&&a[r].splice(o,1)}}class J{constructor(t,a={}){fi(this,a),this.type=t}}class ce extends J{constructor(t,a={}){super("error",fi({error:t},a))}}class ve{on(t,a){return this._listeners=this._listeners||{},$(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return X(t,a,this._listeners),X(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},$(t,a,this._oneTimeListeners),this):new Promise(o=>this.once(t,o))}fire(t,a){typeof t=="string"&&(t=new J(t,a||{}));const o=t.type;if(this.listens(o)){t.target=this;const h=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const v of h)v.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const v of g)X(o,v,this._oneTimeListeners),v.call(this,t);const _=this._eventedParent;_&&(fi(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof ce&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var W={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const De=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function we(r,t){const a={};for(const o in r)o!=="ref"&&(a[o]=r[o]);return De.forEach(o=>{o in t&&(a[o]=t[o])}),a}function ze(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let a=0;a<r.length;a++)if(!ze(r[a],t[a]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const a in r)if(!ze(r[a],t[a]))return!1;return!0}return r===t}function Be(r,t){r.push(t)}function Ee(r,t,a){Be(a,{command:"addSource",args:[r,t[r]]})}function We(r,t,a){Be(t,{command:"removeSource",args:[r]}),a[r]=!0}function ft(r,t,a,o){We(r,a,o),Ee(r,t,a)}function yt(r,t,a){let o;for(o in r[a])if(Object.prototype.hasOwnProperty.call(r[a],o)&&o!=="data"&&!ze(r[a][o],t[a][o]))return!1;for(o in t[a])if(Object.prototype.hasOwnProperty.call(t[a],o)&&o!=="data"&&!ze(r[a][o],t[a][o]))return!1;return!0}function zt(r,t,a,o,h,g){r=r||{},t=t||{};for(const _ in r)Object.prototype.hasOwnProperty.call(r,_)&&(ze(r[_],t[_])||a.push({command:g,args:[o,_,t[_],h]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(r,_)&&(ze(r[_],t[_])||a.push({command:g,args:[o,_,t[_],h]}))}function Ot(r){return r.id}function Dt(r,t){return r[t.id]=t,r}class Ve{constructor(t,a,o,h){this.message=(t?`${t}: `:"")+o,h&&(this.identifier=h),a!=null&&a.__line__&&(this.line=a.__line__)}}function yi(r,...t){for(const a of t)for(const o in a)r[o]=a[o];return r}class ui extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class vi{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[o,h]of a)this.bindings[o]=h}concat(t){return new vi(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Vt={kind:"null"},Qe={kind:"number"},Nt={kind:"string"},Ht={kind:"boolean"},Ri={kind:"color"},ji={kind:"projectionDefinition"},jn={kind:"object"},Ft={kind:"value"},go={kind:"collator"},dl={kind:"formatted"},Ga={kind:"padding"},Br={kind:"colorArray"},os={kind:"numberArray"},Ns={kind:"resolvedImage"},yn={kind:"variableAnchorOffsetCollection"};function qa(r,t){return{kind:"array",itemType:r,N:t}}function ki(r){if(r.kind==="array"){const t=ki(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Us=[Vt,Qe,Nt,Ht,Ri,ji,dl,jn,qa(Ft),Ga,os,Br,Ns,yn];function Ia(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ia(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const a of Us)if(!Ia(a,t))return null}}return`Expected ${ki(r)} but found ${ki(t)} instead.`}function sc(r,t){return t.some(a=>a.kind===r.kind)}function Vs(r,t){return t.some(a=>a==="null"?r===null:a==="array"?Array.isArray(r):a==="object"?r&&!Array.isArray(r)&&typeof r=="object":a===typeof r)}function Ra(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const Xc=.96422,oc=.82521,Fh=4/29,_o=6/29,Ha=3*_o*_o,jh=_o*_o*_o,Qd=Math.PI/180,Yc=180/Math.PI;function Xu(r){return(r%=360)<0&&(r+=360),r}function fl([r,t,a,o]){let h,g;const _=ka((.2225045*(r=yo(r))+.7168786*(t=yo(t))+.0606169*(a=yo(a)))/1);r===t&&t===a?h=g=_:(h=ka((.4360747*r+.3850649*t+.1430804*a)/Xc),g=ka((.0139322*r+.0971045*t+.7141733*a)/oc));const v=116*_-16;return[v<0?0:v,500*(h-_),200*(_-g),o]}function yo(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function ka(r){return r>jh?Math.pow(r,1/3):r/Ha+Fh}function Kc([r,t,a,o]){let h=(r+16)/116,g=isNaN(t)?h:h+t/500,_=isNaN(a)?h:h-a/200;return h=1*lc(h),g=Xc*lc(g),_=oc*lc(_),[Zs(3.1338561*g-1.6168667*h-.4906146*_),Zs(-.9787684*g+1.9161415*h+.033454*_),Zs(.0719453*g-.2289914*h+1.4052427*_),o]}function Zs(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function lc(r){return r>_o?r*r*r:Ha*(r-Fh)}const pl=Object.hasOwn||function(r,t){return Object.prototype.hasOwnProperty.call(r,t)};function ml(r,t){return pl(r,t)?r[t]:void 0}function gl(r){return parseInt(r.padEnd(2,r),16)/255}function Gs(r,t){return ba(t?r/100:r,0,1)}function ba(r,t,a){return Math.min(Math.max(t,r),a)}function pi(r){return!r.some(Number.isNaN)}const vo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ia(r,t,a){return r+a*(t-r)}function xo(r,t,a){return r.map((o,h)=>ia(o,t[h],a))}class hi{constructor(t,a,o,h=1,g=!0){this.r=t,this.g=a,this.b=o,this.a=h,g||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,a,o,h]))}static parse(t){if(t instanceof hi)return t;if(typeof t!="string")return;const a=function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=ml(vo,o);if(h){const[_,v,w]=h;return[_/255,v/255,w/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const _=o.length<6?1:2;let v=1;return[gl(o.slice(v,v+=_)),gl(o.slice(v,v+=_)),gl(o.slice(v,v+=_)),gl(o.slice(v,v+_)||"ff")]}if(o.startsWith("rgb")){const _=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,w,M,A,I,F,N,V,q,Q,ne,ye]=_,se=[A||" ",N||" ",Q].join("");if(se==="  "||se==="  /"||se===",,"||se===",,,"){const j=[M,F,q].join(""),K=j==="%%%"?100:j===""?255:0;if(K){const ue=[ba(+w/K,0,1),ba(+I/K,0,1),ba(+V/K,0,1),ne?Gs(+ne,ye):1];if(pi(ue))return ue}}return}}const g=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,v,w,M,A,I,F,N,V]=g,q=[w||" ",A||" ",F].join("");if(q==="  "||q==="  /"||q===",,"||q===",,,"){const Q=[+v,ba(+M,0,100),ba(+I,0,100),N?Gs(+N,V):1];if(pi(Q))return function([ne,ye,se,j]){function K(ue){const Re=(ue+ne/30)%12,tt=ye*Math.min(se,1-se);return se-tt*Math.max(-1,Math.min(Re-3,9-Re,1))}return ne=Xu(ne),ye/=100,se/=100,[K(0),K(8),K(4),j]}(Q)}}}(t);return a?new hi(...a,!1):void 0}get rgb(){const{r:t,g:a,b:o,a:h}=this,g=h||1/0;return this.overwriteGetter("rgb",[t/g,a/g,o/g,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,o,h,g]=fl(t),_=Math.sqrt(o*o+h*h);return[Math.round(1e4*_)?Xu(Math.atan2(h,o)*Yc):NaN,_,a,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",fl(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,o,h]=this.rgb;return`rgba(${[t,a,o].map(g=>Math.round(255*g)).join(",")},${h})`}static interpolate(t,a,o,h="rgb"){switch(h){case"rgb":{const[g,_,v,w]=xo(t.rgb,a.rgb,o);return new hi(g,_,v,w,!1)}case"hcl":{const[g,_,v,w]=t.hcl,[M,A,I,F]=a.hcl;let N,V;if(isNaN(g)||isNaN(M))isNaN(g)?isNaN(M)?N=NaN:(N=M,v!==1&&v!==0||(V=A)):(N=g,I!==1&&I!==0||(V=_));else{let se=M-g;M>g&&se>180?se-=360:M<g&&g-M>180&&(se+=360),N=g+o*se}const[q,Q,ne,ye]=function([se,j,K,ue]){return se=isNaN(se)?0:se*Qd,Kc([K,Math.cos(se)*j,Math.sin(se)*j,ue])}([N,V??ia(_,A,o),ia(v,I,o),ia(w,F,o)]);return new hi(q,Q,ne,ye,!1)}case"lab":{const[g,_,v,w]=Kc(xo(t.lab,a.lab,o));return new hi(g,_,v,w,!1)}}}}hi.black=new hi(0,0,0,1),hi.white=new hi(1,1,1,1),hi.transparent=new hi(0,0,0,0),hi.red=new hi(1,0,0,1);class qs{constructor(t,a,o){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const bo=["bottom","center","top"];class Hs{constructor(t,a,o,h,g,_){this.text=t,this.image=a,this.scale=o,this.fontStack=h,this.textColor=g,this.verticalAlign=_}}class Nn{constructor(t){this.sections=t}static fromString(t){return new Nn([new Hs(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Nn?t:Nn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class vn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof vn)return t;if(typeof t=="number")return new vn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new vn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o){return new vn(xo(t.values,a.values,o))}}class xn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof xn)return t;if(typeof t=="number")return new xn([t]);if(Array.isArray(t)){for(const a of t)if(typeof a!="number")return;return new xn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o){return new xn(xo(t.values,a.values,o))}}class Un{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Un)return t;if(typeof t=="string"){const o=hi.parse(t);return o?new Un([o]):void 0}if(!Array.isArray(t))return;const a=[];for(const o of t){if(typeof o!="string")return;const h=hi.parse(o);if(!h)return;a.push(h)}return new Un(a)}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o,h="rgb"){const g=[];if(t.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let _=0;_<t.values.length;_++)g.push(hi.interpolate(t.values[_],a.values[_],o,h));return new Un(g)}}class Ni extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Or=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class dn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof dn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const o=t[a],h=t[a+1];if(typeof o!="string"||!Or.has(o)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new dn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,o){const h=t.values,g=a.values;if(h.length!==g.length)throw new Ni(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const _=[];for(let v=0;v<h.length;v+=2){if(h[v]!==g[v])throw new Ni(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${g[v]}`);_.push(h[v]);const[w,M]=h[v+1],[A,I]=g[v+1];_.push([ia(w,A,o),ia(M,I,o)])}return new dn(_)}}class wa{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new wa({name:t,available:!1}):null}}class Xn{constructor(t,a,o){this.from=t,this.to=a,this.transition=o}static interpolate(t,a,o){return new Xn(t,a,o)}static parse(t){return t instanceof Xn?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Xn(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Xn(t.from,t.to,t.transition):typeof t=="string"?new Xn(t,t,1):void 0}}function or(r,t,a,o){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[r,t,a,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[r,t,a,o]:[r,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Mi(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Xn||r instanceof hi||r instanceof qs||r instanceof Nn||r instanceof vn||r instanceof xn||r instanceof Un||r instanceof dn||r instanceof wa)return!0;if(Array.isArray(r)){for(const t of r)if(!Mi(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Mi(r[t]))return!1;return!0}return!1}function qi(r){if(r===null)return Vt;if(typeof r=="string")return Nt;if(typeof r=="boolean")return Ht;if(typeof r=="number")return Qe;if(r instanceof hi)return Ri;if(r instanceof Xn)return ji;if(r instanceof qs)return go;if(r instanceof Nn)return dl;if(r instanceof vn)return Ga;if(r instanceof xn)return os;if(r instanceof Un)return Br;if(r instanceof dn)return yn;if(r instanceof wa)return Ns;if(Array.isArray(r)){const t=r.length;let a;for(const o of r){const h=qi(o);if(a){if(a===h)continue;a=Ft;break}a=h}return qa(a||Ft,t)}return jn}function ri(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof hi||r instanceof Xn||r instanceof Nn||r instanceof vn||r instanceof xn||r instanceof Un||r instanceof dn||r instanceof wa?r.toString():JSON.stringify(r)}class $t{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Mi(t[1]))return a.error("invalid value");const o=t[1];let h=qi(o);const g=a.expectedType;return h.kind!=="array"||h.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(h=g),new $t(h,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ls={string:Nt,number:Qe,boolean:Ht,object:jn};class Jt{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let o,h=1;const g=t[0];if(g==="array"){let v,w;if(t.length>2){const M=t[1];if(typeof M!="string"||!(M in ls)||M==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);v=ls[M],h++}else v=Ft;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);w=t[2],h++}o=qa(v,w)}else{if(!ls[g])throw new Error(`Types doesn't contain name = ${g}`);o=ls[g]}const _=[];for(;h<t.length;h++){const v=a.parse(t[h],h,Ft);if(!v)return null;_.push(v)}return new Jt(o,_)}evaluate(t){for(let a=0;a<this.args.length;a++){const o=this.args[a].evaluate(t);if(!Ia(this.type,qi(o)))return o;if(a===this.args.length-1)throw new Ni(`Expected value to be of type ${ki(this.type)}, but found ${ki(qi(o))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const na={"to-boolean":Ht,"to-color":Ri,"to-number":Qe,"to-string":Nt};class bn{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const o=t[0];if(!na[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return a.error("Expected one argument.");const h=na[o],g=[];for(let _=1;_<t.length;_++){const v=a.parse(t[_],_,Ft);if(!v)return null;g.push(v)}return new bn(h,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,o;for(const h of this.args){if(a=h.evaluate(t),o=null,a instanceof hi)return a;if(typeof a=="string"){const g=t.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(o=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:or(a[0],a[1],a[2],a[3]),!o))return new hi(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Ni(o||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const o of this.args){a=o.evaluate(t);const h=vn.parse(a);if(h)return h}throw new Ni(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const o of this.args){a=o.evaluate(t);const h=xn.parse(a);if(h)return h}throw new Ni(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const o of this.args){a=o.evaluate(t);const h=Un.parse(a);if(h)return h}throw new Ni(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const o of this.args){a=o.evaluate(t);const h=dn.parse(a);if(h)return h}throw new Ni(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const o of this.args){if(a=o.evaluate(t),a===null)return 0;const h=Number(a);if(!isNaN(h))return h}throw new Ni(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Nn.fromString(ri(this.args[0].evaluate(t)));case"resolvedImage":return wa.fromString(ri(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ri(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const _l=["Unknown","Point","LineString","Polygon"];class wo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_l[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache.get(t);return a||(a=hi.parse(t),this._parseColorCache.set(t,a)),a}}class cc{constructor(t,a,o=[],h,g=new vi,_=[]){this.registry=t,this.path=o,this.key=o.map(v=>`[${v}]`).join(""),this.scope=g,this.errors=_,this.expectedType=h,this._isConstant=a}parse(t,a,o,h,g={}){return a?this.concat(a,o,h)._parse(t,g):this._parse(t,g)}_parse(t,a){function o(h,g,_){return _==="assert"?new Jt(g,[h]):_==="coerce"?new bn(g,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[h];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const v=this.expectedType,w=_.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(w.kind)||v.kind==="colorArray"&&["value","string","array"].includes(w.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))_=o(_,v,a.typeAnnotation||"coerce");else if(this.checkSubtype(v,w))return null}else _=o(_,v,a.typeAnnotation||"assert")}if(!(_ instanceof $t)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const v=new wo;try{_=new $t(_.type,_.evaluate(v))}catch(w){return this.error(w.message),null}}return _}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,o){const h=typeof t=="number"?this.path.concat(t):this.path,g=o?this.scope.concat(o):this.scope;return new cc(this.registry,this._isConstant,h,a||null,g,this.errors)}error(t,...a){const o=`${this.key}${a.map(h=>`[${h}]`).join("")}`;this.errors.push(new ui(o,t))}checkSubtype(t,a){const o=Ia(t,a);return o&&this.error(o),o}}class $s{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return a.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);const v=a.parse(t[g+1],g+1);if(!v)return null;o.push([_,v])}const h=a.parse(t[t.length-1],t.length-1,a.expectedType,o);return h?new $s(o,h):null}outputDefined(){return this.result.outputDefined()}}class To{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const o=t[1];return a.scope.has(o)?new To(o,a.scope.get(o)):a.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class So{constructor(t,a,o){this.type=t,this.index=a,this.input=o}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Qe),h=a.parse(t[2],2,qa(a.expectedType||Ft));return o&&h?new So(h.type.itemType,o,h):null}evaluate(t){const a=this.index.evaluate(t),o=this.input.evaluate(t);if(a<0)throw new Ni(`Array index out of bounds: ${a} < 0.`);if(a>=o.length)throw new Ni(`Array index out of bounds: ${a} > ${o.length-1}.`);if(a!==Math.floor(a))throw new Ni(`Array index must be an integer, but found ${a} instead.`);return o[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Mo{constructor(t,a){this.type=Ht,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Ft),h=a.parse(t[2],2,Ft);return o&&h?sc(o.type,[Ht,Nt,Qe,Vt,Ft])?new Mo(o,h):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${ki(o.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!Vs(a,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${ki(qi(a))} instead.`);if(!Vs(o,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${ki(qi(o))} instead.`);return o.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class yl{constructor(t,a,o){this.type=Qe,this.needle=t,this.haystack=a,this.fromIndex=o}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Ft),h=a.parse(t[2],2,Ft);if(!o||!h)return null;if(!sc(o.type,[Ht,Nt,Qe,Vt,Ft]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${ki(o.type)} instead`);if(t.length===4){const g=a.parse(t[3],3,Qe);return g?new yl(o,h,g):null}return new yl(o,h)}evaluate(t){const a=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!Vs(a,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${ki(qi(a))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),Vs(o,["string"])){const g=o.indexOf(a,h);return g===-1?-1:[...o.slice(0,g)].length}if(Vs(o,["array"]))return o.indexOf(a,h);throw new Ni(`Expected second argument to be of type array or string, but found ${ki(qi(o))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Eo{constructor(t,a,o,h,g,_){this.inputType=t,this.type=a,this.input=o,this.cases=h,this.outputs=g,this.otherwise=_}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let o,h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const g={},_=[];for(let M=2;M<t.length-1;M+=2){let A=t[M];const I=t[M+1];Array.isArray(A)||(A=[A]);const F=a.concat(M);if(A.length===0)return F.error("Expected at least one branch label.");for(const V of A){if(typeof V!="number"&&typeof V!="string")return F.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return F.error("Numeric branch labels must be integer values.");if(o){if(F.checkSubtype(o,qi(V)))return null}else o=qi(V);if(g[String(V)]!==void 0)return F.error("Branch labels must be unique.");g[String(V)]=_.length}const N=a.parse(I,M,h);if(!N)return null;h=h||N.type,_.push(N)}const v=a.parse(t[1],1,Ft);if(!v)return null;const w=a.parse(t[t.length-1],t.length-1,h);return w?v.type.kind!=="value"&&a.concat(1).checkSubtype(o,v.type)?null:new Eo(o,h,v,g,_,w):null}evaluate(t){const a=this.input.evaluate(t);return(qi(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Yn{constructor(t,a,o){this.type=t,this.branches=a,this.otherwise=o}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let o;a.expectedType&&a.expectedType.kind!=="value"&&(o=a.expectedType);const h=[];for(let _=1;_<t.length-1;_+=2){const v=a.parse(t[_],_,Ht);if(!v)return null;const w=a.parse(t[_+1],_+1,o);if(!w)return null;h.push([v,w]),o=o||w.type}const g=a.parse(t[t.length-1],t.length-1,o);if(!g)return null;if(!o)throw new Error("Can't infer output type");return new Yn(o,h,g)}evaluate(t){for(const[a,o]of this.branches)if(a.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,o]of this.branches)t(a),t(o);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Co{constructor(t,a,o,h){this.type=t,this.input=a,this.beginIndex=o,this.endIndex=h}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=a.parse(t[1],1,Ft),h=a.parse(t[2],2,Qe);if(!o||!h)return null;if(!sc(o.type,[qa(Ft),Nt,Ft]))return a.error(`Expected first argument to be of type array or string, but found ${ki(o.type)} instead`);if(t.length===4){const g=a.parse(t[3],3,Qe);return g?new Co(o.type,o,h,g):null}return new Co(o.type,o,h)}evaluate(t){const a=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),Vs(a,["string"]))return[...a].slice(o,h).join("");if(Vs(a,["array"]))return a.slice(o,h);throw new Ni(`Expected first argument to be of type array or string, but found ${ki(qi(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ao(r,t){const a=r.length-1;let o,h,g=0,_=a,v=0;for(;g<=_;)if(v=Math.floor((g+_)/2),o=r[v],h=r[v+1],o<=t){if(v===a||t<h)return v;g=v+1}else{if(!(o>t))throw new Ni("Input is not a number.");_=v-1}return 0}class Xs{constructor(t,a,o){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[h,g]of o)this.labels.push(h),this.outputs.push(g)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const o=a.parse(t[1],1,Qe);if(!o)return null;const h=[];let g=null;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);for(let _=1;_<t.length;_+=2){const v=_===1?-1/0:t[_],w=t[_+1],M=_,A=_+1;if(typeof v!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(h.length&&h[h.length-1][0]>=v)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const I=a.parse(w,A,g);if(!I)return null;g=g||I.type,h.push([v,I])}return new Xs(g,o,h)}evaluate(t){const a=this.labels,o=this.outputs;if(a.length===1)return o[0].evaluate(t);const h=this.input.evaluate(t);if(h<=a[0])return o[0].evaluate(t);const g=a.length;return h>=a[g-1]?o[g-1].evaluate(t):o[Ao(a,h)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Kn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Qc,Wc,Nh=function(){if(Wc)return Qc;function r(t,a,o,h){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(h-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=o,this.p2y=h}return Wc=1,Qc=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,h=0;h<8;h++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<a)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var v=0,w=1;for(o=t,h=0;h<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<a));h++)t>g?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},Qc}(),Uh=Kn(Nh);class la{constructor(t,a,o,h,g){this.type=t,this.operator=a,this.interpolation=o,this.input=h,this.labels=[],this.outputs=[];for(const[_,v]of g)this.labels.push(_),this.outputs.push(v)}static interpolationFactor(t,a,o,h){let g=0;if(t.name==="exponential")g=uc(a,t.base,o,h);else if(t.name==="linear")g=uc(a,1,o,h);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new Uh(_[0],_[1],_[2],_[3]).solve(uc(a,1,o,h))}return g}static parse(t,a){let[o,h,g,..._]=t;if(!Array.isArray(h)||h.length===0)return a.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const M=h[1];if(typeof M!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:M}}else{if(h[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const M=h.slice(1);if(M.length!==4||M.some(A=>typeof A!="number"||A<0||A>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:M}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,Qe),!g)return null;const v=[];let w=null;o!=="interpolate-hcl"&&o!=="interpolate-lab"||a.expectedType==Br?a.expectedType&&a.expectedType.kind!=="value"&&(w=a.expectedType):w=Ri;for(let M=0;M<_.length;M+=2){const A=_[M],I=_[M+1],F=M+3,N=M+4;if(typeof A!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(v.length&&v[v.length-1][0]>=A)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const V=a.parse(I,N,w);if(!V)return null;w=w||V.type,v.push([A,V])}return Ra(w,Qe)||Ra(w,ji)||Ra(w,Ri)||Ra(w,Ga)||Ra(w,os)||Ra(w,Br)||Ra(w,yn)||Ra(w,qa(Qe))?new la(w,o,h,g,v):a.error(`Type ${ki(w)} is not interpolatable.`)}evaluate(t){const a=this.labels,o=this.outputs;if(a.length===1)return o[0].evaluate(t);const h=this.input.evaluate(t);if(h<=a[0])return o[0].evaluate(t);const g=a.length;if(h>=a[g-1])return o[g-1].evaluate(t);const _=Ao(a,h),v=la.interpolationFactor(this.interpolation,h,a[_],a[_+1]),w=o[_].evaluate(t),M=o[_+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ia(w,M,v);case"color":return hi.interpolate(w,M,v);case"padding":return vn.interpolate(w,M,v);case"colorArray":return Un.interpolate(w,M,v);case"numberArray":return xn.interpolate(w,M,v);case"variableAnchorOffsetCollection":return dn.interpolate(w,M,v);case"array":return xo(w,M,v);case"projectionDefinition":return Xn.interpolate(w,M,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return hi.interpolate(w,M,v,"hcl");case"colorArray":return Un.interpolate(w,M,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return hi.interpolate(w,M,v,"lab");case"colorArray":return Un.interpolate(w,M,v,"lab")}}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function uc(r,t,a,o){const h=o-a,g=r-a;return h===0?0:t===1?g/h:(Math.pow(t,g)-1)/(Math.pow(t,h)-1)}const Fr={color:hi.interpolate,number:ia,padding:vn.interpolate,numberArray:xn.interpolate,colorArray:Un.interpolate,variableAnchorOffsetCollection:dn.interpolate,array:xo};class zo{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let o=null;const h=a.expectedType;h&&h.kind!=="value"&&(o=h);const g=[];for(const v of t.slice(1)){const w=a.parse(v,1+g.length,o,void 0,{typeAnnotation:"omit"});if(!w)return null;o=o||w.type,g.push(w)}if(!o)throw new Error("No output type");const _=h&&g.some(v=>Ia(h,v.type));return new zo(_?Ft:o,g)}evaluate(t){let a,o=null,h=0;for(const g of this.args)if(h++,o=g.evaluate(t),o&&o instanceof wa&&!o.available&&(a||(a=o.name),o=null,h===this.args.length&&(o=a)),o!==null)break;return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Po(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function lr(r,t,a,o){return o.compare(t,a)===0}function Do(r,t,a){const o=r!=="=="&&r!=="!=";return class gg{constructor(g,_,v){this.type=Ht,this.lhs=g,this.rhs=_,this.collator=v,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const v=g[0];let w=_.parse(g[1],1,Ft);if(!w)return null;if(!Po(v,w.type))return _.concat(1).error(`"${v}" comparisons are not supported for type '${ki(w.type)}'.`);let M=_.parse(g[2],2,Ft);if(!M)return null;if(!Po(v,M.type))return _.concat(2).error(`"${v}" comparisons are not supported for type '${ki(M.type)}'.`);if(w.type.kind!==M.type.kind&&w.type.kind!=="value"&&M.type.kind!=="value")return _.error(`Cannot compare types '${ki(w.type)}' and '${ki(M.type)}'.`);o&&(w.type.kind==="value"&&M.type.kind!=="value"?w=new Jt(M.type,[w]):w.type.kind!=="value"&&M.type.kind==="value"&&(M=new Jt(w.type,[M])));let A=null;if(g.length===4){if(w.type.kind!=="string"&&M.type.kind!=="string"&&w.type.kind!=="value"&&M.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(A=_.parse(g[3],3,go),!A)return null}return new gg(w,M,A)}evaluate(g){const _=this.lhs.evaluate(g),v=this.rhs.evaluate(g);if(o&&this.hasUntypedArgument){const w=qi(_),M=qi(v);if(w.kind!==M.kind||w.kind!=="string"&&w.kind!=="number")throw new Ni(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${w.kind}, ${M.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const w=qi(_),M=qi(v);if(w.kind!=="string"||M.kind!=="string")return t(g,_,v)}return this.collator?a(g,_,v,this.collator.evaluate(g)):t(g,_,v)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Jc=Do("==",function(r,t,a){return t===a},lr),Vh=Do("!=",function(r,t,a){return t!==a},function(r,t,a,o){return!lr(0,t,a,o)}),Yu=Do("<",function(r,t,a){return t<a},function(r,t,a,o){return o.compare(t,a)<0}),Wd=Do(">",function(r,t,a){return t>a},function(r,t,a,o){return o.compare(t,a)>0}),Jd=Do("<=",function(r,t,a){return t<=a},function(r,t,a,o){return o.compare(t,a)<=0}),ef=Do(">=",function(r,t,a){return t>=a},function(r,t,a,o){return o.compare(t,a)>=0});class eu{constructor(t,a,o){this.type=go,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return a.error("Collator options argument must be an object.");const h=a.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,Ht);if(!h)return null;const g=a.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,Ht);if(!g)return null;let _=null;return o.locale&&(_=a.parse(o.locale,1,Nt),!_)?null:new eu(h,g,_)}evaluate(t){return new qs(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class vl{constructor(t,a,o,h,g){this.type=Nt,this.number=t,this.locale=a,this.currency=o,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const o=a.parse(t[1],1,Qe);if(!o)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return a.error("NumberFormat options argument must be an object.");let g=null;if(h.locale&&(g=a.parse(h.locale,1,Nt),!g))return null;let _=null;if(h.currency&&(_=a.parse(h.currency,1,Nt),!_))return null;let v=null;if(h["min-fraction-digits"]&&(v=a.parse(h["min-fraction-digits"],1,Qe),!v))return null;let w=null;return h["max-fraction-digits"]&&(w=a.parse(h["max-fraction-digits"],1,Qe),!w)?null:new vl(o,g,_,v,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class tu{constructor(t){this.type=dl,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return a.error("First argument must be an image or text section.");const h=[];let g=!1;for(let _=1;_<=t.length-1;++_){const v=t[_];if(g&&typeof v=="object"&&!Array.isArray(v)){g=!1;let w=null;if(v["font-scale"]&&(w=a.parse(v["font-scale"],1,Qe),!w))return null;let M=null;if(v["text-font"]&&(M=a.parse(v["text-font"],1,qa(Nt)),!M))return null;let A=null;if(v["text-color"]&&(A=a.parse(v["text-color"],1,Ri),!A))return null;let I=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!bo.includes(v["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(I=a.parse(v["vertical-align"],1,Nt),!I)return null}const F=h[h.length-1];F.scale=w,F.font=M,F.textColor=A,F.verticalAlign=I}else{const w=a.parse(t[_],1,Ft);if(!w)return null;const M=w.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,h.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new tu(h)}evaluate(t){return new Nn(this.sections.map(a=>{const o=a.content.evaluate(t);return qi(o)===Ns?new Hs("",o,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new Hs(ri(o),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class iu{constructor(t){this.type=Ns,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const o=a.parse(t[1],1,Nt);return o?new iu(o):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),o=wa.fromString(a);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(a)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class nu{constructor(t){this.type=Qe,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=a.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${ki(o.type)} instead.`):new nu(o):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Ni(`Expected value to be of type string or array, but found ${ki(qi(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const cr=8192;function xl(r,t){const a=(180+r[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(a*h*cr),Math.round(o*h*cr)]}function Ku(r,t){const a=Math.pow(2,t.z);return[(h=(r[0]/cr+t.x)/a,360*h-180),(o=(r[1]/cr+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,h}function bl(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function wl(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function Zh(r,t,a){const o=r[0]-t[0],h=r[1]-t[1],g=r[0]-a[0],_=r[1]-a[1];return o*_-g*h==0&&o*g<=0&&h*_<=0}function hc(r,t,a,o){return(h=[o[0]-a[0],o[1]-a[1]])[0]*(g=[t[0]-r[0],t[1]-r[1]])[1]-h[1]*g[0]!=0&&!(!Wu(r,t,a,o)||!Wu(a,o,r,t));var h,g}function Qu(r,t,a){for(const o of a)for(let h=0;h<o.length-1;++h)if(hc(r,t,o[h],o[h+1]))return!0;return!1}function ur(r,t,a=!1){let o=!1;for(const v of t)for(let w=0;w<v.length-1;w++){if(Zh(r,v[w],v[w+1]))return a;(g=v[w])[1]>(h=r)[1]!=(_=v[w+1])[1]>h[1]&&h[0]<(_[0]-g[0])*(h[1]-g[1])/(_[1]-g[1])+g[0]&&(o=!o)}var h,g,_;return o}function Gh(r,t){for(const a of t)if(ur(r,a))return!0;return!1}function qh(r,t){for(const a of r)if(!ur(a,t))return!1;for(let a=0;a<r.length-1;++a)if(Qu(r[a],r[a+1],t))return!1;return!0}function tf(r,t){for(const a of t)if(qh(r,a))return!0;return!1}function Wu(r,t,a,o){const h=o[0]-a[0],g=o[1]-a[1],_=(r[0]-a[0])*g-h*(r[1]-a[1]),v=(t[0]-a[0])*g-h*(t[1]-a[1]);return _>0&&v<0||_<0&&v>0}function Tl(r,t,a){const o=[];for(let h=0;h<r.length;h++){const g=[];for(let _=0;_<r[h].length;_++){const v=xl(r[h][_],a);bl(t,v),g.push(v)}o.push(g)}return o}function Sl(r,t,a){const o=[];for(let h=0;h<r.length;h++){const g=Tl(r[h],t,a);o.push(g)}return o}function Ml(r,t,a,o){if(r[0]<a[0]||r[0]>a[2]){const h=.5*o;let g=r[0]-a[0]>h?-o:a[0]-r[0]>h?o:0;g===0&&(g=r[0]-a[2]>h?-o:a[2]-r[0]>h?o:0),r[0]+=g}bl(t,r)}function Hh(r,t,a,o){const h=Math.pow(2,o.z)*cr,g=[o.x*cr,o.y*cr],_=[];for(const v of r)for(const w of v){const M=[w.x+g[0],w.y+g[1]];Ml(M,t,a,h),_.push(M)}return _}function El(r,t,a,o){const h=Math.pow(2,o.z)*cr,g=[o.x*cr,o.y*cr],_=[];for(const w of r){const M=[];for(const A of w){const I=[A.x+g[0],A.y+g[1]];bl(t,I),M.push(I)}_.push(M)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of _)for(const M of w)Ml(M,t,a,h)}var v;return _}class cs{constructor(t,a){this.type=Ht,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Mi(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const h=[];for(const g of o.features){const{type:_,coordinates:v}=g.geometry;_==="Polygon"&&h.push(v),_==="MultiPolygon"&&h.push(...v)}if(h.length)return new cs(o,{type:"MultiPolygon",coordinates:h})}else if(o.type==="Feature"){const h=o.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new cs(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new cs(o,o)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,o){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=a.canonicalID();if(o.type==="Polygon"){const v=Tl(o.coordinates,g,_),w=Hh(a.geometry(),h,g,_);if(!wl(h,g))return!1;for(const M of w)if(!ur(M,v))return!1}if(o.type==="MultiPolygon"){const v=Sl(o.coordinates,g,_),w=Hh(a.geometry(),h,g,_);if(!wl(h,g))return!1;for(const M of w)if(!Gh(M,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,o){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=a.canonicalID();if(o.type==="Polygon"){const v=Tl(o.coordinates,g,_),w=El(a.geometry(),h,g,_);if(!wl(h,g))return!1;for(const M of w)if(!qh(M,v))return!1}if(o.type==="MultiPolygon"){const v=Sl(o.coordinates,g,_),w=El(a.geometry(),h,g,_);if(!wl(h,g))return!1;for(const M of w)if(!tf(M,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ju=class{constructor(r=[],t=(a,o)=>a<o?-1:a>o?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:a}=this,o=t[r];for(;r>0;){const h=r-1>>1,g=t[h];if(a(o,g)>=0)break;t[r]=g,r=h}t[r]=o}_down(r){const{data:t,compare:a}=this,o=this.length>>1,h=t[r];for(;r<o;){let g=1+(r<<1);const _=g+1;if(_<this.length&&a(t[_],t[g])<0&&(g=_),a(t[g],h)>=0)break;t[r]=t[g],r=g}t[r]=h}};function au(r,t,a=0,o=r.length-1,h=eh){for(;o>a;){if(o-a>600){const w=o-a+1,M=t-a+1,A=Math.log(w),I=.5*Math.exp(2*A/3),F=.5*Math.sqrt(A*I*(w-I)/w)*(M-w/2<0?-1:1);au(r,t,Math.max(a,Math.floor(t-M*I/w+F)),Math.min(o,Math.floor(t+(w-M)*I/w+F)),h)}const g=r[t];let _=a,v=o;for(Ys(r,a,t),h(r[o],g)>0&&Ys(r,a,o);_<v;){for(Ys(r,_,v),_++,v--;h(r[_],g)<0;)_++;for(;h(r[v],g)>0;)v--}h(r[a],g)===0?Ys(r,a,v):(v++,Ys(r,v,o)),v<=t&&(a=v+1),t<=v&&(o=v-1)}}function Ys(r,t,a){const o=r[t];r[t]=r[a],r[a]=o}function eh(r,t){return r<t?-1:r>t?1:0}function dc(r,t){if(r.length<=1)return[r];const a=[];let o,h;for(const g of r){const _=nf(g);_!==0&&(g.area=Math.abs(_),h===void 0&&(h=_<0),h===_<0?(o&&a.push(o),o=[g]):o.push(g))}if(o&&a.push(o),t>1)for(let g=0;g<a.length;g++)a[g].length<=t||(au(a[g],t,1,a[g].length-1,$h),a[g]=a[g].slice(0,t));return a}function $h(r,t){return t.area-r.area}function nf(r){let t=0;for(let a,o,h=0,g=r.length,_=g-1;h<g;_=h++)a=r[h],o=r[_],t+=(o.x-a.x)*(a.y+o.y);return t}const th=1/298.257223563,Xh=th*(2-th),Yh=Math.PI/180;class ih{constructor(t){const a=6378.137*Yh*1e3,o=Math.cos(t*Yh),h=1/(1-Xh*(1-o*o)),g=Math.sqrt(h);this.kx=a*g*o,this.ky=a*g*h*(1-Xh)}distance(t,a){const o=this.wrap(t[0]-a[0])*this.kx,h=(t[1]-a[1])*this.ky;return Math.sqrt(o*o+h*h)}pointOnLine(t,a){let o,h,g,_,v=1/0;for(let w=0;w<t.length-1;w++){let M=t[w][0],A=t[w][1],I=this.wrap(t[w+1][0]-M)*this.kx,F=(t[w+1][1]-A)*this.ky,N=0;I===0&&F===0||(N=(this.wrap(a[0]-M)*this.kx*I+(a[1]-A)*this.ky*F)/(I*I+F*F),N>1?(M=t[w+1][0],A=t[w+1][1]):N>0&&(M+=I/this.kx*N,A+=F/this.ky*N)),I=this.wrap(a[0]-M)*this.kx,F=(a[1]-A)*this.ky;const V=I*I+F*F;V<v&&(v=V,o=M,h=A,g=w,_=N)}return{point:[o,h],index:g,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function La(r,t){return t[0]-r[0]}function si(r){return r[1]-r[0]+1}function jr(r,t){return r[1]>=r[0]&&r[1]<t}function ru(r,t){if(r[0]>r[1])return[null,null];const a=si(r);if(t){if(a===2)return[r,null];const h=Math.floor(a/2);return[[r[0],r[0]+h],[r[0]+h,r[1]]]}if(a===1)return[r,null];const o=Math.floor(a/2)-1;return[[r[0],r[0]+o],[r[0]+o+1,r[1]]]}function su(r,t){if(!jr(t,r.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)bl(a,r[o]);return a}function ou(r){const t=[1/0,1/0,-1/0,-1/0];for(const a of r)for(const o of a)bl(t,o);return t}function lu(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function nh(r,t,a){if(!lu(r)||!lu(t))return NaN;let o=0,h=0;return r[2]<t[0]&&(o=t[0]-r[2]),r[0]>t[2]&&(o=r[0]-t[2]),r[1]>t[3]&&(h=r[1]-t[3]),r[3]<t[1]&&(h=t[1]-r[3]),a.distance([0,0],[o,h])}function hr(r,t,a){const o=a.pointOnLine(t,r);return a.distance(r,o.point)}function fc(r,t,a,o,h){const g=Math.min(hr(r,[a,o],h),hr(t,[a,o],h)),_=Math.min(hr(a,[r,t],h),hr(o,[r,t],h));return Math.min(g,_)}function pc(r,t,a,o,h){if(!jr(t,r.length)||!jr(o,a.length))return 1/0;let g=1/0;for(let _=t[0];_<t[1];++_){const v=r[_],w=r[_+1];for(let M=o[0];M<o[1];++M){const A=a[M],I=a[M+1];if(hc(v,w,A,I))return 0;g=Math.min(g,fc(v,w,A,I,h))}}return g}function ah(r,t,a,o,h){if(!jr(t,r.length)||!jr(o,a.length))return NaN;let g=1/0;for(let _=t[0];_<=t[1];++_)for(let v=o[0];v<=o[1];++v)if(g=Math.min(g,h.distance(r[_],a[v])),g===0)return g;return g}function Kh(r,t,a){if(ur(r,t,!0))return 0;let o=1/0;for(const h of t){const g=h[0],_=h[h.length-1];if(g!==_&&(o=Math.min(o,hr(r,[_,g],a)),o===0))return o;const v=a.pointOnLine(h,r);if(o=Math.min(o,a.distance(r,v.point)),o===0)return o}return o}function Io(r,t,a,o){if(!jr(t,r.length))return NaN;for(let g=t[0];g<=t[1];++g)if(ur(r[g],a,!0))return 0;let h=1/0;for(let g=t[0];g<t[1];++g){const _=r[g],v=r[g+1];for(const w of a)for(let M=0,A=w.length,I=A-1;M<A;I=M++){const F=w[I],N=w[M];if(hc(_,v,F,N))return 0;h=Math.min(h,fc(_,v,F,N,o))}}return h}function Ro(r,t){for(const a of r)for(const o of a)if(ur(o,t,!0))return!0;return!1}function rh(r,t,a,o=1/0){const h=ou(r),g=ou(t);if(o!==1/0&&nh(h,g,a)>=o)return o;if(wl(h,g)){if(Ro(r,t))return 0}else if(Ro(t,r))return 0;let _=1/0;for(const v of r)for(let w=0,M=v.length,A=M-1;w<M;A=w++){const I=v[A],F=v[w];for(const N of t)for(let V=0,q=N.length,Q=q-1;V<q;Q=V++){const ne=N[Q],ye=N[V];if(hc(I,F,ne,ye))return 0;_=Math.min(_,fc(I,F,ne,ye,a))}}return _}function sh(r,t,a,o,h,g){if(!g)return;const _=nh(su(o,g),h,a);_<t&&r.push([_,g,[0,0]])}function Nr(r,t,a,o,h,g,_){if(!g||!_)return;const v=nh(su(o,g),su(h,_),a);v<t&&r.push([v,g,_])}function mc(r,t,a,o,h=1/0){let g=Math.min(o.distance(r[0],a[0][0]),h);if(g===0)return g;const _=new Ju([[0,[0,r.length-1],[0,0]]],La),v=ou(a);for(;_.length>0;){const w=_.pop();if(w[0]>=g)continue;const M=w[1],A=t?50:100;if(si(M)<=A){if(!jr(M,r.length))return NaN;if(t){const I=Io(r,M,a,o);if(isNaN(I)||I===0)return I;g=Math.min(g,I)}else for(let I=M[0];I<=M[1];++I){const F=Kh(r[I],a,o);if(g=Math.min(g,F),g===0)return 0}}else{const I=ru(M,t);sh(_,g,o,r,v,I[0]),sh(_,g,o,r,v,I[1])}}return g}function gc(r,t,a,o,h,g=1/0){let _=Math.min(g,h.distance(r[0],a[0]));if(_===0)return _;const v=new Ju([[0,[0,r.length-1],[0,a.length-1]]],La);for(;v.length>0;){const w=v.pop();if(w[0]>=_)continue;const M=w[1],A=w[2],I=t?50:100,F=o?50:100;if(si(M)<=I&&si(A)<=F){if(!jr(M,r.length)&&jr(A,a.length))return NaN;let N;if(t&&o)N=pc(r,M,a,A,h),_=Math.min(_,N);else if(t&&!o){const V=r.slice(M[0],M[1]+1);for(let q=A[0];q<=A[1];++q)if(N=hr(a[q],V,h),_=Math.min(_,N),_===0)return _}else if(!t&&o){const V=a.slice(A[0],A[1]+1);for(let q=M[0];q<=M[1];++q)if(N=hr(r[q],V,h),_=Math.min(_,N),_===0)return _}else N=ah(r,M,a,A,h),_=Math.min(_,N)}else{const N=ru(M,t),V=ru(A,o);Nr(v,_,h,r,a,N[0],V[0]),Nr(v,_,h,r,a,N[0],V[1]),Nr(v,_,h,r,a,N[1],V[0]),Nr(v,_,h,r,a,N[1],V[1])}}return _}function cu(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class ko{constructor(t,a){this.type=Qe,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Mi(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new ko(o,o.features.map(h=>cu(h.geometry)).flat());if(o.type==="Feature")return new ko(o,cu(o.geometry));if("type"in o&&"coordinates"in o)return new ko(o,cu(o))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,o){const h=a.geometry(),g=h.flat().map(w=>Ku([w.x,w.y],a.canonical));if(h.length===0)return NaN;const _=new ih(g[0][1]);let v=1/0;for(const w of o){switch(w.type){case"Point":v=Math.min(v,gc(g,!1,[w.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,gc(g,!1,w.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,mc(g,!1,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,o){const h=a.geometry(),g=h.flat().map(w=>Ku([w.x,w.y],a.canonical));if(h.length===0)return NaN;const _=new ih(g[0][1]);let v=1/0;for(const w of o){switch(w.type){case"Point":v=Math.min(v,gc(g,!0,[w.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,gc(g,!0,w.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,mc(g,!0,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,o){const h=a.geometry();if(h.length===0||h[0].length===0)return NaN;const g=dc(h,0).map(w=>w.map(M=>M.map(A=>Ku([A.x,A.y],a.canonical)))),_=new ih(g[0][0][0][1]);let v=1/0;for(const w of o)for(const M of g){switch(w.type){case"Point":v=Math.min(v,mc([w.coordinates],!1,M,_,v));break;case"LineString":v=Math.min(v,mc(w.coordinates,!0,M,_,v));break;case"Polygon":v=Math.min(v,rh(M,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class uu{constructor(t){this.type=Ft,this.key=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=t[1];return o==null?a.error("Global state property must be defined."):typeof o!="string"?a.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new uu(o)}evaluate(t){var a;const o=(a=t.globals)===null||a===void 0?void 0:a.globalState;return o&&Object.keys(o).length!==0?ml(o,this.key):null}eachChild(){}outputDefined(){return!1}}const Cl={"==":Jc,"!=":Vh,">":Wd,"<":Yu,">=":ef,"<=":Jd,array:Jt,at:So,boolean:Jt,case:Yn,coalesce:zo,collator:eu,format:tu,image:iu,in:Mo,"index-of":yl,interpolate:la,"interpolate-hcl":la,"interpolate-lab":la,length:nu,let:$s,literal:$t,match:Eo,number:Jt,"number-format":vl,object:Jt,slice:Co,step:Xs,string:Jt,"to-boolean":bn,"to-color":bn,"to-number":bn,"to-string":bn,var:To,within:cs,distance:ko,"global-state":uu};class $a{constructor(t,a,o,h){this.name=t,this.type=a,this._evaluate=o,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const o=t[0],h=$a.definitions[o];if(!h)return a.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(h)?h[0]:h.type,_=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=_.filter(([M])=>!Array.isArray(M)||M.length===t.length-1);let w=null;for(const[M,A]of v){w=new cc(a.registry,Ta,a.path,null,a.scope);const I=[];let F=!1;for(let N=1;N<t.length;N++){const V=t[N],q=Array.isArray(M)?M[N-1]:M.type,Q=w.parse(V,1+I.length,q);if(!Q){F=!0;break}I.push(Q)}if(!F)if(Array.isArray(M)&&M.length!==I.length)w.error(`Expected ${M.length} arguments, but found ${I.length} instead.`);else{for(let N=0;N<I.length;N++){const V=Array.isArray(M)?M[N]:M.type,q=I[N];w.concat(N+1).checkSubtype(V,q.type)}if(w.errors.length===0)return new $a(o,g,A,I)}}if(v.length===1)a.errors.push(...w.errors);else{const M=(v.length?v:_).map(([I])=>{return F=I,Array.isArray(F)?`(${F.map(ki).join(", ")})`:`(${ki(F.type)}...)`;var F}).join(" | "),A=[];for(let I=1;I<t.length;I++){const F=a.parse(t[I],1+A.length);if(!F)return null;A.push(ki(F.type))}a.error(`Expected arguments of type ${M}, but found (${A.join(", ")}) instead.`)}return null}static register(t,a){$a.definitions=a;for(const o in a)t[o]=$a}}function oh(r,[t,a,o,h]){t=t.evaluate(r),a=a.evaluate(r),o=o.evaluate(r);const g=h?h.evaluate(r):1,_=or(t,a,o,g);if(_)throw new Ni(_);return new hi(t/255,a/255,o/255,g,!1)}function hu(r,t){return r in t}function Xa(r,t){const a=t[r];return a===void 0?null:a}function Ks(r){return{type:r}}function Ta(r){if(r instanceof To)return Ta(r.boundExpression);if(r instanceof $a&&r.name==="error"||r instanceof eu||r instanceof cs||r instanceof ko||r instanceof uu)return!1;const t=r instanceof bn||r instanceof Jt;let a=!0;return r.eachChild(o=>{a=t?a&&Ta(o):a&&o instanceof $t}),!!a&&Sa(r)&&Al(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Sa(r){if(r instanceof $a&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof cs||r instanceof ko)return!1;let t=!0;return r.eachChild(a=>{t&&!Sa(a)&&(t=!1)}),t}function Ur(r){if(r instanceof $a&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(a=>{t&&!Ur(a)&&(t=!1)}),t}function Al(r,t){if(r instanceof $a&&t.indexOf(r.name)>=0)return!1;let a=!0;return r.eachChild(o=>{a&&!Al(o,t)&&(a=!1)}),a}function Lo(r){return{result:"success",value:r}}function us(r){return{result:"error",value:r}}function Qs(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Bo(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function _c(r){return!!r.expression&&r.expression.interpolated}function ii(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function hs(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&qi(r)===jn}function du(r){return r}function Ma(r,t){const a=r.stops&&typeof r.stops[0][0]=="object",o=a||!(a||r.property!==void 0),h=r.type||(_c(t)?"exponential":"interval"),g=function(A){switch(A.type){case"color":return hi.parse;case"padding":return vn.parse;case"numberArray":return xn.parse;case"colorArray":return Un.parse;default:return null}}(t);if(g&&((r=yi({},r)).stops&&(r.stops=r.stops.map(A=>[A[0],g(A[1])])),r.default=g(r.default?r.default:t.default)),r.colorSpace&&(_=r.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var _;const v=function(A){switch(A){case"exponential":return yc;case"interval":return Qh;case"categorical":return ds;case"identity":return Fo;default:throw new Error(`Unknown function type "${A}"`)}}(h);let w,M;if(h==="categorical"){w=Object.create(null);for(const A of r.stops)w[A[0]]=A[1];M=typeof r.stops[0][0]}if(a){const A={},I=[];for(let V=0;V<r.stops.length;V++){const q=r.stops[V],Q=q[0].zoom;A[Q]===void 0&&(A[Q]={zoom:Q,type:r.type,property:r.property,default:r.default,stops:[]},I.push(Q)),A[Q].stops.push([q[0].value,q[1]])}const F=[];for(const V of I)F.push([A[V].zoom,Ma(A[V],t)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:la.interpolationFactor.bind(void 0,N),zoomStops:F.map(V=>V[0]),evaluate:({zoom:V},q)=>yc({stops:F,base:r.base},t,V).evaluate(V,q)}}if(o){const A=h==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:la.interpolationFactor.bind(void 0,A),zoomStops:r.stops.map(I=>I[0]),evaluate:({zoom:I})=>v(r,t,I,w,M)}}return{kind:"source",evaluate(A,I){const F=I&&I.properties?I.properties[r.property]:void 0;return F===void 0?Oo(r.default,t.default):v(r,t,F,w,M)}}}function Oo(r,t,a){return r!==void 0?r:t!==void 0?t:a!==void 0?a:void 0}function ds(r,t,a,o,h){return Oo(typeof a===h?o[a]:void 0,r.default,t.default)}function Qh(r,t,a){if(ii(a)!=="number")return Oo(r.default,t.default);const o=r.stops.length;if(o===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[o-1][0])return r.stops[o-1][1];const h=Ao(r.stops.map(g=>g[0]),a);return r.stops[h][1]}function yc(r,t,a){const o=r.base!==void 0?r.base:1;if(ii(a)!=="number")return Oo(r.default,t.default);const h=r.stops.length;if(h===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[h-1][0])return r.stops[h-1][1];const g=Ao(r.stops.map(A=>A[0]),a),_=function(A,I,F,N){const V=N-F,q=A-F;return V===0?0:I===1?q/V:(Math.pow(I,q)-1)/(Math.pow(I,V)-1)}(a,o,r.stops[g][0],r.stops[g+1][0]),v=r.stops[g][1],w=r.stops[g+1][1],M=Fr[t.type]||du;return typeof v.evaluate=="function"?{evaluate(...A){const I=v.evaluate.apply(void 0,A),F=w.evaluate.apply(void 0,A);if(I!==void 0&&F!==void 0)return M(I,F,_,r.colorSpace)}}:M(v,w,_,r.colorSpace)}function Fo(r,t,a){switch(t.type){case"color":a=hi.parse(a);break;case"formatted":a=Nn.fromString(a.toString());break;case"resolvedImage":a=wa.fromString(a.toString());break;case"padding":a=vn.parse(a);break;case"colorArray":a=Un.parse(a);break;case"numberArray":a=xn.parse(a);break;default:ii(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return Oo(a,r.default,t.default)}$a.register(Cl,{error:[{kind:"error"},[Nt],(r,[t])=>{throw new Ni(t.evaluate(r))}],typeof:[Nt,[Ft],(r,[t])=>ki(qi(t.evaluate(r)))],"to-rgba":[qa(Qe,4),[Ri],(r,[t])=>{const[a,o,h,g]=t.evaluate(r).rgb;return[255*a,255*o,255*h,g]}],rgb:[Ri,[Qe,Qe,Qe],oh],rgba:[Ri,[Qe,Qe,Qe,Qe],oh],has:{type:Ht,overloads:[[[Nt],(r,[t])=>hu(t.evaluate(r),r.properties())],[[Nt,jn],(r,[t,a])=>hu(t.evaluate(r),a.evaluate(r))]]},get:{type:Ft,overloads:[[[Nt],(r,[t])=>Xa(t.evaluate(r),r.properties())],[[Nt,jn],(r,[t,a])=>Xa(t.evaluate(r),a.evaluate(r))]]},"feature-state":[Ft,[Nt],(r,[t])=>Xa(t.evaluate(r),r.featureState||{})],properties:[jn,[],r=>r.properties()],"geometry-type":[Nt,[],r=>r.geometryType()],id:[Ft,[],r=>r.id()],zoom:[Qe,[],r=>r.globals.zoom],"heatmap-density":[Qe,[],r=>r.globals.heatmapDensity||0],"line-progress":[Qe,[],r=>r.globals.lineProgress||0],accumulated:[Ft,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Qe,Ks(Qe),(r,t)=>{let a=0;for(const o of t)a+=o.evaluate(r);return a}],"*":[Qe,Ks(Qe),(r,t)=>{let a=1;for(const o of t)a*=o.evaluate(r);return a}],"-":{type:Qe,overloads:[[[Qe,Qe],(r,[t,a])=>t.evaluate(r)-a.evaluate(r)],[[Qe],(r,[t])=>-t.evaluate(r)]]},"/":[Qe,[Qe,Qe],(r,[t,a])=>t.evaluate(r)/a.evaluate(r)],"%":[Qe,[Qe,Qe],(r,[t,a])=>t.evaluate(r)%a.evaluate(r)],ln2:[Qe,[],()=>Math.LN2],pi:[Qe,[],()=>Math.PI],e:[Qe,[],()=>Math.E],"^":[Qe,[Qe,Qe],(r,[t,a])=>Math.pow(t.evaluate(r),a.evaluate(r))],sqrt:[Qe,[Qe],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Qe,[Qe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Qe,[Qe],(r,[t])=>Math.log(t.evaluate(r))],log2:[Qe,[Qe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Qe,[Qe],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Qe,[Qe],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Qe,[Qe],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Qe,[Qe],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Qe,[Qe],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Qe,[Qe],(r,[t])=>Math.atan(t.evaluate(r))],min:[Qe,Ks(Qe),(r,t)=>Math.min(...t.map(a=>a.evaluate(r)))],max:[Qe,Ks(Qe),(r,t)=>Math.max(...t.map(a=>a.evaluate(r)))],abs:[Qe,[Qe],(r,[t])=>Math.abs(t.evaluate(r))],round:[Qe,[Qe],(r,[t])=>{const a=t.evaluate(r);return a<0?-Math.round(-a):Math.round(a)}],floor:[Qe,[Qe],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Qe,[Qe],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Ht,[Nt,Ft],(r,[t,a])=>r.properties()[t.value]===a.value],"filter-id-==":[Ht,[Ft],(r,[t])=>r.id()===t.value],"filter-type-==":[Ht,[Nt],(r,[t])=>r.geometryType()===t.value],"filter-<":[Ht,[Nt,Ft],(r,[t,a])=>{const o=r.properties()[t.value],h=a.value;return typeof o==typeof h&&o<h}],"filter-id-<":[Ht,[Ft],(r,[t])=>{const a=r.id(),o=t.value;return typeof a==typeof o&&a<o}],"filter->":[Ht,[Nt,Ft],(r,[t,a])=>{const o=r.properties()[t.value],h=a.value;return typeof o==typeof h&&o>h}],"filter-id->":[Ht,[Ft],(r,[t])=>{const a=r.id(),o=t.value;return typeof a==typeof o&&a>o}],"filter-<=":[Ht,[Nt,Ft],(r,[t,a])=>{const o=r.properties()[t.value],h=a.value;return typeof o==typeof h&&o<=h}],"filter-id-<=":[Ht,[Ft],(r,[t])=>{const a=r.id(),o=t.value;return typeof a==typeof o&&a<=o}],"filter->=":[Ht,[Nt,Ft],(r,[t,a])=>{const o=r.properties()[t.value],h=a.value;return typeof o==typeof h&&o>=h}],"filter-id->=":[Ht,[Ft],(r,[t])=>{const a=r.id(),o=t.value;return typeof a==typeof o&&a>=o}],"filter-has":[Ht,[Ft],(r,[t])=>t.value in r.properties()],"filter-has-id":[Ht,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Ht,[qa(Nt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Ht,[qa(Ft)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Ht,[Nt,qa(Ft)],(r,[t,a])=>a.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Ht,[Nt,qa(Ft)],(r,[t,a])=>function(o,h,g,_){for(;g<=_;){const v=g+_>>1;if(h[v]===o)return!0;h[v]>o?_=v-1:g=v+1}return!1}(r.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Ht,overloads:[[[Ht,Ht],(r,[t,a])=>t.evaluate(r)&&a.evaluate(r)],[Ks(Ht),(r,t)=>{for(const a of t)if(!a.evaluate(r))return!1;return!0}]]},any:{type:Ht,overloads:[[[Ht,Ht],(r,[t,a])=>t.evaluate(r)||a.evaluate(r)],[Ks(Ht),(r,t)=>{for(const a of t)if(a.evaluate(r))return!0;return!1}]]},"!":[Ht,[Ht],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Ht,[Nt],(r,[t])=>{const a=r.globals&&r.globals.isSupportedScript;return!a||a(t.evaluate(r))}],upcase:[Nt,[Nt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Nt,[Nt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Nt,Ks(Ft),(r,t)=>t.map(a=>ri(a.evaluate(r))).join("")],"resolved-locale":[Nt,[go],(r,[t])=>t.evaluate(r).resolvedLocale()]});class zl{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new wo,this._defaultValue=a?function(o){if(o.type==="color"&&hs(o.default))return new hi(0,0,0,0);switch(o.type){case"color":return hi.parse(o.default)||null;case"padding":return vn.parse(o.default)||null;case"numberArray":return xn.parse(o.default)||null;case"colorArray":return Un.parse(o.default)||null;case"variableAnchorOffsetCollection":return dn.parse(o.default)||null;case"projectionDefinition":return Xn.parse(o.default)||null;default:return o.default===void 0?null:o.default}}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,o,h,g,_){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=o,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,a,o,h,g,_){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=o||null,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Ni(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function jo(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Cl}function fs(r,t){const a=new cc(Cl,Ta,[],t?function(h){const g={color:Ri,string:Nt,number:Qe,enum:Nt,boolean:Ht,formatted:dl,padding:Ga,numberArray:os,colorArray:Br,projectionDefinition:ji,resolvedImage:Ns,variableAnchorOffsetCollection:yn};return h.type==="array"?qa(g[h.value]||Ft,h.length):g[h.type]}(t):void 0),o=a.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?Lo(new zl(o,t)):us(a.errors)}class Ws{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!Ur(a.expression)}evaluateWithoutErrorHandling(t,a,o,h,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,a,o,h,g,_)}evaluate(t,a,o,h,g,_){return this._styleExpression.evaluate(t,a,o,h,g,_)}}class No{constructor(t,a,o,h){this.kind=t,this.zoomStops=o,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!Ur(a.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,a,o,h,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,a,o,h,g,_)}evaluate(t,a,o,h,g,_){return this._styleExpression.evaluate(t,a,o,h,g,_)}interpolationFactor(t,a,o){return this.interpolationType?la.interpolationFactor(this.interpolationType,t,a,o):0}}function Pl(r,t){const a=fs(r,t);if(a.result==="error")return a;const o=a.value.expression,h=Sa(o);if(!h&&!Qs(t))return us([new ui("","data expressions not supported")]);const g=Al(o,["zoom"]);if(!g&&!Bo(t))return us([new ui("","zoom expressions not supported")]);const _=ua(o);return _||g?_ instanceof ui?us([_]):_ instanceof la&&!_c(t)?us([new ui("",'"interpolate" expressions cannot be used with this property')]):Lo(_?new No(h?"camera":"composite",a.value,_.labels,_ instanceof la?_.interpolation:void 0):new Ws(h?"constant":"source",a.value)):us([new ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ca{constructor(t,a){this._parameters=t,this._specification=a,yi(this,Ma(this._parameters,this._specification))}static deserialize(t){return new ca(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function ua(r){let t=null;if(r instanceof $s)t=ua(r.result);else if(r instanceof zo){for(const a of r.args)if(t=ua(a),t)break}else(r instanceof Xs||r instanceof la)&&r.input instanceof $a&&r.input.name==="zoom"&&(t=r);return t instanceof ui||r.eachChild(a=>{const o=ua(a);o instanceof ui?t=o:!t&&o?t=new ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new ui("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function vr(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!vr(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const xr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ya(r){if(r==null)return{filter:()=>!0,needGeometry:!1};vr(r)||(r=Dl(r));const t=fs(r,xr);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,o,h)=>t.value.evaluate(a,o,{},h),needGeometry:lh(r)}}function Vr(r,t){return r<t?-1:r>t?1:0}function lh(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(lh(r[t]))return!0;return!1}function Dl(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?vc(r[1],r[2],"=="):t==="!="?xi(vc(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?vc(r[1],r[2],t):t==="any"?(a=r.slice(1),["any"].concat(a.map(Dl))):t==="all"?["all"].concat(r.slice(1).map(Dl)):t==="none"?["all"].concat(r.slice(1).map(Dl).map(xi)):t==="in"?ha(r[1],r.slice(2)):t==="!in"?xi(ha(r[1],r.slice(2))):t==="has"?fn(r[1]):t!=="!has"||xi(fn(r[1]));var a}function vc(r,t,a){switch(r){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,r,t]}}function ha(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",r,["literal",t.sort(Vr)]]:["filter-in-small",r,["literal",t]]}}function fn(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function xi(r){return["!",r]}function Zr(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let h="[";for(const g of r)h+=`${Zr(g)},`;return`${h}]`}const a=Object.keys(r).sort();let o="{";for(let h=0;h<a.length;h++)o+=`${JSON.stringify(a[h])}:${Zr(r[a[h]])},`;return`${o}}`}function br(r){let t="";for(const a of De)t+=`/${Zr(r[a])}`;return t}function Uo(r){const t=r.value;return t?[new Ve(r.key,t,"constants have been deprecated as of v8")]:[]}function Li(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function ps(r){if(Array.isArray(r))return r.map(ps);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const a in r)t[a]=ps(r[a]);return t}return Li(r)}function Ba(r){const t=r.key,a=r.value,o=r.valueSpec||{},h=r.objectElementValidators||{},g=r.style,_=r.styleSpec,v=r.validateSpec;let w=[];const M=ii(a);if(M!=="object")return[new Ve(t,a,`object expected, ${M} found`)];for(const A in a){const I=A.split(".")[0],F=ml(o,I)||o["*"];let N;if(ml(h,I))N=h[I];else if(ml(o,I))N=v;else if(h["*"])N=h["*"];else{if(!o["*"]){w.push(new Ve(t,a[A],`unknown property "${A}"`));continue}N=v}w=w.concat(N({key:(t&&`${t}.`)+A,value:a[A],valueSpec:F,style:g,styleSpec:_,object:a,objectKey:A,validateSpec:v},a))}for(const A in o)h[A]||o[A].required&&o[A].default===void 0&&a[A]===void 0&&w.push(new Ve(t,a,`missing required property "${A}"`));return w}function Vo(r){const t=r.value,a=r.valueSpec,o=r.style,h=r.styleSpec,g=r.key,_=r.arrayElementValidator||r.validateSpec;if(ii(t)!=="array")return[new Ve(g,t,`array expected, ${ii(t)} found`)];if(a.length&&t.length!==a.length)return[new Ve(g,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new Ve(g,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let v={type:a.value,values:a.values};h.$version<7&&(v.function=a.function),ii(a.value)==="object"&&(v=a.value);let w=[];for(let M=0;M<t.length;M++)w=w.concat(_({array:t,arrayIndex:M,value:t[M],valueSpec:v,validateSpec:r.validateSpec,style:o,styleSpec:h,key:`${g}[${M}]`}));return w}function ms(r){const t=r.key,a=r.value,o=r.valueSpec;let h=ii(a);return h==="number"&&a!=a&&(h="NaN"),h!=="number"?[new Ve(t,a,`number expected, ${h} found`)]:"minimum"in o&&a<o.minimum?[new Ve(t,a,`${a} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&a>o.maximum?[new Ve(t,a,`${a} is greater than the maximum value ${o.maximum}`)]:[]}function fu(r){const t=r.valueSpec,a=Li(r.value.type);let o,h,g,_={};const v=a!=="categorical"&&r.value.property===void 0,w=!v,M=ii(r.value.stops)==="array"&&ii(r.value.stops[0])==="array"&&ii(r.value.stops[0][0])==="object",A=Ba({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(N){if(a==="identity")return[new Ve(N.key,N.value,'identity function may not have a "stops" property')];let V=[];const q=N.value;return V=V.concat(Vo({key:N.key,value:q,valueSpec:N.valueSpec,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:I})),ii(q)==="array"&&q.length===0&&V.push(new Ve(N.key,q,"array must have at least one stop")),V},default:function(N){return N.validateSpec({key:N.key,value:N.value,valueSpec:t,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec})}}});return a==="identity"&&v&&A.push(new Ve(r.key,r.value,'missing required property "property"')),a==="identity"||r.value.stops||A.push(new Ve(r.key,r.value,'missing required property "stops"')),a==="exponential"&&r.valueSpec.expression&&!_c(r.valueSpec)&&A.push(new Ve(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(w&&!Qs(r.valueSpec)?A.push(new Ve(r.key,r.value,"property functions not supported")):v&&!Bo(r.valueSpec)&&A.push(new Ve(r.key,r.value,"zoom functions not supported"))),a!=="categorical"&&!M||r.value.property!==void 0||A.push(new Ve(r.key,r.value,'"property" property is required')),A;function I(N){let V=[];const q=N.value,Q=N.key;if(ii(q)!=="array")return[new Ve(Q,q,`array expected, ${ii(q)} found`)];if(q.length!==2)return[new Ve(Q,q,`array length 2 expected, length ${q.length} found`)];if(M){if(ii(q[0])!=="object")return[new Ve(Q,q,`object expected, ${ii(q[0])} found`)];if(q[0].zoom===void 0)return[new Ve(Q,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new Ve(Q,q,"object stop key must have value")];if(g&&g>Li(q[0].zoom))return[new Ve(Q,q[0].zoom,"stop zoom values must appear in ascending order")];Li(q[0].zoom)!==g&&(g=Li(q[0].zoom),h=void 0,_={}),V=V.concat(Ba({key:`${Q}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:ms,value:F}}))}else V=V.concat(F({key:`${Q}[0]`,value:q[0],validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec},q));return jo(ps(q[1]))?V.concat([new Ve(`${Q}[1]`,q[1],"expressions are not allowed in function stops.")]):V.concat(N.validateSpec({key:`${Q}[1]`,value:q[1],valueSpec:t,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec}))}function F(N,V){const q=ii(N.value),Q=Li(N.value),ne=N.value!==null?N.value:V;if(o){if(q!==o)return[new Ve(N.key,ne,`${q} stop domain type must match previous stop domain type ${o}`)]}else o=q;if(q!=="number"&&q!=="string"&&q!=="boolean")return[new Ve(N.key,ne,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&a!=="categorical"){let ye=`number expected, ${q} found`;return Qs(t)&&a===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ve(N.key,ne,ye)]}return a!=="categorical"||q!=="number"||isFinite(Q)&&Math.floor(Q)===Q?a!=="categorical"&&q==="number"&&h!==void 0&&Q<h?[new Ve(N.key,ne,"stop domain values must appear in ascending order")]:(h=Q,a==="categorical"&&Q in _?[new Ve(N.key,ne,"stop domain values must be unique")]:(_[Q]=!0,[])):[new Ve(N.key,ne,`integer expected, found ${Q}`)]}}function Oa(r){const t=(r.expressionContext==="property"?Pl:fs)(ps(r.value),r.valueSpec);if(t.result==="error")return t.value.map(o=>new Ve(`${r.key}${o.key}`,r.value,o.message));const a=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!a.outputDefined())return[new Ve(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Ur(a))return[new Ve(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Ur(a))return[new Ve(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Al(a,["zoom","feature-state"]))return[new Ve(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Sa(a))return[new Ve(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xc(r){const t=r.key,a=r.value,o=ii(a);return o!=="string"?[new Ve(t,a,`color expected, ${o} found`)]:hi.parse(String(a))?[]:[new Ve(t,a,`color expected, "${a}" found`)]}function wr(r){const t=r.key,a=r.value,o=r.valueSpec,h=[];return Array.isArray(o.values)?o.values.indexOf(Li(a))===-1&&h.push(new Ve(t,a,`expected one of [${o.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(o.values).indexOf(Li(a))===-1&&h.push(new Ve(t,a,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(a)} found`)),h}function Tr(r){return vr(ps(r.value))?Oa(yi({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):gs(r)}function gs(r){const t=r.value,a=r.key;if(ii(t)!=="array")return[new Ve(a,t,`array expected, ${ii(t)} found`)];const o=r.styleSpec;let h,g=[];if(t.length<1)return[new Ve(a,t,"filter array must have at least 1 element")];switch(g=g.concat(wr({key:`${a}[0]`,value:t[0],valueSpec:o.filter_operator,style:r.style,styleSpec:r.styleSpec})),Li(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Li(t[1])==="$type"&&g.push(new Ve(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new Ve(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=ii(t[1]),h!=="string"&&g.push(new Ve(`${a}[1]`,t[1],`string expected, ${h} found`)));for(let _=2;_<t.length;_++)h=ii(t[_]),Li(t[1])==="$type"?g=g.concat(wr({key:`${a}[${_}]`,value:t[_],valueSpec:o.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&g.push(new Ve(`${a}[${_}]`,t[_],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(gs({key:`${a}[${_}]`,value:t[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=ii(t[1]),t.length!==2?g.push(new Ve(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&g.push(new Ve(`${a}[1]`,t[1],`string expected, ${h} found`))}return g}function Gr(r,t){const a=r.key,o=r.validateSpec,h=r.style,g=r.styleSpec,_=r.value,v=r.objectKey,w=g[`${t}_${r.layerType}`];if(!w)return[];const M=v.match(/^(.*)-transition$/);if(t==="paint"&&M&&w[M[1]]&&w[M[1]].transition)return o({key:a,value:_,valueSpec:g.transition,style:h,styleSpec:g});const A=r.valueSpec||w[v];if(!A)return[new Ve(a,_,`unknown property "${v}"`)];let I;if(ii(_)==="string"&&Qs(A)&&!A.tokens&&(I=/^{([^}]+)}$/.exec(_)))return[new Ve(a,_,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const F=[];return r.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&F.push(new Ve(a,_,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&hs(ps(_))&&Li(_.type)==="identity"&&F.push(new Ve(a,_,'"text-font" does not support identity functions'))),F.concat(o({key:r.key,value:_,valueSpec:A,style:h,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:v}))}function pu(r){return Gr(r,"paint")}function Js(r){return Gr(r,"layout")}function qr(r){let t=[];const a=r.value,o=r.key,h=r.style,g=r.styleSpec;if(ii(a)!=="object")return[new Ve(o,a,`object expected, ${ii(a)} found`)];a.type||a.ref||t.push(new Ve(o,a,'either "type" or "ref" is required'));let _=Li(a.type);const v=Li(a.ref);if(a.id){const w=Li(a.id);for(let M=0;M<r.arrayIndex;M++){const A=h.layers[M];Li(A.id)===w&&t.push(new Ve(o,a.id,`duplicate layer id "${a.id}", previously used at line ${A.id.__line__}`))}}if("ref"in a){let w;["type","source","source-layer","filter","layout"].forEach(M=>{M in a&&t.push(new Ve(o,a[M],`"${M}" is prohibited for ref layers`))}),h.layers.forEach(M=>{Li(M.id)===v&&(w=M)}),w?w.ref?t.push(new Ve(o,a.ref,"ref cannot reference another ref layer")):_=Li(w.type):t.push(new Ve(o,a.ref,`ref layer "${v}" not found`))}else if(_!=="background")if(a.source){const w=h.sources&&h.sources[a.source],M=w&&Li(w.type);w?M==="vector"&&_==="raster"?t.push(new Ve(o,a.source,`layer "${a.id}" requires a raster source`)):M!=="raster-dem"&&_==="hillshade"?t.push(new Ve(o,a.source,`layer "${a.id}" requires a raster-dem source`)):M==="raster"&&_!=="raster"?t.push(new Ve(o,a.source,`layer "${a.id}" requires a vector source`)):M!=="vector"||a["source-layer"]?M==="raster-dem"&&_!=="hillshade"?t.push(new Ve(o,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!a.paint||!a.paint["line-gradient"]||M==="geojson"&&w.lineMetrics||t.push(new Ve(o,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ve(o,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new Ve(o,a.source,`source "${a.source}" not found`))}else t.push(new Ve(o,a,'missing required property "source"'));return t=t.concat(Ba({key:o,value:a,valueSpec:g.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${o}.type`,value:a.type,valueSpec:g.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:a,objectKey:"type"}),filter:Tr,layout:w=>Ba({layer:a,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":M=>Js(yi({layerType:_},M))}}),paint:w=>Ba({layer:a,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":M=>pu(yi({layerType:_},M))}})}})),t}function wn(r){const t=r.value,a=r.key,o=ii(t);return o!=="string"?[new Ve(a,t,`string expected, ${o} found`)]:[]}const dr={promoteId:function({key:r,value:t}){if(ii(t)==="string")return wn({key:r,value:t});{const a=[];for(const o in t)a.push(...wn({key:`${r}.${o}`,value:t[o]}));return a}}};function Qn(r){const t=r.value,a=r.key,o=r.styleSpec,h=r.style,g=r.validateSpec;if(!t.type)return[new Ve(a,t,'"type" is required')];const _=Li(t.type);let v;switch(_){case"vector":case"raster":return v=Ba({key:a,value:t,valueSpec:o[`source_${_.replace("-","_")}`],style:r.style,styleSpec:o,objectElementValidators:dr,validateSpec:g}),v;case"raster-dem":return v=function(w){var M;const A=(M=w.sourceName)!==null&&M!==void 0?M:"",I=w.value,F=w.styleSpec,N=F.source_raster_dem,V=w.style;let q=[];const Q=ii(I);if(I===void 0)return q;if(Q!=="object")return q.push(new Ve("source_raster_dem",I,`object expected, ${Q} found`)),q;const ne=Li(I.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],se=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const j in I)!ne&&ye.includes(j)?q.push(new Ve(j,I[j],`In "${A}": "${j}" is only valid when "encoding" is set to "custom". ${se} encoding found`)):N[j]?q=q.concat(w.validateSpec({key:j,value:I[j],valueSpec:N[j],validateSpec:w.validateSpec,style:V,styleSpec:F})):q.push(new Ve(j,I[j],`unknown property "${j}"`));return q}({sourceName:a,value:t,style:r.style,styleSpec:o,validateSpec:g}),v;case"geojson":if(v=Ba({key:a,value:t,valueSpec:o.source_geojson,style:h,styleSpec:o,validateSpec:g,objectElementValidators:dr}),t.cluster)for(const w in t.clusterProperties){const[M,A]=t.clusterProperties[w],I=typeof M=="string"?[M,["accumulated"],["get",w]]:M;v.push(...Oa({key:`${a}.${w}.map`,value:A,expressionContext:"cluster-map"})),v.push(...Oa({key:`${a}.${w}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return v;case"video":return Ba({key:a,value:t,valueSpec:o.source_video,style:h,validateSpec:g,styleSpec:o});case"image":return Ba({key:a,value:t,valueSpec:o.source_image,style:h,validateSpec:g,styleSpec:o});case"canvas":return[new Ve(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return wr({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function bc(r){const t=r.value,a=r.styleSpec,o=a.light,h=r.style;let g=[];const _=ii(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Ve("light",t,`object expected, ${_} found`)]),g;for(const v in t){const w=v.match(/^(.*)-transition$/);g=g.concat(w&&o[w[1]]&&o[w[1]].transition?r.validateSpec({key:v,value:t[v],valueSpec:a.transition,validateSpec:r.validateSpec,style:h,styleSpec:a}):o[v]?r.validateSpec({key:v,value:t[v],valueSpec:o[v],validateSpec:r.validateSpec,style:h,styleSpec:a}):[new Ve(v,t[v],`unknown property "${v}"`)])}return g}function ch(r){const t=r.value,a=r.styleSpec,o=a.sky,h=r.style,g=ii(t);if(t===void 0)return[];if(g!=="object")return[new Ve("sky",t,`object expected, ${g} found`)];let _=[];for(const v in t)_=_.concat(o[v]?r.validateSpec({key:v,value:t[v],valueSpec:o[v],style:h,styleSpec:a}):[new Ve(v,t[v],`unknown property "${v}"`)]);return _}function Il(r){const t=r.value,a=r.styleSpec,o=a.terrain,h=r.style;let g=[];const _=ii(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Ve("terrain",t,`object expected, ${_} found`)]),g;for(const v in t)g=g.concat(o[v]?r.validateSpec({key:v,value:t[v],valueSpec:o[v],validateSpec:r.validateSpec,style:h,styleSpec:a}):[new Ve(v,t[v],`unknown property "${v}"`)]);return g}function uh(r){let t=[];const a=r.value,o=r.key;if(Array.isArray(a)){const h=[],g=[];for(const _ in a)a[_].id&&h.includes(a[_].id)&&t.push(new Ve(o,a,`all the sprites' ids must be unique, but ${a[_].id} is duplicated`)),h.push(a[_].id),a[_].url&&g.includes(a[_].url)&&t.push(new Ve(o,a,`all the sprites' URLs must be unique, but ${a[_].url} is duplicated`)),g.push(a[_].url),t=t.concat(Ba({key:`${o}[${_}]`,value:a[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return wn({key:o,value:a})}function mu(r){return t=r.value,t&&t.constructor===Object?[]:[new Ve(r.key,r.value,`object expected, ${ii(r.value)} found`)];var t}const On={"*":()=>[],array:Vo,boolean:function(r){const t=r.value,a=r.key,o=ii(t);return o!=="boolean"?[new Ve(a,t,`boolean expected, ${o} found`)]:[]},number:ms,color:xc,constants:Uo,enum:wr,filter:Tr,function:fu,layer:qr,object:Ba,source:Qn,light:bc,sky:ch,terrain:Il,projection:function(r){const t=r.value,a=r.styleSpec,o=a.projection,h=r.style,g=ii(t);if(t===void 0)return[];if(g!=="object")return[new Ve("projection",t,`object expected, ${g} found`)];let _=[];for(const v in t)_=_.concat(o[v]?r.validateSpec({key:v,value:t[v],valueSpec:o[v],style:h,styleSpec:a}):[new Ve(v,t[v],`unknown property "${v}"`)]);return _},projectionDefinition:function(r){const t=r.key;let a=r.value;a=a instanceof String?a.valueOf():a;const o=ii(a);return o!=="array"||function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"}(a)||function(h){return!!["interpolate","step","literal"].includes(h[0])}(a)?["array","string"].includes(o)?[]:[new Ve(t,a,`projection expected, invalid type "${o}" found`)]:[new Ve(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:wn,formatted:function(r){return wn(r).length===0?[]:Oa(r)},resolvedImage:function(r){return wn(r).length===0?[]:Oa(r)},padding:function(r){const t=r.key,a=r.value;if(ii(a)==="array"){if(a.length<1||a.length>4)return[new Ve(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const o={type:"number"};let h=[];for(let g=0;g<a.length;g++)h=h.concat(r.validateSpec({key:`${t}[${g}]`,value:a[g],validateSpec:r.validateSpec,valueSpec:o}));return h}return ms({key:t,value:a,valueSpec:{}})},numberArray:function(r){const t=r.key,a=r.value;if(ii(a)==="array"){const o={type:"number"};if(a.length<1)return[new Ve(t,a,"array length at least 1 expected, length 0 found")];let h=[];for(let g=0;g<a.length;g++)h=h.concat(r.validateSpec({key:`${t}[${g}]`,value:a[g],validateSpec:r.validateSpec,valueSpec:o}));return h}return ms({key:t,value:a,valueSpec:{}})},colorArray:function(r){const t=r.key,a=r.value;if(ii(a)==="array"){if(a.length<1)return[new Ve(t,a,"array length at least 1 expected, length 0 found")];let o=[];for(let h=0;h<a.length;h++)o=o.concat(xc({key:`${t}[${h}]`,value:a[h]}));return o}return xc({key:t,value:a})},variableAnchorOffsetCollection:function(r){const t=r.key,a=r.value,o=ii(a),h=r.styleSpec;if(o!=="array"||a.length<1||a.length%2!=0)return[new Ve(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<a.length;_+=2)g=g.concat(wr({key:`${t}[${_}]`,value:a[_],valueSpec:h.layout_symbol["text-anchor"]})),g=g.concat(Vo({key:`${t}[${_+1}]`,value:a[_+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:h}));return g},sprite:uh,state:mu};function eo(r){const t=r.value,a=r.valueSpec,o=r.styleSpec;return r.validateSpec=eo,a.expression&&hs(Li(t))?fu(r):a.expression&&jo(ps(t))?Oa(r):a.type&&On[a.type]?On[a.type](r):Ba(yi({},r,{valueSpec:a.type?o[a.type]:a}))}function Rl(r){const t=r.value,a=r.key,o=wn(r);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new Ve(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new Ve(a,t,'"glyphs" url must include a "{range}" token'))),o}function Fn(r,t=W){let a=[];return a=a.concat(eo({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:eo,objectElementValidators:{glyphs:Rl,"*":()=>[]}})),r.constants&&(a=a.concat(Uo({key:"constants",value:r.constants}))),Sr(a)}function Ka(r){return function(t){return r({...t,validateSpec:eo})}}function Sr(r){return[].concat(r).sort((t,a)=>t.line-a.line)}function da(r){return function(...t){return Sr(r.apply(this,t))}}Fn.source=da(Ka(Qn)),Fn.sprite=da(Ka(uh)),Fn.glyphs=da(Ka(Rl)),Fn.light=da(Ka(bc)),Fn.sky=da(Ka(ch)),Fn.terrain=da(Ka(Il)),Fn.state=da(Ka(mu)),Fn.layer=da(Ka(qr)),Fn.filter=da(Ka(Tr)),Fn.paintProperty=da(Ka(pu)),Fn.layoutProperty=da(Ka(Js));const kl=Fn,wc=kl.light,af=kl.sky,gu=kl.paintProperty,Hr=kl.layoutProperty;function Tc(r,t){let a=!1;if(t&&t.length)for(const o of t)r.fire(new ce(new Error(o.message))),a=!0;return a}class _s{constructor(t,a,o){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(a=_[1])+2*(o=_[2]);for(let w=0;w<this.d*this.d;w++){const M=_[3+w],A=_[3+w+1];h.push(M===A?null:_.subarray(M,A))}const v=_[3+h.length+1];this.keys=_.subarray(_[3+h.length],v),this.bboxes=_.subarray(v),this.insert=this._insertReadonly}else{this.d=a+2*o;for(let _=0;_<this.d*this.d;_++)h.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=o,this.scale=a/t,this.uid=0;const g=o/a*t;this.min=-g,this.max=t+g}insert(t,a,o,h,g){this._forEachCell(a,o,h,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,o,h,g,_){this.cells[g].push(_)}query(t,a,o,h,g){const _=this.min,v=this.max;if(t<=_&&a<=_&&v<=o&&v<=h&&!g)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(t,a,o,h,this._queryCell,w,{},g),w}}_queryCell(t,a,o,h,g,_,v,w){const M=this.cells[g];if(M!==null){const A=this.keys,I=this.bboxes;for(let F=0;F<M.length;F++){const N=M[F];if(v[N]===void 0){const V=4*N;(w?w(I[V+0],I[V+1],I[V+2],I[V+3]):t<=I[V+2]&&a<=I[V+3]&&o>=I[V+0]&&h>=I[V+1])?(v[N]=!0,_.push(A[N])):v[N]=!1}}}}_forEachCell(t,a,o,h,g,_,v,w){const M=this._convertToCellCoord(t),A=this._convertToCellCoord(a),I=this._convertToCellCoord(o),F=this._convertToCellCoord(h);for(let N=M;N<=I;N++)for(let V=A;V<=F;V++){const q=this.d*V+N;if((!w||w(this._convertFromCellCoord(N),this._convertFromCellCoord(V),this._convertFromCellCoord(N+1),this._convertFromCellCoord(V+1)))&&g.call(this,t,a,o,h,q,_,v,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let o=0;for(let _=0;_<this.cells.length;_++)o+=this.cells[_].length;const h=new Int32Array(a+o+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let g=a;for(let _=0;_<t.length;_++){const v=t[_];h[3+_]=g,h.set(v,g),g+=v.length}return h[3+t.length]=g,h.set(this.keys,g),g+=this.keys.length,h[3+t.length+1]=g,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer}static serialize(t,a){const o=t.toArrayBuffer();return a&&a.push(o),{buffer:o}}static deserialize(t){return new _s(t.buffer)}}const Mr={};function vt(r,t,a={}){if(Mr[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Mr[r]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}vt("Object",Object),vt("TransferableGridIndex",_s),vt("Color",hi),vt("Error",Error),vt("AJAXError",sr),vt("ResolvedImage",wa),vt("StylePropertyFunction",ca),vt("StyleExpression",zl,{omit:["_evaluator"]}),vt("ZoomDependentExpression",No),vt("ZoomConstantExpression",Ws),vt("CompoundExpression",$a,{omit:["_evaluate"]});for(const r in Cl)Cl[r]._classRegistryKey||vt(`Expression_${r}`,Cl[r]);function Sc(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Zo(r){return r.$name||r.constructor._classRegistryKey}function _u(r){return!function(t){if(t===null||typeof t!="object")return!1;const a=Zo(t);return!(!a||a==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Sc(r)||An(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function Go(r,t){if(_u(r))return(Sc(r)||An(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const g=[];for(const _ of r)g.push(Go(_,t));return g}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const a=Zo(r);if(!a)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Mr[a])throw new Error(`${a} is not registered.`);const{klass:o}=Mr[a],h=o.serialize?o.serialize(r,t):{};if(o.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in r){if(!r.hasOwnProperty(g)||Mr[a].omit.indexOf(g)>=0)continue;const _=r[g];h[g]=Mr[a].shallow.indexOf(g)>=0?_:Go(_,t)}r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}function to(r){if(_u(r))return r;if(Array.isArray(r))return r.map(to);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=Zo(r)||"Object";if(!Mr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=Mr[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(r);const o=Object.create(a.prototype);for(const h of Object.keys(r)){if(h==="$name")continue;const g=r[h];o[h]=Mr[t].shallow.indexOf(h)>=0?g:to(g)}return o}class yu{constructor(){this.first=!0}update(t,a){const o=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=o,!0))}}const ti={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Hangul Syllables":r=>r>=44032&&r<=55215,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Mc(r){for(const t of r)if(Er(t.charCodeAt(0)))return!0;return!1}function Wh(r){for(const t of r)if(!xu(t.charCodeAt(0)))return!1;return!0}function $r(r){const t=r.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const vu=$r(["Arab","Dupl","Mong","Ougr","Syrc"]);function xu(r){return!vu.test(String.fromCodePoint(r))}const Xr=$r(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Er(r){return!(r!==746&&r!==747&&(r<4352||!(ti["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||ti["CJK Compatibility"](r)||ti["CJK Strokes"](r)||!(!ti["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||ti["Enclosed CJK Letters and Months"](r)||ti["Ideographic Description Characters"](r)||ti.Kanbun(r)||ti.Katakana(r)&&r!==12540||!(!ti["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!ti["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||ti["Vertical Forms"](r)||ti["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||Xr.test(String.fromCodePoint(r)))))}function ys(r){return!(Er(r)||function(t){return!!(ti["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ti["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ti["Letterlike Symbols"](t)||ti["Number Forms"](t)||ti["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ti["Control Pictures"](t)&&t!==9251||ti["Optical Character Recognition"](t)||ti["Enclosed Alphanumerics"](t)||ti["Geometric Shapes"](t)||ti["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ti["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ti["CJK Symbols and Punctuation"](t)||ti.Katakana(t)||ti["Private Use Area"](t)||ti["CJK Compatibility Forms"](t)||ti["Small Form Variants"](t)||ti["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}const hh=$r(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Ll(r){return hh.test(String.fromCodePoint(r))}function Ec(r,t){return!(!t&&Ll(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||ti.Khmer(r))}function Cc(r){for(const t of r)if(Ll(t.charCodeAt(0)))return!0;return!1}const Yr=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(Yr.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,t){return d(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const a=r.pluginURL,o=new Promise(g=>{this.loadScriptResolve=g});t(a);const h=new Promise(g=>setTimeout(()=>g(),this.TIMEOUT));if(yield Promise.race([o,h]),this.isParsed()){const g={pluginStatus:"loaded",pluginURL:a};return this.setState(g),g}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class Ui{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yu,this.transition={})}isSupportedScript(t){return function(a,o){for(const h of a)if(!Ec(h.charCodeAt(0),o))return!1;return!0}(t,Yr.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),o=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*a}}}class Kr{constructor(t,a){this.property=t,this.value=a,this.expression=function(o,h){if(hs(o))return new ca(o,h);if(jo(o)){const g=Pl(o,h);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=o;return h.type==="color"&&typeof o=="string"?g=hi.parse(o):h.type!=="padding"||typeof o!="number"&&!Array.isArray(o)?h.type!=="numberArray"||typeof o!="number"&&!Array.isArray(o)?h.type!=="colorArray"||typeof o!="string"&&!Array.isArray(o)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(o)?g=dn.parse(o):h.type==="projectionDefinition"&&typeof o=="string"&&(g=Xn.parse(o)):g=Un.parse(o):g=xn.parse(o):g=vn.parse(o),{kind:"constant",evaluate:()=>g}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,o){return this.property.possiblyEvaluate(this,t,a,o)}}class Bl{constructor(t){this.property=t,this.value=new Kr(t,void 0)}transitioned(t,a){return new bu(this.property,this.value,a,fi({},t.transition,this.transition),t.now)}untransitioned(){return new bu(this.property,this.value,null,{},0)}}class dh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Ii(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Bl(this._values[t].property)),this._values[t].value=new Kr(this._values[t].property,a===null?void 0:Ii(a))}getTransition(t){return Ii(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Bl(this._values[t].property)),this._values[t].transition=Ii(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const o=this.getValue(a);o!==void 0&&(t[a]=o);const h=this.getTransition(a);h!==void 0&&(t[`${a}-transition`]=h)}return t}transitioned(t,a){const o=new wu(this._properties);for(const h of Object.keys(this._values))o._values[h]=this._values[h].transitioned(t,a._values[h]);return o}untransitioned(){const t=new wu(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class bu{constructor(t,a,o,h,g){this.property=t,this.value=a,this.begin=g+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=o)}possiblyEvaluate(t,a,o){const h=t.now||0,g=this.value.possiblyEvaluate(t,a,o),_=this.prior;if(_){if(h>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(h<this.begin)return _.possiblyEvaluate(t,a,o);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,a,o),g,ot(v))}}return g}}class wu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,o){const h=new Ei(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(t,a,o);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class io{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Ii(this._values[t].value)}setValue(t,a){this._values[t]=new Kr(this._values[t].property,a===null?void 0:Ii(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const o=this.getValue(a);o!==void 0&&(t[a]=o)}return t}possiblyEvaluate(t,a,o){const h=new Ei(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(t,a,o);return h}}class Gt{constructor(t,a,o){this.property=t,this.value=a,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,o,h){return this.property.evaluate(this.value,this.parameters,t,a,o,h)}}class Ei{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class gt{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,o){const h=Fr[this.specification.type];return h?h(t,a,o):t}}class jt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,o,h){return new Gt(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},o,h)}:t.expression,a)}interpolate(t,a,o){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new Gt(this,{kind:"constant",value:void 0},t.parameters);const h=Fr[this.specification.type];if(h){const g=h(t.value.value,a.value.value,o);return new Gt(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,a,o,h,g,_){return t.kind==="constant"?t.value:t.evaluate(a,o,h,g,_)}}class Qr extends jt{possiblyEvaluate(t,a,o,h){if(t.value===void 0)return new Gt(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const g=t.expression.evaluate(a,null,{},o,h),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,v=this._calculate(_,_,_,a);return new Gt(this,{kind:"constant",value:v},a)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new Gt(this,{kind:"constant",value:g},a)}return new Gt(this,t.expression,a)}evaluate(t,a,o,h,g,_){if(t.kind==="source"){const v=t.evaluate(a,o,h,g,_);return this._calculate(v,v,v,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},o,h),t.evaluate({zoom:Math.floor(a.zoom)},o,h),t.evaluate({zoom:Math.floor(a.zoom)+1},o,h),a):t.value}_calculate(t,a,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:o,to:a}}interpolate(t){return t}}class vs{constructor(t){this.specification=t}possiblyEvaluate(t,a,o,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(a,null,{},o,h);return this._calculate(g,g,g,a)}return this._calculate(t.expression.evaluate(new Ui(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Ui(Math.floor(a.zoom),a)),t.expression.evaluate(new Ui(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:o,to:a}}interpolate(t){return t}}class Ol{constructor(t){this.specification=t}possiblyEvaluate(t,a,o,h){return!!t.expression.evaluate(a,null,{},o,h)}interpolate(){return!1}}class on{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const o=t[a];o.specification.overridable&&this.overridableProperties.push(a);const h=this.defaultPropertyValues[a]=new Kr(o,void 0),g=this.defaultTransitionablePropertyValues[a]=new Bl(o);this.defaultTransitioningPropertyValues[a]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=h.possiblyEvaluate({})}}}vt("DataDrivenProperty",jt),vt("DataConstantProperty",gt),vt("CrossFadedDataDrivenProperty",Qr),vt("CrossFadedProperty",vs),vt("ColorRampProperty",Ol);const no="-transition";class fr extends ve{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new io(a.layout)),a.paint)){this._transitionablePaint=new dh(a.paint);for(const o in t.paint)this.setPaintProperty(o,t.paint[o],{validate:!1});for(const o in t.layout)this.setLayoutProperty(o,t.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ei(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,o={}){a!=null&&this._validate(Hr,`layers.${this.id}.layout.${t}`,t,a,o)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(no)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,o={}){if(a!=null&&this._validate(gu,`layers.${this.id}.paint.${t}`,t,a,o))return!1;if(t.endsWith(no))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const h=this._transitionablePaint._values[t],g=h.property.specification["property-type"]==="cross-faded-data-driven",_=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const w=this._transitionablePaint._values[t].value;return w.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,v,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,o){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),rn(t,(a,o)=>!(a===void 0||o==="layout"&&!Object.keys(a).length||o==="paint"&&!Object.keys(a).length))}_validate(t,a,o,h,g={}){return(!g||g.validate!==!1)&&Tc(this,t.call(kl,{key:a,layerType:this.type,objectKey:o,value:h,styleSpec:W,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof Gt&&Qs(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Tn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xs{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Wi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ji(r,t=1){let a=0,o=0;return{members:r.map(h=>{const g=Tn[h.type].BYTES_PER_ELEMENT,_=a=qo(a,Math.max(t,g)),v=h.components||1;return o=Math.max(o,g),a+=g*v,{name:h.name,type:h.type,components:v,offset:_}}),size:qo(a,Math.max(o,t)),alignment:t}}function qo(r,t){return Math.ceil(r/t)*t}class Ac extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,a)}emplace(t,a,o){const h=2*t;return this.int16[h+0]=a,this.int16[h+1]=o,t}}Ac.prototype.bytesPerElement=4,vt("StructArrayLayout2i4",Ac);class Ho extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,a,o)}emplace(t,a,o,h){const g=3*t;return this.int16[g+0]=a,this.int16[g+1]=o,this.int16[g+2]=h,t}}Ho.prototype.bytesPerElement=6,vt("StructArrayLayout3i6",Ho);class bs extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,o,h)}emplace(t,a,o,h,g){const _=4*t;return this.int16[_+0]=a,this.int16[_+1]=o,this.int16[_+2]=h,this.int16[_+3]=g,t}}bs.prototype.bytesPerElement=8,vt("StructArrayLayout4i8",bs);class zc extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,o,h,g,_)}emplace(t,a,o,h,g,_,v){const w=6*t;return this.int16[w+0]=a,this.int16[w+1]=o,this.int16[w+2]=h,this.int16[w+3]=g,this.int16[w+4]=_,this.int16[w+5]=v,t}}zc.prototype.bytesPerElement=12,vt("StructArrayLayout2i4i12",zc);class fa extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,o,h,g,_)}emplace(t,a,o,h,g,_,v){const w=4*t,M=8*t;return this.int16[w+0]=a,this.int16[w+1]=o,this.uint8[M+4]=h,this.uint8[M+5]=g,this.uint8[M+6]=_,this.uint8[M+7]=v,t}}fa.prototype.bytesPerElement=8,vt("StructArrayLayout2i4ub8",fa);class en extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,a)}emplace(t,a,o){const h=2*t;return this.float32[h+0]=a,this.float32[h+1]=o,t}}en.prototype.bytesPerElement=8,vt("StructArrayLayout2f8",en);class Pc extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_,v,w,M,A){const I=this.length;return this.resize(I+1),this.emplace(I,t,a,o,h,g,_,v,w,M,A)}emplace(t,a,o,h,g,_,v,w,M,A,I){const F=10*t;return this.uint16[F+0]=a,this.uint16[F+1]=o,this.uint16[F+2]=h,this.uint16[F+3]=g,this.uint16[F+4]=_,this.uint16[F+5]=v,this.uint16[F+6]=w,this.uint16[F+7]=M,this.uint16[F+8]=A,this.uint16[F+9]=I,t}}Pc.prototype.bytesPerElement=20,vt("StructArrayLayout10ui20",Pc);class f extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_,v,w,M,A,I,F){const N=this.length;return this.resize(N+1),this.emplace(N,t,a,o,h,g,_,v,w,M,A,I,F)}emplace(t,a,o,h,g,_,v,w,M,A,I,F,N){const V=12*t;return this.int16[V+0]=a,this.int16[V+1]=o,this.int16[V+2]=h,this.int16[V+3]=g,this.uint16[V+4]=_,this.uint16[V+5]=v,this.uint16[V+6]=w,this.uint16[V+7]=M,this.int16[V+8]=A,this.int16[V+9]=I,this.int16[V+10]=F,this.int16[V+11]=N,t}}f.prototype.bytesPerElement=24,vt("StructArrayLayout4i4ui4i24",f);class e extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,a,o)}emplace(t,a,o,h){const g=3*t;return this.float32[g+0]=a,this.float32[g+1]=o,this.float32[g+2]=h,t}}e.prototype.bytesPerElement=12,vt("StructArrayLayout3f12",e);class n extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}n.prototype.bytesPerElement=4,vt("StructArrayLayout1ul4",n);class l extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_,v,w,M){const A=this.length;return this.resize(A+1),this.emplace(A,t,a,o,h,g,_,v,w,M)}emplace(t,a,o,h,g,_,v,w,M,A){const I=10*t,F=5*t;return this.int16[I+0]=a,this.int16[I+1]=o,this.int16[I+2]=h,this.int16[I+3]=g,this.int16[I+4]=_,this.int16[I+5]=v,this.uint32[F+3]=w,this.uint16[I+8]=M,this.uint16[I+9]=A,t}}l.prototype.bytesPerElement=20,vt("StructArrayLayout6i1ul2ui20",l);class u extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,o,h,g,_)}emplace(t,a,o,h,g,_,v){const w=6*t;return this.int16[w+0]=a,this.int16[w+1]=o,this.int16[w+2]=h,this.int16[w+3]=g,this.int16[w+4]=_,this.int16[w+5]=v,t}}u.prototype.bytesPerElement=12,vt("StructArrayLayout2i2i2i12",u);class m extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,o,h,g)}emplace(t,a,o,h,g,_){const v=4*t,w=8*t;return this.float32[v+0]=a,this.float32[v+1]=o,this.float32[v+2]=h,this.int16[w+6]=g,this.int16[w+7]=_,t}}m.prototype.bytesPerElement=16,vt("StructArrayLayout2f1f2i16",m);class y extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,o,h,g,_)}emplace(t,a,o,h,g,_,v){const w=16*t,M=4*t,A=8*t;return this.uint8[w+0]=a,this.uint8[w+1]=o,this.float32[M+1]=h,this.float32[M+2]=g,this.int16[A+6]=_,this.int16[A+7]=v,t}}y.prototype.bytesPerElement=16,vt("StructArrayLayout2ub2f2i16",y);class b extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,a,o)}emplace(t,a,o,h){const g=3*t;return this.uint16[g+0]=a,this.uint16[g+1]=o,this.uint16[g+2]=h,t}}b.prototype.bytesPerElement=6,vt("StructArrayLayout3ui6",b);class T extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne){const ye=this.length;return this.resize(ye+1),this.emplace(ye,t,a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne)}emplace(t,a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne,ye){const se=24*t,j=12*t,K=48*t;return this.int16[se+0]=a,this.int16[se+1]=o,this.uint16[se+2]=h,this.uint16[se+3]=g,this.uint32[j+2]=_,this.uint32[j+3]=v,this.uint32[j+4]=w,this.uint16[se+10]=M,this.uint16[se+11]=A,this.uint16[se+12]=I,this.float32[j+7]=F,this.float32[j+8]=N,this.uint8[K+36]=V,this.uint8[K+37]=q,this.uint8[K+38]=Q,this.uint32[j+10]=ne,this.int16[se+22]=ye,t}}T.prototype.bytesPerElement=48,vt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",T);class C extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne,ye,se,j,K,ue,Re,tt,Oe,He,rt,nt){const lt=this.length;return this.resize(lt+1),this.emplace(lt,t,a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne,ye,se,j,K,ue,Re,tt,Oe,He,rt,nt)}emplace(t,a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne,ye,se,j,K,ue,Re,tt,Oe,He,rt,nt,lt){const Xe=32*t,wt=16*t;return this.int16[Xe+0]=a,this.int16[Xe+1]=o,this.int16[Xe+2]=h,this.int16[Xe+3]=g,this.int16[Xe+4]=_,this.int16[Xe+5]=v,this.int16[Xe+6]=w,this.int16[Xe+7]=M,this.uint16[Xe+8]=A,this.uint16[Xe+9]=I,this.uint16[Xe+10]=F,this.uint16[Xe+11]=N,this.uint16[Xe+12]=V,this.uint16[Xe+13]=q,this.uint16[Xe+14]=Q,this.uint16[Xe+15]=ne,this.uint16[Xe+16]=ye,this.uint16[Xe+17]=se,this.uint16[Xe+18]=j,this.uint16[Xe+19]=K,this.uint16[Xe+20]=ue,this.uint16[Xe+21]=Re,this.uint16[Xe+22]=tt,this.uint32[wt+12]=Oe,this.float32[wt+13]=He,this.float32[wt+14]=rt,this.uint16[Xe+30]=nt,this.uint16[Xe+31]=lt,t}}C.prototype.bytesPerElement=64,vt("StructArrayLayout8i15ui1ul2f2ui64",C);class z extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}z.prototype.bytesPerElement=4,vt("StructArrayLayout1f4",z);class B extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,a,o)}emplace(t,a,o,h){const g=3*t;return this.uint16[6*t+0]=a,this.float32[g+1]=o,this.float32[g+2]=h,t}}B.prototype.bytesPerElement=12,vt("StructArrayLayout1ui2f12",B);class k extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,a,o)}emplace(t,a,o,h){const g=4*t;return this.uint32[2*t+0]=a,this.uint16[g+2]=o,this.uint16[g+3]=h,t}}k.prototype.bytesPerElement=8,vt("StructArrayLayout1ul2ui8",k);class Z extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,a)}emplace(t,a,o){const h=2*t;return this.uint16[h+0]=a,this.uint16[h+1]=o,t}}Z.prototype.bytesPerElement=4,vt("StructArrayLayout2ui4",Z);class G extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}G.prototype.bytesPerElement=2,vt("StructArrayLayout1ui2",G);class te extends Wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,o,h)}emplace(t,a,o,h,g){const _=4*t;return this.float32[_+0]=a,this.float32[_+1]=o,this.float32[_+2]=h,this.float32[_+3]=g,t}}te.prototype.bytesPerElement=16,vt("StructArrayLayout4f16",te);class ee extends xs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Pe(this.anchorPointX,this.anchorPointY)}}ee.prototype.size=20;class ie extends l{get(t){return new ee(this,t)}}vt("CollisionBoxArray",ie);class oe extends xs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}oe.prototype.size=48;class de extends T{get(t){return new oe(this,t)}}vt("PlacedSymbolArray",de);class he extends xs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}he.prototype.size=64;class me extends C{get(t){return new he(this,t)}}vt("SymbolInstanceArray",me);class xe extends z{getoffsetX(t){return this.float32[1*t+0]}}vt("GlyphOffsetArray",xe);class _e extends Ho{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}vt("SymbolLineVertexArray",_e);class Ie extends xs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ie.prototype.size=12;class $e extends B{get(t){return new Ie(this,t)}}vt("TextAnchorOffsetArray",$e);class je extends xs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}je.prototype.size=8;class Fe extends k{get(t){return new je(this,t)}}vt("FeatureIndexArray",Fe);class Ze extends Ac{}class dt extends Ac{}class ut extends Ac{}class et extends zc{}class Mt extends fa{}class ei extends en{}class oi extends Pc{}class tn extends f{}class Pi extends e{}class nn extends n{}class Hi extends u{}class Bi extends y{}class bi extends b{}class Pn extends Z{}const Vn=Ji([{name:"a_pos",components:2,type:"Int16"}],4),{members:Wn}=Vn;class Ti{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,o,h){const g=this.segments[this.segments.length-1];return t>Ti.MAX_VERTEX_ARRAY_LENGTH&&Qi(`Max vertices per segment is ${Ti.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ti.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!g||g.vertexLength+t>Ti.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==h?this.createNewSegment(a,o,h):g}createNewSegment(t,a,o){const h={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(h.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,a,o){return this.prepareSegment(0,t,a,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,o,h){return new Ti([{vertexOffset:t,primitiveOffset:a,vertexLength:o,primitiveLength:h,vaos:{},sortKey:0}])}}function Wr(r,t){return 256*(r=At(Math.floor(r),0,255))+At(Math.floor(t),0,255)}Ti.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vt("SegmentVector",Ti);const Cr=Ji([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ws,Ts,Fl,Ss={exports:{}},$o={exports:{}},Qa={exports:{}},Ms=function(){if(Fl)return Ss.exports;Fl=1;var r=(ws||(ws=1,$o.exports=function(a,o){var h,g,_,v,w,M,A,I;for(g=a.length-(h=3&a.length),_=o,w=3432918353,M=461845907,I=0;I<g;)A=255&a.charCodeAt(I)|(255&a.charCodeAt(++I))<<8|(255&a.charCodeAt(++I))<<16|(255&a.charCodeAt(++I))<<24,++I,_=27492+(65535&(v=5*(65535&(_=(_^=A=(65535&(A=(A=(65535&A)*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*M+(((A>>>16)*M&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(A=0,h){case 3:A^=(255&a.charCodeAt(I+2))<<16;case 2:A^=(255&a.charCodeAt(I+1))<<8;case 1:_^=A=(65535&(A=(A=(65535&(A^=255&a.charCodeAt(I)))*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*M+(((A>>>16)*M&65535)<<16)&4294967295}return _^=a.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),$o.exports),t=(Ts||(Ts=1,Qa.exports=function(a,o){for(var h,g=a.length,_=o^g,v=0;g>=4;)h=1540483477*(65535&(h=255&a.charCodeAt(v)|(255&a.charCodeAt(++v))<<8|(255&a.charCodeAt(++v))<<16|(255&a.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),g-=4,++v;switch(g){case 3:_^=(255&a.charCodeAt(v+2))<<16;case 2:_^=(255&a.charCodeAt(v+1))<<8;case 1:_=1540483477*(65535&(_^=255&a.charCodeAt(v)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),Qa.exports);return Ss.exports=r,Ss.exports.murmur3=r,Ss.exports.murmur2=t,Ss.exports}(),Wa=ge(Ms);class Jr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,o,h){this.ids.push(pn(t)),this.positions.push(a,o,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=pn(t);let o=0,h=this.ids.length-1;for(;o<h;){const _=o+h>>1;this.ids[_]>=a?h=_:o=_+1}const g=[];for(;this.ids[o]===a;)g.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return g}static serialize(t,a){const o=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Dn(o,h,0,o.length-1),a&&a.push(o.buffer,h.buffer),{ids:o,positions:h}}static deserialize(t){const a=new Jr;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function pn(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Wa(String(r))}function Dn(r,t,a,o){for(;a<o;){const h=r[a+o>>1];let g=a-1,_=o+1;for(;;){do g++;while(r[g]<h);do _--;while(r[_]>h);if(g>=_)break;pa(r,g,_),pa(t,3*g,3*_),pa(t,3*g+1,3*_+1),pa(t,3*g+2,3*_+2)}_-a<o-_?(Dn(r,t,a,_),a=_+1):(Dn(r,t,_+1,o),o=_)}}function pa(r,t,a){const o=r[t];r[t]=r[a],r[a]=o}vt("FeaturePositionMap",Jr);class Di{constructor(t,a){this.gl=t.gl,this.location=a}}class Dc extends Di{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class fh extends Di{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Jh extends Di{constructor(t,a){super(t,a),this.current=hi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const jl=new Float32Array(16);function Xo(r){return[Wr(255*r.r,255*r.g),Wr(255*r.b,255*r.a)]}class ao{constructor(t,a,o){this.value=t,this.uniformNames=a.map(h=>`u_${h}`),this.type=o}setUniform(t,a,o){t.set(o.constantOr(this.value))}getBinding(t,a,o){return this.type==="color"?new Jh(t,a):new Dc(t,a)}}class ma{constructor(t,a){this.uniformNames=a.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,o,h){const g=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,a,o){return o.substr(0,9)==="u_pattern"?new fh(t,a):new Dc(t,a)}}class Ja{constructor(t,a,o,h){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,a,o,h,g){const _=this.paintVertexArray.length,v=this.expression.evaluate(new Ui(0),a,{},h,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,v)}updatePaintArray(t,a,o,h){const g=this.expression.evaluate({zoom:0},o,h);this._setPaintValue(t,a,g)}_setPaintValue(t,a,o){if(this.type==="color"){const h=Xo(o);for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=t;h<a;h++)this.paintVertexArray.emplace(h,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class er{constructor(t,a,o,h,g,_){this.expression=t,this.uniformNames=a.map(v=>`u_${v}_t`),this.type=o,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,a,o,h,g){const _=this.expression.evaluate(new Ui(this.zoom),a,{},h,[],g),v=this.expression.evaluate(new Ui(this.zoom+1),a,{},h,[],g),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,_,v)}updatePaintArray(t,a,o,h){const g=this.expression.evaluate({zoom:this.zoom},o,h),_=this.expression.evaluate({zoom:this.zoom+1},o,h);this._setPaintValue(t,a,g,_)}_setPaintValue(t,a,o,h){if(this.type==="color"){const g=Xo(o),_=Xo(h);for(let v=t;v<a;v++)this.paintVertexArray.emplace(v,g[0],g[1],_[0],_[1])}else{for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,o,h);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const o=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,h=At(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,a,o){return new Dc(t,a)}}class es{constructor(t,a,o,h,g,_){this.expression=t,this.type=a,this.useIntegerZoom=o,this.zoom=h,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,a,o){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,a.patterns&&a.patterns[this.layerId],o)}updatePaintArray(t,a,o,h,g){this._setPaintValues(t,a,o.patterns&&o.patterns[this.layerId],g)}_setPaintValues(t,a,o,h){if(!h||!o)return;const{min:g,mid:_,max:v}=o,w=h[g],M=h[_],A=h[v];if(w&&M&&A)for(let I=t;I<a;I++)this.zoomInPaintVertexArray.emplace(I,M.tl[0],M.tl[1],M.br[0],M.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],M.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,M.tl[0],M.tl[1],M.br[0],M.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],M.pixelRatio,A.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Cr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Cr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Es{constructor(t,a,o){this.binders={},this._buffers=[];const h=[];for(const g in t.paint._values){if(!o(g))continue;const _=t.paint.get(g);if(!(_ instanceof Gt&&Qs(_.property.specification)))continue;const v=Fa(g,t.type),w=_.value,M=_.property.specification.type,A=_.property.useIntegerZoom,I=_.property.specification["property-type"],F=I==="cross-faded"||I==="cross-faded-data-driven";if(w.kind==="constant")this.binders[g]=F?new ma(w.value,v):new ao(w.value,v,M),h.push(`/u_${g}`);else if(w.kind==="source"||F){const N=As(g,M,"source");this.binders[g]=F?new es(w,M,A,a,N,t.id):new Ja(w,v,M,N),h.push(`/a_${g}`)}else{const N=As(g,M,"composite");this.binders[g]=new er(w,v,M,A,a,N),h.push(`/z_${g}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof Ja||a instanceof er?a.maxValue:0}populatePaintArrays(t,a,o,h,g){for(const _ in this.binders){const v=this.binders[_];(v instanceof Ja||v instanceof er||v instanceof es)&&v.populatePaintArray(t,a,o,h,g)}}setConstantPatternPositions(t,a){for(const o in this.binders){const h=this.binders[o];h instanceof ma&&h.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,o,h,g){let _=!1;for(const v in t){const w=a.getPositions(v);for(const M of w){const A=o.feature(M.index);for(const I in this.binders){const F=this.binders[I];if((F instanceof Ja||F instanceof er||F instanceof es)&&F.expression.isStateDependent===!0){const N=h.paint.get(I);F.expression=N.value,F.updatePaintArray(M.start,M.end,A,t[v],g),_=!0}}}}return _}defines(){const t=[];for(const a in this.binders){const o=this.binders[a];(o instanceof ao||o instanceof ma)&&t.push(...o.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const o=this.binders[a];if(o instanceof Ja||o instanceof er)for(let h=0;h<o.paintVertexAttributes.length;h++)t.push(o.paintVertexAttributes[h].name);else if(o instanceof es)for(let h=0;h<Cr.members.length;h++)t.push(Cr.members[h].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const o=this.binders[a];if(o instanceof ao||o instanceof ma||o instanceof er)for(const h of o.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof ao||g instanceof ma||g instanceof er){for(const _ of g.uniformNames)if(a[_]){const v=g.getBinding(t,a[_],_);o.push({name:_,property:h,binding:v})}}}return o}setUniforms(t,a,o,h){for(const{name:g,property:_,binding:v}of a)this.binders[_].setUniform(v,h,o.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const o=this.binders[a];if(t&&o instanceof es){const h=t.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(o instanceof Ja||o instanceof er)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const a in this.binders){const o=this.binders[a];(o instanceof Ja||o instanceof er||o instanceof es)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof Ja||a instanceof er||a instanceof es)&&a.destroy()}}}class Cs{constructor(t,a,o=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Es(h,a,o);this.needsUpload=!1,this._featureMap=new Jr,this._bufferOffset=0}populatePaintArrays(t,a,o,h,g,_){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,a,h,g,_);a.id!==void 0&&this._featureMap.add(a.id,o,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,o,h){for(const g of o)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,a,g,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Fa(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function As(r,t,a){const o={color:{source:en,composite:te},number:{source:z,composite:en}},h=function(g){return{"line-pattern":{source:oi,composite:oi},"fill-pattern":{source:oi,composite:oi},"fill-extrusion-pattern":{source:oi,composite:oi}}[g]}(r);return h&&h[a]||o[t][a]}vt("ConstantBinder",ao),vt("CrossFadedConstantBinder",ma),vt("SourceExpressionBinder",Ja),vt("CrossFadedCompositeBinder",es),vt("CompositeExpressionBinder",er),vt("ProgramConfiguration",Es,{omit:["_buffers"]}),vt("ProgramConfigurationSet",Cs);const ro=Math.pow(2,14)-1,rf=-ro-1;function pr(r){const t=Ge/r.extent,a=r.loadGeometry();for(let o=0;o<a.length;o++){const h=a[o];for(let g=0;g<h.length;g++){const _=h[g],v=Math.round(_.x*t),w=Math.round(_.y*t);_.x=At(v,rf,ro),_.y=At(w,rf,ro),(v<_.x||v>_.x+1||w<_.y||w>_.y+1)&&Qi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function tr(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?pr(r):[]}}const Jn=-32768;function ed(r,t,a,o,h){r.emplaceBack(Jn+8*t+o,Jn+8*a+h)}class ph{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new dt,this.indexArray=new bi,this.segments=new Ti,this.programConfigurations=new Cs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,o){const h=this.layers[0],g=[];let _=null,v=!1,w=h.type==="heatmap";if(h.type==="circle"){const A=h;_=A.layout.get("circle-sort-key"),v=!_.isConstant(),w=w||A.paint.get("circle-pitch-alignment")==="map"}const M=w?a.subdivisionGranularity.circle:1;for(const{feature:A,id:I,index:F,sourceLayerIndex:N}of t){const V=this.layers[0]._featureFilter.needGeometry,q=tr(A,V);if(!this.layers[0]._featureFilter.filter(new Ui(this.zoom),q,o))continue;const Q=v?_.evaluate(q,{},o):void 0,ne={id:I,properties:A.properties,type:A.type,sourceLayerIndex:N,index:F,geometry:V?q.geometry:pr(A),patterns:{},sortKey:Q};g.push(ne)}v&&g.sort((A,I)=>A.sortKey-I.sortKey);for(const A of g){const{geometry:I,index:F,sourceLayerIndex:N}=A,V=t[F].feature;this.addFeature(A,I,F,o,M),a.featureIndex.insert(V,I,F,N,this.index)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Wn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,o,h,g=1){let _;switch(g){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${g}; valid values are 1, 3, 5, 7.`)}const v=_.length;for(const w of a)for(const M of w){const A=M.x,I=M.y;if(A<0||A>=Ge||I<0||I>=Ge)continue;const F=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),N=F.vertexLength;for(let V=0;V<v;V++)for(let q=0;q<v;q++)ed(this.layoutVertexArray,A,I,_[q],_[V]);for(let V=0;V<v-1;V++)for(let q=0;q<v-1;q++){const Q=N+V*v+q,ne=N+(V+1)*v+q;this.indexArray.emplaceBack(Q,ne+1,Q+1),this.indexArray.emplaceBack(Q,ne,ne+1)}F.vertexLength+=v*v,F.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{},h)}}function td(r,t){for(let a=0;a<r.length;a++)if(Nl(t,r[a]))return!0;for(let a=0;a<t.length;a++)if(Nl(r,t[a]))return!0;return!!Tu(r,t)}function ap(r,t,a){return!!Nl(r,t)||!!id(t,r,a)}function sf(r,t){if(r.length===1)return mh(t,r[0]);for(let a=0;a<t.length;a++){const o=t[a];for(let h=0;h<o.length;h++)if(Nl(r,o[h]))return!0}for(let a=0;a<r.length;a++)if(mh(t,r[a]))return!0;for(let a=0;a<t.length;a++)if(Tu(r,t[a]))return!0;return!1}function Ic(r,t,a){if(r.length>1){if(Tu(r,t))return!0;for(let o=0;o<t.length;o++)if(id(t[o],r,a))return!0}for(let o=0;o<r.length;o++)if(id(r[o],t,a))return!0;return!1}function Tu(r,t){if(r.length===0||t.length===0)return!1;for(let a=0;a<r.length-1;a++){const o=r[a],h=r[a+1];for(let g=0;g<t.length-1;g++)if(rp(o,h,t[g],t[g+1]))return!0}return!1}function rp(r,t,a,o){return zi(r,a,o)!==zi(t,a,o)&&zi(r,t,a)!==zi(r,t,o)}function id(r,t,a){const o=a*a;if(t.length===1)return r.distSqr(t[0])<o;for(let h=1;h<t.length;h++)if(of(r,t[h-1],t[h])<o)return!0;return!1}function of(r,t,a){const o=t.distSqr(a);if(o===0)return r.distSqr(t);const h=((r.x-t.x)*(a.x-t.x)+(r.y-t.y)*(a.y-t.y))/o;return r.distSqr(h<0?t:h>1?a:a.sub(t)._mult(h)._add(t))}function mh(r,t){for(let a=0;a<r.length;a++)if(Nl(r[a],t))return!0;return!1}function Nl(r,t){let a=!1;for(let o=0,h=r.length-1;o<r.length;h=o++){const g=r[o],_=r[h];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(a=!a)}return a}function lf(r,t,a){const o=a[0],h=a[2];if(r.x<o.x&&t.x<o.x||r.x>h.x&&t.x>h.x||r.y<o.y&&t.y<o.y||r.y>h.y&&t.y>h.y)return!1;const g=zi(r,t,a[0]);return g!==zi(r,t,a[1])||g!==zi(r,t,a[2])||g!==zi(r,t,a[3])}function Su(r,t,a){const o=t.paint.get(r).value;return o.kind==="constant"?o.value:a.programConfigurations.get(t.id).getMaxValue(r)}function gh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function nd(r,t,a,o,h){if(!t[0]&&!t[1])return r;const g=Pe.convert(t)._mult(h);a==="viewport"&&g._rotate(-o);const _=[];for(let v=0;v<r.length;v++)_.push(r[v].sub(g));return _}let cf,aa;vt("CircleBucket",ph,{omit:["layers"]});var Ea={get paint(){return aa=aa||new on({"circle-radius":new jt(W.paint_circle["circle-radius"]),"circle-color":new jt(W.paint_circle["circle-color"]),"circle-blur":new jt(W.paint_circle["circle-blur"]),"circle-opacity":new jt(W.paint_circle["circle-opacity"]),"circle-translate":new gt(W.paint_circle["circle-translate"]),"circle-translate-anchor":new gt(W.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gt(W.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gt(W.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jt(W.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jt(W.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jt(W.paint_circle["circle-stroke-opacity"])})},get layout(){return cf=cf||new on({"circle-sort-key":new jt(W.layout_circle["circle-sort-key"])})}};class sp extends fr{constructor(t){super(t,Ea)}createBucket(t){return new ph(t)}queryRadius(t){const a=t;return Su("circle-radius",this,a)+Su("circle-stroke-width",this,a)+gh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:h,transform:g,pixelsToTileUnits:_,unwrappedTileID:v,getElevation:w}){const M=nd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-g.bearingInRadians,_),A=this.paint.get("circle-radius").evaluate(a,o)+this.paint.get("circle-stroke-width").evaluate(a,o),I=this.paint.get("circle-pitch-alignment")==="map",F=I?M:function(V,q,Q,ne){return V.map(ye=>uf(ye,q,Q,ne))}(M,g,v,w),N=I?A*_:A;for(const V of h)for(const q of V){const Q=I?q:uf(q,g,v,w);let ne=N;const ye=g.projectTileCoordinates(q.x,q.y,v,w).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=ye/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=g.cameraToCenterDistance/ye),ap(F,Q,ne))return!0}return!1}}function uf(r,t,a,o){const h=t.projectTileCoordinates(r.x,r.y,a,o).point;return new Pe((.5*h.x+.5)*t.width,(.5*-h.y+.5)*t.height)}class hf extends ph{}let df;vt("HeatmapBucket",hf,{omit:["layers"]});var op={get paint(){return df=df||new on({"heatmap-radius":new jt(W.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jt(W.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gt(W.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ol(W.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gt(W.paint_heatmap["heatmap-opacity"])})}};function Mu(r,{width:t,height:a},o,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*a*o)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*a*o}`)}else h=new Uint8Array(t*a*o);return r.width=t,r.height=a,r.data=h,r}function ad(r,{width:t,height:a},o){if(t===r.width&&a===r.height)return;const h=Mu({},{width:t,height:a},o);rd(r,h,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,a)},o),r.width=t,r.height=a,r.data=h.data}function rd(r,t,a,o,h,g){if(h.width===0||h.height===0)return t;if(h.width>r.width||h.height>r.height||a.x>r.width-h.width||a.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||o.x>t.width-h.width||o.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const _=r.data,v=t.data;if(_===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<h.height;w++){const M=((a.y+w)*r.width+a.x)*g,A=((o.y+w)*t.width+o.x)*g;for(let I=0;I<h.width*g;I++)v[A+I]=_[M+I]}return t}class Eu{constructor(t,a){Mu(this,t,1,a)}resize(t){ad(this,t,1)}clone(){return new Eu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,o,h,g){rd(t,a,o,h,g,1)}}class mr{constructor(t,a){Mu(this,t,4,a)}resize(t){ad(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new mr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,o,h,g){rd(t,a,o,h,g,4)}}function sd(r){const t={},a=r.resolution||256,o=r.clips?r.clips.length:1,h=r.image||new mr({width:a,height:o});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const g=(_,v,w)=>{t[r.evaluationKey]=w;const M=r.expression.evaluate(t);h.data[_+v+0]=Math.floor(255*M.r/M.a),h.data[_+v+1]=Math.floor(255*M.g/M.a),h.data[_+v+2]=Math.floor(255*M.b/M.a),h.data[_+v+3]=Math.floor(255*M.a)};if(r.clips)for(let _=0,v=0;_<o;++_,v+=4*a)for(let w=0,M=0;w<a;w++,M+=4){const A=w/(a-1),{start:I,end:F}=r.clips[_];g(v,M,I*(1-A)+F*A)}else for(let _=0,v=0;_<a;_++,v+=4)g(0,v,_/(a-1));return h}vt("AlphaImage",Eu),vt("RGBAImage",mr);const _h="big-fb";class ff extends fr{createBucket(t){return new hf(t)}constructor(t){super(t,op),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(_h)&&this.heatmapFbos.delete(_h)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let pf;var mf={get paint(){return pf=pf||new on({"hillshade-illumination-direction":new gt(W.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new gt(W.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new gt(W.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gt(W.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gt(W.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gt(W.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gt(W.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new gt(W.paint_hillshade["hillshade-method"])})}};class od extends fr{constructor(t){super(t,mf),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,o=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const g=Math.max(t.length,a.length,o.length,h.length);t=t.concat(Array(g-t.length).fill(t.at(-1))),a=a.concat(Array(g-a.length).fill(a.at(-1))),o=o.concat(Array(g-o.length).fill(o.at(-1))),h=h.concat(Array(g-h.length).fill(h.at(-1)));const _=a.map(Fs);return{directionRadians:t.map(Fs),altitudeRadians:_,shadowColor:h,highlightColor:o}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const gf=Ji([{name:"a_pos",components:2,type:"Int16"}],4),{members:lp}=gf;function yh(r,t,a){const o=a.patternDependencies;let h=!1;for(const g of t){const _=g.paint.get(`${r}-pattern`);_.isConstant()||(h=!0);const v=_.constantOr(null);v&&(h=!0,o[v.to]=!0,o[v.from]=!0)}return h}function ld(r,t,a,o,h){const g=h.patternDependencies;for(const _ of t){const v=_.paint.get(`${r}-pattern`).value;if(v.kind!=="constant"){let w=v.evaluate({zoom:o-1},a,{},h.availableImages),M=v.evaluate({zoom:o},a,{},h.availableImages),A=v.evaluate({zoom:o+1},a,{},h.availableImages);w=w&&w.name?w.name:w,M=M&&M.name?M.name:M,A=A&&A.name?A.name:A,g[w]=!0,g[M]=!0,g[A]=!0,a.patterns[_.id]={min:w,mid:M,max:A}}}return a}function so(r,t,a,o,h){let g;if(h===function(_,v,w,M){let A=0;for(let I=v,F=w-M;I<w;I+=M)A+=(_[F]-_[I])*(_[I+1]+_[F+1]),F=I;return A}(r,t,a,o)>0)for(let _=t;_<a;_+=o)g=hd(_/o|0,r[_],r[_+1],g);else for(let _=a-o;_>=t;_-=o)g=hd(_/o|0,r[_],r[_+1],g);return g&&oo(g,g.next)&&(Ul(g),g=g.next),g}function Yo(r,t){if(!r)return r;t||(t=r);let a,o=r;do if(a=!1,o.steiner||!oo(o,o.next)&&Sn(o.prev,o,o.next)!==0)o=o.next;else{if(Ul(o),o=t=o.prev,o===o.next)break;a=!0}while(a||o!==t);return t}function vh(r,t,a,o,h,g,_){if(!r)return;!_&&g&&function(w,M,A,I){let F=w;do F.z===0&&(F.z=_f(F.x,F.y,M,A,I)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==w);F.prevZ.nextZ=null,F.prevZ=null,function(N){let V,q=1;do{let Q,ne=N;N=null;let ye=null;for(V=0;ne;){V++;let se=ne,j=0;for(let ue=0;ue<q&&(j++,se=se.nextZ,se);ue++);let K=q;for(;j>0||K>0&&se;)j!==0&&(K===0||!se||ne.z<=se.z)?(Q=ne,ne=ne.nextZ,j--):(Q=se,se=se.nextZ,K--),ye?ye.nextZ=Q:N=Q,Q.prevZ=ye,ye=Q;ne=se}ye.nextZ=null,q*=2}while(V>1)}(F)}(r,o,h,g);let v=r;for(;r.prev!==r.next;){const w=r.prev,M=r.next;if(g?Ko(r,o,h,g):cp(r))t.push(w.i,r.i,M.i),Ul(r),r=M.next,v=M.next;else if((r=M)===v){_?_===1?vh(r=up(Yo(r),t),t,a,o,h,g,2):_===2&&cd(r,t,a,o,h,g):vh(Yo(r),t,a,o,h,g,1);break}}}function cp(r){const t=r.prev,a=r,o=r.next;if(Sn(t,a,o)>=0)return!1;const h=t.x,g=a.x,_=o.x,v=t.y,w=a.y,M=o.y,A=Math.min(h,g,_),I=Math.min(v,w,M),F=Math.max(h,g,_),N=Math.max(v,w,M);let V=o.next;for(;V!==t;){if(V.x>=A&&V.x<=F&&V.y>=I&&V.y<=N&&ts(h,v,g,w,_,M,V.x,V.y)&&Sn(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function Ko(r,t,a,o){const h=r.prev,g=r,_=r.next;if(Sn(h,g,_)>=0)return!1;const v=h.x,w=g.x,M=_.x,A=h.y,I=g.y,F=_.y,N=Math.min(v,w,M),V=Math.min(A,I,F),q=Math.max(v,w,M),Q=Math.max(A,I,F),ne=_f(N,V,t,a,o),ye=_f(q,Q,t,a,o);let se=r.prevZ,j=r.nextZ;for(;se&&se.z>=ne&&j&&j.z<=ye;){if(se.x>=N&&se.x<=q&&se.y>=V&&se.y<=Q&&se!==h&&se!==_&&ts(v,A,w,I,M,F,se.x,se.y)&&Sn(se.prev,se,se.next)>=0||(se=se.prevZ,j.x>=N&&j.x<=q&&j.y>=V&&j.y<=Q&&j!==h&&j!==_&&ts(v,A,w,I,M,F,j.x,j.y)&&Sn(j.prev,j,j.next)>=0))return!1;j=j.nextZ}for(;se&&se.z>=ne;){if(se.x>=N&&se.x<=q&&se.y>=V&&se.y<=Q&&se!==h&&se!==_&&ts(v,A,w,I,M,F,se.x,se.y)&&Sn(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;j&&j.z<=ye;){if(j.x>=N&&j.x<=q&&j.y>=V&&j.y<=Q&&j!==h&&j!==_&&ts(v,A,w,I,M,F,j.x,j.y)&&Sn(j.prev,j,j.next)>=0)return!1;j=j.nextZ}return!0}function up(r,t){let a=r;do{const o=a.prev,h=a.next.next;!oo(o,h)&&zs(o,a,a.next,h)&&zu(o,h)&&zu(h,o)&&(t.push(o.i,a.i,h.i),Ul(a),Ul(a.next),a=r=h),a=a.next}while(a!==r);return Yo(a)}function cd(r,t,a,o,h,g){let _=r;do{let v=_.next.next;for(;v!==_.prev;){if(_.i!==v.i&&dp(_,v)){let w=ud(_,v);return _=Yo(_,_.next),w=Yo(w,w.next),vh(_,t,a,o,h,g,0),void vh(w,t,a,o,h,g,0)}v=v.next}_=_.next}while(_!==r)}function xh(r,t){let a=r.x-t.x;return a===0&&(a=r.y-t.y,a===0)&&(a=(r.next.y-r.y)/(r.next.x-r.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function In(r,t){const a=function(h,g){let _=g;const v=h.x,w=h.y;let M,A=-1/0;if(oo(h,_))return _;do{if(oo(h,_.next))return _.next;if(w<=_.y&&w>=_.next.y&&_.next.y!==_.y){const q=_.x+(w-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(q<=v&&q>A&&(A=q,M=_.x<_.next.x?_:_.next,q===v))return M}_=_.next}while(_!==g);if(!M)return null;const I=M,F=M.x,N=M.y;let V=1/0;_=M;do{if(v>=_.x&&_.x>=F&&v!==_.x&&Cu(w<N?v:A,w,F,N,w<N?A:v,w,_.x,_.y)){const q=Math.abs(w-_.y)/(v-_.x);zu(_,h)&&(q<V||q===V&&(_.x>M.x||_.x===M.x&&Hp(M,_)))&&(M=_,V=q)}_=_.next}while(_!==I);return M}(r,t);if(!a)return t;const o=ud(a,r);return Yo(o,o.next),Yo(a,a.next)}function Hp(r,t){return Sn(r.prev,r,t.prev)<0&&Sn(t.next,r,r.next)<0}function _f(r,t,a,o,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-a)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function hp(r){let t=r,a=r;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==r);return a}function Cu(r,t,a,o,h,g,_,v){return(h-_)*(t-v)>=(r-_)*(g-v)&&(r-_)*(o-v)>=(a-_)*(t-v)&&(a-_)*(g-v)>=(h-_)*(o-v)}function ts(r,t,a,o,h,g,_,v){return!(r===_&&t===v)&&Cu(r,t,a,o,h,g,_,v)}function dp(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(a,o){let h=a;do{if(h.i!==a.i&&h.next.i!==a.i&&h.i!==o.i&&h.next.i!==o.i&&zs(h,h.next,a,o))return!0;h=h.next}while(h!==a);return!1}(r,t)&&(zu(r,t)&&zu(t,r)&&function(a,o){let h=a,g=!1;const _=(a.x+o.x)/2,v=(a.y+o.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&_<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==a);return g}(r,t)&&(Sn(r.prev,r,t.prev)||Sn(r,t.prev,t))||oo(r,t)&&Sn(r.prev,r,r.next)>0&&Sn(t.prev,t,t.next)>0)}function Sn(r,t,a){return(t.y-r.y)*(a.x-t.x)-(t.x-r.x)*(a.y-t.y)}function oo(r,t){return r.x===t.x&&r.y===t.y}function zs(r,t,a,o){const h=Au(Sn(r,t,a)),g=Au(Sn(r,t,o)),_=Au(Sn(a,o,r)),v=Au(Sn(a,o,t));return h!==g&&_!==v||!(h!==0||!bh(r,a,t))||!(g!==0||!bh(r,o,t))||!(_!==0||!bh(a,r,o))||!(v!==0||!bh(a,t,o))}function bh(r,t,a){return t.x<=Math.max(r.x,a.x)&&t.x>=Math.min(r.x,a.x)&&t.y<=Math.max(r.y,a.y)&&t.y>=Math.min(r.y,a.y)}function Au(r){return r>0?1:r<0?-1:0}function zu(r,t){return Sn(r.prev,r,r.next)<0?Sn(r,t,r.next)>=0&&Sn(r,r.prev,t)>=0:Sn(r,t,r.prev)<0||Sn(r,r.next,t)<0}function ud(r,t){const a=dd(r.i,r.x,r.y),o=dd(t.i,t.x,t.y),h=r.next,g=t.prev;return r.next=t,t.prev=r,a.next=h,h.prev=a,o.next=a,a.prev=o,g.next=o,o.prev=g,o}function hd(r,t,a,o){const h=dd(r,t,a);return o?(h.next=o.next,h.prev=o,o.next.prev=h,o.next=h):(h.prev=h,h.next=h),h}function Ul(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function dd(r,t,a){return{i:r,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class gr{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Mn{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Mn.noSubdivision=new Mn({fill:new gr(0,0),line:new gr(0,0),tile:new gr(0,0),stencil:new gr(0,0),circle:1}),vt("SubdivisionGranularityExpression",gr),vt("SubdivisionGranularitySetting",Mn);const Vl=-32768,Pu=32767;class ga{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ge/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|(a+=32768)<<0}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(t),h=0|Math.round(a),g=this._getKey(o,h);if(this._vertexDictionary.has(g))return this._vertexDictionary.get(g);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(g,_),this._vertexBuffer.push(o,h),_}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(h,g){const _=[];for(let v=0;v<g.length;v+=3){const w=g[v],M=g[v+1],A=g[v+2],I=h[2*w],F=h[2*w+1];(h[2*M]-I)*(h[2*A+1]-F)-(h[2*M+1]-F)*(h[2*A]-I)>0?(_.push(w),_.push(A),_.push(M)):(_.push(w),_.push(M),_.push(A))}return _}(this._vertexBuffer,t);const a=[],o=t.length;for(let h=0;h<o;h+=3){const g=[t[h+0],t[h+1],t[h+2]],_=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,w=1/0,M=-1/0,A=-1/0;for(let q=0;q<3;q++){const Q=_[2*q],ne=_[2*q+1];v=Math.min(v,Q),M=Math.max(M,Q),w=Math.min(w,ne),A=Math.max(A,ne)}if(v===M||w===A)continue;const I=Math.floor(v/this._granularityCellSize),F=Math.ceil(M/this._granularityCellSize),N=Math.floor(w/this._granularityCellSize),V=Math.ceil(A/this._granularityCellSize);if(I!==F||N!==V)for(let q=N;q<V;q++){const Q=this._scanlineGenerateVertexRingForCellRow(q,_,g);pp(this._vertexBuffer,Q,a)}else a.push(...g)}return a}_scanlineGenerateVertexRingForCellRow(t,a,o){const h=t*this._granularityCellSize,g=h+this._granularityCellSize,_=[];for(let v=0;v<3;v++){const w=a[2*v],M=a[2*v+1],A=a[2*(v+1)%6],I=a[(2*(v+1)+1)%6],F=a[2*(v+2)%6],N=a[(2*(v+2)+1)%6],V=A-w,q=I-M,Q=V===0,ne=q===0,ye=(h-M)/q,se=(g-M)/q,j=Math.min(ye,se),K=Math.max(ye,se);if(!ne&&(j>=1||K<=0)||ne&&(M<h||M>g)){I>=h&&I<=g&&_.push(o[(v+1)%3]);continue}!ne&&j>0&&_.push(this._vertexToIndex(w+V*j,M+q*j));const ue=w+V*Math.max(j,0),Re=w+V*Math.min(K,1);Q||this._generateIntraEdgeVertices(_,w,M,A,I,ue,Re),!ne&&K<1&&_.push(this._vertexToIndex(w+V*K,M+q*K)),(ne||I>=h&&I<=g)&&_.push(o[(v+1)%3]),!ne&&(I<=h||I>=g)&&this._generateInterEdgeVertices(_,w,M,A,I,F,N,Re,h,g)}return _}_generateIntraEdgeVertices(t,a,o,h,g,_,v){const w=h-a,M=g-o,A=M===0,I=A?Math.min(a,h):Math.min(_,v),F=A?Math.max(a,h):Math.max(_,v),N=Math.floor(I/this._granularityCellSize)+1,V=Math.ceil(F/this._granularityCellSize)-1;if(A?a<h:_<v)for(let q=N;q<=V;q++){const Q=q*this._granularityCellSize;t.push(this._vertexToIndex(Q,o+M*(Q-a)/w))}else for(let q=V;q>=N;q--){const Q=q*this._granularityCellSize;t.push(this._vertexToIndex(Q,o+M*(Q-a)/w))}}_generateInterEdgeVertices(t,a,o,h,g,_,v,w,M,A){const I=g-o,F=_-h,N=v-g,V=(M-g)/N,q=(A-g)/N,Q=Math.min(V,q),ne=Math.max(V,q),ye=h+F*Q;let se=Math.floor(Math.min(ye,w)/this._granularityCellSize)+1,j=Math.ceil(Math.max(ye,w)/this._granularityCellSize)-1,K=w<ye;const ue=N===0;if(ue&&(v===M||v===A))return;if(ue||Q>=1||ne<=0){const tt=o-v,Oe=_+(a-_)*Math.min((M-v)/tt,(A-v)/tt);se=Math.floor(Math.min(Oe,w)/this._granularityCellSize)+1,j=Math.ceil(Math.max(Oe,w)/this._granularityCellSize)-1,K=w<Oe}const Re=I>0?A:M;if(K)for(let tt=se;tt<=j;tt++)t.push(this._vertexToIndex(tt*this._granularityCellSize,Re));else for(let tt=j;tt>=se;tt--)t.push(this._vertexToIndex(tt*this._granularityCellSize,Re))}_generateOutline(t){const a=[];for(const o of t){const h=Zl(o,this._granularity,!0),g=this._pointArrayToIndices(h),_=[];for(let v=1;v<g.length;v++)_.push(g[v-1]),_.push(g[v]);a.push(_)}return a}_handlePoles(t){let a=!1,o=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(a||o)&&this._fillPoles(t,a,o)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const o=t[a+1];o===Vl&&(t[a+1]=-32767),o===Pu&&(t[a+1]=32766)}}_generatePoleQuad(t,a,o,h,g,_){h>g!=(_===Vl)?(t.push(a),t.push(o),t.push(this._vertexToIndex(h,_)),t.push(o),t.push(this._vertexToIndex(g,_)),t.push(this._vertexToIndex(h,_))):(t.push(o),t.push(a),t.push(this._vertexToIndex(h,_)),t.push(this._vertexToIndex(g,_)),t.push(o),t.push(this._vertexToIndex(h,_)))}_fillPoles(t,a,o){const h=this._vertexBuffer,g=Ge,_=t.length;for(let v=2;v<_;v+=3){const w=t[v-2],M=t[v-1],A=t[v],I=h[2*w],F=h[2*w+1],N=h[2*M],V=h[2*M+1],q=h[2*A],Q=h[2*A+1];a&&(F===0&&V===0&&this._generatePoleQuad(t,w,M,I,N,Vl),V===0&&Q===0&&this._generatePoleQuad(t,M,A,N,q,Vl),Q===0&&F===0&&this._generatePoleQuad(t,A,w,q,I,Vl)),o&&(F===g&&V===g&&this._generatePoleQuad(t,w,M,I,N,Pu),V===g&&Q===g&&this._generatePoleQuad(t,M,A,N,q,Pu),Q===g&&F===g&&this._generatePoleQuad(t,A,w,q,I,Pu))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:h}=function(v){const w=[],M=[];for(const A of v)if(A.length!==0){A!==v[0]&&w.push(M.length/2);for(let I=0;I<A.length;I++)M.push(A[I].x),M.push(A[I].y)}return{flattened:M,holeIndices:w}}(t);let g;this._initializeVertices(o);try{const v=function(M,A,I=2){const F=A&&A.length,N=F?A[0]*I:M.length;let V=so(M,0,N,I,!0);const q=[];if(!V||V.next===V.prev)return q;let Q,ne,ye;if(F&&(V=function(se,j,K,ue){const Re=[];for(let tt=0,Oe=j.length;tt<Oe;tt++){const He=so(se,j[tt]*ue,tt<Oe-1?j[tt+1]*ue:se.length,ue,!1);He===He.next&&(He.steiner=!0),Re.push(hp(He))}Re.sort(xh);for(let tt=0;tt<Re.length;tt++)K=In(Re[tt],K);return K}(M,A,V,I)),M.length>80*I){Q=1/0,ne=1/0;let se=-1/0,j=-1/0;for(let K=I;K<N;K+=I){const ue=M[K],Re=M[K+1];ue<Q&&(Q=ue),Re<ne&&(ne=Re),ue>se&&(se=ue),Re>j&&(j=Re)}ye=Math.max(se-Q,j-ne),ye=ye!==0?32767/ye:0}return vh(V,q,I,Q,ne,ye,0),q}(o,h),w=this._convertIndices(o,v);g=this._subdivideTrianglesScanline(w)}catch(v){console.error(v)}let _=[];return a&&(_=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(g),{verticesFlattened:this._vertexBuffer,indicesTriangles:g,indicesLineList:_}}_convertIndices(t,a){const o=[];for(let h=0;h<a.length;h++)o.push(this._vertexToIndex(t[2*a[h]],t[2*a[h]+1]));return o}_pointArrayToIndices(t){const a=[];for(let o=0;o<t.length;o++){const h=t[o];a.push(this._vertexToIndex(h.x,h.y))}return a}}function fp(r,t,a,o=!0){return new ga(a,t).subdividePolygonInternal(r,o)}function Zl(r,t,a=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const o=r[0],h=r[r.length-1],g=a&&(o.x!==h.x||o.y!==h.y);if(t<2)return g?[...r,r[0]]:[...r];const _=Math.floor(Ge/t),v=[];v.push(new Pe(r[0].x,r[0].y));const w=r.length,M=g?w:w-1;for(let A=0;A<M;A++){const I=r[A],F=A<w-1?r[A+1]:r[0],N=I.x,V=I.y,q=F.x,Q=F.y,ne=N!==q,ye=V!==Q;if(!ne&&!ye)continue;const se=q-N,j=Q-V,K=Math.abs(se),ue=Math.abs(j);let Re=N,tt=V;for(;;){const He=se>0?(Math.floor(Re/_)+1)*_:(Math.ceil(Re/_)-1)*_,rt=j>0?(Math.floor(tt/_)+1)*_:(Math.ceil(tt/_)-1)*_,nt=Math.abs(Re-He),lt=Math.abs(tt-rt),Xe=Math.abs(Re-q),wt=Math.abs(tt-Q),kt=ne?nt/K:Number.POSITIVE_INFINITY,It=ye?lt/ue:Number.POSITIVE_INFINITY;if((Xe<=nt||!ne)&&(wt<=lt||!ye))break;if(kt<It&&ne||!ye){Re=He,tt+=j*kt;const Et=new Pe(Re,Math.round(tt));v[v.length-1].x===Et.x&&v[v.length-1].y===Et.y||v.push(Et)}else{Re+=se*It,tt=rt;const Et=new Pe(Math.round(Re),tt);v[v.length-1].x===Et.x&&v[v.length-1].y===Et.y||v.push(Et)}}const Oe=new Pe(q,Q);v[v.length-1].x===Oe.x&&v[v.length-1].y===Oe.y||v.push(Oe)}return v}function pp(r,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,h=r[2*t[0]];for(let w=1;w<t.length;w++){const M=r[2*t[w]];M<h&&(h=M,o=w)}const g=t.length;let _=o,v=(_+1)%g;for(;;){const w=_-1>=0?_-1:g-1,M=(v+1)%g,A=r[2*t[w]],I=r[2*t[M]],F=r[2*t[_]],N=r[2*t[_]+1],V=r[2*t[v]+1];let q=!1;if(A<I)q=!0;else if(A>I)q=!1;else{const Q=V-N,ne=-(r[2*t[v]]-F),ye=N<V?1:-1;((A-F)*Q+(r[2*t[w]+1]-N)*ne)*ye>((I-F)*Q+(r[2*t[M]+1]-N)*ne)*ye&&(q=!0)}if(q){const Q=t[w],ne=t[_],ye=t[v];Q!==ne&&Q!==ye&&ne!==ye&&a.push(ye,ne,Q),_--,_<0&&(_=g-1)}else{const Q=t[M],ne=t[_],ye=t[v];Q!==ne&&Q!==ye&&ne!==ye&&a.push(ye,ne,Q),v++,v>=g&&(v=0)}if(w===M)break}}function mn(r,t,a,o,h,g,_,v,w){const M=h.length/2,A=_&&v&&w;if(M<Ti.MAX_VERTEX_ARRAY_LENGTH){const I=t.prepareSegment(M,a,o),F=I.vertexLength;for(let q=0;q<g.length;q+=3)o.emplaceBack(F+g[q],F+g[q+1],F+g[q+2]);let N,V;I.vertexLength+=M,I.primitiveLength+=g.length/3,A&&(V=_.prepareSegment(M,a,v),N=V.vertexLength,V.vertexLength+=M);for(let q=0;q<h.length;q+=2)r(h[q],h[q+1]);if(A)for(let q=0;q<w.length;q++){const Q=w[q];for(let ne=1;ne<Q.length;ne+=2)v.emplaceBack(N+Q[ne-1],N+Q[ne]);V.primitiveLength+=Q.length/2}}else(function(I,F,N,V,q,Q){const ne=[];for(let ue=0;ue<V.length/2;ue++)ne.push(-1);const ye={count:0};let se=0,j=I.getOrCreateLatestSegment(F,N),K=j.vertexLength;for(let ue=2;ue<q.length;ue+=3){const Re=q[ue-2],tt=q[ue-1],Oe=q[ue];let He=ne[Re]<se,rt=ne[tt]<se,nt=ne[Oe]<se;j.vertexLength+((He?1:0)+(rt?1:0)+(nt?1:0))>Ti.MAX_VERTEX_ARRAY_LENGTH&&(j=I.createNewSegment(F,N),se=ye.count,He=!0,rt=!0,nt=!0,K=0);const lt=_a(ne,V,Q,ye,Re,He,j),Xe=_a(ne,V,Q,ye,tt,rt,j),wt=_a(ne,V,Q,ye,Oe,nt,j);N.emplaceBack(K+lt-se,K+Xe-se,K+wt-se),j.primitiveLength++}})(t,a,o,h,g,r),A&&function(I,F,N,V,q,Q){const ne=[];for(let ue=0;ue<V.length/2;ue++)ne.push(-1);const ye={count:0};let se=0,j=I.getOrCreateLatestSegment(F,N),K=j.vertexLength;for(let ue=0;ue<q.length;ue++){const Re=q[ue];for(let tt=1;tt<q[ue].length;tt+=2){const Oe=Re[tt-1],He=Re[tt];let rt=ne[Oe]<se,nt=ne[He]<se;j.vertexLength+((rt?1:0)+(nt?1:0))>Ti.MAX_VERTEX_ARRAY_LENGTH&&(j=I.createNewSegment(F,N),se=ye.count,rt=!0,nt=!0,K=0);const lt=_a(ne,V,Q,ye,Oe,rt,j),Xe=_a(ne,V,Q,ye,He,nt,j);N.emplaceBack(K+lt-se,K+Xe-se),j.primitiveLength++}}}(_,a,v,h,w,r),t.forceNewSegmentOnNextPrepare(),_==null||_.forceNewSegmentOnNextPrepare()}function _a(r,t,a,o,h,g,_){if(g){const v=o.count;return a(t[2*h],t[2*h+1]),r[h]=o.count,o.count++,_.vertexLength++,v}return r[h]}class Ps{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ut,this.indexArray=new bi,this.indexArray2=new Pn,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new Ti,this.segments2=new Ti,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,o){this.hasPattern=yh("fill",this.layers,a);const h=this.layers[0].layout.get("fill-sort-key"),g=!h.isConstant(),_=[];for(const{feature:v,id:w,index:M,sourceLayerIndex:A}of t){const I=this.layers[0]._featureFilter.needGeometry,F=tr(v,I);if(!this.layers[0]._featureFilter.filter(new Ui(this.zoom),F,o))continue;const N=g?h.evaluate(F,{},o,a.availableImages):void 0,V={id:w,properties:v.properties,type:v.type,sourceLayerIndex:A,index:M,geometry:I?F.geometry:pr(v),patterns:{},sortKey:N};_.push(V)}g&&_.sort((v,w)=>v.sortKey-w.sortKey);for(const v of _){const{geometry:w,index:M,sourceLayerIndex:A}=v;if(this.hasPattern){const I=ld("fill",this.layers,v,this.zoom,a);this.patternFeatures.push(I)}else this.addFeature(v,w,M,o,{},a.subdivisionGranularity);a.featureIndex.insert(t[M].feature,w,M,A,this.index)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,o)}addFeatures(t,a,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,a,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,o,h,g,_){for(const v of dc(a,500)){const w=fp(v,h,_.fill.getGranularityForZoomLevel(h.z)),M=this.layoutVertexArray;mn((A,I)=>{M.emplaceBack(A,I)},this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,h)}}let yf,vf;vt("FillBucket",Ps,{omit:["layers","patternFeatures"]});var $p={get paint(){return vf=vf||new on({"fill-antialias":new gt(W.paint_fill["fill-antialias"]),"fill-opacity":new jt(W.paint_fill["fill-opacity"]),"fill-color":new jt(W.paint_fill["fill-color"]),"fill-outline-color":new jt(W.paint_fill["fill-outline-color"]),"fill-translate":new gt(W.paint_fill["fill-translate"]),"fill-translate-anchor":new gt(W.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qr(W.paint_fill["fill-pattern"])})},get layout(){return yf=yf||new on({"fill-sort-key":new jt(W.layout_fill["fill-sort-key"])})}};class xf extends fr{constructor(t){super(t,$p)}recalculate(t,a){super.recalculate(t,a);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Ps(t)}queryRadius(){return gh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:o,pixelsToTileUnits:h}){return sf(nd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,h),a)}isTileClipped(){return!0}}const Ar=Ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ds=Ji([{name:"a_centroid",components:2,type:"Int16"}],4),{members:mp}=Ar;var ir,bf,lo,Gl,co,fd,pd,zr={};function wf(){if(bf)return ir;bf=1;var r=Ne();function t(h,g,_,v,w){this.properties={},this.extent=_,this.type=0,this._pbf=h,this._geometry=-1,this._keys=v,this._values=w,h.readFields(a,this,g)}function a(h,g,_){h==1?g.id=_.readVarint():h==2?function(v,w){for(var M=v.readVarint()+v.pos;v.pos<M;){var A=w._keys[v.readVarint()],I=w._values[v.readVarint()];w.properties[A]=I}}(_,g):h==3?g.type=_.readVarint():h==4&&(g._geometry=_.pos)}function o(h){for(var g,_,v=0,w=0,M=h.length,A=M-1;w<M;A=w++)v+=((_=h[A]).x-(g=h[w]).x)*(g.y+_.y);return v}return ir=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var g,_=h.readVarint()+h.pos,v=1,w=0,M=0,A=0,I=[];h.pos<_;){if(w<=0){var F=h.readVarint();v=7&F,w=F>>3}if(w--,v===1||v===2)M+=h.readSVarint(),A+=h.readSVarint(),v===1&&(g&&I.push(g),g=[]),g.push(new r(M,A));else{if(v!==7)throw new Error("unknown command "+v);g&&g.push(g[0].clone())}}return g&&I.push(g),I},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var g=h.readVarint()+h.pos,_=1,v=0,w=0,M=0,A=1/0,I=-1/0,F=1/0,N=-1/0;h.pos<g;){if(v<=0){var V=h.readVarint();_=7&V,v=V>>3}if(v--,_===1||_===2)(w+=h.readSVarint())<A&&(A=w),w>I&&(I=w),(M+=h.readSVarint())<F&&(F=M),M>N&&(N=M);else if(_!==7)throw new Error("unknown command "+_)}return[A,F,I,N]},t.prototype.toGeoJSON=function(h,g,_){var v,w,M=this.extent*Math.pow(2,_),A=this.extent*h,I=this.extent*g,F=this.loadGeometry(),N=t.types[this.type];function V(ne){for(var ye=0;ye<ne.length;ye++){var se=ne[ye];ne[ye]=[360*(se.x+A)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+I)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(v=0;v<F.length;v++)q[v]=F[v][0];V(F=q);break;case 2:for(v=0;v<F.length;v++)V(F[v]);break;case 3:for(F=function(ne){var ye=ne.length;if(ye<=1)return[ne];for(var se,j,K=[],ue=0;ue<ye;ue++){var Re=o(ne[ue]);Re!==0&&(j===void 0&&(j=Re<0),j===Re<0?(se&&K.push(se),se=[ne[ue]]):se.push(ne[ue]))}return se&&K.push(se),K}(F),v=0;v<F.length;v++)for(w=0;w<F[v].length;w++)V(F[v][w])}F.length===1?F=F[0]:N="Multi"+N;var Q={type:"Feature",geometry:{type:N,coordinates:F},properties:this.properties};return"id"in this&&(Q.id=this.id),Q},ir}function Rc(){if(Gl)return lo;Gl=1;var r=wf();function t(o,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(a,this,h),this.length=this._features.length}function a(o,h,g){o===15?h.version=g.readVarint():o===1?h.name=g.readString():o===5?h.extent=g.readVarint():o===2?h._features.push(g.pos):o===3?h._keys.push(g.readString()):o===4&&h._values.push(function(_){for(var v=null,w=_.readVarint()+_.pos;_.pos<w;){var M=_.readVarint()>>3;v=M===1?_.readString():M===2?_.readFloat():M===3?_.readDouble():M===4?_.readVarint64():M===5?_.readVarint():M===6?_.readSVarint():M===7?_.readBoolean():null}return v}(g))}return lo=t,t.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var h=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,h,this.extent,this._keys,this._values)},lo}function Du(){return pd||(pd=1,zr.VectorTile=function(){if(fd)return co;fd=1;var r=Rc();function t(a,o,h){if(a===3){var g=new r(h,h.readVarint()+h.pos);g.length&&(o[g.name]=g)}}return co=function(a,o){this.layers=a.readFields(t,{},o)},co}(),zr.VectorTileFeature=wf(),zr.VectorTileLayer=Rc()),zr}var Qo=ge(Du());const Iu=Qo.VectorTileFeature.types,md=Math.pow(2,13);function Ru(r,t,a,o,h,g,_,v){r.emplaceBack(t,a,2*Math.floor(o*md)+_,h*md*2,g*md*2,Math.round(v))}class kc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new et,this.centroidVertexArray=new Ze,this.indexArray=new bi,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new Ti,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,o){this.features=[],this.hasPattern=yh("fill-extrusion",this.layers,a);for(const{feature:h,id:g,index:_,sourceLayerIndex:v}of t){const w=this.layers[0]._featureFilter.needGeometry,M=tr(h,w);if(!this.layers[0]._featureFilter.filter(new Ui(this.zoom),M,o))continue;const A={id:g,sourceLayerIndex:v,index:_,geometry:w?M.geometry:pr(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(ld("fill-extrusion",this.layers,A,this.zoom,a)):this.addFeature(A,A.geometry,_,o,{},a.subdivisionGranularity),a.featureIndex.insert(h,A.geometry,_,v,this.index,!0)}}addFeatures(t,a,o){for(const h of this.features){const{geometry:g}=h;this.addFeature(h,g,h.index,a,o,t.subdivisionGranularity)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ds.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,o,h,g,_){for(const v of dc(a,500)){const w={x:0,y:0,sampleCount:0},M=this.layoutVertexArray.length;this.processPolygon(w,h,t,v,_);const A=this.layoutVertexArray.length-M,I=Math.floor(w.x/w.sampleCount),F=Math.floor(w.y/w.sampleCount);for(let N=0;N<A;N++)this.centroidVertexArray.emplaceBack(I,F)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,h)}processPolygon(t,a,o,h,g){if(h.length<1||Tf(h[0]))return;for(const I of h)I.length!==0&&gp(t,I);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=g.fill.getGranularityForZoomLevel(a.z),w=Iu[o.type]==="Polygon";for(const I of h){if(I.length===0||Tf(I))continue;const F=Zl(I,v,w);this._generateSideFaces(F,_)}if(!w)return;const M=fp(h,a,v,!1),A=this.layoutVertexArray;mn((I,F)=>{Ru(A,I,F,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles)}_generateSideFaces(t,a){let o=0;for(let h=1;h<t.length;h++){const g=t[h],_=t[h-1];if(gd(g,_))continue;a.segment.vertexLength+4>Ti.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=g.sub(_)._perp()._unit(),w=_.dist(g);o+w>32768&&(o=0),Ru(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,o),Ru(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,o),o+=w,Ru(this.layoutVertexArray,_.x,_.y,v.x,v.y,0,0,o),Ru(this.layoutVertexArray,_.x,_.y,v.x,v.y,0,1,o);const M=a.segment.vertexLength;this.indexArray.emplaceBack(M,M+2,M+1),this.indexArray.emplaceBack(M+1,M+2,M+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function gp(r,t){for(let a=0;a<t.length;a++){const o=t[a];a===t.length-1&&t[0].x===o.x&&t[0].y===o.y||(r.x+=o.x,r.y+=o.y,r.sampleCount++)}}function gd(r,t){return r.x===t.x&&(r.x<0||r.x>Ge)||r.y===t.y&&(r.y<0||r.y>Ge)}function Tf(r){return r.every(t=>t.x<0)||r.every(t=>t.x>Ge)||r.every(t=>t.y<0)||r.every(t=>t.y>Ge)}let _p;vt("FillExtrusionBucket",kc,{omit:["layers","features"]});var Xp={get paint(){return _p=_p||new on({"fill-extrusion-opacity":new gt(W["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jt(W["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gt(W["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gt(W["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qr(W["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jt(W["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jt(W["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gt(W["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Vi extends fr{constructor(t){super(t,Xp)}createBucket(t){return new kc(t)}queryRadius(){return gh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:h,transform:g,pixelsToTileUnits:_,pixelPosMatrix:v}){const w=nd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-g.bearingInRadians,_),M=this.paint.get("fill-extrusion-height").evaluate(a,o),A=this.paint.get("fill-extrusion-base").evaluate(a,o),I=function(N,V,q){const Q=[];for(const ne of N){const ye=[ne.x,ne.y,0,1];Ct(ye,ye,V),Q.push(new Pe(ye[0]/ye[3],ye[1]/ye[3]))}return Q}(w,v),F=function(N,V,q,Q){const ne=[],ye=[],se=Q[8]*V,j=Q[9]*V,K=Q[10]*V,ue=Q[11]*V,Re=Q[8]*q,tt=Q[9]*q,Oe=Q[10]*q,He=Q[11]*q;for(const rt of N){const nt=[],lt=[];for(const Xe of rt){const wt=Xe.x,kt=Xe.y,It=Q[0]*wt+Q[4]*kt+Q[12],Et=Q[1]*wt+Q[5]*kt+Q[13],ai=Q[2]*wt+Q[6]*kt+Q[14],Ci=Q[3]*wt+Q[7]*kt+Q[15],$i=ai+K,gn=Ci+ue,Aa=It+Re,ra=Et+tt,ln=ai+Oe,cn=Ci+He,Zn=new Pe((It+se)/gn,(Et+j)/gn);Zn.z=$i/gn,nt.push(Zn);const kn=new Pe(Aa/cn,ra/cn);kn.z=ln/cn,lt.push(kn)}ne.push(nt),ye.push(lt)}return[ne,ye]}(h,A,M,v);return function(N,V,q){let Q=1/0;sf(q,V)&&(Q=gi(q,V[0]));for(let ne=0;ne<V.length;ne++){const ye=V[ne],se=N[ne];for(let j=0;j<ye.length-1;j++){const K=ye[j],ue=[K,ye[j+1],se[j+1],se[j],K];td(q,ue)&&(Q=Math.min(Q,gi(q,ue)))}}return Q!==1/0&&Q}(F[0],F[1],I)}}function Oi(r,t){return r.x*t.x+r.y*t.y}function gi(r,t){if(r.length===1){let a=0;const o=t[a++];let h;for(;!h||o.equals(h);)if(h=t[a++],!h)return 1/0;for(;a<t.length;a++){const g=t[a],_=r[0],v=h.sub(o),w=g.sub(o),M=_.sub(o),A=Oi(v,v),I=Oi(v,w),F=Oi(w,w),N=Oi(M,v),V=Oi(M,w),q=A*F-I*I,Q=(F*N-I*V)/q,ne=(A*V-I*N)/q,ye=o.z*(1-Q-ne)+h.z*Q+g.z*ne;if(isFinite(ye))return ye}return 1/0}{let a=1/0;for(const o of t)a=Math.min(a,o.z);return a}}const Si=Ji([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Zi}=Si,Pr=Ji([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:ql}=Pr,ku=Qo.VectorTileFeature.types,Sf=Math.cos(Math.PI/180*37.5),uo=Math.pow(2,14)/.5;class En{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Mt,this.layoutVertexArray2=new ei,this.indexArray=new bi,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new Ti,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,o){this.hasPattern=yh("line",this.layers,a);const h=this.layers[0].layout.get("line-sort-key"),g=!h.isConstant(),_=[];for(const{feature:v,id:w,index:M,sourceLayerIndex:A}of t){const I=this.layers[0]._featureFilter.needGeometry,F=tr(v,I);if(!this.layers[0]._featureFilter.filter(new Ui(this.zoom),F,o))continue;const N=g?h.evaluate(F,{},o):void 0,V={id:w,properties:v.properties,type:v.type,sourceLayerIndex:A,index:M,geometry:I?F.geometry:pr(v),patterns:{},sortKey:N};_.push(V)}g&&_.sort((v,w)=>v.sortKey-w.sortKey);for(const v of _){const{geometry:w,index:M,sourceLayerIndex:A}=v;if(this.hasPattern){const I=ld("line",this.layers,v,this.zoom,a);this.patternFeatures.push(I)}else this.addFeature(v,w,M,o,{},a.subdivisionGranularity);a.featureIndex.insert(t[M].feature,w,M,A,this.index)}}update(t,a,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,o)}addFeatures(t,a,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,a,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,ql)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,o,h,g,_){const v=this.layers[0].layout,w=v.get("line-join").evaluate(t,{}),M=v.get("line-cap"),A=v.get("line-miter-limit"),I=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const F of a)this.addLine(F,t,w,M,A,I,h,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,h)}addLine(t,a,o,h,g,_,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Zl(t,v?w.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<t.length-1;se++)this.totalDistance+=t[se].dist(t[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=ku[a.type]==="Polygon";let A=t.length;for(;A>=2&&t[A-1].equals(t[A-2]);)A--;let I=0;for(;I<A-1&&t[I].equals(t[I+1]);)I++;if(A<(M?3:2))return;o==="bevel"&&(g=1.05);const F=this.overscaling<=16?15*Ge/(512*this.overscaling):0,N=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let V,q,Q,ne,ye;this.e1=this.e2=-1,M&&(V=t[A-2],ye=t[I].sub(V)._unit()._perp());for(let se=I;se<A;se++){if(Q=se===A-1?M?t[I+1]:void 0:t[se+1],Q&&t[se].equals(Q))continue;ye&&(ne=ye),V&&(q=V),V=t[se],ye=Q?Q.sub(V)._unit()._perp():ne,ne=ne||ye;let j=ne.add(ye);j.x===0&&j.y===0||j._unit();const K=ne.x*ye.x+ne.y*ye.y,ue=j.x*ye.x+j.y*ye.y,Re=ue!==0?1/ue:1/0,tt=2*Math.sqrt(2-2*ue),Oe=ue<Sf&&q&&Q,He=ne.x*ye.y-ne.y*ye.x>0;if(Oe&&se>I){const lt=V.dist(q);if(lt>2*F){const Xe=V.sub(V.sub(q)._mult(F/lt)._round());this.updateDistance(q,Xe),this.addCurrentVertex(Xe,ne,0,0,N),q=Xe}}const rt=q&&Q;let nt=rt?o:M?"butt":h;if(rt&&nt==="round"&&(Re<_?nt="miter":Re<=2&&(nt="fakeround")),nt==="miter"&&Re>g&&(nt="bevel"),nt==="bevel"&&(Re>2&&(nt="flipbevel"),Re<g&&(nt="miter")),q&&this.updateDistance(q,V),nt==="miter")j._mult(Re),this.addCurrentVertex(V,j,0,0,N);else if(nt==="flipbevel"){if(Re>100)j=ye.mult(-1);else{const lt=Re*ne.add(ye).mag()/ne.sub(ye).mag();j._perp()._mult(lt*(He?-1:1))}this.addCurrentVertex(V,j,0,0,N),this.addCurrentVertex(V,j.mult(-1),0,0,N)}else if(nt==="bevel"||nt==="fakeround"){const lt=-Math.sqrt(Re*Re-1),Xe=He?lt:0,wt=He?0:lt;if(q&&this.addCurrentVertex(V,ne,Xe,wt,N),nt==="fakeround"){const kt=Math.round(180*tt/Math.PI/20);for(let It=1;It<kt;It++){let Et=It/kt;if(Et!==.5){const Ci=Et-.5;Et+=Et*Ci*(Et-1)*((1.0904+K*(K*(3.55645-1.43519*K)-3.2452))*Ci*Ci+(.848013+K*(.215638*K-1.06021)))}const ai=ye.sub(ne)._mult(Et)._add(ne)._unit()._mult(He?-1:1);this.addHalfVertex(V,ai.x,ai.y,!1,He,0,N)}}Q&&this.addCurrentVertex(V,ye,-Xe,-wt,N)}else if(nt==="butt")this.addCurrentVertex(V,j,0,0,N);else if(nt==="square"){const lt=q?1:-1;this.addCurrentVertex(V,j,lt,lt,N)}else nt==="round"&&(q&&(this.addCurrentVertex(V,ne,0,0,N),this.addCurrentVertex(V,ne,1,1,N,!0)),Q&&(this.addCurrentVertex(V,ye,-1,-1,N,!0),this.addCurrentVertex(V,ye,0,0,N)));if(Oe&&se<A-1){const lt=V.dist(Q);if(lt>2*F){const Xe=V.add(Q.sub(V)._mult(F/lt)._round());this.updateDistance(V,Xe),this.addCurrentVertex(Xe,ye,0,0,N),V=Xe}}}}addCurrentVertex(t,a,o,h,g,_=!1){const v=a.y*h-a.x,w=-a.y-a.x*h;this.addHalfVertex(t,a.x+a.y*o,a.y-a.x*o,_,!1,o,g),this.addHalfVertex(t,v,w,_,!0,-h,g),this.distance>uo/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,o,h,g,_))}addHalfVertex({x:t,y:a},o,h,g,_,v,w){const M=.5*(this.lineClips?this.scaledDistance*(uo-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(a<<1)+(_?1:0),Math.round(63*o)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,A,this.e2),w.primitiveLength++),_?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let Wo,Hl;vt("LineBucket",En,{omit:["layers","patternFeatures"]});var _d={get paint(){return Hl=Hl||new on({"line-opacity":new jt(W.paint_line["line-opacity"]),"line-color":new jt(W.paint_line["line-color"]),"line-translate":new gt(W.paint_line["line-translate"]),"line-translate-anchor":new gt(W.paint_line["line-translate-anchor"]),"line-width":new jt(W.paint_line["line-width"]),"line-gap-width":new jt(W.paint_line["line-gap-width"]),"line-offset":new jt(W.paint_line["line-offset"]),"line-blur":new jt(W.paint_line["line-blur"]),"line-dasharray":new vs(W.paint_line["line-dasharray"]),"line-pattern":new Qr(W.paint_line["line-pattern"]),"line-gradient":new Ol(W.paint_line["line-gradient"])})},get layout(){return Wo=Wo||new on({"line-cap":new gt(W.layout_line["line-cap"]),"line-join":new jt(W.layout_line["line-join"]),"line-miter-limit":new gt(W.layout_line["line-miter-limit"]),"line-round-limit":new gt(W.layout_line["line-round-limit"]),"line-sort-key":new jt(W.layout_line["line-sort-key"])})}};class is extends jt{possiblyEvaluate(t,a){return a=new Ui(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,o,h){return a=fi({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,o,h)}}let Jo;class wh extends fr{constructor(t){super(t,_d),this.gradientVersion=0,Jo||(Jo=new is(_d.paint.properties["line-width"].specification),Jo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(o){return o._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Xs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=Jo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new En(t)}queryRadius(t){const a=t,o=nr(Su("line-width",this,a),Su("line-gap-width",this,a)),h=Su("line-offset",this,a);return o/2+Math.abs(h)+gh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:o,geometry:h,transform:g,pixelsToTileUnits:_}){const v=nd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-g.bearingInRadians,_),w=_/2*nr(this.paint.get("line-width").evaluate(a,o),this.paint.get("line-gap-width").evaluate(a,o)),M=this.paint.get("line-offset").evaluate(a,o);return M&&(h=function(A,I){const F=[];for(let N=0;N<A.length;N++){const V=A[N],q=[];for(let Q=0;Q<V.length;Q++){const ne=V[Q-1],ye=V[Q],se=V[Q+1],j=Q===0?new Pe(0,0):ye.sub(ne)._unit()._perp(),K=Q===V.length-1?new Pe(0,0):se.sub(ye)._unit()._perp(),ue=j._add(K)._unit(),Re=ue.x*K.x+ue.y*K.y;Re!==0&&ue._mult(1/Re),q.push(ue._mult(I)._add(ye))}F.push(q)}return F}(h,M*_)),function(A,I,F){for(let N=0;N<I.length;N++){const V=I[N];if(A.length>=3){for(let q=0;q<V.length;q++)if(Nl(A,V[q]))return!0}if(Ic(A,V,F))return!0}return!1}(v,h,w)}isTileClipped(){return!0}}function nr(r,t){return t>0?t+2*r:r}const Mf=Ji([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ef=Ji([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ji([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yd=Ji([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ji([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Th=Ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$l=Ji([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ca(r,t,a){return r.sections.forEach(o=>{o.text=function(h,g,_){const v=g.layout.get("text-transform").evaluate(_,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Yr.applyArabicShaping&&(h=Yr.applyArabicShaping(h)),h}(o.text,t,a)}),r}Ji([{name:"triangle",components:3,type:"Uint16"}]),Ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ji([{type:"Float32",name:"offsetX"}]),Ji([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ji([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ns={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Lc,Xl,vd,Rn=24,xd={};function Sh(){return Lc||(Lc=1,xd.read=function(r,t,a,o,h){var g,_,v=8*h-o-1,w=(1<<v)-1,M=w>>1,A=-7,I=a?h-1:0,F=a?-1:1,N=r[t+I];for(I+=F,g=N&(1<<-A)-1,N>>=-A,A+=v;A>0;g=256*g+r[t+I],I+=F,A-=8);for(_=g&(1<<-A)-1,g>>=-A,A+=o;A>0;_=256*_+r[t+I],I+=F,A-=8);if(g===0)g=1-M;else{if(g===w)return _?NaN:1/0*(N?-1:1);_+=Math.pow(2,o),g-=M}return(N?-1:1)*_*Math.pow(2,g-o)},xd.write=function(r,t,a,o,h,g){var _,v,w,M=8*g-h-1,A=(1<<M)-1,I=A>>1,F=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=o?0:g-1,V=o?1:-1,q=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,_=A):(_=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-_))<1&&(_--,w*=2),(t+=_+I>=1?F/w:F*Math.pow(2,1-I))*w>=2&&(_++,w/=2),_+I>=A?(v=0,_=A):_+I>=1?(v=(t*w-1)*Math.pow(2,h),_+=I):(v=t*Math.pow(2,I-1)*Math.pow(2,h),_=0));h>=8;r[a+N]=255&v,N+=V,v/=256,h-=8);for(_=_<<h|v,M+=h;M>0;r[a+N]=255&_,N+=V,_/=256,M-=8);r[a+N-V]|=128*q}),xd}function bd(){if(vd)return Xl;vd=1,Xl=t;var r=Sh();function t(j){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(j)?j:new Uint8Array(j||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var a=4294967296,o=1/a,h=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function g(j){return j.type===t.Bytes?j.readVarint()+j.pos:j.pos+1}function _(j,K,ue){return ue?4294967296*K+(j>>>0):4294967296*(K>>>0)+(j>>>0)}function v(j,K,ue){var Re=K<=16383?1:K<=2097151?2:K<=268435455?3:Math.floor(Math.log(K)/(7*Math.LN2));ue.realloc(Re);for(var tt=ue.pos-1;tt>=j;tt--)ue.buf[tt+Re]=ue.buf[tt]}function w(j,K){for(var ue=0;ue<j.length;ue++)K.writeVarint(j[ue])}function M(j,K){for(var ue=0;ue<j.length;ue++)K.writeSVarint(j[ue])}function A(j,K){for(var ue=0;ue<j.length;ue++)K.writeFloat(j[ue])}function I(j,K){for(var ue=0;ue<j.length;ue++)K.writeDouble(j[ue])}function F(j,K){for(var ue=0;ue<j.length;ue++)K.writeBoolean(j[ue])}function N(j,K){for(var ue=0;ue<j.length;ue++)K.writeFixed32(j[ue])}function V(j,K){for(var ue=0;ue<j.length;ue++)K.writeSFixed32(j[ue])}function q(j,K){for(var ue=0;ue<j.length;ue++)K.writeFixed64(j[ue])}function Q(j,K){for(var ue=0;ue<j.length;ue++)K.writeSFixed64(j[ue])}function ne(j,K){return(j[K]|j[K+1]<<8|j[K+2]<<16)+16777216*j[K+3]}function ye(j,K,ue){j[ue]=K,j[ue+1]=K>>>8,j[ue+2]=K>>>16,j[ue+3]=K>>>24}function se(j,K){return(j[K]|j[K+1]<<8|j[K+2]<<16)+(j[K+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(j,K,ue){for(ue=ue||this.length;this.pos<ue;){var Re=this.readVarint(),tt=Re>>3,Oe=this.pos;this.type=7&Re,j(tt,K,this),this.pos===Oe&&this.skip(Re)}return K},readMessage:function(j,K){return this.readFields(j,K,this.readVarint()+this.pos)},readFixed32:function(){var j=ne(this.buf,this.pos);return this.pos+=4,j},readSFixed32:function(){var j=se(this.buf,this.pos);return this.pos+=4,j},readFixed64:function(){var j=ne(this.buf,this.pos)+ne(this.buf,this.pos+4)*a;return this.pos+=8,j},readSFixed64:function(){var j=ne(this.buf,this.pos)+se(this.buf,this.pos+4)*a;return this.pos+=8,j},readFloat:function(){var j=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,j},readDouble:function(){var j=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,j},readVarint:function(j){var K,ue,Re=this.buf;return K=127&(ue=Re[this.pos++]),ue<128?K:(K|=(127&(ue=Re[this.pos++]))<<7,ue<128?K:(K|=(127&(ue=Re[this.pos++]))<<14,ue<128?K:(K|=(127&(ue=Re[this.pos++]))<<21,ue<128?K:function(tt,Oe,He){var rt,nt,lt=He.buf;if(rt=(112&(nt=lt[He.pos++]))>>4,nt<128||(rt|=(127&(nt=lt[He.pos++]))<<3,nt<128)||(rt|=(127&(nt=lt[He.pos++]))<<10,nt<128)||(rt|=(127&(nt=lt[He.pos++]))<<17,nt<128)||(rt|=(127&(nt=lt[He.pos++]))<<24,nt<128)||(rt|=(1&(nt=lt[He.pos++]))<<31,nt<128))return _(tt,rt,Oe);throw new Error("Expected varint not more than 10 bytes")}(K|=(15&(ue=Re[this.pos]))<<28,j,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var j=this.readVarint();return j%2==1?(j+1)/-2:j/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var j=this.readVarint()+this.pos,K=this.pos;return this.pos=j,j-K>=12&&h?function(ue,Re,tt){return h.decode(ue.subarray(Re,tt))}(this.buf,K,j):function(ue,Re,tt){for(var Oe="",He=Re;He<tt;){var rt,nt,lt,Xe=ue[He],wt=null,kt=Xe>239?4:Xe>223?3:Xe>191?2:1;if(He+kt>tt)break;kt===1?Xe<128&&(wt=Xe):kt===2?(192&(rt=ue[He+1]))==128&&(wt=(31&Xe)<<6|63&rt)<=127&&(wt=null):kt===3?(nt=ue[He+2],(192&(rt=ue[He+1]))==128&&(192&nt)==128&&((wt=(15&Xe)<<12|(63&rt)<<6|63&nt)<=2047||wt>=55296&&wt<=57343)&&(wt=null)):kt===4&&(nt=ue[He+2],lt=ue[He+3],(192&(rt=ue[He+1]))==128&&(192&nt)==128&&(192&lt)==128&&((wt=(15&Xe)<<18|(63&rt)<<12|(63&nt)<<6|63&lt)<=65535||wt>=1114112)&&(wt=null)),wt===null?(wt=65533,kt=1):wt>65535&&(wt-=65536,Oe+=String.fromCharCode(wt>>>10&1023|55296),wt=56320|1023&wt),Oe+=String.fromCharCode(wt),He+=kt}return Oe}(this.buf,K,j)},readBytes:function(){var j=this.readVarint()+this.pos,K=this.buf.subarray(this.pos,j);return this.pos=j,K},readPackedVarint:function(j,K){if(this.type!==t.Bytes)return j.push(this.readVarint(K));var ue=g(this);for(j=j||[];this.pos<ue;)j.push(this.readVarint(K));return j},readPackedSVarint:function(j){if(this.type!==t.Bytes)return j.push(this.readSVarint());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readSVarint());return j},readPackedBoolean:function(j){if(this.type!==t.Bytes)return j.push(this.readBoolean());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readBoolean());return j},readPackedFloat:function(j){if(this.type!==t.Bytes)return j.push(this.readFloat());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readFloat());return j},readPackedDouble:function(j){if(this.type!==t.Bytes)return j.push(this.readDouble());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readDouble());return j},readPackedFixed32:function(j){if(this.type!==t.Bytes)return j.push(this.readFixed32());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readFixed32());return j},readPackedSFixed32:function(j){if(this.type!==t.Bytes)return j.push(this.readSFixed32());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readSFixed32());return j},readPackedFixed64:function(j){if(this.type!==t.Bytes)return j.push(this.readFixed64());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readFixed64());return j},readPackedSFixed64:function(j){if(this.type!==t.Bytes)return j.push(this.readSFixed64());var K=g(this);for(j=j||[];this.pos<K;)j.push(this.readSFixed64());return j},skip:function(j){var K=7&j;if(K===t.Varint)for(;this.buf[this.pos++]>127;);else if(K===t.Bytes)this.pos=this.readVarint()+this.pos;else if(K===t.Fixed32)this.pos+=4;else{if(K!==t.Fixed64)throw new Error("Unimplemented type: "+K);this.pos+=8}},writeTag:function(j,K){this.writeVarint(j<<3|K)},realloc:function(j){for(var K=this.length||16;K<this.pos+j;)K*=2;if(K!==this.length){var ue=new Uint8Array(K);ue.set(this.buf),this.buf=ue,this.length=K}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(j){this.realloc(4),ye(this.buf,j,this.pos),this.pos+=4},writeSFixed32:function(j){this.realloc(4),ye(this.buf,j,this.pos),this.pos+=4},writeFixed64:function(j){this.realloc(8),ye(this.buf,-1&j,this.pos),ye(this.buf,Math.floor(j*o),this.pos+4),this.pos+=8},writeSFixed64:function(j){this.realloc(8),ye(this.buf,-1&j,this.pos),ye(this.buf,Math.floor(j*o),this.pos+4),this.pos+=8},writeVarint:function(j){(j=+j||0)>268435455||j<0?function(K,ue){var Re,tt;if(K>=0?(Re=K%4294967296|0,tt=K/4294967296|0):(tt=~(-K/4294967296),4294967295^(Re=~(-K%4294967296))?Re=Re+1|0:(Re=0,tt=tt+1|0)),K>=18446744073709552e3||K<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ue.realloc(10),function(Oe,He,rt){rt.buf[rt.pos++]=127&Oe|128,Oe>>>=7,rt.buf[rt.pos++]=127&Oe|128,Oe>>>=7,rt.buf[rt.pos++]=127&Oe|128,Oe>>>=7,rt.buf[rt.pos++]=127&Oe|128,rt.buf[rt.pos]=127&(Oe>>>=7)}(Re,0,ue),function(Oe,He){var rt=(7&Oe)<<4;He.buf[He.pos++]|=rt|((Oe>>>=3)?128:0),Oe&&(He.buf[He.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(He.buf[He.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(He.buf[He.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(He.buf[He.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(He.buf[He.pos++]=127&Oe)))))}(tt,ue)}(j,this):(this.realloc(4),this.buf[this.pos++]=127&j|(j>127?128:0),j<=127||(this.buf[this.pos++]=127&(j>>>=7)|(j>127?128:0),j<=127||(this.buf[this.pos++]=127&(j>>>=7)|(j>127?128:0),j<=127||(this.buf[this.pos++]=j>>>7&127))))},writeSVarint:function(j){this.writeVarint(j<0?2*-j-1:2*j)},writeBoolean:function(j){this.writeVarint(!!j)},writeString:function(j){j=String(j),this.realloc(4*j.length),this.pos++;var K=this.pos;this.pos=function(Re,tt,Oe){for(var He,rt,nt=0;nt<tt.length;nt++){if((He=tt.charCodeAt(nt))>55295&&He<57344){if(!rt){He>56319||nt+1===tt.length?(Re[Oe++]=239,Re[Oe++]=191,Re[Oe++]=189):rt=He;continue}if(He<56320){Re[Oe++]=239,Re[Oe++]=191,Re[Oe++]=189,rt=He;continue}He=rt-55296<<10|He-56320|65536,rt=null}else rt&&(Re[Oe++]=239,Re[Oe++]=191,Re[Oe++]=189,rt=null);He<128?Re[Oe++]=He:(He<2048?Re[Oe++]=He>>6|192:(He<65536?Re[Oe++]=He>>12|224:(Re[Oe++]=He>>18|240,Re[Oe++]=He>>12&63|128),Re[Oe++]=He>>6&63|128),Re[Oe++]=63&He|128)}return Oe}(this.buf,j,this.pos);var ue=this.pos-K;ue>=128&&v(K,ue,this),this.pos=K-1,this.writeVarint(ue),this.pos+=ue},writeFloat:function(j){this.realloc(4),r.write(this.buf,j,this.pos,!0,23,4),this.pos+=4},writeDouble:function(j){this.realloc(8),r.write(this.buf,j,this.pos,!0,52,8),this.pos+=8},writeBytes:function(j){var K=j.length;this.writeVarint(K),this.realloc(K);for(var ue=0;ue<K;ue++)this.buf[this.pos++]=j[ue]},writeRawMessage:function(j,K){this.pos++;var ue=this.pos;j(K,this);var Re=this.pos-ue;Re>=128&&v(ue,Re,this),this.pos=ue-1,this.writeVarint(Re),this.pos+=Re},writeMessage:function(j,K,ue){this.writeTag(j,t.Bytes),this.writeRawMessage(K,ue)},writePackedVarint:function(j,K){K.length&&this.writeMessage(j,w,K)},writePackedSVarint:function(j,K){K.length&&this.writeMessage(j,M,K)},writePackedBoolean:function(j,K){K.length&&this.writeMessage(j,F,K)},writePackedFloat:function(j,K){K.length&&this.writeMessage(j,A,K)},writePackedDouble:function(j,K){K.length&&this.writeMessage(j,I,K)},writePackedFixed32:function(j,K){K.length&&this.writeMessage(j,N,K)},writePackedSFixed32:function(j,K){K.length&&this.writeMessage(j,V,K)},writePackedFixed64:function(j,K){K.length&&this.writeMessage(j,q,K)},writePackedSFixed64:function(j,K){K.length&&this.writeMessage(j,Q,K)},writeBytesField:function(j,K){this.writeTag(j,t.Bytes),this.writeBytes(K)},writeFixed32Field:function(j,K){this.writeTag(j,t.Fixed32),this.writeFixed32(K)},writeSFixed32Field:function(j,K){this.writeTag(j,t.Fixed32),this.writeSFixed32(K)},writeFixed64Field:function(j,K){this.writeTag(j,t.Fixed64),this.writeFixed64(K)},writeSFixed64Field:function(j,K){this.writeTag(j,t.Fixed64),this.writeSFixed64(K)},writeVarintField:function(j,K){this.writeTag(j,t.Varint),this.writeVarint(K)},writeSVarintField:function(j,K){this.writeTag(j,t.Varint),this.writeSVarint(K)},writeStringField:function(j,K){this.writeTag(j,t.Bytes),this.writeString(K)},writeFloatField:function(j,K){this.writeTag(j,t.Fixed32),this.writeFloat(K)},writeDoubleField:function(j,K){this.writeTag(j,t.Fixed64),this.writeDouble(K)},writeBooleanField:function(j,K){this.writeVarintField(j,!!K)}},Xl}var ar=ge(bd());const wd=3;function Dr(r,t,a){r===1&&a.readMessage(yp,t)}function yp(r,t,a){if(r===3){const{id:o,bitmap:h,width:g,height:_,left:v,top:w,advance:M}=a.readMessage(vp,{});t.push({id:o,bitmap:new Eu({width:g+2*wd,height:_+2*wd},h),metrics:{width:g,height:_,left:v,top:w,advance:M}})}}function vp(r,t,a){r===1?t.id=a.readVarint():r===2?t.bitmap=a.readBytes():r===3?t.width=a.readVarint():r===4?t.height=a.readVarint():r===5?t.left=a.readSVarint():r===6?t.top=a.readSVarint():r===7&&(t.advance=a.readVarint())}const Yp=wd;function el(r){let t=0,a=0;for(const _ of r)t+=_.w*_.h,a=Math.max(a,_.w);r.sort((_,v)=>v.h-_.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let h=0,g=0;for(const _ of r)for(let v=o.length-1;v>=0;v--){const w=o[v];if(!(_.w>w.w||_.h>w.h)){if(_.x=w.x,_.y=w.y,g=Math.max(g,_.y+_.h),h=Math.max(h,_.x+_.w),_.w===w.w&&_.h===w.h){const M=o.pop();v<o.length&&(o[v]=M)}else _.h===w.h?(w.x+=_.w,w.w-=_.w):_.w===w.w?(w.y+=_.h,w.h-=_.h):(o.push({x:w.x+_.w,y:w.y,w:w.w-_.w,h:_.h}),w.y+=_.h,w.h-=_.h);break}}return{w:h,h:g,fill:t/(h*g)||0}}const ya=1;class Mh{constructor(t,{pixelRatio:a,version:o,stretchX:h,stretchY:g,content:_,textFitWidth:v,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=h,this.stretchY=g,this.content=_,this.version=o,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+ya,this.paddedRect.y+ya]}get br(){return[this.paddedRect.x+this.paddedRect.w-ya,this.paddedRect.y+this.paddedRect.h-ya]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ya)/this.pixelRatio,(this.paddedRect.h-2*ya)/this.pixelRatio]}}class Bc{constructor(t,a){const o={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,o,g),this.addImages(a,h,g);const{w:_,h:v}=el(g),w=new mr({width:_||1,height:v||1});for(const M in t){const A=t[M],I=o[M].paddedRect;mr.copy(A.data,w,{x:0,y:0},{x:I.x+ya,y:I.y+ya},A.data)}for(const M in a){const A=a[M],I=h[M].paddedRect,F=I.x+ya,N=I.y+ya,V=A.data.width,q=A.data.height;mr.copy(A.data,w,{x:0,y:0},{x:F,y:N},A.data),mr.copy(A.data,w,{x:0,y:q-1},{x:F,y:N-1},{width:V,height:1}),mr.copy(A.data,w,{x:0,y:0},{x:F,y:N+q},{width:V,height:1}),mr.copy(A.data,w,{x:V-1,y:0},{x:F-1,y:N},{width:1,height:q}),mr.copy(A.data,w,{x:0,y:0},{x:F+V,y:N},{width:1,height:q})}this.image=w,this.iconPositions=o,this.patternPositions=h}addImages(t,a,o){for(const h in t){const g=t[h],_={x:0,y:0,w:g.data.width+2*ya,h:g.data.height+2*ya};o.push(_),a[h]=new Mh(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in t.updatedImages)this.patchUpdatedImage(this.iconPositions[o],t.getImage(o),a),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o),a)}patchUpdatedImage(t,a,o){if(!t||!a||t.version===a.version)return;t.version=a.version;const[h,g]=t.tl;o.update(a.data,void 0,{x:h,y:g})}}var tl;vt("ImagePosition",Mh),vt("ImageAtlas",Bc),P.al=void 0,(tl=P.al||(P.al={}))[tl.none=0]="none",tl[tl.horizontal=1]="horizontal",tl[tl.vertical=2]="vertical",tl[tl.horizontalOnly=3]="horizontalOnly";const Eh=-17;class Lu{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,o){const h=new Lu;return h.scale=t||1,h.fontStack=a,h.verticalAlign=o||"bottom",h}static forImage(t,a){const o=new Lu;return o.imageName=t,o.verticalAlign=a||"bottom",o}}class Yl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const o=new Yl;for(let h=0;h<t.sections.length;h++){const g=t.sections[h];g.image?o.addImageSection(g):o.addTextSection(g,a)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let o=0;o<t.length;o++){const h=t.charCodeAt(o+1)||null,g=t.charCodeAt(o-1)||null;a+=h&&ys(h)&&!ns[t[o+1]]||g&&ys(g)&&!ns[t[o-1]]||!ns[t[o]]?t[o]:ns[t[o]]}return a}(this.text)}trim(){let t=0;for(let o=0;o<this.text.length&&Td[this.text.charCodeAt(o)];o++)t++;let a=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&Td[this.text.charCodeAt(o)];o--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const o=new Yl;return o.text=this.text.substring(t,a),o.sectionIndex=this.sectionIndex.slice(t,a),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}getMaxImageSize(t){let a=0,o=0;for(let h=0;h<this.length();h++){const g=this.getSection(h);if(g.imageName){const _=t[g.imageName];if(!_)continue;const v=_.displaySize;a=Math.max(a,v[0]),o=Math.max(o,v[1])}}return{maxImageWidth:a,maxImageHeight:o}}addTextSection(t,a){this.text+=t.text,this.sections.push(Lu.forText(t.scale,t.fontStack||a,t.verticalAlign));const o=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(o)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void Qi("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(Lu.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Qi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Bu(r,t,a,o,h,g,_,v,w,M,A,I,F,N,V){const q=Yl.fromFeature(r,h);let Q;I===P.al.vertical&&q.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:ye}=Yr;if(ne&&q.sections.length===1){Q=[];const K=ne(q.toString(),Sd(q,M,g,t,o,N));for(const ue of K){const Re=new Yl;Re.text=ue,Re.sections=q.sections;for(let tt=0;tt<ue.length;tt++)Re.sectionIndex.push(0);Q.push(Re)}}else if(ye){Q=[];const K=ye(q.text,q.sectionIndex,Sd(q,M,g,t,o,N));for(const ue of K){const Re=new Yl;Re.text=ue[0],Re.sectionIndex=ue[1],Re.sections=q.sections,Q.push(Re)}}else Q=function(K,ue){const Re=[],tt=K.text;let Oe=0;for(const He of ue)Re.push(K.substring(Oe,He)),Oe=He;return Oe<tt.length&&Re.push(K.substring(Oe,tt.length)),Re}(q,Sd(q,M,g,t,o,N));const se=[],j={positionedLines:se,text:q.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:I,iconsInText:!1,verticalizable:!1};return function(K,ue,Re,tt,Oe,He,rt,nt,lt,Xe,wt,kt){let It=0,Et=0,ai=0,Ci=0;const $i=nt==="right"?1:nt==="left"?0:.5,gn=Rn/kt;let Aa=0;for(const cn of Oe){cn.trim();const Zn=cn.getMaxScale(),kn={positionedGlyphs:[],lineOffset:0};K.positionedLines[Aa]=kn;const sa=kn.positionedGlyphs;let za=0;if(!cn.length()){Et+=He,++Aa;continue}const Na=xp(tt,cn,gn);for(let rr=0;rr<cn.length();rr++){const Cn=cn.getSection(rr),Ln=cn.getSectionIndex(rr),qn=cn.getCharCode(rr),un=bp(lt,wt,qn);let Fi;if(Cn.imageName){if(K.iconsInText=!0,Cn.scale=Cn.scale*gn,Fi=wp(Cn,un,Zn,Na,tt),!Fi)continue;za=Math.max(za,Fi.imageOffset)}else if(Fi=Ed(Cn,qn,un,Na,ue,Re),!Fi)continue;const{rect:_r,metrics:Gc,baselineOffset:Rs}=Fi;sa.push({glyph:qn,imageName:Cn.imageName,x:It,y:Et+Rs+Eh,vertical:un,scale:Cn.scale,fontStack:Cn.fontStack,sectionIndex:Ln,metrics:Gc,rect:_r}),un?(K.verticalizable=!0,It+=(Cn.imageName?Gc.advance:Rn)*Cn.scale+Xe):It+=Gc.advance*Cn.scale+Xe}sa.length!==0&&(ai=Math.max(It-Xe,ai),Tp(sa,0,sa.length-1,$i)),It=0,kn.lineOffset=Math.max(za,(Zn-1)*Rn);const Gn=He*Zn+za;Et+=Gn,Ci=Math.max(Gn,Ci),++Aa}const{horizontalAlign:ra,verticalAlign:ln}=Md(rt);(function(cn,Zn,kn,sa,za,Na,Gn,rr,Cn){const Ln=(Zn-kn)*za;let qn=0;qn=Na!==Gn?-rr*sa-Eh:-sa*Cn*Gn+.5*Gn;for(const un of cn)for(const Fi of un.positionedGlyphs)Fi.x+=Ln,Fi.y+=qn})(K.positionedLines,$i,ra,ln,ai,Ci,He,Et,Oe.length),K.top+=-ln*Et,K.bottom=K.top+Et,K.left+=-ra*ai,K.right=K.left+ai}(j,t,a,o,Q,_,v,w,I,M,F,V),!function(K){for(const ue of K)if(ue.positionedGlyphs.length!==0)return!1;return!0}(se)&&j}const Td={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Kp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Qp={40:!0};function Cf(r,t,a,o,h,g){if(t.imageName){const _=o[t.imageName];return _?_.displaySize[0]*t.scale*Rn/g+h:0}{const _=a[t.fontStack],v=_&&_[r];return v?v.metrics.advance*t.scale+h:0}}function Af(r,t,a,o){const h=Math.pow(r-t,2);return o?r<t?h/2:2*h:h+Math.abs(a)*a}function Ou(r,t,a){let o=0;return r===10&&(o-=1e4),a&&(o+=150),r!==40&&r!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function Ch(r,t,a,o,h,g){let _=null,v=Af(t,a,h,g);for(const w of o){const M=Af(t-w.x,a,h,g)+w.badness;M<=v&&(_=w,v=M)}return{index:r,x:t,priorBreak:_,badness:v}}function zf(r){return r?zf(r.priorBreak).concat(r.index):[]}function Sd(r,t,a,o,h,g){if(!r)return[];const _=[],v=function(I,F,N,V,q,Q){let ne=0;for(let ye=0;ye<I.length();ye++){const se=I.getSection(ye);ne+=Cf(I.getCharCode(ye),se,V,q,F,Q)}return ne/Math.max(1,Math.ceil(ne/N))}(r,t,a,o,h,g),w=r.text.indexOf("")>=0;let M=0;for(let I=0;I<r.length();I++){const F=r.getSection(I),N=r.getCharCode(I);if(Td[N]||(M+=Cf(N,F,o,h,t,g)),I<r.length()-1){const V=!((A=N)<11904)&&(!!ti["CJK Compatibility Forms"](A)||!!ti["CJK Compatibility"](A)||!!ti["CJK Strokes"](A)||!!ti["CJK Symbols and Punctuation"](A)||!!ti["Enclosed CJK Letters and Months"](A)||!!ti["Halfwidth and Fullwidth Forms"](A)||!!ti["Ideographic Description Characters"](A)||!!ti["Vertical Forms"](A)||Xr.test(String.fromCodePoint(A)));(Kp[N]||V||F.imageName||I!==r.length()-2&&Qp[r.getCharCode(I+1)])&&_.push(Ch(I+1,M,v,_,Ou(N,r.getCharCode(I+1),V&&w),!1))}}var A;return zf(Ch(r.length(),M,v,_,0,!0))}function Md(r){let t=.5,a=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function xp(r,t,a){const o=t.getMaxScale()*Rn,{maxImageWidth:h,maxImageHeight:g}=t.getMaxImageSize(r),_=Math.max(o,g*a);return{verticalLineContentWidth:Math.max(o,h*a),horizontalLineContentHeight:_}}function Pf(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function bp(r,t,a){return!(r===P.al.horizontal||!t&&!Er(a)||t&&(Td[a]||(o=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function Ed(r,t,a,o,h,g){const _=g[r.fontStack],v=function(M,A,I,F){if(M&&M.rect)return M;const N=A[I.fontStack],V=N&&N[F];return V?{rect:null,metrics:V.metrics}:null}(_&&_[t],h,r,t);if(v===null)return null;let w;if(a)w=o.verticalLineContentWidth-r.scale*Rn;else{const M=Pf(r.verticalAlign);w=(o.horizontalLineContentHeight-r.scale*Rn)*M}return{rect:v.rect,metrics:v.metrics,baselineOffset:w}}function wp(r,t,a,o,h){const g=h[r.imageName];if(!g)return null;const _=g.paddedRect,v=g.displaySize,w={width:v[0],height:v[1],left:ya,top:-3,advance:t?v[1]:v[0]};let M;if(t)M=o.verticalLineContentWidth-v[1]*r.scale;else{const A=Pf(r.verticalAlign);M=(o.horizontalLineContentHeight-v[1]*r.scale)*A}return{rect:_,metrics:w,baselineOffset:M,imageOffset:(t?v[0]:v[1])*r.scale-Rn*a}}function Tp(r,t,a,o){if(o===0)return;const h=r[a],g=(r[a].x+h.metrics.advance*h.scale)*o;for(let _=t;_<=a;_++)r[_].x-=g}function an(r,t,a){const{horizontalAlign:o,verticalAlign:h}=Md(a),g=t[0]-r.displaySize[0]*o,_=t[1]-r.displaySize[1]*h;return{image:r,top:_,bottom:_+r.displaySize[1],left:g,right:g+r.displaySize[0]}}function Cd(r){var t,a;let o=r.left,h=r.top,g=r.right-o,_=r.bottom-h;const v=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(a=r.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",M=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&g/_<M||v==="proportional"){const A=Math.ceil(_*M);o*=A/g,g=A}}else if(v==="proportional"&&w==="stretchOnly"&&M!==0&&g/_>M){const A=Math.ceil(g/M);h*=A/_,_=A}return{x1:o,y1:h,x2:o+g,y2:h+_}}function Sp(r,t,a,o,h,g){const _=r.image;let v;if(_.content){const Q=_.content,ne=_.pixelRatio||1;v=[Q[0]/ne,Q[1]/ne,_.displaySize[0]-Q[2]/ne,_.displaySize[1]-Q[3]/ne]}const w=t.left*g,M=t.right*g;let A,I,F,N;a==="width"||a==="both"?(N=h[0]+w-o[3],I=h[0]+M+o[1]):(N=h[0]+(w+M-_.displaySize[0])/2,I=N+_.displaySize[0]);const V=t.top*g,q=t.bottom*g;return a==="height"||a==="both"?(A=h[1]+V-o[0],F=h[1]+q+o[2]):(A=h[1]+(V+q-_.displaySize[1])/2,F=A+_.displaySize[1]),{image:_,top:A,right:I,bottom:F,left:N,collisionPadding:v}}const Fu=255,ho=128,Kl=Fu*ho;function Mp(r,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Ui(r+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:h}=a;let g=0;for(;g<o.length&&o[g]<=r;)g++;g=Math.max(0,g-1);let _=g;for(;_<o.length&&o[_]<r+1;)_++;_=Math.min(o.length-1,_);const v=o[g],w=o[_];return a.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:w,minSize:a.evaluate(new Ui(v)),maxSize:a.evaluate(new Ui(w)),interpolationType:h}}}function ju(r,t,a){let o="never";const h=r.get(t);return h?o=h:r.get(a)&&(o="always"),o}const Nu=Qo.VectorTileFeature.types,Df=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Oc(r,t,a,o,h,g,_,v,w,M,A,I,F){const N=v?Math.min(Kl,Math.round(v[0])):0,V=v?Math.min(Kl,Math.round(v[1])):0;r.emplaceBack(t,a,Math.round(32*o),Math.round(32*h),g,_,(N<<1)+(w?1:0),V,16*M,16*A,256*I,256*F)}function Ah(r,t,a){r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a)}function Fc(r){for(const t of r.sections)if(Cc(t.text))return!0;return!1}class as{constructor(t){this.layoutVertexArray=new tn,this.indexArray=new bi,this.programConfigurations=t,this.segments=new Ti,this.dynamicLayoutVertexArray=new Pi,this.opacityVertexArray=new nn,this.hasVisibleVertices=!1,this.placedSymbolArray=new de}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,o,h){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ef.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Df,!0),this.opacityVertexBuffer.itemSize=1),(o||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}vt("SymbolBuffers",as);class jc{constructor(t,a,o){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new o,this.segments=new Ti,this.collisionVertexArray=new Bi}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,yd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}vt("CollisionBuffers",jc);class Uu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mp(this.zoom,a["text-size"]),this.iconSizeData=Mp(this.zoom,a["icon-size"]);const o=this.layers[0].layout,h=o.get("symbol-sort-key"),g=o.get("symbol-z-order");this.canOverlap=ju(o,"text-overlap","text-allow-overlap")!=="never"||ju(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map(_=>P.al[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new as(new Cs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new as(new Cs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new xe,this.lineVertexArray=new _e,this.symbolInstances=new me,this.textAnchorOffsets=new $e}calculateGlyphDependencies(t,a,o,h,g){for(let _=0;_<t.length;_++)if(a[t.charCodeAt(_)]=!0,(o||h)&&g){const v=ns[t.charAt(_)];v&&(a[v.charCodeAt(0)]=!0)}}populate(t,a,o){const h=this.layers[0],g=h.layout,_=g.get("text-font"),v=g.get("text-field"),w=g.get("icon-image"),M=(v.value.kind!=="constant"||v.value.value instanceof Nn&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),A=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,I=g.get("symbol-sort-key");if(this.features=[],!M&&!A)return;const F=a.iconDependencies,N=a.glyphDependencies,V=a.availableImages,q=new Ui(this.zoom);for(const{feature:Q,id:ne,index:ye,sourceLayerIndex:se}of t){const j=h._featureFilter.needGeometry,K=tr(Q,j);if(!h._featureFilter.filter(q,K,o))continue;let ue,Re;if(j||(K.geometry=pr(Q)),M){const Oe=h.getValueAndResolveTokens("text-field",K,o,V),He=Nn.factory(Oe),rt=this.hasRTLText=this.hasRTLText||Fc(He);(!rt||Yr.getRTLTextPluginStatus()==="unavailable"||rt&&Yr.isParsed())&&(ue=Ca(He,h,K))}if(A){const Oe=h.getValueAndResolveTokens("icon-image",K,o,V);Re=Oe instanceof wa?Oe:wa.fromString(Oe)}if(!ue&&!Re)continue;const tt=this.sortFeaturesByKey?I.evaluate(K,{},o):void 0;if(this.features.push({id:ne,text:ue,icon:Re,index:ye,sourceLayerIndex:se,geometry:K.geometry,properties:Q.properties,type:Nu[Q.type],sortKey:tt}),Re&&(F[Re.name]=!0),ue){const Oe=_.evaluate(K,{},o).join(","),He=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(P.al.vertical)>=0;for(const rt of ue.sections)if(rt.image)F[rt.image.name]=!0;else{const nt=Mc(ue.toString()),lt=rt.fontStack||Oe,Xe=N[lt]=N[lt]||{};this.calculateGlyphDependencies(rt.text,Xe,He,this.allowVerticalPlacement,nt)}}}g.get("symbol-placement")==="line"&&(this.features=function(Q){const ne={},ye={},se=[];let j=0;function K(Oe){se.push(Q[Oe]),j++}function ue(Oe,He,rt){const nt=ye[Oe];return delete ye[Oe],ye[He]=nt,se[nt].geometry[0].pop(),se[nt].geometry[0]=se[nt].geometry[0].concat(rt[0]),nt}function Re(Oe,He,rt){const nt=ne[He];return delete ne[He],ne[Oe]=nt,se[nt].geometry[0].shift(),se[nt].geometry[0]=rt[0].concat(se[nt].geometry[0]),nt}function tt(Oe,He,rt){const nt=rt?He[0][He[0].length-1]:He[0][0];return`${Oe}:${nt.x}:${nt.y}`}for(let Oe=0;Oe<Q.length;Oe++){const He=Q[Oe],rt=He.geometry,nt=He.text?He.text.toString():null;if(!nt){K(Oe);continue}const lt=tt(nt,rt),Xe=tt(nt,rt,!0);if(lt in ye&&Xe in ne&&ye[lt]!==ne[Xe]){const wt=Re(lt,Xe,rt),kt=ue(lt,Xe,se[wt].geometry);delete ne[lt],delete ye[Xe],ye[tt(nt,se[kt].geometry,!0)]=kt,se[wt].geometry=null}else lt in ye?ue(lt,Xe,rt):Xe in ne?Re(lt,Xe,rt):(K(Oe),ne[lt]=j-1,ye[Xe]=j-1)}return se.filter(Oe=>Oe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,ne)=>Q.sortKey-ne.sortKey)}update(t,a,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,o),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,o))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const o=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(a[t.segment+1]),g=t.dist(a[t.segment]);const _={};for(let v=t.segment+1;v<a.length;v++)_[v]={x:a[v].x,y:a[v].y,tileUnitDistanceFromAnchor:h},v<a.length-1&&(h+=a[v+1].dist(a[v]));for(let v=t.segment||0;v>=0;v--)_[v]={x:a[v].x,y:a[v].y,tileUnitDistanceFromAnchor:g},v>0&&(g+=a[v-1].dist(a[v]));for(let v=0;v<a.length;v++){const w=_[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,a,o,h,g,_,v,w,M,A,I,F){const N=t.indexArray,V=t.layoutVertexArray,q=t.segments.prepareSegment(4*a.length,V,N,this.canOverlap?_.sortKey:void 0),Q=this.glyphOffsetArray.length,ne=q.vertexLength,ye=this.allowVerticalPlacement&&v===P.al.vertical?Math.PI/2:0,se=_.text&&_.text.sections;for(let j=0;j<a.length;j++){const{tl:K,tr:ue,bl:Re,br:tt,tex:Oe,pixelOffsetTL:He,pixelOffsetBR:rt,minFontScaleX:nt,minFontScaleY:lt,glyphOffset:Xe,isSDF:wt,sectionIndex:kt}=a[j],It=q.vertexLength,Et=Xe[1];Oc(V,w.x,w.y,K.x,Et+K.y,Oe.x,Oe.y,o,wt,He.x,He.y,nt,lt),Oc(V,w.x,w.y,ue.x,Et+ue.y,Oe.x+Oe.w,Oe.y,o,wt,rt.x,He.y,nt,lt),Oc(V,w.x,w.y,Re.x,Et+Re.y,Oe.x,Oe.y+Oe.h,o,wt,He.x,rt.y,nt,lt),Oc(V,w.x,w.y,tt.x,Et+tt.y,Oe.x+Oe.w,Oe.y+Oe.h,o,wt,rt.x,rt.y,nt,lt),Ah(t.dynamicLayoutVertexArray,w,ye),N.emplaceBack(It,It+2,It+1),N.emplaceBack(It+1,It+2,It+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xe[0]),j!==a.length-1&&kt===a[j+1].sectionIndex||t.programConfigurations.populatePaintArrays(V.length,_,_.index,{},F,se&&se[kt])}t.placedSymbolArray.emplaceBack(w.x,w.y,Q,this.glyphOffsetArray.length-Q,ne,M,A,w.segment,o?o[0]:0,o?o[1]:0,h[0],h[1],v,0,!1,0,I)}_addCollisionDebugVertex(t,a,o,h,g,_){return a.emplaceBack(0,0),t.emplaceBack(o.x,o.y,h,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,a,o,h,g,_,v){const w=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),M=w.vertexLength,A=g.layoutVertexArray,I=g.collisionVertexArray,F=v.anchorX,N=v.anchorY;this._addCollisionDebugVertex(A,I,_,F,N,new Pe(t,a)),this._addCollisionDebugVertex(A,I,_,F,N,new Pe(o,a)),this._addCollisionDebugVertex(A,I,_,F,N,new Pe(o,h)),this._addCollisionDebugVertex(A,I,_,F,N,new Pe(t,h)),w.vertexLength+=4;const V=g.indexArray;V.emplaceBack(M,M+1),V.emplaceBack(M+1,M+2),V.emplaceBack(M+2,M+3),V.emplaceBack(M+3,M),w.primitiveLength+=4}addDebugCollisionBoxes(t,a,o,h){for(let g=t;g<a;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,h?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new jc(Hi,Th.members,Pn),this.iconCollisionBox=new jc(Hi,Th.members,Pn);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,o,h,g,_,v,w,M){const A={};for(let I=a;I<o;I++){const F=t.get(I);A.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},A.textFeatureIndex=F.featureIndex;break}for(let I=h;I<g;I++){const F=t.get(I);A.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},A.verticalTextFeatureIndex=F.featureIndex;break}for(let I=_;I<v;I++){const F=t.get(I);A.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},A.iconFeatureIndex=F.featureIndex;break}for(let I=w;I<M;I++){const F=t.get(I);A.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},A.verticalIconFeatureIndex=F.featureIndex;break}return A}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const o=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const o=t.placedSymbolArray.get(a),h=o.vertexStartIndex+4*o.numGlyphs;for(let g=o.vertexStartIndex;g<h;g+=4)t.indexArray.emplaceBack(g,g+2,g+1),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),o=Math.cos(t),h=[],g=[],_=[];for(let v=0;v<this.symbolInstances.length;++v){_.push(v);const w=this.symbolInstances.get(v);h.push(0|Math.round(a*w.anchorX+o*w.anchorY)),g.push(w.featureIndex)}return _.sort((v,w)=>h[v]-h[w]||g[w]-g[v]),_}addToSortKeyRanges(t,a){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===a?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const o=this.symbolInstances.get(a);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((h,g,_)=>{h>=0&&_.indexOf(h)===g&&this.addIndicesForPlacedSymbol(this.text,h)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let If,Rf;vt("SymbolBucket",Uu,{omit:["layers","collisionBoxArray","features","compareText"]}),Uu.MAX_GLYPHS=65535,Uu.addDynamicAttributes=Ah;var Ad={get paint(){return Rf=Rf||new on({"icon-opacity":new jt(W.paint_symbol["icon-opacity"]),"icon-color":new jt(W.paint_symbol["icon-color"]),"icon-halo-color":new jt(W.paint_symbol["icon-halo-color"]),"icon-halo-width":new jt(W.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jt(W.paint_symbol["icon-halo-blur"]),"icon-translate":new gt(W.paint_symbol["icon-translate"]),"icon-translate-anchor":new gt(W.paint_symbol["icon-translate-anchor"]),"text-opacity":new jt(W.paint_symbol["text-opacity"]),"text-color":new jt(W.paint_symbol["text-color"],{runtimeType:Ri,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new jt(W.paint_symbol["text-halo-color"]),"text-halo-width":new jt(W.paint_symbol["text-halo-width"]),"text-halo-blur":new jt(W.paint_symbol["text-halo-blur"]),"text-translate":new gt(W.paint_symbol["text-translate"]),"text-translate-anchor":new gt(W.paint_symbol["text-translate-anchor"])})},get layout(){return If=If||new on({"symbol-placement":new gt(W.layout_symbol["symbol-placement"]),"symbol-spacing":new gt(W.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gt(W.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jt(W.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gt(W.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gt(W.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gt(W.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gt(W.layout_symbol["icon-ignore-placement"]),"icon-optional":new gt(W.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gt(W.layout_symbol["icon-rotation-alignment"]),"icon-size":new jt(W.layout_symbol["icon-size"]),"icon-text-fit":new gt(W.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gt(W.layout_symbol["icon-text-fit-padding"]),"icon-image":new jt(W.layout_symbol["icon-image"]),"icon-rotate":new jt(W.layout_symbol["icon-rotate"]),"icon-padding":new jt(W.layout_symbol["icon-padding"]),"icon-keep-upright":new gt(W.layout_symbol["icon-keep-upright"]),"icon-offset":new jt(W.layout_symbol["icon-offset"]),"icon-anchor":new jt(W.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gt(W.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gt(W.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gt(W.layout_symbol["text-rotation-alignment"]),"text-field":new jt(W.layout_symbol["text-field"]),"text-font":new jt(W.layout_symbol["text-font"]),"text-size":new jt(W.layout_symbol["text-size"]),"text-max-width":new jt(W.layout_symbol["text-max-width"]),"text-line-height":new gt(W.layout_symbol["text-line-height"]),"text-letter-spacing":new jt(W.layout_symbol["text-letter-spacing"]),"text-justify":new jt(W.layout_symbol["text-justify"]),"text-radial-offset":new jt(W.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gt(W.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new jt(W.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new jt(W.layout_symbol["text-anchor"]),"text-max-angle":new gt(W.layout_symbol["text-max-angle"]),"text-writing-mode":new gt(W.layout_symbol["text-writing-mode"]),"text-rotate":new jt(W.layout_symbol["text-rotate"]),"text-padding":new gt(W.layout_symbol["text-padding"]),"text-keep-upright":new gt(W.layout_symbol["text-keep-upright"]),"text-transform":new jt(W.layout_symbol["text-transform"]),"text-offset":new jt(W.layout_symbol["text-offset"]),"text-allow-overlap":new gt(W.layout_symbol["text-allow-overlap"]),"text-overlap":new gt(W.layout_symbol["text-overlap"]),"text-ignore-placement":new gt(W.layout_symbol["text-ignore-placement"]),"text-optional":new gt(W.layout_symbol["text-optional"])})}};class kf{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Vt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vt("FormatSectionOverride",kf,{omit:["defaultValue"]});class zd extends fr{constructor(t){super(t,Ad)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const h=[];for(const g of o)h.indexOf(g)<0&&h.push(g);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,o,h){const g=this.layout.get(t).evaluate(a,{},o,h),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||jo(_.value)||!g?g:function(v,w){return w.replace(/{([^{}]+)}/g,(M,A)=>v&&A in v?String(v[A]):"")}(a.properties,g)}createBucket(t){return new Uu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Ad.paint.overridableProperties){if(!zd.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),o=new kf(a),h=new zl(o,a.property.specification);let g=null;g=a.value.kind==="constant"||a.value.kind==="source"?new Ws("source",h):new No("composite",h,a.value.zoomStops),this.paint._values[t]=new Gt(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,o){return!(!this.layout||a.isDataDriven()||o.isDataDriven())&&zd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const o=t.get("text-field"),h=Ad.paint.properties[a];let g=!1;const _=v=>{for(const w of v)if(h.overrides&&h.overrides.hasOverride(w))return void(g=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Nn)_(o.value.value.sections);else if(o.value.kind==="source"){const v=M=>{g||(M instanceof $t&&qi(M.value)===dl?_(M.value.sections):M instanceof tu?_(M.sections):M.eachChild(v))},w=o.value;w._styleExpression&&v(w._styleExpression.expression)}return g}}let Pd;var Ep={get paint(){return Pd=Pd||new on({"background-color":new gt(W.paint_background["background-color"]),"background-pattern":new vs(W.paint_background["background-pattern"]),"background-opacity":new gt(W.paint_background["background-opacity"])})}};class Cp extends fr{constructor(t){super(t,Ep)}}let Ap;var Lf={get paint(){return Ap=Ap||new on({"raster-opacity":new gt(W.paint_raster["raster-opacity"]),"raster-hue-rotate":new gt(W.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gt(W.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gt(W.paint_raster["raster-brightness-max"]),"raster-saturation":new gt(W.paint_raster["raster-saturation"]),"raster-contrast":new gt(W.paint_raster["raster-contrast"]),"raster-resampling":new gt(W.paint_raster["raster-resampling"]),"raster-fade-duration":new gt(W.paint_raster["raster-fade-duration"])})}};class Bf extends fr{constructor(t){super(t,Lf)}}class Wp extends fr{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Jp{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const zh={once:!0},Of=63710088e-1;class il{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new il(Rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,o=this.lat*a,h=t.lat*a,g=Math.sin(o)*Math.sin(h)+Math.cos(o)*Math.cos(h)*Math.cos((t.lng-this.lng)*a);return Of*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof il)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new il(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new il(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const _i=2*Math.PI*Of;function Dd(r){return _i*Math.cos(r*Math.PI/180)}function Ph(r){return(180+r)/360}function Id(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Ff(r,t){return r/Dd(t)}function Dh(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Vu(r,t){return r*Dd(Dh(t))}class Ql{constructor(t,a,o=0){this.x=+t,this.y=+a,this.z=+o}static fromLngLat(t,a=0){const o=il.convert(t);return new Ql(Ph(o.lng),Id(o.lat),Ff(a,o.lat))}toLngLat(){return new il(360*this.x-180,Dh(this.y))}toAltitude(){return Vu(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/_i*(t=Dh(this.y),1/Math.cos(t*Math.PI/180));var t}}function Nc(r,t,a){var o=2*Math.PI*6378137/256/Math.pow(2,a);return[r*o-2*Math.PI*6378137/2,t*o-2*Math.PI*6378137/2]}class Rd{constructor(t,a,o){if(!function(h,g,_){return!(h<0||h>25||_<0||_>=Math.pow(2,h)||g<0||g>=Math.pow(2,h))}(t,a,o))throw new Error(`x=${a}, y=${o}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=o,this.key=Uc(0,t,t,a,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,o){const h=(_=this.y,v=this.z,w=Nc(256*(g=this.x),256*(_=Math.pow(2,v)-_-1),v),M=Nc(256*(g+1),256*(_+1),v),w[0]+","+w[1]+","+M[0]+","+M[1]);var g,_,v,w,M;const A=function(I,F,N){let V,q="";for(let Q=I;Q>0;Q--)V=1<<Q-1,q+=(F&V?1:0)+(N&V?2:0);return q}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new Pe((t.x*a-this.x)*Ge,(t.y*a-this.y)*Ge)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zp{constructor(t,a){this.wrap=t,this.canonical=a,this.key=Uc(t,a.z,a.z,a.x,a.y)}}class Ir{constructor(t,a,o,h,g){if(this.terrainRttPosMatrix32f=null,t<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${o}`);this.overscaledZ=t,this.wrap=a,this.canonical=new Rd(o,+h,+g),this.key=Uc(a,t,o,h,g)}clone(){return new Ir(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new Ir(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ir(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?Uc(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):Uc(this.wrap*+a,t,t,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new Ir(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,o=2*this.canonical.x,h=2*this.canonical.y;return[new Ir(a,this.wrap,a,o,h),new Ir(a,this.wrap,a,o+1,h),new Ir(a,this.wrap,a,o,h+1),new Ir(a,this.wrap,a,o+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ir(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ir(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Ql(t.x-this.wrap,t.y))}}function Uc(r,t,a,o,h){(r*=2)<0&&(r=-1*r-1);const g=1<<a;return(g*g*r+g*h+o).toString(36)+a.toString(36)+t.toString(36)}vt("CanonicalTileID",Rd),vt("OverscaledTileID",Ir,{omit:["terrainRttPosMatrix32f"]});class jf{constructor(t,a,o,h=1,g=1,_=1,v=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void Qi(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const w=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=g,this.blueFactor=_,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<w;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(w,M)]=this.data[this._idx(w-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,w)]=this.data[this._idx(M,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<w;M++)for(let A=0;A<w;A++){const I=this.get(M,A);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(t,a){const o=new Uint8Array(this.data.buffer),h=4*this._idx(t,a);return this.unpack(o[h],o[h+1],o[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,o){return t*this.redFactor+a*this.greenFactor+o*this.blueFactor-this.baseShift}getPixels(){return new mr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=a*this.dim,g=a*this.dim+this.dim,_=o*this.dim,v=o*this.dim+this.dim;switch(a){case-1:h=g-1;break;case 1:g=h+1}switch(o){case-1:_=v-1;break;case 1:v=_+1}const w=-a*this.dim,M=-o*this.dim;for(let A=_;A<v;A++)for(let I=h;I<g;I++)this.data[this._idx(I,A)]=t.data[this._idx(I+w,A+M)]}}vt("DEMData",jf);class Ih{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const o=t[a];this._stringToNumber[o]=a,this._numberToString[a]=o}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Gi{constructor(t,a,o,h,g){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=o,t._y=h,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class kd{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new _s(Ge,16,0),this.grid3D=new _s(Ge,16,0),this.featureIndexArray=new Fe,this.promoteId=a}insert(t,a,o,h,g,_){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,h,g);const w=_?this.grid3D:this.grid;for(let M=0;M<a.length;M++){const A=a[M],I=[1/0,1/0,-1/0,-1/0];for(let F=0;F<A.length;F++){const N=A[F];I[0]=Math.min(I[0],N.x),I[1]=Math.min(I[1],N.y),I[2]=Math.max(I[2],N.x),I[3]=Math.max(I[3],N.y)}I[0]<Ge&&I[1]<Ge&&I[2]>=0&&I[3]>=0&&w.insert(v,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Qo.VectorTile(new ar(this.rawTileData)).layers,this.sourceLayerCoder=new Ih(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,o,h){this.loadVTLayers();const g=t.params,_=Ge/t.tileSize/t.scale,v=Ya(g.filter),w=t.queryGeometry,M=t.queryPadding*_,A=Pp(w),I=this.grid.query(A.minX-M,A.minY-M,A.maxX+M,A.maxY+M),F=Pp(t.cameraQueryGeometry),N=this.grid3D.query(F.minX-M,F.minY-M,F.maxX+M,F.maxY+M,(Q,ne,ye,se)=>function(j,K,ue,Re,tt){for(const He of j)if(K<=He.x&&ue<=He.y&&Re>=He.x&&tt>=He.y)return!0;const Oe=[new Pe(K,ue),new Pe(K,tt),new Pe(Re,tt),new Pe(Re,ue)];if(j.length>2){for(const He of Oe)if(Nl(j,He))return!0}for(let He=0;He<j.length-1;He++)if(lf(j[He],j[He+1],Oe))return!0;return!1}(t.cameraQueryGeometry,Q-M,ne-M,ye+M,se+M));for(const Q of N)I.push(Q);I.sort(Nf);const V={};let q;for(let Q=0;Q<I.length;Q++){const ne=I[Q];if(ne===q)continue;q=ne;const ye=this.featureIndexArray.get(ne);let se=null;this.loadMatchingFeature(V,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,v,g.layers,g.availableImages,a,o,h,(j,K,ue)=>(se||(se=pr(j)),K.queryIntersectsFeature({queryGeometry:w,feature:j,featureState:ue,geometry:se,zoom:this.z,transform:t.transform,pixelsToTileUnits:_,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return V}loadMatchingFeature(t,a,o,h,g,_,v,w,M,A,I){const F=this.bucketLayerIDs[a];if(_&&!F.some(Q=>_.has(Q)))return;const N=this.sourceLayerCoder.decode(o),V=this.vtLayers[N].feature(h);if(g.needGeometry){const Q=tr(V,!0);if(!g.filter(new Ui(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!g.filter(new Ui(this.tileID.overscaledZ),V))return;const q=this.getId(V,N);for(let Q=0;Q<F.length;Q++){const ne=F[Q];if(_&&!_.has(ne))continue;const ye=w[ne];if(!ye)continue;let se={};q&&A&&(se=A.getState(ye.sourceLayer||"_geojsonTileLayer",q));const j=fi({},M[ne]);j.paint=va(j.paint,ye.paint,V,se,v),j.layout=va(j.layout,ye.layout,V,se,v);const K=!I||I(V,ye,se);if(!K)continue;const ue=new Gi(V,this.z,this.x,this.y,q);ue.layer=j;let Re=t[ne];Re===void 0&&(Re=t[ne]=[]),Re.push({featureIndex:h,feature:ue,intersectionZ:K})}}lookupSymbolFeatures(t,a,o,h,g,_,v,w){const M={};this.loadVTLayers();const A=Ya(g);for(const I of t)this.loadMatchingFeature(M,o,h,I,A,_,v,w,a);return M}hasLayer(t){for(const a of this.bucketLayerIDs)for(const o of a)if(t===o)return!0;return!1}getId(t,a){var o;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((o=t.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function va(r,t,a,o,h){return Ki(r,(g,_)=>{const v=t instanceof Ei?t.get(_):null;return v&&v.evaluate?v.evaluate(a,o,h):v})}function Pp(r){let t=1/0,a=1/0,o=-1/0,h=-1/0;for(const g of r)t=Math.min(t,g.x),a=Math.min(a,g.y),o=Math.max(o,g.x),h=Math.max(h,g.y);return{minX:t,minY:a,maxX:o,maxY:h}}function Nf(r,t){return t-r}function Ld(r,t,a,o,h){const g=[];for(let _=0;_<r.length;_++){const v=r[_];let w;for(let M=0;M<v.length-1;M++){let A=v[M],I=v[M+1];A.x<t&&I.x<t||(A.x<t?A=new Pe(t,A.y+(t-A.x)/(I.x-A.x)*(I.y-A.y))._round():I.x<t&&(I=new Pe(t,A.y+(t-A.x)/(I.x-A.x)*(I.y-A.y))._round()),A.y<a&&I.y<a||(A.y<a?A=new Pe(A.x+(a-A.y)/(I.y-A.y)*(I.x-A.x),a)._round():I.y<a&&(I=new Pe(A.x+(a-A.y)/(I.y-A.y)*(I.x-A.x),a)._round()),A.x>=o&&I.x>=o||(A.x>=o?A=new Pe(o,A.y+(o-A.x)/(I.x-A.x)*(I.y-A.y))._round():I.x>=o&&(I=new Pe(o,A.y+(o-A.x)/(I.x-A.x)*(I.y-A.y))._round()),A.y>=h&&I.y>=h||(A.y>=h?A=new Pe(A.x+(h-A.y)/(I.y-A.y)*(I.x-A.x),h)._round():I.y>=h&&(I=new Pe(A.x+(h-A.y)/(I.y-A.y)*(I.x-A.x),h)._round()),w&&A.equals(w[w.length-1])||(w=[A],g.push(w)),w.push(I)))))}}return g}vt("FeatureIndex",kd,{omit:["rawTileData","sourceLayerCoder"]});class Is extends Pe{constructor(t,a,o,h){super(t,a),this.angle=o,h!==void 0&&(this.segment=h)}clone(){return new Is(this.x,this.y,this.angle,this.segment)}}function Uf(r,t,a,o,h){if(t.segment===void 0||a===0)return!0;let g=t,_=t.segment+1,v=0;for(;v>-a/2;){if(_--,_<0)return!1;v-=r[_].dist(g),g=r[_]}v+=r[_].dist(r[_+1]),_++;const w=[];let M=0;for(;v<a/2;){const A=r[_],I=r[_+1];if(!I)return!1;let F=r[_-1].angleTo(A)-A.angleTo(I);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:F}),M+=F;v-w[0].distance>o;)M-=w.shift().angleDelta;if(M>h)return!1;_++,v+=A.dist(I)}return!0}function Vf(r){let t=0;for(let a=0;a<r.length-1;a++)t+=r[a].dist(r[a+1]);return t}function Bd(r,t,a){return r?.6*t*a:0}function Od(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function em(r,t,a,o,h,g){const _=Bd(a,h,g),v=Od(a,o)*g;let w=0;const M=Vf(r)/2;for(let A=0;A<r.length-1;A++){const I=r[A],F=r[A+1],N=I.dist(F);if(w+N>M){const V=(M-w)/N,q=Fr.number(I.x,F.x,V),Q=Fr.number(I.y,F.y,V),ne=new Is(q,Q,F.angleTo(I),A);return ne._round(),!_||Uf(r,ne,v,_,t)?ne:void 0}w+=N}}function Dp(r,t,a,o,h,g,_,v,w){const M=Bd(o,g,_),A=Od(o,h),I=A*_,F=r[0].x===0||r[0].x===w||r[0].y===0||r[0].y===w;return t-I<t/4&&(t=I+t/4),Ip(r,F?t/2*v%t:(A/2+2*g)*_*v%t,t,M,a,I,F,!1,w)}function Ip(r,t,a,o,h,g,_,v,w){const M=g/2,A=Vf(r);let I=0,F=t-a,N=[];for(let V=0;V<r.length-1;V++){const q=r[V],Q=r[V+1],ne=q.dist(Q),ye=Q.angleTo(q);for(;F+a<I+ne;){F+=a;const se=(F-I)/ne,j=Fr.number(q.x,Q.x,se),K=Fr.number(q.y,Q.y,se);if(j>=0&&j<w&&K>=0&&K<w&&F-M>=0&&F+M<=A){const ue=new Is(j,K,ye,V);ue._round(),o&&!Uf(r,ue,g,o,h)||N.push(ue)}}I+=ne}return v||N.length||_||(N=Ip(r,I/2,a,o,h,g,_,!0,w)),N}vt("Anchor",Is);const Zu=ya;function Rp(r,t,a,o){const h=[],g=r.image,_=g.pixelRatio,v=g.paddedRect.w-2*Zu,w=g.paddedRect.h-2*Zu;let M={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const A=g.stretchX||[[0,v]],I=g.stretchY||[[0,w]],F=(Xe,wt)=>Xe+wt[1]-wt[0],N=A.reduce(F,0),V=I.reduce(F,0),q=v-N,Q=w-V;let ne=0,ye=N,se=0,j=V,K=0,ue=q,Re=0,tt=Q;if(g.content&&o){const Xe=g.content,wt=Xe[2]-Xe[0],kt=Xe[3]-Xe[1];(g.textFitWidth||g.textFitHeight)&&(M=Cd(r)),ne=Fd(A,0,Xe[0]),se=Fd(I,0,Xe[1]),ye=Fd(A,Xe[0],Xe[2]),j=Fd(I,Xe[1],Xe[3]),K=Xe[0]-ne,Re=Xe[1]-se,ue=wt-ye,tt=kt-j}const Oe=M.x1,He=M.y1,rt=M.x2-Oe,nt=M.y2-He,lt=(Xe,wt,kt,It)=>{const Et=Rh(Xe.stretch-ne,ye,rt,Oe),ai=Gu(Xe.fixed-K,ue,Xe.stretch,N),Ci=Rh(wt.stretch-se,j,nt,He),$i=Gu(wt.fixed-Re,tt,wt.stretch,V),gn=Rh(kt.stretch-ne,ye,rt,Oe),Aa=Gu(kt.fixed-K,ue,kt.stretch,N),ra=Rh(It.stretch-se,j,nt,He),ln=Gu(It.fixed-Re,tt,It.stretch,V),cn=new Pe(Et,Ci),Zn=new Pe(gn,Ci),kn=new Pe(gn,ra),sa=new Pe(Et,ra),za=new Pe(ai/_,$i/_),Na=new Pe(Aa/_,ln/_),Gn=t*Math.PI/180;if(Gn){const Ln=Math.sin(Gn),qn=Math.cos(Gn),un=[qn,-Ln,Ln,qn];cn._matMult(un),Zn._matMult(un),sa._matMult(un),kn._matMult(un)}const rr=Xe.stretch+Xe.fixed,Cn=wt.stretch+wt.fixed;return{tl:cn,tr:Zn,bl:sa,br:kn,tex:{x:g.paddedRect.x+Zu+rr,y:g.paddedRect.y+Zu+Cn,w:kt.stretch+kt.fixed-rr,h:It.stretch+It.fixed-Cn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:za,pixelOffsetBR:Na,minFontScaleX:ue/_/rt,minFontScaleY:tt/_/nt,isSDF:a}};if(o&&(g.stretchX||g.stretchY)){const Xe=nl(A,q,N),wt=nl(I,Q,V);for(let kt=0;kt<Xe.length-1;kt++){const It=Xe[kt],Et=Xe[kt+1];for(let ai=0;ai<wt.length-1;ai++)h.push(lt(It,wt[ai],Et,wt[ai+1]))}}else h.push(lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return h}function Fd(r,t,a){let o=0;for(const h of r)o+=Math.max(t,Math.min(a,h[1]))-Math.max(t,Math.min(a,h[0]));return o}function nl(r,t,a){const o=[{fixed:-1,stretch:0}];for(const[h,g]of r){const _=o[o.length-1];o.push({fixed:h-_.stretch,stretch:_.stretch}),o.push({fixed:h-_.stretch,stretch:_.stretch+(g-h)})}return o.push({fixed:t+Zu,stretch:a}),o}function Rh(r,t,a,o){return r/t*a+o}function Gu(r,t,a,o){return r-t*a/o}class jd{constructor(t,a,o,h,g,_,v,w,M,A){var I;if(this.boxStartIndex=t.length,M){let F=_.top,N=_.bottom;const V=_.collisionPadding;V&&(F-=V[1],N+=V[3]);let q=N-F;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{const F=!((I=_.image)===null||I===void 0)&&I.content&&(_.image.textFitWidth||_.image.textFitHeight)?Cd(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};F.y1=F.y1*v-w[0],F.y2=F.y2*v+w[2],F.x1=F.x1*v-w[3],F.x2=F.x2*v+w[1];const N=_.collisionPadding;if(N&&(F.x1-=N[0]*v,F.y1-=N[1]*v,F.x2+=N[2]*v,F.y2+=N[3]*v),A){const V=new Pe(F.x1,F.y1),q=new Pe(F.x2,F.y1),Q=new Pe(F.x1,F.y2),ne=new Pe(F.x2,F.y2),ye=A*Math.PI/180;V._rotate(ye),q._rotate(ye),Q._rotate(ye),ne._rotate(ye),F.x1=Math.min(V.x,q.x,Q.x,ne.x),F.x2=Math.max(V.x,q.x,Q.x,ne.x),F.y1=Math.min(V.y,q.y,Q.y,ne.y),F.y2=Math.max(V.y,q.y,Q.y,ne.y)}t.emplaceBack(a.x,a.y,F.x1,F.y1,F.x2,F.y2,o,h,g)}this.boxEndIndex=t.length}}class tm{constructor(t=[],a=(o,h)=>o<h?-1:o>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:o}=this,h=a[t];for(;t>0;){const g=t-1>>1,_=a[g];if(o(h,_)>=0)break;a[t]=_,t=g}a[t]=h}_down(t){const{data:a,compare:o}=this,h=this.length>>1,g=a[t];for(;t<h;){let _=1+(t<<1);const v=_+1;if(v<this.length&&o(a[v],a[_])<0&&(_=v),o(a[_],g)>=0)break;a[t]=a[_],t=_}a[t]=g}}function Zf(r,t=1,a=!1){let o=1/0,h=1/0,g=-1/0,_=-1/0;const v=r[0];for(let N=0;N<v.length;N++){const V=v[N];(!N||V.x<o)&&(o=V.x),(!N||V.y<h)&&(h=V.y),(!N||V.x>g)&&(g=V.x),(!N||V.y>_)&&(_=V.y)}const w=Math.min(g-o,_-h);let M=w/2;const A=new tm([],im);if(w===0)return new Pe(o,h);for(let N=o;N<g;N+=w)for(let V=h;V<_;V+=w)A.push(new ja(N+M,V+M,M,r));let I=function(N){let V=0,q=0,Q=0;const ne=N[0];for(let ye=0,se=ne.length,j=se-1;ye<se;j=ye++){const K=ne[ye],ue=ne[j],Re=K.x*ue.y-ue.x*K.y;q+=(K.x+ue.x)*Re,Q+=(K.y+ue.y)*Re,V+=3*Re}return new ja(q/V,Q/V,0,N)}(r),F=A.length;for(;A.length;){const N=A.pop();(N.d>I.d||!I.d)&&(I=N,a&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,F)),N.max-I.d<=t||(M=N.h/2,A.push(new ja(N.p.x-M,N.p.y-M,M,r)),A.push(new ja(N.p.x+M,N.p.y-M,M,r)),A.push(new ja(N.p.x-M,N.p.y+M,M,r)),A.push(new ja(N.p.x+M,N.p.y+M,M,r)),F+=4)}return a&&(console.log(`num probes: ${F}`),console.log(`best distance: ${I.d}`)),I.p}function im(r,t){return t.max-r.max}function ja(r,t,a,o){this.p=new Pe(r,t),this.h=a,this.d=function(h,g){let _=!1,v=1/0;for(let w=0;w<g.length;w++){const M=g[w];for(let A=0,I=M.length,F=I-1;A<I;F=A++){const N=M[A],V=M[F];N.y>h.y!=V.y>h.y&&h.x<(V.x-N.x)*(h.y-N.y)/(V.y-N.y)+N.x&&(_=!_),v=Math.min(v,of(h,N,V))}}return(_?1:-1)*Math.sqrt(v)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var ea;P.aB=void 0,(ea=P.aB||(P.aB={}))[ea.center=1]="center",ea[ea.left=2]="left",ea[ea.right=3]="right",ea[ea.top=4]="top",ea[ea.bottom=5]="bottom",ea[ea["top-left"]=6]="top-left",ea[ea["top-right"]=7]="top-right",ea[ea["bottom-left"]=8]="bottom-left",ea[ea["bottom-right"]=9]="bottom-right";const al=7,Nd=Number.POSITIVE_INFINITY;function qu(r,t){return t[1]!==Nd?function(a,o,h){let g=0,_=0;switch(o=Math.abs(o),h=Math.abs(h),a){case"top-right":case"top-left":case"top":_=h-al;break;case"bottom-right":case"bottom-left":case"bottom":_=-h+al}switch(a){case"top-right":case"bottom-right":case"right":g=-o;break;case"top-left":case"bottom-left":case"left":g=o}return[g,_]}(r,t[0],t[1]):function(a,o){let h=0,g=0;o<0&&(o=0);const _=o/Math.SQRT2;switch(a){case"top-right":case"top-left":g=_-al;break;case"bottom-right":case"bottom-left":g=-_+al;break;case"bottom":g=-o+al;break;case"top":g=o-al}switch(a){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=o;break;case"right":h=-o}return[h,g]}(r,t[0])}function Rr(r,t,a){var o;const h=r.layout,g=(o=h.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(t,{},a);if(g){const v=g.values,w=[];for(let M=0;M<v.length;M+=2){const A=w[M]=v[M],I=v[M+1].map(F=>F*Rn);A.startsWith("top")?I[1]-=al:A.startsWith("bottom")&&(I[1]+=al),w[M+1]=I}return new dn(w)}const _=h.get("text-variable-anchor");if(_){let v;v=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},a)*Rn,Nd]:h.get("text-offset").evaluate(t,{},a).map(M=>M*Rn);const w=[];for(const M of _)w.push(M,qu(M,v));return new dn(w)}return null}function Ud(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Vd(r,t,a,o,h,g,_,v,w,M,A,I){let F=g.textMaxSize.evaluate(t,{});F===void 0&&(F=_);const N=r.layers[0].layout,V=N.get("icon-offset").evaluate(t,{},A),q=kp(a.horizontal),Q=_/24,ne=r.tilePixelRatio*Q,ye=r.tilePixelRatio*F/24,se=r.tilePixelRatio*v,j=r.tilePixelRatio*N.get("symbol-spacing"),K=N.get("text-padding")*r.tilePixelRatio,ue=function(kt,It,Et,ai=1){const Ci=kt.get("icon-padding").evaluate(It,{},Et),$i=Ci&&Ci.values;return[$i[0]*ai,$i[1]*ai,$i[2]*ai,$i[3]*ai]}(N,t,A,r.tilePixelRatio),Re=N.get("text-max-angle")/180*Math.PI,tt=N.get("text-rotation-alignment")!=="viewport"&&N.get("symbol-placement")!=="point",Oe=N.get("icon-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",He=N.get("symbol-placement"),rt=j/2,nt=N.get("icon-text-fit");let lt;o&&nt!=="none"&&(r.allowVerticalPlacement&&a.vertical&&(lt=Sp(o,a.vertical,nt,N.get("icon-text-fit-padding"),V,Q)),q&&(o=Sp(o,q,nt,N.get("icon-text-fit-padding"),V,Q)));const Xe=A?I.line.getGranularityForZoomLevel(A.z):1,wt=(kt,It)=>{It.x<0||It.x>=Ge||It.y<0||It.y>=Ge||function(Et,ai,Ci,$i,gn,Aa,ra,ln,cn,Zn,kn,sa,za,Na,Gn,rr,Cn,Ln,qn,un,Fi,_r,Gc,Rs,Hd){const i=Et.addToLineVertexArray(ai,Ci);let s,c,p,x,S=0,U=0,Y=0,fe=0,Le=-1,Je=-1;const it={};let Ue=Wa("");if(Et.allowVerticalPlacement&&$i.vertical){const Pa=ln.layout.get("text-rotate").evaluate(Fi,{},Rs)+90;p=new jd(cn,ai,Zn,kn,sa,$i.vertical,za,Na,Gn,Pa),ra&&(x=new jd(cn,ai,Zn,kn,sa,ra,Cn,Ln,Gn,Pa))}if(gn){const Pa=ln.layout.get("icon-rotate").evaluate(Fi,{}),ks=ln.layout.get("icon-text-fit")!=="none",Lh=Rp(gn,Pa,Gc,ks),rl=ra?Rp(ra,Pa,Gc,ks):void 0;c=new jd(cn,ai,Zn,kn,sa,gn,Cn,Ln,!1,Pa),S=4*Lh.length;const Bh=Et.iconSizeData;let ec=null;Bh.kind==="source"?(ec=[ho*ln.layout.get("icon-size").evaluate(Fi,{})],ec[0]>Kl&&Qi(`${Et.layerIds[0]}: Value for "icon-size" is >= ${Fu}. Reduce your "icon-size".`)):Bh.kind==="composite"&&(ec=[ho*_r.compositeIconSizes[0].evaluate(Fi,{},Rs),ho*_r.compositeIconSizes[1].evaluate(Fi,{},Rs)],(ec[0]>Kl||ec[1]>Kl)&&Qi(`${Et.layerIds[0]}: Value for "icon-size" is >= ${Fu}. Reduce your "icon-size".`)),Et.addSymbols(Et.icon,Lh,ec,un,qn,Fi,P.al.none,ai,i.lineStartIndex,i.lineLength,-1,Rs),Le=Et.icon.placedSymbolArray.length-1,rl&&(U=4*rl.length,Et.addSymbols(Et.icon,rl,ec,un,qn,Fi,P.al.vertical,ai,i.lineStartIndex,i.lineLength,-1,Rs),Je=Et.icon.placedSymbolArray.length-1)}const qe=Object.keys($i.horizontal);for(const Pa of qe){const ks=$i.horizontal[Pa];if(!s){Ue=Wa(ks.text);const rl=ln.layout.get("text-rotate").evaluate(Fi,{},Rs);s=new jd(cn,ai,Zn,kn,sa,ks,za,Na,Gn,rl)}const Lh=ks.positionedLines.length===1;if(Y+=fo(Et,ai,ks,Aa,ln,Gn,Fi,rr,i,$i.vertical?P.al.horizontal:P.al.horizontalOnly,Lh?qe:[Pa],it,Le,_r,Rs),Lh)break}$i.vertical&&(fe+=fo(Et,ai,$i.vertical,Aa,ln,Gn,Fi,rr,i,P.al.vertical,["vertical"],it,Je,_r,Rs));const Qt=s?s.boxStartIndex:Et.collisionBoxArray.length,Yt=s?s.boxEndIndex:Et.collisionBoxArray.length,Xi=p?p.boxStartIndex:Et.collisionBoxArray.length,Ae=p?p.boxEndIndex:Et.collisionBoxArray.length,Te=c?c.boxStartIndex:Et.collisionBoxArray.length,ke=c?c.boxEndIndex:Et.collisionBoxArray.length,at=x?x.boxStartIndex:Et.collisionBoxArray.length,Lt=x?x.boxEndIndex:Et.collisionBoxArray.length;let Wt=-1;const Ut=(Pa,ks)=>Pa&&Pa.circleDiameter?Math.max(Pa.circleDiameter,ks):ks;Wt=Ut(s,Wt),Wt=Ut(p,Wt),Wt=Ut(c,Wt),Wt=Ut(x,Wt);const Kt=Wt>-1?1:0;Kt&&(Wt*=Hd/Rn),Et.glyphOffsetArray.length>=Uu.MAX_GLYPHS&&Qi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fi.sortKey!==void 0&&Et.addToSortKeyRanges(Et.symbolInstances.length,Fi.sortKey);const xa=Rr(ln,Fi,Rs),[Ai,Jl]=function(Pa,ks){const Lh=Pa.length,rl=ks==null?void 0:ks.values;if((rl==null?void 0:rl.length)>0)for(let Bh=0;Bh<rl.length;Bh+=2){const ec=rl[Bh+1];Pa.emplaceBack(P.aB[rl[Bh]],ec[0],ec[1])}return[Lh,Pa.length]}(Et.textAnchorOffsets,xa);Et.symbolInstances.emplaceBack(ai.x,ai.y,it.right>=0?it.right:-1,it.center>=0?it.center:-1,it.left>=0?it.left:-1,it.vertical||-1,Le,Je,Ue,Qt,Yt,Xi,Ae,Te,ke,at,Lt,Zn,Y,fe,S,U,Kt,0,za,Wt,Ai,Jl)}(r,It,kt,a,o,h,lt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,ne,[K,K,K,K],tt,w,se,ue,Oe,V,t,g,M,A,_)};if(He==="line")for(const kt of Ld(t.geometry,0,0,Ge,Ge)){const It=Zl(kt,Xe),Et=Dp(It,j,Re,a.vertical||q,o,24,ye,r.overscaling,Ge);for(const ai of Et)q&&nm(r,q.text,rt,ai)||wt(It,ai)}else if(He==="line-center"){for(const kt of t.geometry)if(kt.length>1){const It=Zl(kt,Xe),Et=em(It,Re,a.vertical||q,o,24,ye);Et&&wt(It,Et)}}else if(t.type==="Polygon")for(const kt of dc(t.geometry,0)){const It=Zf(kt,16);wt(Zl(kt[0],Xe,!0),new Is(It.x,It.y,0))}else if(t.type==="LineString")for(const kt of t.geometry){const It=Zl(kt,Xe);wt(It,new Is(It[0].x,It[0].y,0))}else if(t.type==="Point")for(const kt of t.geometry)for(const It of kt)wt([It],new Is(It.x,It.y,0))}function fo(r,t,a,o,h,g,_,v,w,M,A,I,F,N,V){const q=function(ye,se,j,K,ue,Re,tt,Oe){const He=K.layout.get("text-rotate").evaluate(Re,{})*Math.PI/180,rt=[];for(const nt of se.positionedLines)for(const lt of nt.positionedGlyphs){if(!lt.rect)continue;const Xe=lt.rect||{};let wt=Yp+1,kt=!0,It=1,Et=0;const ai=(ue||Oe)&&lt.vertical,Ci=lt.metrics.advance*lt.scale/2;if(Oe&&se.verticalizable&&(Et=nt.lineOffset/2-(lt.imageName?-(Rn-lt.metrics.width*lt.scale)/2:(lt.scale-1)*Rn)),lt.imageName){const Ln=tt[lt.imageName];kt=Ln.sdf,It=Ln.pixelRatio,wt=ya/It}const $i=ue?[lt.x+Ci,lt.y]:[0,0];let gn=ue?[0,0]:[lt.x+Ci+j[0],lt.y+j[1]-Et],Aa=[0,0];ai&&(Aa=gn,gn=[0,0]);const ra=lt.metrics.isDoubleResolution?2:1,ln=(lt.metrics.left-wt)*lt.scale-Ci+gn[0],cn=(-lt.metrics.top-wt)*lt.scale+gn[1],Zn=ln+Xe.w/ra*lt.scale/It,kn=cn+Xe.h/ra*lt.scale/It,sa=new Pe(ln,cn),za=new Pe(Zn,cn),Na=new Pe(ln,kn),Gn=new Pe(Zn,kn);if(ai){const Ln=new Pe(-Ci,Ci-Eh),qn=-Math.PI/2,un=Rn/2-Ci,Fi=new Pe(5-Eh-un,-(lt.imageName?un:0)),_r=new Pe(...Aa);sa._rotateAround(qn,Ln)._add(Fi)._add(_r),za._rotateAround(qn,Ln)._add(Fi)._add(_r),Na._rotateAround(qn,Ln)._add(Fi)._add(_r),Gn._rotateAround(qn,Ln)._add(Fi)._add(_r)}if(He){const Ln=Math.sin(He),qn=Math.cos(He),un=[qn,-Ln,Ln,qn];sa._matMult(un),za._matMult(un),Na._matMult(un),Gn._matMult(un)}const rr=new Pe(0,0),Cn=new Pe(0,0);rt.push({tl:sa,tr:za,bl:Na,br:Gn,tex:Xe,writingMode:se.writingMode,glyphOffset:$i,sectionIndex:lt.sectionIndex,isSDF:kt,pixelOffsetTL:rr,pixelOffsetBR:Cn,minFontScaleX:0,minFontScaleY:0})}return rt}(0,a,v,h,g,_,o,r.allowVerticalPlacement),Q=r.textSizeData;let ne=null;Q.kind==="source"?(ne=[ho*h.layout.get("text-size").evaluate(_,{})],ne[0]>Kl&&Qi(`${r.layerIds[0]}: Value for "text-size" is >= ${Fu}. Reduce your "text-size".`)):Q.kind==="composite"&&(ne=[ho*N.compositeTextSizes[0].evaluate(_,{},V),ho*N.compositeTextSizes[1].evaluate(_,{},V)],(ne[0]>Kl||ne[1]>Kl)&&Qi(`${r.layerIds[0]}: Value for "text-size" is >= ${Fu}. Reduce your "text-size".`)),r.addSymbols(r.text,q,ne,v,g,_,M,t,w.lineStartIndex,w.lineLength,F,V);for(const ye of A)I[ye]=r.text.placedSymbolArray.length-1;return 4*q.length}function kp(r){for(const t in r)return r[t];return null}function nm(r,t,a,o){const h=r.compareText;if(t in h){const g=h[t];for(let _=g.length-1;_>=0;_--)if(o.dist(g[_])<a)return!0}else h[t]=[];return h[t].push(o),!1}const Vc=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Zd{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,o]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=o>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const g=Vc[15&o];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Zd(v,_,g,t)}constructor(t,a=64,o=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=Vc.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+v+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=a,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Gf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:v}=this,w=[0,g.length-1,0],M=[];for(;w.length;){const A=w.pop()||0,I=w.pop()||0,F=w.pop()||0;if(I-F<=v){for(let Q=F;Q<=I;Q++){const ne=_[2*Q],ye=_[2*Q+1];ne>=t&&ne<=o&&ye>=a&&ye<=h&&M.push(g[Q])}continue}const N=F+I>>1,V=_[2*N],q=_[2*N+1];V>=t&&V<=o&&q>=a&&q<=h&&M.push(g[N]),(A===0?t<=V:a<=q)&&(w.push(F),w.push(N-1),w.push(1-A)),(A===0?o>=V:h>=q)&&(w.push(N+1),w.push(I),w.push(1-A))}return M}within(t,a,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:_}=this,v=[0,h.length-1,0],w=[],M=o*o;for(;v.length;){const A=v.pop()||0,I=v.pop()||0,F=v.pop()||0;if(I-F<=_){for(let Q=F;Q<=I;Q++)Bp(g[2*Q],g[2*Q+1],t,a)<=M&&w.push(h[Q]);continue}const N=F+I>>1,V=g[2*N],q=g[2*N+1];Bp(V,q,t,a)<=M&&w.push(h[N]),(A===0?t-o<=V:a-o<=q)&&(v.push(F),v.push(N-1),v.push(1-A)),(A===0?t+o>=V:a+o>=q)&&(v.push(N+1),v.push(I),v.push(1-A))}return w}}function Gf(r,t,a,o,h,g){if(h-o<=a)return;const _=o+h>>1;Lp(r,t,_,o,h,g),Gf(r,t,a,o,_-1,1-g),Gf(r,t,a,_+1,h,1-g)}function Lp(r,t,a,o,h,g){for(;h>o;){if(h-o>600){const M=h-o+1,A=a-o+1,I=Math.log(M),F=.5*Math.exp(2*I/3),N=.5*Math.sqrt(I*F*(M-F)/M)*(A-M/2<0?-1:1);Lp(r,t,a,Math.max(o,Math.floor(a-A*F/M+N)),Math.min(h,Math.floor(a+(M-A)*F/M+N)),g)}const _=t[2*a+g];let v=o,w=h;for(kh(r,t,o,a),t[2*h+g]>_&&kh(r,t,o,h);v<w;){for(kh(r,t,v,w),v++,w--;t[2*v+g]<_;)v++;for(;t[2*w+g]>_;)w--}t[2*o+g]===_?kh(r,t,o,w):(w++,kh(r,t,w,h)),w<=a&&(o=w+1),a<=w&&(h=w-1)}}function kh(r,t,a,o){qf(r,a,o),qf(t,2*a,2*o),qf(t,2*a+1,2*o+1)}function qf(r,t,a){const o=r[t];r[t]=r[a],r[a]=o}function Bp(r,t,a,o){const h=r-a,g=t-o;return h*h+g*g}var Hf;P.co=void 0,(Hf=P.co||(P.co={})).create="create",Hf.load="load",Hf.fullLoad="fullLoad";let Gd=null,Hu=[];const Wl=1e3/60,Zc="loadTime",qd="fullLoadTime",am={mark(r){performance.mark(r)},frame(r){const t=r;Gd!=null&&Hu.push(t-Gd),Gd=t},clearMetrics(){Gd=null,Hu=[],performance.clearMeasures(Zc),performance.clearMeasures(qd);for(const r in P.co)performance.clearMarks(P.co[r])},getPerformanceMetrics(){performance.measure(Zc,P.co.create,P.co.load),performance.measure(qd,P.co.create,P.co.fullLoad);const r=performance.getEntriesByName(Zc)[0].duration,t=performance.getEntriesByName(qd)[0].duration,a=Hu.length,o=1/(Hu.reduce((g,_)=>g+_,0)/a/1e3),h=Hu.filter(g=>g>Wl).reduce((g,_)=>g+(_-Wl)/Wl,0);return{loadTime:r,fullLoadTime:t,fps:o,percentDroppedFrames:h/(a+h)*100,totalFrames:a}}};P.$=Ql,P.A=Zt,P.B=Fr,P.C=Ui,P.D=gt,P.E=ve,P.F=af,P.G=function(r){if(Os==null){const t=r.navigator?r.navigator.userAgent:null;Os=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Os},P.H=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Jp(()=>this.process()),this.subscription=mo(this.target,"message",a=>this.receive(a),!1),this.globalScope=kr(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((a,o)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),g=t?mo(t.signal,"abort",()=>{g==null||g.unsubscribe(),delete this.resolveRejects[h];const w={id:h,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},zh):null;this.resolveRejects[h]={resolve:w=>{g==null||g.unsubscribe(),a(w)},reject:w=>{g==null||g.unsubscribe(),o(w)}};const _=[],v=Object.assign(Object.assign({},r),{id:h,sourceMapId:this.mapId,origin:location.origin,data:Go(r.data,_)});this.target.postMessage(v,{transfer:_})})}receive(r){const t=r.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const o=this.abortControllers[a];return delete this.abortControllers[a],void(o&&o.abort())}if(kr(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return d(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[r];return delete this.resolveRejects[r],h?void(t.error?h.reject(to(t.error)):h.resolve(to(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=to(t.data),o=new AbortController;this.abortControllers[r]=o;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,a,o);this.completeTask(r,null,h)}catch(h){this.completeTask(r,h)}})}completeTask(r,t,a){const o=[];delete this.abortControllers[r];const h={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Go(t):null,data:Go(a,o)};this.target.postMessage(h,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},P.I=Mh,P.J=hl,P.K=function(){var r=new Zt(16);return Zt!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},P.L=function(r,t,a){var o,h,g,_,v,w,M,A,I,F,N,V,q=a[0],Q=a[1],ne=a[2];return t===r?(r[12]=t[0]*q+t[4]*Q+t[8]*ne+t[12],r[13]=t[1]*q+t[5]*Q+t[9]*ne+t[13],r[14]=t[2]*q+t[6]*Q+t[10]*ne+t[14],r[15]=t[3]*q+t[7]*Q+t[11]*ne+t[15]):(h=t[1],g=t[2],_=t[3],v=t[4],w=t[5],M=t[6],A=t[7],I=t[8],F=t[9],N=t[10],V=t[11],r[0]=o=t[0],r[1]=h,r[2]=g,r[3]=_,r[4]=v,r[5]=w,r[6]=M,r[7]=A,r[8]=I,r[9]=F,r[10]=N,r[11]=V,r[12]=o*q+v*Q+I*ne+t[12],r[13]=h*q+w*Q+F*ne+t[13],r[14]=g*q+M*Q+N*ne+t[14],r[15]=_*q+A*Q+V*ne+t[15]),r},P.M=function(r,t,a){var o=a[0],h=a[1],g=a[2];return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r[4]=t[4]*h,r[5]=t[5]*h,r[6]=t[6]*h,r[7]=t[7]*h,r[8]=t[8]*g,r[9]=t[9]*g,r[10]=t[10]*g,r[11]=t[11]*g,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},P.N=function(r,t,a){var o=t[0],h=t[1],g=t[2],_=t[3],v=t[4],w=t[5],M=t[6],A=t[7],I=t[8],F=t[9],N=t[10],V=t[11],q=t[12],Q=t[13],ne=t[14],ye=t[15],se=a[0],j=a[1],K=a[2],ue=a[3];return r[0]=se*o+j*v+K*I+ue*q,r[1]=se*h+j*w+K*F+ue*Q,r[2]=se*g+j*M+K*N+ue*ne,r[3]=se*_+j*A+K*V+ue*ye,r[4]=(se=a[4])*o+(j=a[5])*v+(K=a[6])*I+(ue=a[7])*q,r[5]=se*h+j*w+K*F+ue*Q,r[6]=se*g+j*M+K*N+ue*ne,r[7]=se*_+j*A+K*V+ue*ye,r[8]=(se=a[8])*o+(j=a[9])*v+(K=a[10])*I+(ue=a[11])*q,r[9]=se*h+j*w+K*F+ue*Q,r[10]=se*g+j*M+K*N+ue*ne,r[11]=se*_+j*A+K*V+ue*ye,r[12]=(se=a[12])*o+(j=a[13])*v+(K=a[14])*I+(ue=a[15])*q,r[13]=se*h+j*w+K*F+ue*Q,r[14]=se*g+j*M+K*N+ue*ne,r[15]=se*_+j*A+K*V+ue*ye,r},P.O=function(r,t){const a={};for(let o=0;o<t.length;o++){const h=t[o];h in r&&(a[h]=r[h])}return a},P.P=Pe,P.Q=il,P.R=mr,P.S=Id,P.T=dh,P.U=Ph,P.V=Pt,P.W=qt,P.X=cl,P.Y=Ir,P.Z=Ge,P._=d,P.a=zn,P.a$=function(r,t,a){var o=Math.sin(a),h=Math.cos(a),g=t[4],_=t[5],v=t[6],w=t[7],M=t[8],A=t[9],I=t[10],F=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=g*h+M*o,r[5]=_*h+A*o,r[6]=v*h+I*o,r[7]=w*h+F*o,r[8]=M*h-g*o,r[9]=A*h-_*o,r[10]=I*h-v*o,r[11]=F*h-w*o,r},P.a0=25,P.a1=Rd,P.a2=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const o of r){const h=window.document.createElement("source");Me(o)||(t.crossOrigin="Anonymous"),h.src=o,t.appendChild(h)}})},P.a3=Ve,P.a4=function(){return ci++},P.a5=ie,P.a6=Uu,P.a7=Ya,P.a8=tr,P.a9=Gi,P.aA=function(r,t,a,o,h=!1){if(!a[0]&&!a[1])return[0,0];const g=h?o==="map"?-r.bearingInRadians:0:o==="viewport"?r.bearingInRadians:0;if(g){const _=Math.sin(g),v=Math.cos(g);a=[a[0]*v-a[1]*_,a[0]*_+a[1]*v]}return[h?a[0]:_t(t,a[0],r.zoom),h?a[1]:_t(t,a[1],r.zoom)]},P.aC=ju,P.aD=Ud,P.aE=Md,P.aF=Zd,P.aG=Ji,P.aH=Mn,P.aI=Ze,P.aJ=Ti,P.aK=bi,P.aL=Rt,P.aM=ss,P.aN=Vu,P.aO=function(r,t,a){return r[0]=t[0]*a,r[1]=t[1]*a,r[2]=t[2]*a,r},P.aP=function(r,t,a){return r[0]=t[0]+a[0],r[1]=t[1]+a[1],r[2]=t[2]+a[2],r},P.aQ=function(r){var t=new Zt(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},P.aR=function(r,t,a){return r[0]=t[0]*a[0],r[1]=t[1]*a[1],r[2]=t[2]*a[2],r[3]=t[3]*a[3],r},P.aS=function(r,t,a){return r[0]=t[0]-a[0],r[1]=t[1]-a[1],r[2]=t[2]-a[2],r},P.aT=function(r,t){var a=t[0],o=t[1],h=t[2],g=a*a+o*o+h*h;return g>0&&(g=1/Math.sqrt(g)),r[0]=t[0]*g,r[1]=t[1]*g,r[2]=t[2]*g,r},P.aU=function(r,t,a){var o=t[0],h=t[1],g=t[2],_=a[0],v=a[1],w=a[2];return r[0]=h*w-g*v,r[1]=g*_-o*w,r[2]=o*v-h*_,r},P.aV=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},P.aW=zp,P.aX=Uc,P.aY=function(r,t,a,o,h){var g,_=1/Math.tan(t/2);return r[0]=_/a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0?(r[10]=(h+o)*(g=1/(o-h)),r[14]=2*h*o*g):(r[10]=-1,r[14]=-2*o),r},P.aZ=function(r){var t=new Zt(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},P.a_=function(r,t,a){var o=Math.sin(a),h=Math.cos(a),g=t[0],_=t[1],v=t[2],w=t[3],M=t[4],A=t[5],I=t[6],F=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*h+M*o,r[1]=_*h+A*o,r[2]=v*h+I*o,r[3]=w*h+F*o,r[4]=M*h-g*o,r[5]=A*h-_*o,r[6]=I*h-v*o,r[7]=F*h-w*o,r},P.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,o,h,g)=>{const _=h||g;return t[o]=!_||_.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},P.ab=Fs,P.ac=function(r){return Math.pow(2,r)},P.ad=Xt,P.ae=At,P.af=85.051129,P.ag=Ff,P.ah=function(r){return Math.log(r)/Math.LN2},P.ai=function(r){var t=r[0],a=r[1];return t*t+a*a},P.aj=function(r,t){const a=[];for(const o in r)o in t||a.push(o);return a},P.ak=function(r,t){let a=0,o=0;if(r.kind==="constant")o=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:g,maxZoom:_}=r,v=h?At(la.interpolationFactor(h,t,g,_),0,1):0;r.kind==="camera"?o=Fr.number(r.minSize,r.maxSize,v):a=v}return{uSizeT:a,uSize:o}},P.am=function(r,{uSize:t,uSizeT:a},{lowerSize:o,upperSize:h}){return r.kind==="source"?o/ho:r.kind==="composite"?Fr.number(o/ho,h/ho,a):t},P.an=function(r,t){var a=t[0],o=t[1],h=t[2],g=t[3],_=t[4],v=t[5],w=t[6],M=t[7],A=t[8],I=t[9],F=t[10],N=t[11],V=t[12],q=t[13],Q=t[14],ne=t[15],ye=a*v-o*_,se=a*w-h*_,j=a*M-g*_,K=o*w-h*v,ue=o*M-g*v,Re=h*M-g*w,tt=A*q-I*V,Oe=A*Q-F*V,He=A*ne-N*V,rt=I*Q-F*q,nt=I*ne-N*q,lt=F*ne-N*Q,Xe=ye*lt-se*nt+j*rt+K*He-ue*Oe+Re*tt;return Xe?(r[0]=(v*lt-w*nt+M*rt)*(Xe=1/Xe),r[1]=(h*nt-o*lt-g*rt)*Xe,r[2]=(q*Re-Q*ue+ne*K)*Xe,r[3]=(F*ue-I*Re-N*K)*Xe,r[4]=(w*He-_*lt-M*Oe)*Xe,r[5]=(a*lt-h*He+g*Oe)*Xe,r[6]=(Q*j-V*Re-ne*se)*Xe,r[7]=(A*Re-F*j+N*se)*Xe,r[8]=(_*nt-v*He+M*tt)*Xe,r[9]=(o*He-a*nt-g*tt)*Xe,r[10]=(V*ue-q*j+ne*ye)*Xe,r[11]=(I*j-A*ue-N*ye)*Xe,r[12]=(v*Oe-_*rt-w*tt)*Xe,r[13]=(a*rt-o*Oe+h*tt)*Xe,r[14]=(q*se-V*K-Q*ye)*Xe,r[15]=(A*K-I*se+F*ye)*Xe,r):null},P.ao=be,P.ap=function(r){return Math.hypot(r[0],r[1])},P.aq=function(r){return r[0]=0,r[1]=0,r},P.ar=function(r,t,a){return r[0]=t[0]*a,r[1]=t[1]*a,r},P.as=Ah,P.at=Ct,P.au=function(r,t,a,o){const h=t.y-r.y,g=t.x-r.x,_=o.y-a.y,v=o.x-a.x,w=_*g-v*h;if(w===0)return null;const M=(v*(r.y-a.y)-_*(r.x-a.x))/w;return new Pe(r.x+M*g,r.y+M*h)},P.av=Ld,P.aw=td,P.ax=function(r){let t=1/0,a=1/0,o=-1/0,h=-1/0;for(const g of r)t=Math.min(t,g.x),a=Math.min(a,g.y),o=Math.max(o,g.x),h=Math.max(h,g.y);return[t,a,o,h]},P.ay=Rn,P.az=_t,P.b=An,P.b$=class extends G{},P.b0=function(){const r=new Float32Array(16);return Xt(r),r},P.b1=function(){const r=new Float64Array(16);return Xt(r),r},P.b2=function(){return new Float64Array(16)},P.b3=function(r,t,a){const o=new Float64Array(4);return function(h,g,_,v){var w=.5*Math.PI/180;g*=w,_*=w,v*=w;var M=Math.sin(g),A=Math.cos(g),I=Math.sin(_),F=Math.cos(_),N=Math.sin(v),V=Math.cos(v);h[0]=M*F*V-A*I*N,h[1]=A*I*V+M*F*N,h[2]=A*F*N-M*I*V,h[3]=A*F*V+M*I*N}(o,r,t-90,a),o},P.b4=function(r,t,a,o){var h,g,_,v,w,M=t[0],A=t[1],I=t[2],F=t[3],N=a[0],V=a[1],q=a[2],Q=a[3];return(g=M*N+A*V+I*q+F*Q)<0&&(g=-g,N=-N,V=-V,q=-q,Q=-Q),1-g>bt?(h=Math.acos(g),_=Math.sin(h),v=Math.sin((1-o)*h)/_,w=Math.sin(o*h)/_):(v=1-o,w=o),r[0]=v*M+w*N,r[1]=v*A+w*V,r[2]=v*I+w*q,r[3]=v*F+w*Q,r},P.b5=function(r){const t=new Float64Array(9);var a,o,h,g,_,v,w,M,A,I,F,N,V,q,Q,ne,ye,se;I=(h=(o=r)[0])*(w=h+h),F=(g=o[1])*w,V=(_=o[2])*w,q=_*(M=g+g),ne=(v=o[3])*w,ye=v*M,se=v*(A=_+_),(a=t)[0]=1-(N=g*M)-(Q=_*A),a[3]=F-se,a[6]=V+ye,a[1]=F+se,a[4]=1-I-Q,a[7]=q-ne,a[2]=V-ye,a[5]=q+ne,a[8]=1-I-N;const j=ss(-Math.asin(At(t[2],-1,1)));let K,ue;return Math.hypot(t[5],t[8])<.001?(K=0,ue=-ss(Math.atan2(t[3],t[4]))):(K=ss(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ue=ss(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:K,pitch:j+90,bearing:ue}},P.b6=function(r,t){return r.roll==t.roll&&r.pitch==t.pitch&&r.bearing==t.bearing},P.b7=hi,P.b8=Dc,P.b9=Vl,P.bA=function(r){if(r.type==="custom")return new Wp(r);switch(r.type){case"background":return new Cp(r);case"circle":return new sp(r);case"fill":return new xf(r);case"fill-extrusion":return new Vi(r);case"heatmap":return new ff(r);case"hillshade":return new od(r);case"line":return new wh(r);case"raster":return new Bf(r);case"symbol":return new zd(r)}},P.bB=Ii,P.bC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let a=[];try{if(!ze(r.version,t.version))return[{command:"setStyle",args:[t]}];ze(r.center,t.center)||a.push({command:"setCenter",args:[t.center]}),ze(r.state,t.state)||a.push({command:"setGlobalState",args:[t.state]}),ze(r.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ze(r.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),ze(r.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),ze(r.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),ze(r.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),ze(r.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),ze(r.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),ze(r.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),ze(r.light,t.light)||a.push({command:"setLight",args:[t.light]}),ze(r.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),ze(r.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),ze(r.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const o={},h=[];(function(_,v,w,M){let A;for(A in v=v||{},_=_||{})Object.prototype.hasOwnProperty.call(_,A)&&(Object.prototype.hasOwnProperty.call(v,A)||We(A,w,M));for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&(Object.prototype.hasOwnProperty.call(_,A)?ze(_[A],v[A])||(_[A].type==="geojson"&&v[A].type==="geojson"&&yt(_,v,A)?Be(w,{command:"setGeoJSONSourceData",args:[A,v[A].data]}):ft(A,v,w,M)):Ee(A,v,w))})(r.sources,t.sources,h,o);const g=[];r.layers&&r.layers.forEach(_=>{"source"in _&&o[_.source]?a.push({command:"removeLayer",args:[_.id]}):g.push(_)}),a=a.concat(h),function(_,v,w){v=v||[];const M=(_=_||[]).map(Ot),A=v.map(Ot),I=_.reduce(Dt,{}),F=v.reduce(Dt,{}),N=M.slice(),V=Object.create(null);let q,Q,ne,ye,se;for(let j=0,K=0;j<M.length;j++)q=M[j],Object.prototype.hasOwnProperty.call(F,q)?K++:(Be(w,{command:"removeLayer",args:[q]}),N.splice(N.indexOf(q,K),1));for(let j=0,K=0;j<A.length;j++)q=A[A.length-1-j],N[N.length-1-j]!==q&&(Object.prototype.hasOwnProperty.call(I,q)?(Be(w,{command:"removeLayer",args:[q]}),N.splice(N.lastIndexOf(q,N.length-K),1)):K++,ye=N[N.length-j],Be(w,{command:"addLayer",args:[F[q],ye]}),N.splice(N.length-j,0,q),V[q]=!0);for(let j=0;j<A.length;j++)if(q=A[j],Q=I[q],ne=F[q],!V[q]&&!ze(Q,ne))if(ze(Q.source,ne.source)&&ze(Q["source-layer"],ne["source-layer"])&&ze(Q.type,ne.type)){for(se in zt(Q.layout,ne.layout,w,q,null,"setLayoutProperty"),zt(Q.paint,ne.paint,w,q,null,"setPaintProperty"),ze(Q.filter,ne.filter)||Be(w,{command:"setFilter",args:[q,ne.filter]}),ze(Q.minzoom,ne.minzoom)&&ze(Q.maxzoom,ne.maxzoom)||Be(w,{command:"setLayerZoomRange",args:[q,ne.minzoom,ne.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,se)&&se!=="layout"&&se!=="paint"&&se!=="filter"&&se!=="metadata"&&se!=="minzoom"&&se!=="maxzoom"&&(se.indexOf("paint.")===0?zt(Q[se],ne[se],w,q,se.slice(6),"setPaintProperty"):ze(Q[se],ne[se])||Be(w,{command:"setLayerProperty",args:[q,se,ne[se]]}));for(se in ne)Object.prototype.hasOwnProperty.call(ne,se)&&!Object.prototype.hasOwnProperty.call(Q,se)&&se!=="layout"&&se!=="paint"&&se!=="filter"&&se!=="metadata"&&se!=="minzoom"&&se!=="maxzoom"&&(se.indexOf("paint.")===0?zt(Q[se],ne[se],w,q,se.slice(6),"setPaintProperty"):ze(Q[se],ne[se])||Be(w,{command:"setLayerProperty",args:[q,se,ne[se]]}))}else Be(w,{command:"removeLayer",args:[q]}),ye=N[N.lastIndexOf(q)+1],Be(w,{command:"addLayer",args:[ne,ye]})}(g,t.layers,a)}catch(o){console.warn("Unable to compute style diff:",o),a=[{command:"setStyle",args:[t]}]}return a},P.bD=function(r){const t=[],a=r.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},P.bE=function r(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(!r(t[o],a[o]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const o in t)if(!r(t[o],a[o]))return!1;return!0}return t===a},P.bF=Ki,P.bG=rn,P.bH=class extends Di{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},P.bI=Jh,P.bJ=class extends Di{constructor(r,t){super(r,t),this.current=jl}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},P.bK=fh,P.bL=class extends Di{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},P.bM=class extends Di{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},P.bN=di,P.bO=function(r,t){var a=Math.sin(t),o=Math.cos(t);return r[0]=o,r[1]=a,r[2]=0,r[3]=-a,r[4]=o,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},P.bP=function(r,t,a){var o=t[0],h=t[1],g=t[2];return r[0]=o*a[0]+h*a[3]+g*a[6],r[1]=o*a[1]+h*a[4]+g*a[7],r[2]=o*a[2]+h*a[5]+g*a[8],r},P.bQ=function(r,t,a,o,h,g,_){var v=1/(t-a),w=1/(o-h),M=1/(g-_);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*w,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*M,r[11]=0,r[12]=(t+a)*v,r[13]=(h+o)*w,r[14]=(_+g)*M,r[15]=1,r},P.bR=class extends Di{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(4*r.length);for(let a=0;a<r.length;a++)t[4*a]=r[a].r,t[4*a+1]=r[a].g,t[4*a+2]=r[a].b,t[4*a+3]=r[a].a;this.gl.uniform4fv(this.location,t)}}},P.bS=class extends Di{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(r);this.gl.uniform1fv(this.location,t)}}},P.bT=class extends m{},P.bU=$l,P.bV=class extends b{},P.bW=_h,P.bX=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},P.bY=sd,P.bZ=function(r,t,a){var o=t[0],h=t[1],g=t[2],_=a[3]*o+a[7]*h+a[11]*g+a[15];return r[0]=(a[0]*o+a[4]*h+a[8]*g+a[12])/(_=_||1),r[1]=(a[1]*o+a[5]*h+a[9]*g+a[13])/_,r[2]=(a[2]*o+a[6]*h+a[10]*g+a[14])/_,r},P.b_=class extends bs{},P.ba=Pu,P.bb=gr,P.bc=Ye,P.bd=ot,P.be=Xn,P.bf=function(r,t,a,o,h){return Ye(o,h,At((r-t)/(a-t),0,1))},P.bg=le,P.bh=function(){return new Float64Array(3)},P.bi=function(r,t,a,o){return r[0]=t[0]+a[0]*o,r[1]=t[1]+a[1]*o,r[2]=t[2]+a[2]*o,r},P.bj=_n,P.bk=function(){return new Float64Array(4)},P.bl=function(r,t,a,o){var h=[],g=[];return h[0]=t[0]-a[0],h[1]=t[1]-a[1],h[2]=t[2]-a[2],g[0]=h[0]*Math.cos(o)-h[1]*Math.sin(o),g[1]=h[0]*Math.sin(o)+h[1]*Math.cos(o),g[2]=h[2],r[0]=g[0]+a[0],r[1]=g[1]+a[1],r[2]=g[2]+a[2],r},P.bm=function(r,t,a,o){var h=[],g=[];return h[0]=t[0]-a[0],h[1]=t[1]-a[1],h[2]=t[2]-a[2],g[0]=h[0],g[1]=h[1]*Math.cos(o)-h[2]*Math.sin(o),g[2]=h[1]*Math.sin(o)+h[2]*Math.cos(o),r[0]=g[0]+a[0],r[1]=g[1]+a[1],r[2]=g[2]+a[2],r},P.bn=function(r,t,a,o){var h=[],g=[];return h[0]=t[0]-a[0],h[1]=t[1]-a[1],h[2]=t[2]-a[2],g[0]=h[2]*Math.sin(o)+h[0]*Math.cos(o),g[1]=h[1],g[2]=h[2]*Math.cos(o)-h[0]*Math.sin(o),r[0]=g[0]+a[0],r[1]=g[1]+a[1],r[2]=g[2]+a[2],r},P.bo=ni,P.bp=function(r,t,a){var o=Math.sin(a),h=Math.cos(a),g=t[0],_=t[1],v=t[2],w=t[3],M=t[8],A=t[9],I=t[10],F=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*h-M*o,r[1]=_*h-A*o,r[2]=v*h-I*o,r[3]=w*h-F*o,r[8]=g*o+M*h,r[9]=_*o+A*h,r[10]=v*o+I*h,r[11]=w*o+F*h,r},P.bq=function(r,t){const a=le(r,360),o=le(t,360),h=o-a,g=o>a?h-360:h+360;return Math.abs(h)<Math.abs(g)?h:g},P.br=function(r){return r[0]=0,r[1]=0,r[2]=0,r},P.bs=function(r,t,a,o){const h=Math.sqrt(r*r+t*t),g=Math.sqrt(a*a+o*o);r/=h,t/=h,a/=g,o/=g;const _=Math.acos(r*a+t*o);return-t*a+r*o>0?_:-_},P.bt=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]},P.bu=Of,P.bv=function(r,t){const a=le(r,2*Math.PI),o=le(t,2*Math.PI);return Math.min(Math.abs(a-o),Math.abs(a-o+2*Math.PI),Math.abs(a-o-2*Math.PI))},P.bw=function(){const r={},t=W.$version;for(const a in W.$root){const o=W.$root[a];if(o.required){let h=null;h=a==="version"?t:o.type==="array"?[]:{},h!=null&&(r[a]=h)}}return r},P.bx=yu,P.by=ta,P.bz=function(r){r=r.slice();const t=Object.create(null);for(let a=0;a<r.length;a++)t[r[a].id]=r[a];for(let a=0;a<r.length;a++)"ref"in r[a]&&(r[a]=we(r[a],t[r[a].ref]));return r},P.c=oa,P.c0=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},P.c1=function(r,t){var a=r[0],o=r[1],h=r[2],g=r[3],_=r[4],v=r[5],w=r[6],M=r[7],A=r[8],I=r[9],F=r[10],N=r[11],V=r[12],q=r[13],Q=r[14],ne=r[15],ye=t[0],se=t[1],j=t[2],K=t[3],ue=t[4],Re=t[5],tt=t[6],Oe=t[7],He=t[8],rt=t[9],nt=t[10],lt=t[11],Xe=t[12],wt=t[13],kt=t[14],It=t[15];return Math.abs(a-ye)<=bt*Math.max(1,Math.abs(a),Math.abs(ye))&&Math.abs(o-se)<=bt*Math.max(1,Math.abs(o),Math.abs(se))&&Math.abs(h-j)<=bt*Math.max(1,Math.abs(h),Math.abs(j))&&Math.abs(g-K)<=bt*Math.max(1,Math.abs(g),Math.abs(K))&&Math.abs(_-ue)<=bt*Math.max(1,Math.abs(_),Math.abs(ue))&&Math.abs(v-Re)<=bt*Math.max(1,Math.abs(v),Math.abs(Re))&&Math.abs(w-tt)<=bt*Math.max(1,Math.abs(w),Math.abs(tt))&&Math.abs(M-Oe)<=bt*Math.max(1,Math.abs(M),Math.abs(Oe))&&Math.abs(A-He)<=bt*Math.max(1,Math.abs(A),Math.abs(He))&&Math.abs(I-rt)<=bt*Math.max(1,Math.abs(I),Math.abs(rt))&&Math.abs(F-nt)<=bt*Math.max(1,Math.abs(F),Math.abs(nt))&&Math.abs(N-lt)<=bt*Math.max(1,Math.abs(N),Math.abs(lt))&&Math.abs(V-Xe)<=bt*Math.max(1,Math.abs(V),Math.abs(Xe))&&Math.abs(q-wt)<=bt*Math.max(1,Math.abs(q),Math.abs(wt))&&Math.abs(Q-kt)<=bt*Math.max(1,Math.abs(Q),Math.abs(kt))&&Math.abs(ne-It)<=bt*Math.max(1,Math.abs(ne),Math.abs(It))},P.c2=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},P.c3=r=>r.type==="symbol",P.c4=r=>r.type==="circle",P.c5=r=>r.type==="heatmap",P.c6=r=>r.type==="line",P.c7=r=>r.type==="fill",P.c8=r=>r.type==="fill-extrusion",P.c9=r=>r.type==="hillshade",P.cA=Ps,P.cB=kc,P.cC=Qo,P.cD=ar,P.cE=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},P.cF=function(r,t,a,o,h){return d(this,void 0,void 0,function*(){if(qt())try{return yield cl(r,t,a,o,h)}catch{}return function(g,_,v,w,M){const A=g.width,I=g.height;Da&&Va||(Da=new OffscreenCanvas(A,I),Va=Da.getContext("2d",{willReadFrequently:!0})),Da.width=A,Da.height=I,Va.drawImage(g,0,0,A,I);const F=Va.getImageData(_,v,w,M);return Va.clearRect(0,0,A,I),F.data}(r,t,a,o,h)})},P.cG=jf,P.cH=ge,P.cI=Ne,P.cJ=Du,P.cK=bd,P.cL=fs,P.cM=Yr,P.ca=r=>r.type==="raster",P.cb=r=>r.type==="background",P.cc=r=>r.type==="custom",P.cd=ct,P.ce=function(r,t,a){const o=Ke(t.x-a.x,t.y-a.y),h=Ke(r.x-a.x,r.y-a.y);var g,_;return ss(Math.atan2(o[0]*h[1]-o[1]*h[0],(g=o)[0]*(_=h)[0]+g[1]*_[1]))},P.cf=xt,P.cg=function(r,t){return Lr[t]&&(r instanceof MouseEvent||r instanceof WheelEvent)},P.ch=function(r,t){return ul[t]&&"touches"in r},P.ci=function(r){return ul[r]||Lr[r]},P.cj=function(r,t,a){var o=t[0],h=t[1];return r[0]=a[0]*o+a[4]*h+a[12],r[1]=a[1]*o+a[5]*h+a[13],r},P.ck=function(r,t){const{x:a,y:o}=Ql.fromLngLat(t);return!(r<0||r>25||o<0||o>=1||a<0||a>=1)},P.cl=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},P.cm=class extends Ho{},P.cn=am,P.cp=function(r){return r.message===$n},P.cq=sr,P.cr=function(r,t){zn.REGISTERED_PROTOCOLS[r]=t},P.cs=function(r){delete zn.REGISTERED_PROTOCOLS[r]},P.ct=function(r,t){const a={};for(let h=0;h<r.length;h++){const g=t&&t[r[h].id]||br(r[h]);t&&(t[r[h].id]=g);let _=a[g];_||(_=a[g]=[]),_.push(r[h])}const o=[];for(const h in a)o.push(a[h]);return o},P.cu=vt,P.cv=Ih,P.cw=kd,P.cx=Bc,P.cy=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Ge/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],a=t.layout,o=t._unevaluatedLayout._values,h={layoutIconSize:o["icon-size"].possiblyEvaluate(new Ui(r.bucket.zoom+1),r.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Ui(r.bucket.zoom+1),r.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Ui(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:A}=r.bucket.textSizeData;h.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Ui(M),r.canonical),o["text-size"].possiblyEvaluate(new Ui(A),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:A}=r.bucket.iconSizeData;h.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Ui(M),r.canonical),o["icon-size"].possiblyEvaluate(new Ui(A),r.canonical)]}const g=a.get("text-line-height")*Rn,_=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",v=a.get("text-keep-upright"),w=a.get("text-size");for(const M of r.bucket.features){const A=a.get("text-font").evaluate(M,{},r.canonical).join(","),I=w.evaluate(M,{},r.canonical),F=h.layoutTextSize.evaluate(M,{},r.canonical),N=h.layoutIconSize.evaluate(M,{},r.canonical),V={horizontal:{},vertical:void 0},q=M.text;let Q,ne=[0,0];if(q){const j=q.toString(),K=a.get("text-letter-spacing").evaluate(M,{},r.canonical)*Rn,ue=Wh(j)?K:0,Re=a.get("text-anchor").evaluate(M,{},r.canonical),tt=Rr(t,M,r.canonical);if(!tt){const nt=a.get("text-radial-offset").evaluate(M,{},r.canonical);ne=nt?qu(Re,[nt*Rn,Nd]):a.get("text-offset").evaluate(M,{},r.canonical).map(lt=>lt*Rn)}let Oe=_?"center":a.get("text-justify").evaluate(M,{},r.canonical);const He=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(M,{},r.canonical)*Rn:1/0,rt=()=>{r.bucket.allowVerticalPlacement&&Mc(j)&&(V.vertical=Bu(q,r.glyphMap,r.glyphPositions,r.imagePositions,A,He,g,Re,"left",ue,ne,P.al.vertical,!0,F,I))};if(!_&&tt){const nt=new Set;if(Oe==="auto")for(let Xe=0;Xe<tt.values.length;Xe+=2)nt.add(Ud(tt.values[Xe]));else nt.add(Oe);let lt=!1;for(const Xe of nt)if(!V.horizontal[Xe])if(lt)V.horizontal[Xe]=V.horizontal[0];else{const wt=Bu(q,r.glyphMap,r.glyphPositions,r.imagePositions,A,He,g,"center",Xe,ue,ne,P.al.horizontal,!1,F,I);wt&&(V.horizontal[Xe]=wt,lt=wt.positionedLines.length===1)}rt()}else{Oe==="auto"&&(Oe=Ud(Re));const nt=Bu(q,r.glyphMap,r.glyphPositions,r.imagePositions,A,He,g,Re,Oe,ue,ne,P.al.horizontal,!1,F,I);nt&&(V.horizontal[Oe]=nt),rt(),Mc(j)&&_&&v&&(V.vertical=Bu(q,r.glyphMap,r.glyphPositions,r.imagePositions,A,He,g,Re,Oe,ue,ne,P.al.vertical,!1,F,I))}}let ye=!1;if(M.icon&&M.icon.name){const j=r.imageMap[M.icon.name];j&&(Q=an(r.imagePositions[M.icon.name],a.get("icon-offset").evaluate(M,{},r.canonical),a.get("icon-anchor").evaluate(M,{},r.canonical)),ye=!!j.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ye:r.bucket.sdfIcons!==ye&&Qi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(j.pixelRatio!==r.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const se=kp(V.horizontal)||V.vertical;r.bucket.iconsInText=!!se&&se.iconsInText,(se||Q)&&Vd(r.bucket,M,V,Q,r.imageMap,h,F,N,ne,ye,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},P.cz=En,P.d=Me,P.e=fi,P.f=r=>d(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),P.g=js,P.h=r=>new Promise((t,a)=>{const o=new Image;o.onload=()=>{t(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=rc})},o.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(r)],{type:"image/png"});o.src=r.byteLength?URL.createObjectURL(h):rc}),P.i=kr,P.j=(r,t)=>Za(fi(r,{type:"json"}),t),P.k=ce,P.l=J,P.m=Za,P.n=(r,t)=>Za(fi(r,{type:"arrayBuffer"}),t),P.o=function(r){return new ar(r).readFields(Dr,[])},P.p=el,P.q=Eu,P.r=on,P.s=mo,P.t=wc,P.u=ti,P.v=W,P.w=Qi,P.x=Tc,P.y=kl,P.z=function([r,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(a),y:r*Math.sin(t)*Math.sin(a),z:r*Math.cos(a)}}}),H("worker",["./shared"],function(P){class d{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,X){for(const ce of $){this._layerConfigs[ce.id]=ce;const ve=this._layers[ce.id]=P.bA(ce);ve._featureFilter=P.a7(ve.filter),this.keyCache[ce.id]&&delete this.keyCache[ce.id]}for(const ce of X)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const J=P.ct(Object.values(this._layerConfigs),this.keyCache);for(const ce of J){const ve=ce.map(Ee=>this._layers[Ee.id]),W=ve[0];if(W.visibility==="none")continue;const De=W.source||"";let we=this.familiesBySource[De];we||(we=this.familiesBySource[De]={});const ze=W.sourceLayer||"_geojsonTileLayer";let Be=we[ze];Be||(Be=we[ze]=[]),Be.push(ve)}}}class ge{constructor($){const X={},J=[];for(const De in $){const we=$[De],ze=X[De]={};for(const Be in we){const Ee=we[+Be];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const We={x:0,y:0,w:Ee.bitmap.width+2,h:Ee.bitmap.height+2};J.push(We),ze[Be]={rect:We,metrics:Ee.metrics}}}const{w:ce,h:ve}=P.p(J),W=new P.q({width:ce||1,height:ve||1});for(const De in $){const we=$[De];for(const ze in we){const Be=we[+ze];if(!Be||Be.bitmap.width===0||Be.bitmap.height===0)continue;const Ee=X[De][ze].rect;P.q.copy(Be.bitmap,W,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},Be.bitmap)}}this.image=W,this.positions=X}}P.cu("GlyphAtlas",ge);class re{constructor($){this.tileID=new P.Y($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[]}parse($,X,J,ce,ve){return P._(this,void 0,void 0,function*(){this.status="parsing",this.data=$,this.collisionBoxArray=new P.a5;const W=new P.cv(Object.keys($.layers).sort()),De=new P.cw(this.tileID,this.promoteId);De.bucketLayerIDs=[];const we={},ze={featureIndex:De,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J,subdivisionGranularity:ve},Be=X.familiesBySource[this.source];for(const Vt in Be){const Qe=$.layers[Vt];if(!Qe)continue;Qe.version===1&&P.w(`Vector tile source "${this.source}" layer "${Vt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Nt=W.encode(Vt),Ht=[];for(let Ri=0;Ri<Qe.length;Ri++){const ji=Qe.feature(Ri),jn=De.getId(ji,Vt);Ht.push({feature:ji,id:jn,index:Ri,sourceLayerIndex:Nt})}for(const Ri of Be[Vt]){const ji=Ri[0];ji.source!==this.source&&P.w(`layer.source = ${ji.source} does not equal this.source = ${this.source}`),ji.minzoom&&this.zoom<Math.floor(ji.minzoom)||ji.maxzoom&&this.zoom>=ji.maxzoom||ji.visibility!=="none"&&(Ce(Ri,this.zoom,J),(we[ji.id]=ji.createBucket({index:De.bucketLayerIDs.length,layers:Ri,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Nt,sourceID:this.source})).populate(Ht,ze,this.tileID.canonical),De.bucketLayerIDs.push(Ri.map(jn=>jn.id)))}}const Ee=P.bF(ze.glyphDependencies,Vt=>Object.keys(Vt).map(Number));this.inFlightDependencies.forEach(Vt=>Vt==null?void 0:Vt.abort()),this.inFlightDependencies=[];let We=Promise.resolve({});if(Object.keys(Ee).length){const Vt=new AbortController;this.inFlightDependencies.push(Vt),We=ce.sendAsync({type:"GG",data:{stacks:Ee,source:this.source,tileID:this.tileID,type:"glyphs"}},Vt)}const ft=Object.keys(ze.iconDependencies);let yt=Promise.resolve({});if(ft.length){const Vt=new AbortController;this.inFlightDependencies.push(Vt),yt=ce.sendAsync({type:"GI",data:{icons:ft,source:this.source,tileID:this.tileID,type:"icons"}},Vt)}const zt=Object.keys(ze.patternDependencies);let Ot=Promise.resolve({});if(zt.length){const Vt=new AbortController;this.inFlightDependencies.push(Vt),Ot=ce.sendAsync({type:"GI",data:{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"}},Vt)}const[Dt,Ve,yi]=yield Promise.all([We,yt,Ot]),ui=new ge(Dt),vi=new P.cx(Ve,yi);for(const Vt in we){const Qe=we[Vt];Qe instanceof P.a6?(Ce(Qe.layers,this.zoom,J),P.cy({bucket:Qe,glyphMap:Dt,glyphPositions:ui.positions,imageMap:Ve,imagePositions:vi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ze.subdivisionGranularity})):Qe.hasPattern&&(Qe instanceof P.cz||Qe instanceof P.cA||Qe instanceof P.cB)&&(Ce(Qe.layers,this.zoom,J),Qe.addFeatures(ze,this.tileID.canonical,vi.patternPositions))}return this.status="done",{buckets:Object.values(we).filter(Vt=>!Vt.isEmpty()),featureIndex:De,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ui.image,imageAtlas:vi,glyphMap:this.returnDependencies?Dt:null,iconMap:this.returnDependencies?Ve:null,glyphPositions:this.returnDependencies?ui.positions:null}})}}function Ce(Me,$,X){const J=new P.C($);for(const ce of Me)ce.recalculate(J,X)}class Ne{constructor($,X,J){this.actor=$,this.layerIndex=X,this.availableImages=J,this.fetching={},this.loading={},this.loaded={}}loadVectorTile($,X){return P._(this,void 0,void 0,function*(){const J=yield P.n($.request,X);try{return{vectorTile:new P.cC.VectorTile(new P.cD(J.data)),rawData:J.data,cacheControl:J.cacheControl,expires:J.expires}}catch(ce){const ve=new Uint8Array(J.data);let W=`Unable to parse the tile at ${$.request.url}, `;throw W+=ve[0]===31&&ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ce.message}`,new Error(W)}})}loadTile($){return P._(this,void 0,void 0,function*(){const X=$.uid,J=!!($&&$.request&&$.request.collectResourceTiming)&&new P.cE($.request),ce=new re($);this.loading[X]=ce;const ve=new AbortController;ce.abort=ve;try{const W=yield this.loadVectorTile($,ve);if(delete this.loading[X],!W)return null;const De=W.rawData,we={};W.expires&&(we.expires=W.expires),W.cacheControl&&(we.cacheControl=W.cacheControl);const ze={};if(J){const Ee=J.finish();Ee&&(ze.resourceTiming=JSON.parse(JSON.stringify(Ee)))}ce.vectorTile=W.vectorTile;const Be=ce.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);this.loaded[X]=ce,this.fetching[X]={rawTileData:De,cacheControl:we,resourceTiming:ze};try{const Ee=yield Be;return P.e({rawTileData:De.slice(0)},Ee,we,ze)}finally{delete this.fetching[X]}}catch(W){throw delete this.loading[X],ce.status="done",this.loaded[X]=ce,W}})}reloadTile($){return P._(this,void 0,void 0,function*(){const X=$.uid;if(!this.loaded||!this.loaded[X])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const J=this.loaded[X];if(J.showCollisionBoxes=$.showCollisionBoxes,J.status==="parsing"){const ce=yield J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);let ve;if(this.fetching[X]){const{rawTileData:W,cacheControl:De,resourceTiming:we}=this.fetching[X];delete this.fetching[X],ve=P.e({rawTileData:W.slice(0)},ce,De,we)}else ve=ce;return ve}if(J.status==="done"&&J.vectorTile)return J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity)})}abortTile($){return P._(this,void 0,void 0,function*(){const X=this.loading,J=$.uid;X&&X[J]&&X[J].abort&&(X[J].abort.abort(),delete X[J])})}removeTile($){return P._(this,void 0,void 0,function*(){this.loaded&&this.loaded[$.uid]&&delete this.loaded[$.uid]})}}class Se{constructor(){this.loaded={}}loadTile($){return P._(this,void 0,void 0,function*(){const{uid:X,encoding:J,rawImageData:ce,redFactor:ve,greenFactor:W,blueFactor:De,baseShift:we}=$,ze=ce.width+2,Be=ce.height+2,Ee=P.b(ce)?new P.R({width:ze,height:Be},yield P.cF(ce,-1,-1,ze,Be)):ce,We=new P.cG(X,Ee,J,ve,W,De,we);return this.loaded=this.loaded||{},this.loaded[X]=We,We})}removeTile($){const X=this.loaded,J=$.uid;X&&X[J]&&delete X[J]}}var pe,Pe,ht=function(){if(Pe)return pe;function Me(X,J){if(X.length!==0){$(X[0],J);for(var ce=1;ce<X.length;ce++)$(X[ce],!J)}}function $(X,J){for(var ce=0,ve=0,W=0,De=X.length,we=De-1;W<De;we=W++){var ze=(X[W][0]-X[we][0])*(X[we][1]+X[W][1]),Be=ce+ze;ve+=Math.abs(ce)>=Math.abs(ze)?ce-Be+ze:ze-Be+ce,ce=Be}ce+ve>=0!=!!J&&X.reverse()}return Pe=1,pe=function X(J,ce){var ve,W=J&&J.type;if(W==="FeatureCollection")for(ve=0;ve<J.features.length;ve++)X(J.features[ve],ce);else if(W==="GeometryCollection")for(ve=0;ve<J.geometries.length;ve++)X(J.geometries[ve],ce);else if(W==="Feature")X(J.geometry,ce);else if(W==="Polygon")Me(J.coordinates,ce);else if(W==="MultiPolygon")for(ve=0;ve<J.coordinates.length;ve++)Me(J.coordinates[ve],ce);return J}}(),Tt=P.cH(ht);const pt=P.cC.VectorTileFeature.prototype.toGeoJSON;class St{constructor($){this._feature=$,this.extent=P.Z,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))}loadGeometry(){if(this._feature.type===1){const $=[];for(const X of this._feature.geometry)$.push([new P.P(X[0],X[1])]);return $}{const $=[];for(const X of this._feature.geometry){const J=[];for(const ce of X)J.push(new P.P(ce[0],ce[1]));$.push(J)}return $}}toGeoJSON($,X,J){return pt.call(this,$,X,J)}}class Pt{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=P.Z,this.length=$.length,this._features=$}feature($){return new St(this._features[$])}}var qt,bt,Zt,di={exports:{}},Xt=function(){if(Zt)return di.exports;Zt=1;var Me=P.cK(),$=function(){if(bt)return qt;bt=1;var Be=P.cI(),Ee=P.cJ().VectorTileFeature;function We(yt,zt){this.options=zt||{},this.features=yt,this.length=yt.length}function ft(yt,zt){this.id=typeof yt.id=="number"?yt.id:void 0,this.type=yt.type,this.rawGeometry=yt.type===1?[yt.geometry]:yt.geometry,this.properties=yt.tags,this.extent=zt||4096}return qt=We,We.prototype.feature=function(yt){return new ft(this.features[yt],this.options.extent)},ft.prototype.loadGeometry=function(){var yt=this.rawGeometry;this.geometry=[];for(var zt=0;zt<yt.length;zt++){for(var Ot=yt[zt],Dt=[],Ve=0;Ve<Ot.length;Ve++)Dt.push(new Be(Ot[Ve][0],Ot[Ve][1]));this.geometry.push(Dt)}return this.geometry},ft.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var yt=this.geometry,zt=1/0,Ot=-1/0,Dt=1/0,Ve=-1/0,yi=0;yi<yt.length;yi++)for(var ui=yt[yi],vi=0;vi<ui.length;vi++){var Vt=ui[vi];zt=Math.min(zt,Vt.x),Ot=Math.max(Ot,Vt.x),Dt=Math.min(Dt,Vt.y),Ve=Math.max(Ve,Vt.y)}return[zt,Dt,Ot,Ve]},ft.prototype.toGeoJSON=Ee.prototype.toGeoJSON,qt}();function X(Be){var Ee=new Me;return function(We,ft){for(var yt in We.layers)ft.writeMessage(3,J,We.layers[yt])}(Be,Ee),Ee.finish()}function J(Be,Ee){var We;Ee.writeVarintField(15,Be.version||1),Ee.writeStringField(1,Be.name||""),Ee.writeVarintField(5,Be.extent||4096);var ft={keys:[],values:[],keycache:{},valuecache:{}};for(We=0;We<Be.length;We++)ft.feature=Be.feature(We),Ee.writeMessage(2,ce,ft);var yt=ft.keys;for(We=0;We<yt.length;We++)Ee.writeStringField(3,yt[We]);var zt=ft.values;for(We=0;We<zt.length;We++)Ee.writeMessage(4,ze,zt[We])}function ce(Be,Ee){var We=Be.feature;We.id!==void 0&&Ee.writeVarintField(1,We.id),Ee.writeMessage(2,ve,Be),Ee.writeVarintField(3,We.type),Ee.writeMessage(4,we,We)}function ve(Be,Ee){var We=Be.feature,ft=Be.keys,yt=Be.values,zt=Be.keycache,Ot=Be.valuecache;for(var Dt in We.properties){var Ve=We.properties[Dt],yi=zt[Dt];if(Ve!==null){yi===void 0&&(ft.push(Dt),zt[Dt]=yi=ft.length-1),Ee.writeVarint(yi);var ui=typeof Ve;ui!=="string"&&ui!=="boolean"&&ui!=="number"&&(Ve=JSON.stringify(Ve));var vi=ui+":"+Ve,Vt=Ot[vi];Vt===void 0&&(yt.push(Ve),Ot[vi]=Vt=yt.length-1),Ee.writeVarint(Vt)}}}function W(Be,Ee){return(Ee<<3)+(7&Be)}function De(Be){return Be<<1^Be>>31}function we(Be,Ee){for(var We=Be.loadGeometry(),ft=Be.type,yt=0,zt=0,Ot=We.length,Dt=0;Dt<Ot;Dt++){var Ve=We[Dt],yi=1;ft===1&&(yi=Ve.length),Ee.writeVarint(W(1,yi));for(var ui=ft===3?Ve.length-1:Ve.length,vi=0;vi<ui;vi++){vi===1&&ft!==1&&Ee.writeVarint(W(2,ui-1));var Vt=Ve[vi].x-yt,Qe=Ve[vi].y-zt;Ee.writeVarint(De(Vt)),Ee.writeVarint(De(Qe)),yt+=Vt,zt+=Qe}ft===3&&Ee.writeVarint(W(7,1))}}function ze(Be,Ee){var We=typeof Be;We==="string"?Ee.writeStringField(1,Be):We==="boolean"?Ee.writeBooleanField(7,Be):We==="number"&&(Be%1!=0?Ee.writeDoubleField(3,Be):Be<0?Ee.writeSVarintField(6,Be):Ee.writeVarintField(5,Be))}return di.exports=X,di.exports.fromVectorTileJs=X,di.exports.fromGeojsonVt=function(Be,Ee){Ee=Ee||{};var We={};for(var ft in Be)We[ft]=new $(Be[ft].features,Ee),We[ft].name=ft,We[ft].version=Ee.version,We[ft].extent=Ee.extent;return X({layers:We})},di.exports.GeoJSONWrapper=$,di.exports}(),li=P.cH(Xt);const ni={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Bt=Math.fround||(wi=new Float32Array(1),Me=>(wi[0]=+Me,wi[0]));var wi;const _n=3,Ct=5,mt=6;class be{constructor($){this.options=Object.assign(Object.create(ni),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:X,minZoom:J,maxZoom:ce}=this.options;X&&console.time("total time");const ve=`prepare ${$.length} points`;X&&console.time(ve),this.points=$;const W=[];for(let we=0;we<$.length;we++){const ze=$[we];if(!ze.geometry)continue;const[Be,Ee]=ze.geometry.coordinates,We=Bt(_t(Be)),ft=Bt(le(Ee));W.push(We,ft,1/0,we,-1,1),this.options.reduce&&W.push(0)}let De=this.trees[ce+1]=this._createTree(W);X&&console.timeEnd(ve);for(let we=ce;we>=J;we--){const ze=+Date.now();De=this.trees[we]=this._createTree(this._cluster(De,we)),X&&console.log("z%d: %d clusters in %dms",we,De.numItems,+Date.now()-ze)}return X&&console.timeEnd("total time"),this}getClusters($,X){let J=(($[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,$[1]));let ve=$[2]===180?180:(($[2]+180)%360+360)%360-180;const W=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)J=-180,ve=180;else if(J>ve){const Ee=this.getClusters([J,ce,180,W],X),We=this.getClusters([-180,ce,ve,W],X);return Ee.concat(We)}const De=this.trees[this._limitZoom(X)],we=De.range(_t(J),le(W),_t(ve),le(ce)),ze=De.data,Be=[];for(const Ee of we){const We=this.stride*Ee;Be.push(ze[We+Ct]>1?Ke(ze,We,this.clusterProps):this.points[ze[We+_n]])}return Be}getChildren($){const X=this._getOriginId($),J=this._getOriginZoom($),ce="No cluster with the specified id.",ve=this.trees[J];if(!ve)throw new Error(ce);const W=ve.data;if(X*this.stride>=W.length)throw new Error(ce);const De=this.options.radius/(this.options.extent*Math.pow(2,J-1)),we=ve.within(W[X*this.stride],W[X*this.stride+1],De),ze=[];for(const Be of we){const Ee=Be*this.stride;W[Ee+4]===$&&ze.push(W[Ee+Ct]>1?Ke(W,Ee,this.clusterProps):this.points[W[Ee+_n]])}if(ze.length===0)throw new Error(ce);return ze}getLeaves($,X,J){const ce=[];return this._appendLeaves(ce,$,X=X||10,J=J||0,0),ce}getTile($,X,J){const ce=this.trees[this._limitZoom($)],ve=Math.pow(2,$),{extent:W,radius:De}=this.options,we=De/W,ze=(J-we)/ve,Be=(J+1+we)/ve,Ee={features:[]};return this._addTileFeatures(ce.range((X-we)/ve,ze,(X+1+we)/ve,Be),ce.data,X,J,ve,Ee),X===0&&this._addTileFeatures(ce.range(1-we/ve,ze,1,Be),ce.data,ve,J,ve,Ee),X===ve-1&&this._addTileFeatures(ce.range(0,ze,we/ve,Be),ce.data,-1,J,ve,Ee),Ee.features.length?Ee:null}getClusterExpansionZoom($){let X=this._getOriginZoom($)-1;for(;X<=this.options.maxZoom;){const J=this.getChildren($);if(X++,J.length!==1)break;$=J[0].properties.cluster_id}return X}_appendLeaves($,X,J,ce,ve){const W=this.getChildren(X);for(const De of W){const we=De.properties;if(we&&we.cluster?ve+we.point_count<=ce?ve+=we.point_count:ve=this._appendLeaves($,we.cluster_id,J,ce,ve):ve<ce?ve++:$.push(De),$.length===J)break}return ve}_createTree($){const X=new P.aF($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<$.length;J+=this.stride)X.add($[J],$[J+1]);return X.finish(),X.data=$,X}_addTileFeatures($,X,J,ce,ve,W){for(const De of $){const we=De*this.stride,ze=X[we+Ct]>1;let Be,Ee,We;if(ze)Be=Ge(X,we,this.clusterProps),Ee=X[we],We=X[we+1];else{const zt=this.points[X[we+_n]];Be=zt.properties;const[Ot,Dt]=zt.geometry.coordinates;Ee=_t(Ot),We=le(Dt)}const ft={type:1,geometry:[[Math.round(this.options.extent*(Ee*ve-J)),Math.round(this.options.extent*(We*ve-ce))]],tags:Be};let yt;yt=ze||this.options.generateId?X[we+_n]:this.points[X[we+_n]].id,yt!==void 0&&(ft.id=yt),W.features.push(ft)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,X){const{radius:J,extent:ce,reduce:ve,minPoints:W}=this.options,De=J/(ce*Math.pow(2,X)),we=$.data,ze=[],Be=this.stride;for(let Ee=0;Ee<we.length;Ee+=Be){if(we[Ee+2]<=X)continue;we[Ee+2]=X;const We=we[Ee],ft=we[Ee+1],yt=$.within(we[Ee],we[Ee+1],De),zt=we[Ee+Ct];let Ot=zt;for(const Dt of yt){const Ve=Dt*Be;we[Ve+2]>X&&(Ot+=we[Ve+Ct])}if(Ot>zt&&Ot>=W){let Dt,Ve=We*zt,yi=ft*zt,ui=-1;const vi=((Ee/Be|0)<<5)+(X+1)+this.points.length;for(const Vt of yt){const Qe=Vt*Be;if(we[Qe+2]<=X)continue;we[Qe+2]=X;const Nt=we[Qe+Ct];Ve+=we[Qe]*Nt,yi+=we[Qe+1]*Nt,we[Qe+4]=vi,ve&&(Dt||(Dt=this._map(we,Ee,!0),ui=this.clusterProps.length,this.clusterProps.push(Dt)),ve(Dt,this._map(we,Qe)))}we[Ee+4]=vi,ze.push(Ve/Ot,yi/Ot,1/0,vi,-1,Ot),ve&&ze.push(ui)}else{for(let Dt=0;Dt<Be;Dt++)ze.push(we[Ee+Dt]);if(Ot>1)for(const Dt of yt){const Ve=Dt*Be;if(!(we[Ve+2]<=X)){we[Ve+2]=X;for(let yi=0;yi<Be;yi++)ze.push(we[Ve+yi])}}}}return ze}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,X,J){if($[X+Ct]>1){const W=this.clusterProps[$[X+mt]];return J?Object.assign({},W):W}const ce=this.points[$[X+_n]].properties,ve=this.options.map(ce);return J&&ve===ce?Object.assign({},ve):ve}}function Ke(Me,$,X){return{type:"Feature",id:Me[$+_n],properties:Ge(Me,$,X),geometry:{type:"Point",coordinates:[(J=Me[$],360*(J-.5)),Ye(Me[$+1])]}};var J}function Ge(Me,$,X){const J=Me[$+Ct],ce=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,ve=Me[$+mt],W=ve===-1?{}:Object.assign({},X[ve]);return Object.assign(W,{cluster:!0,cluster_id:Me[$+_n],point_count:J,point_count_abbreviated:ce})}function _t(Me){return Me/360+.5}function le(Me){const $=Math.sin(Me*Math.PI/180),X=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return X<0?0:X>1?1:X}function Ye(Me){const $=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function ot(Me,$,X,J){let ce=J;const ve=$+(X-$>>1);let W,De=X-$;const we=Me[$],ze=Me[$+1],Be=Me[X],Ee=Me[X+1];for(let We=$+3;We<X;We+=3){const ft=ct(Me[We],Me[We+1],we,ze,Be,Ee);if(ft>ce)W=We,ce=ft;else if(ft===ce){const yt=Math.abs(We-ve);yt<De&&(W=We,De=yt)}}ce>J&&(W-$>3&&ot(Me,$,W,J),Me[W+2]=ce,X-W>3&&ot(Me,W,X,J))}function ct(Me,$,X,J,ce,ve){let W=ce-X,De=ve-J;if(W!==0||De!==0){const we=((Me-X)*W+($-J)*De)/(W*W+De*De);we>1?(X=ce,J=ve):we>0&&(X+=W*we,J+=De*we)}return W=Me-X,De=$-J,W*W+De*De}function xt(Me,$,X,J){const ce={id:Me??null,type:$,geometry:X,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if($==="Point"||$==="MultiPoint"||$==="LineString")At(ce,X);else if($==="Polygon")At(ce,X[0]);else if($==="MultiLineString")for(const ve of X)At(ce,ve);else if($==="MultiPolygon")for(const ve of X)At(ce,ve[0]);return ce}function At(Me,$){for(let X=0;X<$.length;X+=3)Me.minX=Math.min(Me.minX,$[X]),Me.minY=Math.min(Me.minY,$[X+1]),Me.maxX=Math.max(Me.maxX,$[X]),Me.maxY=Math.max(Me.maxY,$[X+1])}function Rt(Me,$,X,J){if(!$.geometry)return;const ce=$.geometry.coordinates;if(ce&&ce.length===0)return;const ve=$.geometry.type,W=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2);let De=[],we=$.id;if(X.promoteId?we=$.properties[X.promoteId]:X.generateId&&(we=J||0),ve==="Point")fi(ce,De);else if(ve==="MultiPoint")for(const ze of ce)fi(ze,De);else if(ve==="LineString")ci(ce,De,W,!1);else if(ve==="MultiLineString"){if(X.lineMetrics){for(const ze of ce)De=[],ci(ze,De,W,!1),Me.push(xt(we,"LineString",De,$.properties));return}Ki(ce,De,W,!1)}else if(ve==="Polygon")Ki(ce,De,W,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(const ze of $.geometry.geometries)Rt(Me,{id:we,geometry:ze,properties:$.properties},X,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ze of ce){const Be=[];Ki(ze,Be,W,!0),De.push(Be)}}Me.push(xt(we,ve,De,$.properties))}function fi(Me,$){$.push(rn(Me[0]),Ii(Me[1]),0)}function ci(Me,$,X,J){let ce,ve,W=0;for(let we=0;we<Me.length;we++){const ze=rn(Me[we][0]),Be=Ii(Me[we][1]);$.push(ze,Be,0),we>0&&(W+=J?(ce*Be-ze*ve)/2:Math.sqrt(Math.pow(ze-ce,2)+Math.pow(Be-ve,2))),ce=ze,ve=Be}const De=$.length-3;$[2]=1,ot($,0,De,X),$[De+2]=1,$.size=Math.abs(W),$.start=0,$.end=$.size}function Ki(Me,$,X,J){for(let ce=0;ce<Me.length;ce++){const ve=[];ci(Me[ce],ve,X,J),$.push(ve)}}function rn(Me){return Me/360+.5}function Ii(Me){const $=Math.sin(Me*Math.PI/180),X=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return X<0?0:X>1?1:X}function sn(Me,$,X,J,ce,ve,W,De){if(J/=$,ve>=(X/=$)&&W<J)return Me;if(W<X||ve>=J)return null;const we=[];for(const ze of Me){const Be=ze.geometry;let Ee=ze.type;const We=ce===0?ze.minX:ze.minY,ft=ce===0?ze.maxX:ze.maxY;if(We>=X&&ft<J){we.push(ze);continue}if(ft<X||We>=J)continue;let yt=[];if(Ee==="Point"||Ee==="MultiPoint")Qi(Be,yt,X,J,ce);else if(Ee==="LineString")zi(Be,yt,X,J,ce,!1,De.lineMetrics);else if(Ee==="MultiLineString")Os(Be,yt,X,J,ce,!1);else if(Ee==="Polygon")Os(Be,yt,X,J,ce,!0);else if(Ee==="MultiPolygon")for(const zt of Be){const Ot=[];Os(zt,Ot,X,J,ce,!0),Ot.length&&yt.push(Ot)}if(yt.length){if(De.lineMetrics&&Ee==="LineString"){for(const zt of yt)we.push(xt(ze.id,Ee,zt,ze.tags));continue}Ee!=="LineString"&&Ee!=="MultiLineString"||(yt.length===1?(Ee="LineString",yt=yt[0]):Ee="MultiLineString"),Ee!=="Point"&&Ee!=="MultiPoint"||(Ee=yt.length===3?"Point":"MultiPoint"),we.push(xt(ze.id,Ee,yt,ze.tags))}}return we.length?we:null}function Qi(Me,$,X,J,ce){for(let ve=0;ve<Me.length;ve+=3){const W=Me[ve+ce];W>=X&&W<=J&&An($,Me[ve],Me[ve+1],Me[ve+2])}}function zi(Me,$,X,J,ce,ve,W){let De=kr(Me);const we=ce===0?rc:cl;let ze,Be,Ee=Me.start;for(let Ot=0;Ot<Me.length-3;Ot+=3){const Dt=Me[Ot],Ve=Me[Ot+1],yi=Me[Ot+2],ui=Me[Ot+3],vi=Me[Ot+4],Vt=ce===0?Dt:Ve,Qe=ce===0?ui:vi;let Nt=!1;W&&(ze=Math.sqrt(Math.pow(Dt-ui,2)+Math.pow(Ve-vi,2))),Vt<X?Qe>X&&(Be=we(De,Dt,Ve,ui,vi,X),W&&(De.start=Ee+ze*Be)):Vt>J?Qe<J&&(Be=we(De,Dt,Ve,ui,vi,J),W&&(De.start=Ee+ze*Be)):An(De,Dt,Ve,yi),Qe<X&&Vt>=X&&(Be=we(De,Dt,Ve,ui,vi,X),Nt=!0),Qe>J&&Vt<=J&&(Be=we(De,Dt,Ve,ui,vi,J),Nt=!0),!ve&&Nt&&(W&&(De.end=Ee+ze*Be),$.push(De),De=kr(Me)),W&&(Ee+=ze)}let We=Me.length-3;const ft=Me[We],yt=Me[We+1],zt=ce===0?ft:yt;zt>=X&&zt<=J&&An(De,ft,yt,Me[We+2]),We=De.length-3,ve&&We>=3&&(De[We]!==De[0]||De[We+1]!==De[1])&&An(De,De[0],De[1],De[2]),De.length&&$.push(De)}function kr(Me){const $=[];return $.size=Me.size,$.start=Me.start,$.end=Me.end,$}function Os(Me,$,X,J,ce,ve){for(const W of Me)zi(W,$,X,J,ce,ve,!1)}function An(Me,$,X,J){Me.push($,X,J)}function rc(Me,$,X,J,ce,ve){const W=(ve-$)/(J-$);return An(Me,ve,X+(ce-X)*W,1),W}function cl(Me,$,X,J,ce,ve){const W=(ve-X)/(ce-X);return An(Me,$+(J-$)*W,ve,1),W}function Da(Me,$){const X=[];for(let J=0;J<Me.length;J++){const ce=Me[J],ve=ce.type;let W;if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")W=Va(ce.geometry,$);else if(ve==="MultiLineString"||ve==="Polygon"){W=[];for(const De of ce.geometry)W.push(Va(De,$))}else if(ve==="MultiPolygon"){W=[];for(const De of ce.geometry){const we=[];for(const ze of De)we.push(Va(ze,$));W.push(we)}}X.push(xt(ce.id,ve,W,ce.tags))}return X}function Va(Me,$){const X=[];X.size=Me.size,Me.start!==void 0&&(X.start=Me.start,X.end=Me.end);for(let J=0;J<Me.length;J+=3)X.push(Me[J]+$,Me[J+1],Me[J+2]);return X}function mo(Me,$){if(Me.transformed)return Me;const X=1<<Me.z,J=Me.x,ce=Me.y;for(const ve of Me.features){const W=ve.geometry,De=ve.type;if(ve.geometry=[],De===1)for(let we=0;we<W.length;we+=2)ve.geometry.push(Fs(W[we],W[we+1],$,X,J,ce));else for(let we=0;we<W.length;we++){const ze=[];for(let Be=0;Be<W[we].length;Be+=2)ze.push(Fs(W[we][Be],W[we][Be+1],$,X,J,ce));ve.geometry.push(ze)}}return Me.transformed=!0,Me}function Fs(Me,$,X,J,ce,ve){return[Math.round(X*(Me*J-ce)),Math.round(X*($*J-ve))]}function ss(Me,$,X,J,ce){const ve=$===ce.maxZoom?0:ce.tolerance/((1<<$)*ce.extent),W={features:[],numPoints:0,numSimplified:0,numFeatures:Me.length,source:null,x:X,y:J,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const De of Me)ul(W,De,ve,ce);return W}function ul(Me,$,X,J){const ce=$.geometry,ve=$.type,W=[];if(Me.minX=Math.min(Me.minX,$.minX),Me.minY=Math.min(Me.minY,$.minY),Me.maxX=Math.max(Me.maxX,$.maxX),Me.maxY=Math.max(Me.maxY,$.maxY),ve==="Point"||ve==="MultiPoint")for(let De=0;De<ce.length;De+=3)W.push(ce[De],ce[De+1]),Me.numPoints++,Me.numSimplified++;else if(ve==="LineString")Lr(W,ce,Me,X,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(let De=0;De<ce.length;De++)Lr(W,ce[De],Me,X,ve==="Polygon",De===0);else if(ve==="MultiPolygon")for(let De=0;De<ce.length;De++){const we=ce[De];for(let ze=0;ze<we.length;ze++)Lr(W,we[ze],Me,X,!0,ze===0)}if(W.length){let De=$.tags||null;if(ve==="LineString"&&J.lineMetrics){De={};for(const ze in $.tags)De[ze]=$.tags[ze];De.mapbox_clip_start=ce.start/ce.size,De.mapbox_clip_end=ce.end/ce.size}const we={geometry:W,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:De};$.id!==null&&(we.id=$.id),Me.features.push(we)}}function Lr(Me,$,X,J,ce,ve){const W=J*J;if(J>0&&$.size<(ce?W:J))return void(X.numPoints+=$.length/3);const De=[];for(let we=0;we<$.length;we+=3)(J===0||$[we+2]>W)&&(X.numSimplified++,De.push($[we],$[we+1])),X.numPoints++;ce&&function(we,ze){let Be=0;for(let Ee=0,We=we.length,ft=We-2;Ee<We;ft=Ee,Ee+=2)Be+=(we[Ee]-we[ft])*(we[Ee+1]+we[ft+1]);if(Be>0===ze)for(let Ee=0,We=we.length;Ee<We/2;Ee+=2){const ft=we[Ee],yt=we[Ee+1];we[Ee]=we[We-2-Ee],we[Ee+1]=we[We-1-Ee],we[We-2-Ee]=ft,we[We-1-Ee]=yt}}(De,ve),Me.push(De)}const $n={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class oa{constructor($,X){const J=(X=this.options=function(ve,W){for(const De in W)ve[De]=W[De];return ve}(Object.create($n),X)).debug;if(J&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");let ce=function(ve,W){const De=[];if(ve.type==="FeatureCollection")for(let we=0;we<ve.features.length;we++)Rt(De,ve.features[we],W,we);else Rt(De,ve.type==="Feature"?ve:{geometry:ve},W);return De}($,X);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ce=function(ve,W){const De=W.buffer/W.extent;let we=ve;const ze=sn(ve,1,-1-De,De,0,-1,2,W),Be=sn(ve,1,1-De,2+De,0,-1,2,W);return(ze||Be)&&(we=sn(ve,1,-De,1+De,0,-1,2,W)||[],ze&&(we=Da(ze,1).concat(we)),Be&&(we=we.concat(Da(Be,-1)))),we}(ce,X),ce.length&&this.splitTile(ce,0,0,0),J&&(ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile($,X,J,ce,ve,W,De){const we=[$,X,J,ce],ze=this.options,Be=ze.debug;for(;we.length;){ce=we.pop(),J=we.pop(),X=we.pop(),$=we.pop();const Ee=1<<X,We=zn(X,J,ce);let ft=this.tiles[We];if(!ft&&(Be>1&&console.time("creation"),ft=this.tiles[We]=ss($,X,J,ce,ze),this.tileCoords.push({z:X,x:J,y:ce}),Be)){Be>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,J,ce,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));const Nt=`z${X}`;this.stats[Nt]=(this.stats[Nt]||0)+1,this.total++}if(ft.source=$,ve==null){if(X===ze.indexMaxZoom||ft.numPoints<=ze.indexMaxPoints)continue}else{if(X===ze.maxZoom||X===ve)continue;if(ve!=null){const Nt=ve-X;if(J!==W>>Nt||ce!==De>>Nt)continue}}if(ft.source=null,$.length===0)continue;Be>1&&console.time("clipping");const yt=.5*ze.buffer/ze.extent,zt=.5-yt,Ot=.5+yt,Dt=1+yt;let Ve=null,yi=null,ui=null,vi=null,Vt=sn($,Ee,J-yt,J+Ot,0,ft.minX,ft.maxX,ze),Qe=sn($,Ee,J+zt,J+Dt,0,ft.minX,ft.maxX,ze);$=null,Vt&&(Ve=sn(Vt,Ee,ce-yt,ce+Ot,1,ft.minY,ft.maxY,ze),yi=sn(Vt,Ee,ce+zt,ce+Dt,1,ft.minY,ft.maxY,ze),Vt=null),Qe&&(ui=sn(Qe,Ee,ce-yt,ce+Ot,1,ft.minY,ft.maxY,ze),vi=sn(Qe,Ee,ce+zt,ce+Dt,1,ft.minY,ft.maxY,ze),Qe=null),Be>1&&console.timeEnd("clipping"),we.push(Ve||[],X+1,2*J,2*ce),we.push(yi||[],X+1,2*J,2*ce+1),we.push(ui||[],X+1,2*J+1,2*ce),we.push(vi||[],X+1,2*J+1,2*ce+1)}}getTile($,X,J){$=+$,X=+X,J=+J;const ce=this.options,{extent:ve,debug:W}=ce;if($<0||$>24)return null;const De=1<<$,we=zn($,X=X+De&De-1,J);if(this.tiles[we])return mo(this.tiles[we],ve);W>1&&console.log("drilling down to z%d-%d-%d",$,X,J);let ze,Be=$,Ee=X,We=J;for(;!ze&&Be>0;)Be--,Ee>>=1,We>>=1,ze=this.tiles[zn(Be,Ee,We)];return ze&&ze.source?(W>1&&(console.log("found parent tile z%d-%d-%d",Be,Ee,We),console.time("drilling down")),this.splitTile(ze.source,Be,Ee,We,$,X,J),W>1&&console.timeEnd("drilling down"),this.tiles[we]?mo(this.tiles[we],ve):null):null}}function zn(Me,$,X){return 32*((1<<Me)*X+$)+Me}function js(Me,$){return $?Me.properties[$]:Me.id}function hl(Me,$){if(Me==null)return!0;if(Me.type==="Feature")return js(Me,$)!=null;if(Me.type==="FeatureCollection"){const X=new Set;for(const J of Me.features){const ce=js(J,$);if(ce==null||X.has(ce))return!1;X.add(ce)}return!0}return!1}function sr(Me,$){const X=new Map;if(Me!=null)if(Me.type==="Feature")X.set(js(Me,$),Me);else for(const J of Me.features)X.set(js(J,$),J);return X}class ta extends Ne{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile($,X){return P._(this,void 0,void 0,function*(){const J=$.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ce=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!ce)return null;const ve=new Pt(ce.features);let W=li(ve);return W.byteOffset===0&&W.byteLength===W.buffer.byteLength||(W=new Uint8Array(W)),{vectorTile:ve,rawData:W.buffer}})}loadData($){return P._(this,void 0,void 0,function*(){var X;(X=this._pendingRequest)===null||X===void 0||X.abort();const J=!!($&&$.request&&$.request.collectResourceTiming)&&new P.cE($.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON($,this._pendingRequest),this._geoJSONIndex=$.cluster?new be(function({superclusterOptions:W,clusterProperties:De}){if(!De||!W)return W;const we={},ze={},Be={accumulated:null,zoom:0},Ee={properties:null},We=Object.keys(De);for(const ft of We){const[yt,zt]=De[ft],Ot=P.cL(zt),Dt=P.cL(typeof yt=="string"?[yt,["accumulated"],["get",ft]]:yt);we[ft]=Ot.value,ze[ft]=Dt.value}return W.map=ft=>{Ee.properties=ft;const yt={};for(const zt of We)yt[zt]=we[zt].evaluate(Be,Ee);return yt},W.reduce=(ft,yt)=>{Ee.properties=yt;for(const zt of We)Be.accumulated=ft[zt],ft[zt]=ze[zt].evaluate(Be,Ee)},W}($)).load((yield this._pendingData).features):(ce=yield this._pendingData,new oa(ce,$.geojsonVtOptions)),this.loaded={};const ve={};if(J){const W=J.finish();W&&(ve.resourceTiming={},ve.resourceTiming[$.source]=JSON.parse(JSON.stringify(W)))}return ve}catch(ve){if(delete this._pendingRequest,P.cp(ve))return{abandoned:!0};throw ve}var ce})}getData(){return P._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile($){const X=this.loaded;return X&&X[$.uid]?super.reloadTile($):this.loadTile($)}loadAndProcessGeoJSON($,X){return P._(this,void 0,void 0,function*(){let J=yield this.loadGeoJSON($,X);if(delete this._pendingRequest,typeof J!="object")throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(Tt(J,!0),$.filter){const ce=P.cL($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ce.result==="error")throw new Error(ce.value.map(W=>`${W.key}: ${W.message}`).join(", "));J={type:"FeatureCollection",features:J.features.filter(W=>ce.value.evaluate({zoom:0},W))}}return J})}loadGeoJSON($,X){return P._(this,void 0,void 0,function*(){const{promoteId:J}=$;if($.request){const ce=yield P.j($.request,X);return this._dataUpdateable=hl(ce.data,J)?sr(ce.data,J):void 0,ce.data}if(typeof $.data=="string")try{const ce=JSON.parse($.data);return this._dataUpdateable=hl(ce,J)?sr(ce,J):void 0,ce}catch{throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`)}if(!$.dataDiff)throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${$.source}`);return function(ce,ve,W){var De,we,ze,Be;if(ve.removeAll&&ce.clear(),ve.remove)for(const Ee of ve.remove)ce.delete(Ee);if(ve.add)for(const Ee of ve.add){const We=js(Ee,W);We!=null&&ce.set(We,Ee)}if(ve.update)for(const Ee of ve.update){let We=ce.get(Ee.id);if(We==null)continue;const ft=!Ee.removeAllProperties&&(((De=Ee.removeProperties)===null||De===void 0?void 0:De.length)>0||((we=Ee.addOrUpdateProperties)===null||we===void 0?void 0:we.length)>0);if((Ee.newGeometry||Ee.removeAllProperties||ft)&&(We=Object.assign({},We),ce.set(Ee.id,We),ft&&(We.properties=Object.assign({},We.properties))),Ee.newGeometry&&(We.geometry=Ee.newGeometry),Ee.removeAllProperties)We.properties={};else if(((ze=Ee.removeProperties)===null||ze===void 0?void 0:ze.length)>0)for(const yt of Ee.removeProperties)Object.prototype.hasOwnProperty.call(We.properties,yt)&&delete We.properties[yt];if(((Be=Ee.addOrUpdateProperties)===null||Be===void 0?void 0:Be.length)>0)for(const{key:yt,value:zt}of Ee.addOrUpdateProperties)We.properties[yt]=zt}}(this._dataUpdateable,$.dataDiff,J),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource($){return P._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom($){return this._geoJSONIndex.getClusterExpansionZoom($.clusterId)}getClusterChildren($){return this._geoJSONIndex.getChildren($.clusterId)}getClusterLeaves($){return this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset)}}class Za{constructor($){this.self=$,this.actor=new P.H($),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(X,J)=>{if(this.externalWorkerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.externalWorkerSourceTypes[X]=J},this.self.addProtocol=P.cr,this.self.removeProtocol=P.cs,this.self.registerRTLTextPlugin=X=>{P.cM.setMethods(X)},this.actor.registerMessageHandler("LDT",(X,J)=>this._getDEMWorkerSource(X,J.source).loadTile(J)),this.actor.registerMessageHandler("RDT",(X,J)=>P._(this,void 0,void 0,function*(){this._getDEMWorkerSource(X,J.source).removeTile(J)})),this.actor.registerMessageHandler("GCEZ",(X,J)=>P._(this,void 0,void 0,function*(){return this._getWorkerSource(X,J.type,J.source).getClusterExpansionZoom(J)})),this.actor.registerMessageHandler("GCC",(X,J)=>P._(this,void 0,void 0,function*(){return this._getWorkerSource(X,J.type,J.source).getClusterChildren(J)})),this.actor.registerMessageHandler("GCL",(X,J)=>P._(this,void 0,void 0,function*(){return this._getWorkerSource(X,J.type,J.source).getClusterLeaves(J)})),this.actor.registerMessageHandler("LD",(X,J)=>this._getWorkerSource(X,J.type,J.source).loadData(J)),this.actor.registerMessageHandler("GD",(X,J)=>this._getWorkerSource(X,J.type,J.source).getData()),this.actor.registerMessageHandler("LT",(X,J)=>this._getWorkerSource(X,J.type,J.source).loadTile(J)),this.actor.registerMessageHandler("RT",(X,J)=>this._getWorkerSource(X,J.type,J.source).reloadTile(J)),this.actor.registerMessageHandler("AT",(X,J)=>this._getWorkerSource(X,J.type,J.source).abortTile(J)),this.actor.registerMessageHandler("RMT",(X,J)=>this._getWorkerSource(X,J.type,J.source).removeTile(J)),this.actor.registerMessageHandler("RS",(X,J)=>P._(this,void 0,void 0,function*(){if(!this.workerSources[X]||!this.workerSources[X][J.type]||!this.workerSources[X][J.type][J.source])return;const ce=this.workerSources[X][J.type][J.source];delete this.workerSources[X][J.type][J.source],ce.removeSource!==void 0&&ce.removeSource(J)})),this.actor.registerMessageHandler("RM",X=>P._(this,void 0,void 0,function*(){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X]})),this.actor.registerMessageHandler("SR",(X,J)=>P._(this,void 0,void 0,function*(){this.referrer=J})),this.actor.registerMessageHandler("SRPS",(X,J)=>this._syncRTLPluginState(X,J)),this.actor.registerMessageHandler("IS",(X,J)=>P._(this,void 0,void 0,function*(){this.self.importScripts(J)})),this.actor.registerMessageHandler("SI",(X,J)=>this._setImages(X,J)),this.actor.registerMessageHandler("UL",(X,J)=>P._(this,void 0,void 0,function*(){this._getLayerIndex(X).update(J.layers,J.removedIds)})),this.actor.registerMessageHandler("SL",(X,J)=>P._(this,void 0,void 0,function*(){this._getLayerIndex(X).replace(J)}))}_setImages($,X){return P._(this,void 0,void 0,function*(){this.availableImages[$]=X;for(const J in this.workerSources[$]){const ce=this.workerSources[$][J];for(const ve in ce)ce[ve].availableImages=X}})}_syncRTLPluginState($,X){return P._(this,void 0,void 0,function*(){return yield P.cM.syncState(X,this.self.importScripts)})}_getAvailableImages($){let X=this.availableImages[$];return X||(X=[]),X}_getLayerIndex($){let X=this.layerIndexes[$];return X||(X=this.layerIndexes[$]=new d),X}_getWorkerSource($,X,J){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][X]||(this.workerSources[$][X]={}),!this.workerSources[$][X][J]){const ce={sendAsync:(ve,W)=>(ve.targetMapId=$,this.actor.sendAsync(ve,W))};switch(X){case"vector":this.workerSources[$][X][J]=new Ne(ce,this._getLayerIndex($),this._getAvailableImages($));break;case"geojson":this.workerSources[$][X][J]=new ta(ce,this._getLayerIndex($),this._getAvailableImages($));break;default:this.workerSources[$][X][J]=new this.externalWorkerSourceTypes[X](ce,this._getLayerIndex($),this._getAvailableImages($))}}return this.workerSources[$][X][J]}_getDEMWorkerSource($,X){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][X]||(this.demWorkerSources[$][X]=new Se),this.demWorkerSources[$][X]}}return P.i(self)&&(self.worker=new Za(self)),Za}),H("index",["exports","./shared"],function(P,d){var ge="5.5.0";function re(){var f=new d.A(4);return d.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let Ce,Ne;const Se={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,n){const l=requestAnimationFrame(m=>{u(),e(m)}),{unsubscribe:u}=d.s(f.signal,"abort",()=>{u(),cancelAnimationFrame(l),n(d.c())},!1)},frameAsync(f){return new Promise((e,n)=>{this.frame(f,e,n)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,n.drawImage(f,0,0,f.width,f.height),n},resolveURL:f=>(Ce||(Ce=document.createElement("a")),Ce.href=f,Ce.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ne==null&&(Ne=matchMedia("(prefers-reduced-motion: reduce)")),Ne.matches)}};class pe{static testProp(e){if(!pe.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in pe.docStyle)return e[n];return e[0]}static create(e,n,l){const u=window.document.createElement(e);return n!==void 0&&(u.className=n),l&&l.appendChild(u),u}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){pe.docStyle&&pe.selectProp&&(pe.userSelect=pe.docStyle[pe.selectProp],pe.docStyle[pe.selectProp]="none")}static enableDrag(){pe.docStyle&&pe.selectProp&&(pe.docStyle[pe.selectProp]=pe.userSelect)}static setTransform(e,n){e.style[pe.transformProp]=n}static addEventListener(e,n,l,u={}){e.addEventListener(n,l,"passive"in u?u:u.capture)}static removeEventListener(e,n,l,u={}){e.removeEventListener(n,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",pe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",pe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",pe.suppressClickInternal,!0)},0)}static getScale(e){const n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,l){const u=n.boundingClientRect;return new d.P((l.clientX-u.left)/n.x-e.clientLeft,(l.clientY-u.top)/n.y-e.clientTop)}static mousePos(e,n){const l=pe.getScale(e);return pe.getPoint(e,l,n)}static touchPos(e,n){const l=[],u=pe.getScale(e);for(let m=0;m<n.length;m++)l.push(pe.getPoint(e,u,n[m]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=n.querySelectorAll("script");for(const u of l)u.remove();return pe.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){const l=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const n=e.children;for(const l of n)pe.removeAttributes(l),pe.clean(l)}static removeAttributes(e){for(const{name:n,value:l}of e.attributes)pe.isPossiblyDangerous(n,l)&&e.removeAttribute(n)}}pe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,pe.selectProp=pe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),pe.transformProp=pe.testProp(["transform","WebkitTransform"]);const Pe={supported:!1,testSupport:function(f){!pt&&Tt&&(St?Pt(f):ht=f)}};let ht,Tt,pt=!1,St=!1;function Pt(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Tt),f.isContextLost())return;Pe.supported=!0}catch{}f.deleteTexture(e),pt=!0}var qt;typeof document<"u"&&(Tt=document.createElement("img"),Tt.onload=()=>{ht&&Pt(ht),ht=null,St=!0},Tt.onerror=()=>{pt=!0,ht=null},Tt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,n,l,u;f.resetRequestQueue=()=>{e=[],n=0,l=0,u={}},f.addThrottleControl=T=>{const C=l++;return u[C]=T,C},f.removeThrottleControl=T=>{delete u[T],y()},f.getImage=(T,C,z=!0)=>new Promise((B,k)=>{Pe.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),d.e(T,{type:"image"}),e.push({abortController:C,requestParameters:T,supportImageRefresh:z,state:"queued",onError:Z=>{k(Z)},onSuccess:Z=>{B(Z)}}),y()});const m=T=>d._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:C,supportImageRefresh:z,onError:B,onSuccess:k,abortController:Z}=T,G=z===!1&&!d.i(self)&&!d.g(C.url)&&(!C.headers||Object.keys(C.headers).reduce((ie,oe)=>ie&&oe==="accept",!0));n++;const te=G?b(C,Z):d.m(C,Z);try{const ie=yield te;delete T.abortController,T.state="completed",ie.data instanceof HTMLImageElement||d.b(ie.data)?k(ie):ie.data&&k({data:yield(ee=ie.data,typeof createImageBitmap=="function"?d.f(ee):d.h(ee)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete T.abortController,B(ie)}finally{n--,y()}var ee}),y=()=>{const T=(()=>{for(const C of Object.keys(u))if(u[C]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=n;C<T&&e.length>0;C++){const z=e.shift();z.abortController.signal.aborted?C--:m(z)}},b=(T,C)=>new Promise((z,B)=>{const k=new Image,Z=T.url,G=T.credentials;G&&G==="include"?k.crossOrigin="use-credentials":(G&&G==="same-origin"||!d.d(Z))&&(k.crossOrigin="anonymous"),C.signal.addEventListener("abort",()=>{k.src="",B(d.c())}),k.fetchPriority="high",k.onload=()=>{k.onerror=k.onload=null,z({data:k})},k.onerror=()=>{k.onerror=k.onload=null,C.signal.aborted||B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},k.src=Z})}(qt||(qt={})),qt.resetRequestQueue();class bt{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Zt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const n=[];for(const{id:l,url:u}of f){const m=`${l}${u}`;n.indexOf(m)===-1&&(n.push(m),e.push({id:l,url:u}))}}return e}function di(f,e,n){try{const l=new URL(f);return l.pathname+=`${e}${n}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class Xt{constructor(e,n,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,l){const{width:u,height:m}=e,y=!(this.size&&this.size[0]===u&&this.size[1]===m||l),{context:b}=this,{gl:T}=b;if(this.useMipmap=!!(n&&n.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!n||n.premultiply!==!1)),y)this.size=[u,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,u,m,0,this.format,T.UNSIGNED_BYTE,e.data);else{const{x:C,y:z}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?T.texSubImage2D(T.TEXTURE_2D,0,C,z,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,C,z,u,m,T.RGBA,T.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D),b.pixelStoreUnpackFlipY.setDefault(),b.pixelStoreUnpack.setDefault(),b.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,l){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),l!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,l||e),this.filter=e),n!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function li(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class ni extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:n,promiseResolve:l}of this.requestors)l(this._getImagesForIds(n));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const l=n.spriteData;n.data=new d.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let l=!0;const u=n.data||n.spriteData;return this._validateStretch(n.stretchX,u&&u.width)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(n.stretchY,u&&u.height)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(n.content,n)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,n){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||n<u[1])return!1;l=u[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;const l=n.spriteData,u=l&&l.width||n.data.width,m=l&&l.height||n.data.height;return!(e[0]<0||u<e[0]||e[1]<0||m<e[1]||e[2]<0||u<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==n.data.width||u.data.height!==n.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=u.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){const n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,l)=>{let u=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(u=!1);this.isLoaded()||u?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){const n={};for(const l of e){let u=this.getImage(l);u||(this.fire(new d.l("styleimagemissing",{id:l})),u=this.getImage(l)),u?n[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:d.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){const n=this.patterns[e],l=this.getImage(e);if(!l)return null;if(n&&n.position.version===l.version)return n.position;if(n)n.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},m=new d.I(u,l);this.patterns[e]={bin:u,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Xt(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:n,h:l}=d.p(e),u=this.atlasImage;u.resize({width:n||1,height:l||1});for(const m in this.patterns){const{bin:y}=this.patterns[m],b=y.x+1,T=y.y+1,C=this.getImage(m).data,z=C.width,B=C.height;d.R.copy(C,u,{x:0,y:0},{x:b,y:T},{width:z,height:B}),d.R.copy(C,u,{x:0,y:B-1},{x:b,y:T-1},{width:z,height:1}),d.R.copy(C,u,{x:0,y:0},{x:b,y:T+B},{width:z,height:1}),d.R.copy(C,u,{x:z-1,y:0},{x:b-1,y:T},{width:1,height:B}),d.R.copy(C,u,{x:0,y:0},{x:b+z,y:T},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const l=this.getImage(n);l||d.w(`Image with ID: "${n}" was not found`),li(l)&&this.updateImage(n,l)}}}const Bt=1e20;function wi(f,e,n,l,u,m,y,b,T){for(let C=e;C<e+l;C++)_n(f,n*m+C,m,u,y,b,T);for(let C=n;C<n+u;C++)_n(f,C*m+e,1,l,y,b,T)}function _n(f,e,n,l,u,m,y){m[0]=0,y[0]=-1e20,y[1]=Bt,u[0]=f[e];for(let b=1,T=0,C=0;b<l;b++){u[b]=f[e+b*n];const z=b*b;do{const B=m[T];C=(u[b]-u[B]+z-B*B)/(b-B)/2}while(C<=y[T]&&--T>-1);T++,m[T]=b,y[T]=C,y[T+1]=Bt}for(let b=0,T=0;b<l;b++){for(;y[T+1]<b;)T++;const C=m[T],z=b-C;f[e+b*n]=u[C]+z*z}}class Ct{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return d._(this,void 0,void 0,function*(){const n=[];for(const m in e)for(const y of e[m])n.push(this._getAndCacheGlyphsPromise(m,y));const l=yield Promise.all(n),u={};for(const{stack:m,id:y,glyph:b}of l)u[m]||(u[m]={}),u[m][y]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics};return u})}_getAndCacheGlyphsPromise(e,n){return d._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[n];if(u!==void 0)return{stack:e,id:n,glyph:u};if(u=this._tinySDF(l,e,n),u)return l.glyphs[n]=u,{stack:e,id:n,glyph:u};const m=Math.floor(n/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[m])return{stack:e,id:n,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[m]){const b=Ct.loadGlyphRange(e,m,this.url,this.requestManager);l.requests[m]=b}const y=yield l.requests[m];for(const b in y)this._doesCharSupportLocalGlyph(+b)||(l.glyphs[+b]=y[+b]);return l.ranges[m]=!0,{stack:e,id:n,glyph:y[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||d.u["CJK Unified Ideographs"](e)||d.u["Hangul Syllables"](e)||d.u.Hiragana(e)||d.u.Katakana(e)||d.u["CJK Symbols and Punctuation"](e)||d.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,n,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let m=e.tinySDF;if(!m){let b="400";/bold/i.test(n)?b="900":/medium/i.test(n)?b="500":/light/i.test(n)&&(b="200"),m=e.tinySDF=new Ct.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:b})}const y=m.draw(String.fromCharCode(l));return{id:l,bitmap:new d.q({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ct.loadGlyphRange=function(f,e,n,l){return d._(this,void 0,void 0,function*(){const u=256*e,m=u+255,y=l.transformRequest(n.replace("{fontstack}",f).replace("{range}",`${u}-${m}`),"Glyphs"),b=yield d.n(y,new AbortController);if(!b||!b.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${m}`);const T={};for(const C of d.o(b.data))T[C.id]=C;return T})},Ct.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:n=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=n;const b=this.size=f+4*e,T=this._createCanvas(b),C=this.ctx=T.getContext("2d",{willReadFrequently:!0});C.font=`${y} ${m} ${f}px ${u}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:m}=this.ctx.measureText(f),y=Math.ceil(n),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-u))),T=Math.min(this.size-this.buffer,y+Math.ceil(l)),C=b+2*this.buffer,z=T+2*this.buffer,B=Math.max(C*z,0),k=new Uint8ClampedArray(B),Z={data:k,width:C,height:z,glyphWidth:b,glyphHeight:T,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(b===0||T===0)return Z;const{ctx:G,buffer:te,gridInner:ee,gridOuter:ie}=this;G.clearRect(te,te,b,T),G.fillText(f,te,te+y);const oe=G.getImageData(te,te,b,T);ie.fill(Bt,0,B),ee.fill(0,0,B);for(let de=0;de<T;de++)for(let he=0;he<b;he++){const me=oe.data[4*(de*b+he)+3]/255;if(me===0)continue;const xe=(de+te)*C+he+te;if(me===1)ie[xe]=0,ee[xe]=Bt;else{const _e=.5-me;ie[xe]=_e>0?_e*_e:0,ee[xe]=_e<0?_e*_e:0}}wi(ie,0,0,C,z,C,this.f,this.v,this.z),wi(ee,te,te,b,T,C,this.f,this.v,this.z);for(let de=0;de<B;de++){const he=Math.sqrt(ie[de])-Math.sqrt(ee[de]);k[de]=Math.round(255-255*(he/this.radius+this.cutoff))}return Z}};class mt{constructor(){this.specification=d.v.light.position}possiblyEvaluate(e,n){return d.z(e.expression.evaluate(n))}interpolate(e,n,l){return{x:d.B.number(e.x,n.x,l),y:d.B.number(e.y,n.y,l),z:d.B.number(e.z,n.z,l)}}}let be;class Ke extends d.E{constructor(e){super(),be=be||new d.r({anchor:new d.D(d.v.light.anchor),position:new mt,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(be),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(d.t,e,n))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,l){return(!l||l.validate!==!1)&&d.x(this,e.call(d.y,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const Ge=new d.r({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class _t extends d.E{constructor(e){super(),this._transitionable=new d.T(Ge),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.C(0))}setSky(e,n={}){if(!this._validate(d.F,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,l={}){return(l==null?void 0:l.validate)!==!1&&d.x(this,e.call(d.y,d.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class le{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){const l=e.join(",")+String(n);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,n)),this.dashEntry[l]}getDashRanges(e,n,l){const u=[];let m=e.length%2==1?-e[e.length-1]*l:0,y=e[0]*l,b=!0;u.push({left:m,right:y,isDash:b,zeroLength:e[0]===0});let T=e[0];for(let C=1;C<e.length;C++){b=!b;const z=e[C];m=T*l,T+=z,y=T*l,u.push({left:m,right:y,isDash:b,zeroLength:z===0})}return u}addRoundDash(e,n,l){const u=n/2;for(let m=-l;m<=l;m++){const y=this.width*(this.nextRow+l+m);let b=0,T=e[b];for(let C=0;C<this.width;C++){C/T.right>1&&(T=e[++b]);const z=Math.abs(C-T.left),B=Math.abs(C-T.right),k=Math.min(z,B);let Z;const G=m/l*(u+1);if(T.isDash){const te=u-Math.abs(G);Z=Math.sqrt(k*k+te*te)}else Z=u-Math.sqrt(k*k+G*G);this.data[y+C]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(e){for(let b=e.length-1;b>=0;--b){const T=e[b],C=e[b+1];T.zeroLength?e.splice(b,1):C&&C.isDash===T.isDash&&(C.left=T.left,e.splice(b,1))}const n=e[0],l=e[e.length-1];n.isDash===l.isDash&&(n.left=l.left-this.width,l.right=n.right+this.width);const u=this.width*this.nextRow;let m=0,y=e[m];for(let b=0;b<this.width;b++){b/y.right>1&&(y=e[++m]);const T=Math.abs(b-y.left),C=Math.abs(b-y.right),z=Math.min(T,C);this.data[u+b]=Math.max(0,Math.min(255,(y.isDash?z:-z)+128))}}addDash(e,n){const l=n?7:0,u=2*l+1;if(this.nextRow+u>this.height)return d.w("LineAtlas out of space"),null;let m=0;for(let b=0;b<e.length;b++)m+=e[b];if(m!==0){const b=this.width/m,T=this.getDashRanges(e,this.width,b);n?this.addRoundDash(T,b,l):this.addRegularDash(T)}const y={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:m};return this.nextRow+=u,this.dirty=!0,y}bind(e){const n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const Ye="maplibre_preloaded_worker_pool";class ot{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<ot.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ye]}numActive(){return Object.keys(this.active).length}}const ct=Math.floor(Se.hardwareConcurrency/2);let xt,At;function Rt(){return xt||(xt=new ot),xt}ot.workerCount=d.G(globalThis)?Math.max(Math.min(ct,3),1):1;class fi{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const l=this.workerPool.acquire(n);for(let u=0;u<l.length;u++){const m=new d.H(l[u],n);m.name=`Worker ${u}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:n}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(const l of this.actors)l.registerMessageHandler(e,n)}}function ci(){return At||(At=new fi(Rt(),d.J),At.registerMessageHandler("GR",(f,e,n)=>d.m(e,n))),At}function Ki(f,e){const n=d.K();return d.L(n,n,[1,1,0]),d.M(n,n,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?d.N(n,n,f.calculatePosMatrix(e.toUnwrapped())):n}function rn(f,e,n,l,u,m,y){var b;const T=function(k,Z,G){if(k)for(const te of k){const ee=Z[te];if(ee&&ee.source===G&&ee.type==="fill-extrusion")return!0}else for(const te in Z){const ee=Z[te];if(ee.source===G&&ee.type==="fill-extrusion")return!0}return!1}((b=u==null?void 0:u.layers)!==null&&b!==void 0?b:null,e,f.id),C=m.maxPitchScaleFactor(),z=f.tilesIn(l,C,T);z.sort(Ii);const B=[];for(const k of z)B.push({wrappedTileID:k.tileID.wrapped().key,queryResults:k.tile.queryRenderedFeatures(e,n,f._state,k.queryGeometry,k.cameraQueryGeometry,k.scale,u,m,C,Ki(f.transform,k.tileID),y?(Z,G)=>y(k.tileID,Z,G):void 0)});return function(k,Z){for(const G in k)for(const te of k[G])sn(te,Z);return k}(function(k){const Z={},G={};for(const te of k){const ee=te.queryResults,ie=te.wrappedTileID,oe=G[ie]=G[ie]||{};for(const de in ee){const he=ee[de],me=oe[de]=oe[de]||{},xe=Z[de]=Z[de]||[];for(const _e of he)me[_e.featureIndex]||(me[_e.featureIndex]=!0,xe.push(_e))}}return Z}(B),f)}function Ii(f,e){const n=f.tileID,l=e.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}function sn(f,e){const n=f.feature,l=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=l}function Qi(f,e,n){return d._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield d.j(e.transformRequest(f.url,"Source"),n)).data:yield Se.frameAsync(n),!l)return null;const u=d.O(d.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(m=>m.id)),u})}class zi{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof d.Q?new d.Q(e.lng,e.lat):d.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof d.Q?new d.Q(e.lng,e.lat):d.Q.convert(e),this}extend(e){const n=this._sw,l=this._ne;let u,m;if(e instanceof d.Q)u=e,m=e;else{if(!(e instanceof zi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(zi.convert(e)):this.extend(d.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(d.Q.convert(e)):this;if(u=e._sw,m=e._ne,!u||!m)return this}return n||l?(n.lng=Math.min(u.lng,n.lng),n.lat=Math.min(u.lat,n.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new d.Q(u.lng,u.lat),this._ne=new d.Q(m.lng,m.lat)),this}getCenter(){return new d.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.Q(this.getWest(),this.getNorth())}getSouthEast(){return new d.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:l}=d.Q.convert(e);let u=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof zi?e:e&&new zi(e)}static fromLngLat(e,n=0){const l=360*n/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new zi(new d.Q(e.lng-u,e.lat-l),new d.Q(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new d.Q(this._sw.lng,this._sw.lat),n=new d.Q(this._ne.lng,this._ne.lat);return new zi(e,e.lng>n.lng?new d.Q(n.lng+360,n.lat):n)}}class kr{constructor(e,n,l){this.bounds=zi.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),l=Math.floor(d.U(this.bounds.getWest())*n),u=Math.floor(d.S(this.bounds.getNorth())*n),m=Math.ceil(d.U(this.bounds.getEast())*n),y=Math.ceil(d.S(this.bounds.getSouth())*n);return e.x>=l&&e.x<m&&e.y>=u&&e.y<y}}class Os extends d.E{constructor(e,n,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.O(n,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Qi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(d.e(this,e),e.bounds&&(this.tileBounds=new kr(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,y)=>{e.reloadPromise={resolve:m,reject:y}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class An extends d.E{constructor(e,n,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},n),d.e(this,d.O(n,["url","scheme","tileSize"]))}load(){return d._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Qi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(d.e(this,n),n.bounds&&(this.tileBounds=new kr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new d.k(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return d.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield qt.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,m=u.gl,y=l.data;e.texture=this.map.painter.getTileTexture(y.width),e.texture?e.texture.update(y,{useMipmap:!0}):(e.texture=new Xt(u,y,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class rc extends An{constructor(e,n,l,u){super(e,n,l,u),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield qt.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const m=u.data;this.map._refreshExpiredTiles&&(u.cacheControl||u.expires)&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const y=d.b(m)&&d.V()?m:yield this.readImageNow(m),b={type:this.type,uid:e.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const T=yield e.actor.sendAsync({type:"LDT",data:b});e.dem=T,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return d._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&d.W()){const n=e.width+2,l=e.height+2;try{return new d.R({width:n,height:l},yield d.X(e,-1,-1,n,l))}catch{}}return Se.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,l=Math.pow(2,n.z),u=(n.x-1+l)%l,m=n.x===0?e.wrap-1:e.wrap,y=(n.x+1+l)%l,b=n.x+1===l?e.wrap+1:e.wrap,T={};return T[new d.Y(e.overscaledZ,m,n.z,u,n.y).key]={backfilled:!1},T[new d.Y(e.overscaledZ,b,n.z,y,n.y).key]={backfilled:!1},n.y>0&&(T[new d.Y(e.overscaledZ,m,n.z,u,n.y-1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,b,n.z,y,n.y-1).key]={backfilled:!1}),n.y+1<l&&(T[new d.Y(e.overscaledZ,m,n.z,u,n.y+1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,b,n.z,y,n.y+1).key]={backfilled:!1}),T}unloadTile(e){return d._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class cl extends d.E{constructor(e,n,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=n.data,this._options=d.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:d.Z,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:d.Z,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(d.Z/this.tileSize)}load(){return d._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return d._(this,void 0,void 0,function*(){const e=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(n=>n.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return d._(this,void 0,void 0,function*(){const e=new zi,n=yield this.getData();let l;switch(n.type){case"FeatureCollection":l=n.features.map(u=>this.getCoordinatesFromGeometry(u.geometry)).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(n.geometry);break;default:l=this.getCoordinatesFromGeometry(n)}if(l.length==0)return e;for(let u=0;u<l.length-1;u+=2)e.extend([l[u],l[u+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:l}})}_updateWorkerData(e){return d._(this,void 0,void 0,function*(){const n=d.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(Se.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new d.l("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&d.e(m,{resourceTiming:u}),this.fire(new d.l("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new d.l("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new d.l("dataabort",{dataType:"source"}));this.fire(new d.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:n,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,n==="RT")})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Da extends d.E{constructor(e,n,l,u){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=n}load(e){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield qt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new d.k(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(d.$.fromLngLat);var l;return this.tileID=function(u){let m=1/0,y=1/0,b=-1/0,T=-1/0;for(const k of u)m=Math.min(m,k.x),y=Math.min(y,k.y),b=Math.max(b,k.x),T=Math.max(T,k.y);const C=Math.max(b-m,T-y),z=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),B=Math.pow(2,z);return new d.a1(z,Math.floor((m+b)/2*B),Math.floor((y+T)/2*B))}(n),this.terrainTileRanges=this._getOverlappingTileRanges(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(u=>this.tileID.getTilePoint(u)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new d.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new Xt(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const m=this.tiles[u];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return d._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let n=1/0,l=1/0,u=-1/0,m=-1/0;for(const b of e)n=Math.min(n,b.x),l=Math.min(l,b.y),u=Math.max(u,b.x),m=Math.max(m,b.y);const y={};for(let b=0;b<=d.a0;b++){const T=Math.pow(2,b),C=Math.floor(n*T),z=Math.floor(l*T),B=Math.floor(u*T),k=Math.floor(m*T);y[b]={minTileX:C,minTileY:z,maxTileX:B,maxTileY:k}}return y}}class Va extends Da{constructor(e,n,l,u){super(e,n,l,u),this.roundZoom=!0,this.type="video",this.options=n}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield d.a2(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new d.k(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new d.k(new d.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new Xt(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const m=this.tiles[u];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class mo extends Da{constructor(e,n,l,u){super(e,n,l,u),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(y=>typeof y!="number"))||this.fire(new d.k(new d.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.k(new d.a3(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new d.k(new d.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new d.k(new d.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.k(new d.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return d._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,l=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Xt(n,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const m in this.tiles){const y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Fs={},ss=f=>{switch(f){case"geojson":return cl;case"image":return Da;case"raster":return An;case"raster-dem":return rc;case"vector":return Os;case"video":return Va;case"canvas":return mo}return Fs[f]},ul="RTLPluginLoaded";class Lr extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ci()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return d._(this,arguments,void 0,function*(n,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Se.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return d._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.l(ul))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let $n=null;function oa(){return $n||($n=new Lr),$n}class zn{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=d.a4(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,m){const y={};if(!m)return y;for(const b of u){const T=b.layerIds.map(C=>m.getLayer(C)).filter(Boolean);if(T.length!==0){b.layers=T,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(C=>T.filter(z=>z.id===C)[0]));for(const C of T)y[C.id]=b}}return y}(e.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const m=this.buckets[u];if(m instanceof d.a6){if(this.hasSymbolBuckets=!0,!l)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const m=this.buckets[u];if(m instanceof d.a6&&m.hasRTLText){this.hasRTLText=!0,oa().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const m=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(u).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xt(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xt(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,l,u,m,y,b,T,C,z,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:m,scale:y,tileSize:this.tileSize,pixelPosMatrix:z,transform:T,params:b,queryPadding:this.queryPadding*C,getElevation:B},e,n,l):{}}querySourceFeatures(e,n){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),m=n&&n.sourceLayer?n.sourceLayer:"",y=u._geojsonTileLayer||u[m];if(!y)return;const b=d.a7(n&&n.filter),{z:T,x:C,y:z}=this.tileID.canonical,B={z:T,x:C,y:z};for(let k=0;k<y.length;k++){const Z=y.feature(k);if(b.needGeometry){const ee=d.a8(Z,!0);if(!b.filter(new d.C(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!b.filter(new d.C(this.tileID.overscaledZ),Z))continue;const G=l.getId(Z,m),te=new d.a9(Z,T,C,z,G);te.tile=B,e.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const l=d.aa(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(n)if(this.expirationTime<n)u=!0;else{const m=this.expirationTime-n;m?this.expirationTime=l+Math.max(m,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!n.style.hasLayer(u))continue;const m=this.buckets[u],y=m.layers[0].sourceLayer||"_geojsonTileLayer",b=l[y],T=e[y];if(!b||!T||Object.keys(T).length===0)continue;m.update(T,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=n&&n.style&&n.style.getLayer(u);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Se.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Se.now()+e}setDependencies(e,n){const l={};for(const u of n)l[u]=!0;this.dependencies[e]=l}hasDependency(e,n){for(const l of e){const u=this.dependencies[l];if(u){for(const m of n)if(u[m])return!0}}return!1}}class js{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const m={value:n,timeout:void 0};if(l!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},l)),this.data[u].push(m),this.order.push(u),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const l=e.wrapped().key,u=n===void 0?0:this.data[l].indexOf(n),m=this.data[l][u];return this.data[l].splice(u,1),m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(m.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||n.push(u);for(const l of n)this.remove(l.value.tileID,l)}}class hl{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,l){const u=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},d.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==u&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const m in this.state[e][u])l[m]||(this.deletedStates[e][u][m]=null)}else for(const m in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][m]===null&&delete this.deletedStates[e][u][m]}removeFeatureState(e,n,l){if(this.deletedStates[e]===null)return;const u=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&n!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,n){const l=String(n),u=d.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][n];if(m===null)return{};for(const y in m)delete u[y]}return u}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const m={};for(const y in this.stateChanges[u])this.state[u][y]||(this.state[u][y]={}),d.e(this.state[u][y],this.stateChanges[u][y]),m[y]=this.state[u][y];l[u]=m}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const m={};if(this.deletedStates[u]===null)for(const y in this.state[u])m[y]={},this.state[u][y]={};else for(const y in this.deletedStates[u]){if(this.deletedStates[u][y]===null)this.state[u][y]={};else for(const b of Object.keys(this.deletedStates[u][y]))delete this.state[u][y][b];m[y]=this.state[u][y]}l[u]=l[u]||{},d.e(l[u],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,n)}}const sr=89.25;function ta(f,e){const n=d.ae(e.lat,-85.051129,d.af);return new d.P(d.U(e.lng)*f,d.S(n)*f)}function Za(f,e){return new d.$(e.x/f,e.y/f).toLngLat()}function Me(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(d.ab(90-f.pitch)),Math.tan(d.ab(sr-f.pitch)))}function $(f,e){const n=f.canonical,l=e/d.ac(n.z),u=n.x+Math.pow(2,n.z)*f.wrap,m=d.ad(new Float64Array(16));return d.L(m,m,[u*l,n.y*l,0]),d.M(m,m,[l/d.Z,l/d.Z,1]),m}function X(f,e,n,l,u){const m=d.$.fromLngLat(f,e),y=u*d.ag(1,f.lat),b=y*Math.cos(d.ab(n)),T=Math.sqrt(y*y-b*b),C=T*Math.sin(d.ab(-l)),z=T*Math.cos(d.ab(-l));return new d.$(m.x+C,m.y+z,m.z+b)}function J(f,e,n){const l=e.intersectsFrustum(f);if(!n)return l;const u=e.intersectsPlane(n);return l===0||u===0?0:l===2&&u===2?2:1}function ce(f,e,n){let l=0;const u=(n-e)/10;for(let m=0;m<10;m++)l+=u*Math.pow(Math.cos(e+(m+.5)/10*(n-e)),f);return l}function ve(f,e){return function(n,l,u,m,y){const b=2*((f-1)/d.ah(Math.cos(d.ab(sr-y))/Math.cos(d.ab(sr)))-1),T=Math.acos(u/m),C=2*ce(b-1,0,d.ab(y/2)),z=Math.min(d.ab(sr),T+d.ab(y/2)),B=ce(b-1,Math.min(z,T-d.ab(y/2)),z),k=Math.atan(l/u),Z=Math.hypot(l,u);let G=n;return G+=d.ah(m/Z/Math.max(.5,Math.cos(d.ab(y/2)))),G+=b*d.ah(Math.cos(k))/2,G-=d.ah(Math.max(1,B/C/e))/2,G}}const W=ve(9.314,3);function De(f,e){const n=(e.roundZoom?Math.round:Math.floor)(f.zoom+d.ah(f.tileSize/e.tileSize));return Math.max(0,n)}function we(f,e){const n=f.getCameraFrustum(),l=f.getClippingPlane(),u=f.screenPointToMercatorCoordinate(f.getCameraPoint()),m=d.$.fromLngLat(f.center,f.elevation);u.z=m.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const y=f.getCoveringTilesDetailsProvider(),b=y.allowVariableZoom(f,e),T=De(f,e),C=e.minzoom||0,z=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,B=Math.min(Math.max(0,T),z),k=Math.pow(2,B),Z=[k*u.x,k*u.y,0],G=[k*m.x,k*m.y,0],te=Math.hypot(m.x-u.x,m.y-u.y),ee=Math.abs(m.z-u.z),ie=Math.hypot(te,ee),oe=me=>({zoom:0,x:0,y:0,wrap:me,fullyVisible:!1}),de=[],he=[];if(f.renderWorldCopies&&y.allowWorldCopies())for(let me=1;me<=3;me++)de.push(oe(-me)),de.push(oe(me));for(de.push(oe(0));de.length>0;){const me=de.pop(),xe=me.x,_e=me.y;let Ie=me.fullyVisible;const $e={x:xe,y:_e,z:me.zoom},je=y.getTileAABB($e,me.wrap,f.elevation,e);if(!Ie){const ut=J(n,je,l);if(ut===0)continue;Ie=ut===2}const Fe=y.distanceToTile2d(u.x,u.y,$e,je);let Ze=T;b&&(Ze=(e.calculateTileZoom||W)(f.zoom+d.ah(f.tileSize/e.tileSize),Fe,ee,ie,f.fov)),Ze=(e.roundZoom?Math.round:Math.floor)(Ze),Ze=Math.max(0,Ze);const dt=Math.min(Ze,z);if(me.wrap=y.getWrap(m,$e,me.wrap),me.zoom>=dt){if(me.zoom<C)continue;const ut=B-me.zoom,et=Z[0]-.5-(xe<<ut),Mt=Z[1]-.5-(_e<<ut),ei=e.reparseOverscaled?Math.max(me.zoom,Ze):me.zoom;he.push({tileID:new d.Y(me.zoom===z?ei:me.zoom,me.wrap,me.zoom,xe,_e),distanceSq:d.ai([G[0]-.5-xe,G[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(et*et+Mt*Mt)})}else for(let ut=0;ut<4;ut++)de.push({zoom:me.zoom+1,x:(xe<<1)+ut%2,y:(_e<<1)+(ut>>1),wrap:me.wrap,fullyVisible:Ie})}return he.sort((me,xe)=>me.distanceSq-xe.distanceSq).map(me=>me.tileID)}class ze extends d.E{constructor(e,n,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,m,y,b)=>{const T=new(ss(m.type))(u,m,y,b);if(T.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${T.id}`);return T})(e,n,l,this),this._tiles={},this._cache=new js(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new hl,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,l){return d._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new d.k(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new d.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const l=this._tiles[n];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Be).map(e=>e.key)}getRenderableIds(e){const n=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&n.push(this._tiles[l]);return e?n.sort((l,u)=>{const m=l.tileID,y=u.tileID,b=new d.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),T=new d.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-y.overscaledZ||T.y-b.y||T.x-b.x}).map(l=>l.tileID.key):n.map(l=>l.tileID).sort(Be).map(l=>l.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return d._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=n),yield this._loadTile(l,e,n))})}_tileLoaded(e,n,l){e.timeAdded=Se.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new d.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const n=this.getRenderableIds();for(let u=0;u<n.length;u++){const m=n[u];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);l(e,y),l(y,e)}}function l(u,m){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let y=m.tileID.canonical.x-u.tileID.canonical.x;const b=m.tileID.canonical.y-u.tileID.canonical.y,T=Math.pow(2,u.tileID.canonical.z),C=m.tileID.key;y===0&&b===0||Math.abs(b)>1||(Math.abs(y)>1&&(Math.abs(y+T)===1?y+=T:Math.abs(y-T)===1&&(y-=T)),m.dem&&u.dem&&(u.dem.backfillBorder(m.dem,y,b),u.neighboringTiles&&u.neighboringTiles[C]&&(u.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,l,u){for(const m in this._tiles){let y=this._tiles[m];if(u[m]||!y.hasData()||y.tileID.overscaledZ<=n||y.tileID.overscaledZ>l)continue;let b=y.tileID;for(;y&&y.tileID.overscaledZ>n+1;){const C=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[C.key],y&&y.hasData()&&(b=C)}let T=b;for(;T.overscaledZ>n;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]||e[T.canonical.key]){u[b.key]=b;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=n?l:null}for(let l=e.overscaledZ-1;l>=n;l--){const u=e.scaledTo(l),m=this._getLoadedTile(u);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(n*l*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(m)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const l={};for(const u in this._tiles){const m=this._tiles[u];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+n),l[m.tileID.key]=m}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,n,l,u,m,y){const b={},T={},C=Object.keys(e),z=Se.now();for(const B of C){const k=e[B],Z=this._tiles[B];if(!Z||Z.fadeEndTime!==0&&Z.fadeEndTime<=z)continue;const G=this.findLoadedParent(k,n),te=this.findLoadedSibling(k),ee=G||te||null;ee&&(this._addTile(ee.tileID),b[ee.tileID.key]=ee.tileID),T[B]=k}this._retainLoadedChildren(T,u,l,e);for(const B in b)e[B]||(this._coveredTiles[B]=!0,e[B]=b[B]);if(y){const B={},k={};for(const Z of m)this._tiles[Z.key].hasData()?B[Z.key]=Z:k[Z.key]=Z;for(const Z in k){const G=k[Z].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(B[G[0].key]=e[G[0].key]=G[0],B[G[1].key]=e[G[1].key]=G[1],B[G[2].key]=e[G[2].key]=G[2],B[G[3].key]=e[G[3].key]=G[3],delete k[Z])}for(const Z in k){const G=k[Z],te=this.findLoadedParent(G,this._source.minzoom),ee=this.findLoadedSibling(G),ie=te||ee||null;if(ie){B[ie.tileID.key]=e[ie.tileID.key]=ie.tileID;for(const oe in B)B[oe].isChildOf(ie.tileID)&&delete B[oe]}}for(const Z in this._tiles)B[Z]||(this._coveredTiles[Z]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new d.Y(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(l=we(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(z=>this._source.hasTile(z)))):l=[];const u=De(e,this._source),m=Math.max(u-ze.maxOverzooming,this._source.minzoom),y=Math.max(u+ze.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const B of l)if(B.canonical.z>this._source.minzoom){const k=B.scaledTo(B.canonical.z-1);z[k.key]=k;const Z=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));z[Z.key]=Z}l=l.concat(Object.values(z))}const b=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new d.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(l,u);Ee(this._source.type)&&this._updateCoveredAndRetainedTiles(T,m,y,u,l,n);for(const z in T)this._tiles[z].clearFadeHold();const C=d.aj(this._tiles,T);for(const z of C){const B=this._tiles[z];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var l;const u={},m={},y=Math.max(n-ze.maxOverzooming,this._source.minzoom),b=Math.max(n+ze.maxUnderzooming,this._source.minzoom),T={};for(const C of e){const z=this._addTile(C);u[C.key]=C,z.hasData()||n<this._source.maxzoom&&(T[C.key]=C)}this._retainLoadedChildren(T,n,b,u);for(const C of e){let z=this._tiles[C.key];if(z.hasData())continue;if(n+1>this._source.maxzoom){const k=C.children(this._source.maxzoom)[0],Z=this.getTile(k);if(Z&&Z.hasData()){u[k.key]=k;continue}}else{const k=C.children(this._source.maxzoom);if(u[k[0].key]&&u[k[1].key]&&u[k[2].key]&&u[k[3].key])continue}let B=z.wasRequested();for(let k=C.overscaledZ-1;k>=y;--k){const Z=C.scaledTo(k);if(m[Z.key])break;if(m[Z.key]=!0,z=this.getTile(Z),!z&&B&&(z=this._addTile(Z)),z){const G=z.hasData();if((G||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||B)&&(u[Z.key]=Z),B=z.wasRequested(),G)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}n.push(u.key);const m=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(m),l)break;u=m}for(const m of n)this._loadedParentTiles[m]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const n=this._tiles[e].tileID,l=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=l}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const l=n;return n||(n=new zn(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,l||this._source.fire(new d.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=n.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}refreshTiles(e){for(const n in this._tiles)this._isIdRenderable(n)&&e.some(l=>l.equals(this._tiles[n].tileID.canonical))&&this._reloadTile(n,"expired")}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){const n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,l){const u=[],m=this.transform;if(!m)return u;const y=l?m.getCameraQueryGeometry(e):e,b=e.map(G=>m.screenPointToMercatorCoordinate(G,this.terrain)),T=y.map(G=>m.screenPointToMercatorCoordinate(G,this.terrain)),C=this.getIds();let z=1/0,B=1/0,k=-1/0,Z=-1/0;for(const G of T)z=Math.min(z,G.x),B=Math.min(B,G.y),k=Math.max(k,G.x),Z=Math.max(Z,G.y);for(let G=0;G<C.length;G++){const te=this._tiles[C[G]];if(te.holdingForFade())continue;const ee=m.getCoveringTilesDetailsProvider().allowWorldCopies()?te.tileID:te.tileID.unwrapTo(0),ie=Math.pow(2,m.zoom-te.tileID.overscaledZ),oe=n*te.queryPadding*d.Z/te.tileSize/ie,de=[ee.getTilePoint(new d.$(z,B)),ee.getTilePoint(new d.$(k,Z))];if(de[0].x-oe<d.Z&&de[0].y-oe<d.Z&&de[1].x+oe>=0&&de[1].y+oe>=0){const he=b.map(xe=>ee.getTilePoint(xe)),me=T.map(xe=>ee.getTilePoint(xe));u.push({tile:te,tileID:ee,queryGeometry:he,cameraQueryGeometry:me,scale:ie})}}return u}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(Ee(this._source.type)){const e=Se.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,l){this._state.updateState(e=e||"_geojsonTileLayer",n,l)}removeFeatureState(e,n,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,l)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,l){const u=this._tiles[e];u&&u.setDependencies(n,l)}reloadTilesForDependencies(e,n){for(const l in this._tiles)this._tiles[l].hasDependency(e,n)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,n))}}function Be(f,e){const n=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-n||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Ee(f){return f==="raster"||f==="image"||f==="video"}ze.maxOverzooming=10,ze.maxUnderzooming=3;class We{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=d.ae(e,0,1);let n=1,l=this._distances[n];const u=e*this.paddedLength+this.padding;for(;l<u&&n<this._distances.length;)l=this._distances[++n];const m=n-1,y=this._distances[m],b=l-y,T=b>0?(u-y)/b:0;return this.points[m].mult(1-T).add(this.points[n].mult(T))}}function ft(f,e){let n=!0;return f==="always"||f!=="never"&&e!=="never"||(n=!1),n}class yt{constructor(e,n,l){const u=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(n/l);for(let y=0;y<this.xCellCount*this.yCellCount;y++)u.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,l,u,m){this._forEachCell(n,l,u,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(m)}insertCircle(e,n,l,u){this._forEachCell(n-u,l-u,n+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,n,l,u,m,y){this.boxCells[m].push(y)}_insertCircleCell(e,n,l,u,m,y){this.circleCells[m].push(y)}_query(e,n,l,u,m,y,b){if(l<0||e>this.width||u<0||n>this.height)return[];const T=[];if(e<=0&&n<=0&&this.width<=l&&this.height<=u){if(m)return[{key:null,x1:e,y1:n,x2:l,y2:u}];for(let C=0;C<this.boxKeys.length;C++)T.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const z=this.circles[3*C],B=this.circles[3*C+1],k=this.circles[3*C+2];T.push({key:this.circleKeys[C],x1:z-k,y1:B-k,x2:z+k,y2:B+k})}}else this._forEachCell(e,n,l,u,this._queryCell,T,{hitTest:m,overlapMode:y,seenUids:{box:{},circle:{}}},b);return T}query(e,n,l,u){return this._query(e,n,l,u,!1,null)}hitTest(e,n,l,u,m,y){return this._query(e,n,l,u,!0,m,y).length>0}hitTestCircle(e,n,l,u,m){const y=e-l,b=e+l,T=n-l,C=n+l;if(b<0||y>this.width||C<0||T>this.height)return!1;const z=[];return this._forEachCell(y,T,b,C,this._queryCellCircle,z,{hitTest:!0,overlapMode:u,circle:{x:e,y:n,radius:l},seenUids:{box:{},circle:{}}},m),z.length>0}_queryCell(e,n,l,u,m,y,b,T){const{seenUids:C,hitTest:z,overlapMode:B}=b,k=this.boxCells[m];if(k!==null){const G=this.bboxes;for(const te of k)if(!C.box[te]){C.box[te]=!0;const ee=4*te,ie=this.boxKeys[te];if(e<=G[ee+2]&&n<=G[ee+3]&&l>=G[ee+0]&&u>=G[ee+1]&&(!T||T(ie))&&(!z||!ft(B,ie.overlapMode))&&(y.push({key:ie,x1:G[ee],y1:G[ee+1],x2:G[ee+2],y2:G[ee+3]}),z))return!0}}const Z=this.circleCells[m];if(Z!==null){const G=this.circles;for(const te of Z)if(!C.circle[te]){C.circle[te]=!0;const ee=3*te,ie=this.circleKeys[te];if(this._circleAndRectCollide(G[ee],G[ee+1],G[ee+2],e,n,l,u)&&(!T||T(ie))&&(!z||!ft(B,ie.overlapMode))){const oe=G[ee],de=G[ee+1],he=G[ee+2];if(y.push({key:ie,x1:oe-he,y1:de-he,x2:oe+he,y2:de+he}),z)return!0}}}return!1}_queryCellCircle(e,n,l,u,m,y,b,T){const{circle:C,seenUids:z,overlapMode:B}=b,k=this.boxCells[m];if(k!==null){const G=this.bboxes;for(const te of k)if(!z.box[te]){z.box[te]=!0;const ee=4*te,ie=this.boxKeys[te];if(this._circleAndRectCollide(C.x,C.y,C.radius,G[ee+0],G[ee+1],G[ee+2],G[ee+3])&&(!T||T(ie))&&!ft(B,ie.overlapMode))return y.push(!0),!0}}const Z=this.circleCells[m];if(Z!==null){const G=this.circles;for(const te of Z)if(!z.circle[te]){z.circle[te]=!0;const ee=3*te,ie=this.circleKeys[te];if(this._circlesCollide(G[ee],G[ee+1],G[ee+2],C.x,C.y,C.radius)&&(!T||T(ie))&&!ft(B,ie.overlapMode))return y.push(!0),!0}}}_forEachCell(e,n,l,u,m,y,b,T){const C=this._convertToXCellCoord(e),z=this._convertToYCellCoord(n),B=this._convertToXCellCoord(l),k=this._convertToYCellCoord(u);for(let Z=C;Z<=B;Z++)for(let G=z;G<=k;G++)if(m.call(this,e,n,l,u,this.xCellCount*G+Z,y,b,T))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,l,u,m,y){const b=u-e,T=m-n,C=l+y;return C*C>b*b+T*T}_circleAndRectCollide(e,n,l,u,m,y,b){const T=(y-u)/2,C=Math.abs(e-(u+T));if(C>T+l)return!1;const z=(b-m)/2,B=Math.abs(n-(m+z));if(B>z+l)return!1;if(C<=T||B<=z)return!0;const k=C-T,Z=B-z;return k*k+Z*Z<=l*l}}function zt(f,e,n){const l=d.K();if(!f){const{vecSouth:B,vecEast:k}=Dt(e),Z=re();Z[0]=k[0],Z[1]=k[1],Z[2]=B[0],Z[3]=B[1],u=Z,(z=(y=(m=Z)[0])*(C=m[3])-(T=m[2])*(b=m[1]))&&(u[0]=C*(z=1/z),u[1]=-b*z,u[2]=-T*z,u[3]=y*z),l[0]=Z[0],l[1]=Z[1],l[4]=Z[2],l[5]=Z[3]}var u,m,y,b,T,C,z;return d.M(l,l,[1/n,1/n,1]),l}function Ot(f,e,n,l){if(f){const u=d.K();if(!e){const{vecSouth:m,vecEast:y}=Dt(n);u[0]=y[0],u[1]=y[1],u[4]=m[0],u[5]=m[1]}return d.M(u,u,[l,l,1]),u}return n.pixelsToClipSpaceMatrix}function Dt(f){const e=Math.cos(f.rollInRadians),n=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),u=Math.cos(f.bearingInRadians),m=Math.sin(f.bearingInRadians),y=d.ao();y[0]=-u*l*n-m*e,y[1]=-m*l*n+u*e;const b=d.ap(y);b<1e-9?d.aq(y):d.ar(y,y,1/b);const T=d.ao();T[0]=u*l*e-m*n,T[1]=m*l*e+u*n;const C=d.ap(T);return C<1e-9?d.aq(T):d.ar(T,T,1/C),{vecEast:T,vecSouth:y}}function Ve(f,e,n,l){let u;l?(u=[f,e,l(f,e),1],d.at(u,u,n)):(u=[f,e,0,1],Ns(u,u,n));const m=u[3];return{point:new d.P(u[0]/m,u[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function yi(f,e){return .5+f/e*.5}function ui(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function vi(f,e,n,l,u,m,y,b,T,C,z,B,k){const Z=n?f.textSizeData:f.iconSizeData,G=d.ak(Z,e.transform.zoom),te=[256/e.width*2+1,256/e.height*2+1],ee=n?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ee.clear();const ie=f.lineVertexArray,oe=n?f.text.placedSymbolArray:f.icon.placedSymbolArray,de=e.transform.width/e.transform.height;let he=!1;for(let me=0;me<oe.length;me++){const xe=oe.get(me);if(xe.hidden||xe.writingMode===d.al.vertical&&!he){os(xe.numGlyphs,ee);continue}he=!1;const _e=new d.P(xe.anchorX,xe.anchorY),Ie={getElevation:k,pitchedLabelPlaneMatrix:l,lineVertexArray:ie,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:_e,unwrappedTileID:T,width:C,height:z,translation:B},$e=Ft(xe.anchorX,xe.anchorY,Ie);if(!ui($e.point,te)){os(xe.numGlyphs,ee);continue}const je=yi(e.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),Fe=d.am(Z,G,xe),Ze=m?Fe*e.transform.getPitchedTextCorrection(xe.anchorX,xe.anchorY,T)/je:Fe*je,dt=Nt({projectionContext:Ie,pitchedLabelPlaneMatrixInverse:u,symbol:xe,fontSize:Ze,flip:!1,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:de,rotateToLine:b});he=dt.useVertical,(dt.notEnoughRoom||he||dt.needsFlipping&&Nt({projectionContext:Ie,pitchedLabelPlaneMatrixInverse:u,symbol:xe,fontSize:Ze,flip:!0,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:de,rotateToLine:b}).notEnoughRoom)&&os(xe.numGlyphs,ee)}n?f.text.dynamicLayoutVertexBuffer.updateData(ee):f.icon.dynamicLayoutVertexBuffer.updateData(ee)}function Vt(f,e,n,l,u,m,y,b){const T=m.glyphStartIndex+m.numGlyphs,C=m.lineStartIndex,z=m.lineStartIndex+m.lineLength,B=e.getoffsetX(m.glyphStartIndex),k=e.getoffsetX(T-1),Z=Ga(f*B,n,l,u,m.segment,C,z,b,y);if(!Z)return null;const G=Ga(f*k,n,l,u,m.segment,C,z,b,y);return G?b.projectionCache.anyProjectionOccluded?null:{first:Z,last:G}:null}function Qe(f,e,n,l){return f===d.al.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*l?{useVertical:!0}:(f===d.al.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function Nt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:l,fontSize:u,flip:m,keepUpright:y,glyphOffsetArray:b,dynamicLayoutVertexArray:T,aspectRatio:C,rotateToLine:z}=f,B=u/24,k=l.lineOffsetX*B,Z=l.lineOffsetY*B;let G;if(l.numGlyphs>1){const te=l.glyphStartIndex+l.numGlyphs,ee=l.lineStartIndex,ie=l.lineStartIndex+l.lineLength,oe=Vt(B,b,k,Z,m,l,z,e);if(!oe)return{notEnoughRoom:!0};const de=jn(oe.first.point.x,oe.first.point.y,e,n),he=jn(oe.last.point.x,oe.last.point.y,e,n);if(y&&!m){const me=Qe(l.writingMode,de,he,C);if(me)return me}G=[oe.first];for(let me=l.glyphStartIndex+1;me<te-1;me++)G.push(Ga(B*b.getoffsetX(me),k,Z,m,l.segment,ee,ie,e,z));G.push(oe.last)}else{if(y&&!m){const ee=ji(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ie=l.lineStartIndex+l.segment+1,oe=new d.P(e.lineVertexArray.getx(ie),e.lineVertexArray.gety(ie)),de=ji(oe.x,oe.y,e),he=de.signedDistanceFromCamera>0?de.point:Ht(e.tileAnchorPoint,oe,ee,1,e),me=jn(ee.x,ee.y,e,n),xe=jn(he.x,he.y,e,n),_e=Qe(l.writingMode,me,xe,C);if(_e)return _e}const te=Ga(B*b.getoffsetX(l.glyphStartIndex),k,Z,m,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,z);if(!te||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};G=[te]}for(const te of G)d.as(T,te.point,te.angle);return{}}function Ht(f,e,n,l,u){const m=f.add(f.sub(e)._unit()),y=ji(m.x,m.y,u).point,b=n.sub(y);return n.add(b._mult(l/b.mag()))}function Ri(f,e,n){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const u=new d.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),m=ji(u.x,u.y,e);if(m.signedDistanceFromCamera>0)return l.projections[f]=m.point,l.anyProjectionOccluded=l.anyProjectionOccluded||m.isOccluded,m.point;const y=f-n.direction;return Ht(n.distanceFromAnchor===0?e.tileAnchorPoint:new d.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),u,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function ji(f,e,n){const l=f+n.translation[0],u=e+n.translation[1];let m;return n.pitchWithMap?(m=Ve(l,u,n.pitchedLabelPlaneMatrix,n.getElevation),m.isOccluded=!1):(m=n.transform.projectTileCoordinates(l,u,n.unwrappedTileID,n.getElevation),m.point.x=(.5*m.point.x+.5)*n.width,m.point.y=(.5*-m.point.y+.5)*n.height),m}function jn(f,e,n,l){if(n.pitchWithMap){const u=[f,e,0,1];return d.at(u,u,l),n.transform.projectTileCoordinates(u[0]/u[3],u[1]/u[3],n.unwrappedTileID,n.getElevation).point}return{x:f/n.width*2-1,y:e/n.height*2-1}}function Ft(f,e,n){return n.transform.projectTileCoordinates(f,e,n.unwrappedTileID,n.getElevation)}function go(f,e,n){return f._unit()._perp()._mult(e*n)}function dl(f,e,n,l,u,m,y,b,T){if(b.projectionCache.offsets[f])return b.projectionCache.offsets[f];const C=n.add(e);if(f+T.direction<l||f+T.direction>=u)return b.projectionCache.offsets[f]=C,C;const z=Ri(f+T.direction,b,T),B=go(z.sub(n),y,T.direction),k=n.add(B),Z=z.add(B);return b.projectionCache.offsets[f]=d.au(m,C,k,Z)||C,b.projectionCache.offsets[f]}function Ga(f,e,n,l,u,m,y,b,T){const C=l?f-e:f+e;let z=C>0?1:-1,B=0;l&&(z*=-1,B=Math.PI),z<0&&(B+=Math.PI);let k,Z=z>0?m+u:m+u+1;b.projectionCache.cachedAnchorPoint?k=b.projectionCache.cachedAnchorPoint:(k=ji(b.tileAnchorPoint.x,b.tileAnchorPoint.y,b).point,b.projectionCache.cachedAnchorPoint=k);let G,te,ee=k,ie=k,oe=0,de=0;const he=Math.abs(C),me=[];let xe;for(;oe+de<=he;){if(Z+=z,Z<m||Z>=y)return null;oe+=de,ie=ee,te=G;const $e={absOffsetX:he,direction:z,distanceFromAnchor:oe,previousVertex:ie};if(ee=Ri(Z,b,$e),n===0)me.push(ie),xe=ee.sub(ie);else{let je;const Fe=ee.sub(ie);je=Fe.mag()===0?go(Ri(Z+z,b,$e).sub(ee),n,z):go(Fe,n,z),te||(te=ie.add(je)),G=dl(Z,je,ee,m,y,te,n,b,$e),me.push(te),xe=G.sub(te)}de=xe.mag()}const _e=xe._mult((he-oe)/de)._add(te||ie),Ie=B+Math.atan2(ee.y-ie.y,ee.x-ie.x);return me.push(_e),{point:_e,angle:T?Ie:0,path:me}}const Br=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function os(f,e){for(let n=0;n<f;n++){const l=e.length;e.resize(l+4),e.float32.set(Br,3*l)}}function Ns(f,e,n){const l=e[0],u=e[1];return f[0]=n[0]*l+n[4]*u+n[12],f[1]=n[1]*l+n[5]*u+n[13],f[3]=n[3]*l+n[7]*u+n[15],f}const yn=100;class qa{constructor(e,n=new yt(e.width+200,e.height+200,25),l=new yt(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+yn,this.screenBottomBoundary=e.height+yn,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,l,u,m,y,b,T,C,z,B,k){const Z=this.projectAndGetPerspectiveRatio(e.anchorPointX+T[0],e.anchorPointY+T[1],m,z,k),G=l*Z.perspectiveRatio;let te;if(y||b)te=this._projectCollisionBox(e,G,u,m,y,b,T,Z,z,B,k);else{const xe=Z.x+(B?B.x*G:0),_e=Z.y+(B?B.y*G:0);te={allPointsOccluded:!1,box:[xe+e.x1*G,_e+e.y1*G,xe+e.x2*G,_e+e.y2*G]}}const[ee,ie,oe,de]=te.box,he=y?te.allPointsOccluded:Z.isOccluded;let me=he;return me||(me=Z.perspectiveRatio<this.perspectiveRatioCutoff),me||(me=!this.isInsideGrid(ee,ie,oe,de)),me||n!=="always"&&this.grid.hitTest(ee,ie,oe,de,n,C)?{box:[ee,ie,oe,de],placeable:!1,offscreen:!1,occluded:he}:{box:[ee,ie,oe,de],placeable:!0,offscreen:this.isOffscreen(ee,ie,oe,de),occluded:he}}placeCollisionCircles(e,n,l,u,m,y,b,T,C,z,B,k,Z,G){const te=[],ee=new d.P(n.anchorX,n.anchorY),ie=this.getPerspectiveRatio(ee.x,ee.y,y,G),oe=(C?m*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,y)/ie:m*ie)/d.ay,de={getElevation:G,pitchedLabelPlaneMatrix:b,lineVertexArray:l,pitchWithMap:C,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ee,unwrappedTileID:y,width:this.transform.width,height:this.transform.height,translation:Z},he=Vt(oe,u,n.lineOffsetX*oe,n.lineOffsetY*oe,!1,n,!1,de);let me=!1,xe=!1,_e=!0;if(he){const Ie=.5*B*ie+k,$e=new d.P(-100,-100),je=new d.P(this.screenRightBoundary,this.screenBottomBoundary),Fe=new We,Ze=he.first,dt=he.last;let ut=[];for(let ei=Ze.path.length-1;ei>=1;ei--)ut.push(Ze.path[ei]);for(let ei=1;ei<dt.path.length;ei++)ut.push(dt.path[ei]);const et=2.5*Ie;if(C){const ei=this.projectPathToScreenSpace(ut,de);ut=ei.some(oi=>oi.signedDistanceFromCamera<=0)?[]:ei.map(oi=>oi.point)}let Mt=[];if(ut.length>0){const ei=ut[0].clone(),oi=ut[0].clone();for(let tn=1;tn<ut.length;tn++)ei.x=Math.min(ei.x,ut[tn].x),ei.y=Math.min(ei.y,ut[tn].y),oi.x=Math.max(oi.x,ut[tn].x),oi.y=Math.max(oi.y,ut[tn].y);Mt=ei.x>=$e.x&&oi.x<=je.x&&ei.y>=$e.y&&oi.y<=je.y?[ut]:oi.x<$e.x||ei.x>je.x||oi.y<$e.y||ei.y>je.y?[]:d.av([ut],$e.x,$e.y,je.x,je.y)}for(const ei of Mt){Fe.reset(ei,.25*Ie);let oi=0;oi=Fe.length<=.5*Ie?1:Math.ceil(Fe.paddedLength/et)+1;for(let tn=0;tn<oi;tn++){const Pi=tn/Math.max(oi-1,1),nn=Fe.lerp(Pi),Hi=nn.x+yn,Bi=nn.y+yn;te.push(Hi,Bi,Ie,0);const bi=Hi-Ie,Pn=Bi-Ie,Vn=Hi+Ie,Wn=Bi+Ie;if(_e=_e&&this.isOffscreen(bi,Pn,Vn,Wn),xe=xe||this.isInsideGrid(bi,Pn,Vn,Wn),e!=="always"&&this.grid.hitTestCircle(Hi,Bi,Ie,e,z)&&(me=!0,!T))return{circles:[],offscreen:!1,collisionDetected:me}}}}return{circles:!T&&me||!xe||ie<this.perspectiveRatioCutoff?[]:te,offscreen:_e,collisionDetected:me}}projectPathToScreenSpace(e,n){const l=function(u,m){const y=d.K();return d.an(y,m.pitchedLabelPlaneMatrix),u.map(b=>{const T=Ve(b.x,b.y,y,m.getElevation),C=m.transform.projectTileCoordinates(T.point.x,T.point.y,m.unwrappedTileID,m.getElevation);return C.point.x=(.5*C.point.x+.5)*m.width,C.point.y=(.5*-C.point.y+.5)*m.height,C})}(e,n);return function(u){let m=0,y=0,b=0,T=0;for(let C=0;C<u.length;C++)u[C].isOccluded?(b=C+1,T=0):(T++,T>y&&(y=T,m=b));return u.slice(m,m+y)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let l=1/0,u=1/0,m=-1/0,y=-1/0;for(const z of e){const B=new d.P(z.x+yn,z.y+yn);l=Math.min(l,B.x),u=Math.min(u,B.y),m=Math.max(m,B.x),y=Math.max(y,B.y),n.push(B)}const b=this.grid.query(l,u,m,y).concat(this.ignoredGrid.query(l,u,m,y)),T={},C={};for(const z of b){const B=z.key;if(T[B.bucketInstanceId]===void 0&&(T[B.bucketInstanceId]={}),T[B.bucketInstanceId][B.featureIndex])continue;const k=[new d.P(z.x1,z.y1),new d.P(z.x2,z.y1),new d.P(z.x2,z.y2),new d.P(z.x1,z.y2)];d.aw(n,k)&&(T[B.bucketInstanceId][B.featureIndex]=!0,C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]=[]),C[B.bucketInstanceId].push(B.featureIndex))}return C}insertCollisionBox(e,n,l,u,m,y){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:m,collisionGroupID:y,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,l,u,m,y){const b=l?this.ignoredGrid:this.grid,T={bucketInstanceId:u,featureIndex:m,collisionGroupID:y,overlapMode:n};for(let C=0;C<e.length;C+=4)b.insertCircle(T,e[C],e[C+1],e[C+2])}projectAndGetPerspectiveRatio(e,n,l,u,m){if(m){let y;u?(y=[e,n,u(e,n),1],d.at(y,y,m)):(y=[e,n,0,1],Ns(y,y,m));const b=y[3];return{x:(y[0]/b+1)/2*this.transform.width+yn,y:(-y[1]/b+1)/2*this.transform.height+yn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b*.5,isOccluded:!1,signedDistanceFromCamera:b}}{const y=this.transform.projectTileCoordinates(e,n,l,u);return{x:(y.point.x+1)/2*this.transform.width+yn,y:(1-y.point.y)/2*this.transform.height+yn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5,isOccluded:y.isOccluded,signedDistanceFromCamera:y.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,l,u){const m=this.transform.projectTileCoordinates(e,n,l,u);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,n,l,u){return l<yn||e>=this.screenRightBoundary||u<yn||n>this.screenBottomBoundary}isInsideGrid(e,n,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=d.ad([]);return d.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,l,u,m,y,b,T,C,z,B){let k=1,Z=0,G=0,te=1;const ee=e.anchorPointX+b[0],ie=e.anchorPointY+b[1];if(y&&!m){const ut=this.projectAndGetPerspectiveRatio(ee+1,ie,u,C,B),et=ut.x-T.x,Mt=Math.atan((ut.y-T.y)/et)+(et<0?Math.PI:0),ei=Math.sin(Mt),oi=Math.cos(Mt);k=oi,Z=ei,G=-ei,te=oi}else if(!y&&m){const ut=Dt(this.transform);k=ut.vecEast[0],Z=ut.vecEast[1],G=ut.vecSouth[0],te=ut.vecSouth[1]}let oe=T.x,de=T.y,he=n;m&&(oe=ee,de=ie,he=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),he*=this.transform.getPitchedTextCorrection(ee,ie,u),z||(he*=d.ae(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),z&&(oe+=k*z.x*he+G*z.y*he,de+=Z*z.x*he+te*z.y*he);const me=e.x1*he,xe=e.x2*he,_e=(me+xe)/2,Ie=e.y1*he,$e=e.y2*he,je=(Ie+$e)/2,Fe=[{offsetX:me,offsetY:Ie},{offsetX:_e,offsetY:Ie},{offsetX:xe,offsetY:Ie},{offsetX:xe,offsetY:je},{offsetX:xe,offsetY:$e},{offsetX:_e,offsetY:$e},{offsetX:me,offsetY:$e},{offsetX:me,offsetY:je}];let Ze=[];for(const{offsetX:ut,offsetY:et}of Fe)Ze.push(new d.P(oe+k*ut+G*et,de+Z*ut+te*et));let dt=!1;if(m){const ut=Ze.map(et=>this.projectAndGetPerspectiveRatio(et.x,et.y,u,C,B));dt=ut.some(et=>!et.isOccluded),Ze=ut.map(et=>new d.P(et.x,et.y))}else dt=!0;return{box:d.ax(Ze),allPointsOccluded:!dt}}}class ki{constructor(e,n,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Us{constructor(e,n,l,u,m){this.text=new ki(e?e.text:null,n,l,m),this.icon=new ki(e?e.icon:null,n,u,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ia{constructor(e,n,l){this.text=e,this.icon=n,this.skipFade=l}}class sc{constructor(e,n,l,u,m){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=m}}class Vs{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:l=>l.collisionGroupID===n}}return this.collisionGroups[e]}}function Ra(f,e,n,l,u){const{horizontalAlign:m,verticalAlign:y}=d.aE(f);return new d.P(-(m-.5)*e+l[0]*u,-(y-.5)*n+l[1]*u)}class Xc{constructor(e,n,l,u,m){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new qa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Vs(u),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const n=this.terrain;return n?(l,u)=>n.getElevation(e,l,u):null}getBucketParts(e,n,l,u){const m=l.getBucket(n),y=l.latestFeatureIndex;if(!m||!y||n.id!==m.layerIds[0])return;const b=l.collisionBoxArray,T=m.layers[0].layout,C=m.layers[0].paint,z=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),B=l.tileSize/d.Z,k=l.tileID.toUnwrapped(),Z=T.get("text-rotation-alignment")==="map",G=d.az(l,1,this.transform.zoom),te=d.aA(this.collisionIndex.transform,l,C.get("text-translate"),C.get("text-translate-anchor")),ee=d.aA(this.collisionIndex.transform,l,C.get("icon-translate"),C.get("icon-translate-anchor")),ie=zt(Z,this.transform,G);this.retainedQueryData[m.bucketInstanceId]=new sc(m.bucketInstanceId,y,m.sourceLayerIndex,m.index,l.tileID);const oe={bucket:m,layout:T,translationText:te,translationIcon:ee,unwrappedTileID:k,pitchedLabelPlaneMatrix:ie,scale:z,textPixelRatio:B,holdingForFade:l.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:d.ak(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(u)for(const de of m.sortKeyRanges){const{sortKey:he,symbolInstanceStart:me,symbolInstanceEnd:xe}=de;e.push({sortKey:he,symbolInstanceStart:me,symbolInstanceEnd:xe,parameters:oe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(e,n,l,u,m,y,b,T,C,z,B,k,Z,G,te,ee,ie,oe,de,he){const me=d.aB[e.textAnchor],xe=[e.textOffset0,e.textOffset1],_e=Ra(me,l,u,xe,m),Ie=this.collisionIndex.placeCollisionBox(n,k,T,C,z,b,y,ee,B.predicate,de,_e,he);if((!oe||this.collisionIndex.placeCollisionBox(oe,k,T,C,z,b,y,ie,B.predicate,de,_e,he).placeable)&&Ie.placeable){let $e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&($e=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:xe,width:l,height:u,anchor:me,textBoxScale:m,prevAnchor:$e},this.markUsedJustification(G,me,Z,te),G.allowVerticalPlacement&&(this.markUsedOrientation(G,te,Z),this.placedOrientations[Z.crossTileID]=te),{shift:_e,placedGlyphBoxes:Ie}}}placeLayerBucketPart(e,n,l){const{bucket:u,layout:m,translationText:y,translationIcon:b,unwrappedTileID:T,pitchedLabelPlaneMatrix:C,textPixelRatio:z,holdingForFade:B,collisionBoxArray:k,partiallyEvaluatedTextSize:Z,collisionGroup:G}=e.parameters,te=m.get("text-optional"),ee=m.get("icon-optional"),ie=d.aC(m,"text-overlap","text-allow-overlap"),oe=ie==="always",de=d.aC(m,"icon-overlap","icon-allow-overlap"),he=de==="always",me=m.get("text-rotation-alignment")==="map",xe=m.get("text-pitch-alignment")==="map",_e=m.get("icon-text-fit")!=="none",Ie=m.get("symbol-z-order")==="viewport-y",$e=oe&&(he||!u.hasIconData()||ee),je=he&&(oe||!u.hasTextData()||te);!u.collisionArrays&&k&&u.deserializeCollisionBoxes(k);const Fe=this.retainedQueryData[u.bucketInstanceId].tileID,Ze=this._getTerrainElevationFunc(Fe),dt=this.transform.getFastPathSimpleProjectionMatrix(Fe),ut=(et,Mt,ei)=>{var oi,tn;if(n[et.crossTileID])return;if(B)return void(this.placements[et.crossTileID]=new Ia(!1,!1,!1));let Pi=!1,nn=!1,Hi=!0,Bi=null,bi={box:null,placeable:!1,offscreen:null,occluded:!1},Pn={placeable:!1},Vn=null,Wn=null,Ti=null,Wr=0,Cr=0,ws=0;Mt.textFeatureIndex?Wr=Mt.textFeatureIndex:et.useRuntimeCollisionCircles&&(Wr=et.featureIndex),Mt.verticalTextFeatureIndex&&(Cr=Mt.verticalTextFeatureIndex);const Ts=Mt.textBox;if(Ts){const Qa=pn=>{let Dn=d.al.horizontal;if(u.allowVerticalPlacement&&!pn&&this.prevPlacement){const pa=this.prevPlacement.placedOrientations[et.crossTileID];pa&&(this.placedOrientations[et.crossTileID]=pa,Dn=pa,this.markUsedOrientation(u,Dn,et))}return Dn},Ms=(pn,Dn)=>{if(u.allowVerticalPlacement&&et.numVerticalGlyphVertices>0&&Mt.verticalTextBox){for(const pa of u.writingModes)if(pa===d.al.vertical?(bi=Dn(),Pn=bi):bi=pn(),bi&&bi.placeable)break}else bi=pn()},Wa=et.textAnchorOffsetStartIndex,Jr=et.textAnchorOffsetEndIndex;if(Jr===Wa){const pn=(Dn,pa)=>{const Di=this.collisionIndex.placeCollisionBox(Dn,ie,z,Fe,T,xe,me,y,G.predicate,Ze,void 0,dt);return Di&&Di.placeable&&(this.markUsedOrientation(u,pa,et),this.placedOrientations[et.crossTileID]=pa),Di};Ms(()=>pn(Ts,d.al.horizontal),()=>{const Dn=Mt.verticalTextBox;return u.allowVerticalPlacement&&et.numVerticalGlyphVertices>0&&Dn?pn(Dn,d.al.vertical):{box:null,offscreen:null}}),Qa(bi&&bi.placeable)}else{let pn=d.aB[(tn=(oi=this.prevPlacement)===null||oi===void 0?void 0:oi.variableOffsets[et.crossTileID])===null||tn===void 0?void 0:tn.anchor];const Dn=(Di,Dc,fh)=>{const Jh=Di.x2-Di.x1,jl=Di.y2-Di.y1,Xo=et.textBoxScale,ao=_e&&de==="never"?Dc:null;let ma=null,Ja=ie==="never"?1:2,er="never";pn&&Ja++;for(let es=0;es<Ja;es++){for(let Es=Wa;Es<Jr;Es++){const Cs=u.textAnchorOffsets.get(Es);if(pn&&Cs.textAnchor!==pn)continue;const Fa=this.attemptAnchorPlacement(Cs,Di,Jh,jl,Xo,me,xe,z,Fe,T,G,er,et,u,fh,y,b,ao,Ze);if(Fa&&(ma=Fa.placedGlyphBoxes,ma&&ma.placeable))return Pi=!0,Bi=Fa.shift,ma}pn?pn=null:er=ie}return l&&!ma&&(ma={box:this.collisionIndex.placeCollisionBox(Ts,"always",z,Fe,T,xe,me,y,G.predicate,Ze,void 0,dt).box,offscreen:!1,placeable:!1,occluded:!1}),ma};Ms(()=>Dn(Ts,Mt.iconBox,d.al.horizontal),()=>{const Di=Mt.verticalTextBox;return u.allowVerticalPlacement&&(!bi||!bi.placeable)&&et.numVerticalGlyphVertices>0&&Di?Dn(Di,Mt.verticalIconBox,d.al.vertical):{box:null,occluded:!0,offscreen:null}}),bi&&(Pi=bi.placeable,Hi=bi.offscreen);const pa=Qa(bi&&bi.placeable);if(!Pi&&this.prevPlacement){const Di=this.prevPlacement.variableOffsets[et.crossTileID];Di&&(this.variableOffsets[et.crossTileID]=Di,this.markUsedJustification(u,Di.anchor,et,pa))}}}if(Vn=bi,Pi=Vn&&Vn.placeable,Hi=Vn&&Vn.offscreen,et.useRuntimeCollisionCircles){const Qa=u.text.placedSymbolArray.get(et.centerJustifiedTextSymbolIndex),Ms=d.am(u.textSizeData,Z,Qa),Wa=m.get("text-padding");Wn=this.collisionIndex.placeCollisionCircles(ie,Qa,u.lineVertexArray,u.glyphOffsetArray,Ms,T,C,l,xe,G.predicate,et.collisionCircleDiameter,Wa,y,Ze),Wn.circles.length&&Wn.collisionDetected&&!l&&d.w("Collisions detected, but collision boxes are not shown"),Pi=oe||Wn.circles.length>0&&!Wn.collisionDetected,Hi=Hi&&Wn.offscreen}if(Mt.iconFeatureIndex&&(ws=Mt.iconFeatureIndex),Mt.iconBox){const Qa=Ms=>this.collisionIndex.placeCollisionBox(Ms,de,z,Fe,T,xe,me,b,G.predicate,Ze,_e&&Bi?Bi:void 0,dt);Pn&&Pn.placeable&&Mt.verticalIconBox?(Ti=Qa(Mt.verticalIconBox),nn=Ti.placeable):(Ti=Qa(Mt.iconBox),nn=Ti.placeable),Hi=Hi&&Ti.offscreen}const Fl=te||et.numHorizontalGlyphVertices===0&&et.numVerticalGlyphVertices===0,Ss=ee||et.numIconVertices===0;Fl||Ss?Ss?Fl||(nn=nn&&Pi):Pi=nn&&Pi:nn=Pi=nn&&Pi;const $o=nn&&Ti.placeable;if(Pi&&Vn.placeable&&this.collisionIndex.insertCollisionBox(Vn.box,ie,m.get("text-ignore-placement"),u.bucketInstanceId,Pn&&Pn.placeable&&Cr?Cr:Wr,G.ID),$o&&this.collisionIndex.insertCollisionBox(Ti.box,de,m.get("icon-ignore-placement"),u.bucketInstanceId,ws,G.ID),Wn&&Pi&&this.collisionIndex.insertCollisionCircles(Wn.circles,ie,m.get("text-ignore-placement"),u.bucketInstanceId,Wr,G.ID),l&&this.storeCollisionData(u.bucketInstanceId,ei,Mt,Vn,Ti,Wn),et.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[et.crossTileID]=new Ia((Pi||$e)&&!(Vn!=null&&Vn.occluded),(nn||je)&&!(Ti!=null&&Ti.occluded),Hi||u.justReloaded),n[et.crossTileID]=!0};if(Ie){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const et=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Mt=et.length-1;Mt>=0;--Mt){const ei=et[Mt];ut(u.symbolInstances.get(ei),u.collisionArrays[ei],ei)}}else for(let et=e.symbolInstanceStart;et<e.symbolInstanceEnd;et++)ut(u.symbolInstances.get(et),u.collisionArrays[et],et);u.justReloaded=!1}storeCollisionData(e,n,l,u,m,y){if(l.textBox||l.iconBox){let b,T;this.collisionBoxArrays.has(e)?b=this.collisionBoxArrays.get(e):(b=new Map,this.collisionBoxArrays.set(e,b)),b.has(n)?T=b.get(n):(T={text:null,icon:null},b.set(n,T)),l.textBox&&(T.text=u.box),l.iconBox&&(T.icon=m.box)}if(y){let b=this.collisionCircleArrays[e];b===void 0&&(b=this.collisionCircleArrays[e]=[]);for(let T=0;T<y.circles.length;T+=4)b.push(y.circles[T+0]-yn),b.push(y.circles[T+1]-yn),b.push(y.circles[T+2]),b.push(y.collisionDetected?1:0)}}markUsedJustification(e,n,l,u){let m;m=u===d.al.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[d.aD(n)];const y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of y)b>=0&&(e.text.placedSymbolArray.get(b).crossTileID=m>=0&&b!==m?0:l.crossTileID)}markUsedOrientation(e,n,l){const u=n===d.al.horizontal||n===d.al.horizontalOnly?n:0,m=n===d.al.vertical?n:0,y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of y)e.text.placedSymbolArray.get(b).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let l=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const u=n?n.symbolFadeChange(e):1,m=n?n.opacities:{},y=n?n.variableOffsets:{},b=n?n.placedOrientations:{};for(const T in this.placements){const C=this.placements[T],z=m[T];z?(this.opacities[T]=new Us(z,u,C.text,C.icon),l=l||C.text!==z.text.placed||C.icon!==z.icon.placed):(this.opacities[T]=new Us(null,u,C.text,C.icon,C.skipFade),l=l||C.text||C.icon)}for(const T in m){const C=m[T];if(!this.opacities[T]){const z=new Us(C,u,!1,!1);z.isHidden()||(this.opacities[T]=z,l=l||C.text.placed||C.icon.placed)}}for(const T in y)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=y[T]);for(const T in b)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=b[T]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const l={};for(const u of n){const m=u.getBucket(e);m&&u.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,n,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],y=m.layout,b=new Us(null,0,!1,!1,!0),T=y.get("text-allow-overlap"),C=y.get("icon-allow-overlap"),z=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=y.get("text-rotation-alignment")==="map",k=y.get("text-pitch-alignment")==="map",Z=y.get("icon-text-fit")!=="none",G=new Us(null,0,T&&(C||!e.hasIconData()||y.get("icon-optional")),C&&(T||!e.hasTextData()||y.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const te=(ie,oe,de)=>{for(let he=0;he<oe/4;he++)ie.opacityVertexArray.emplaceBack(de);ie.hasVisibleVertices=ie.hasVisibleVertices||de!==yo},ee=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ie=0;ie<e.symbolInstances.length;ie++){const oe=e.symbolInstances.get(ie),{numHorizontalGlyphVertices:de,numVerticalGlyphVertices:he,crossTileID:me}=oe;let xe=this.opacities[me];l[me]?xe=b:xe||(xe=G,this.opacities[me]=xe),l[me]=!0;const _e=oe.numIconVertices>0,Ie=this.placedOrientations[oe.crossTileID],$e=Ie===d.al.vertical,je=Ie===d.al.horizontal||Ie===d.al.horizontalOnly;if(de>0||he>0){const Ze=fl(xe.text);te(e.text,de,$e?yo:Ze),te(e.text,he,je?yo:Ze);const dt=xe.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(Mt=>{Mt>=0&&(e.text.placedSymbolArray.get(Mt).hidden=dt||$e?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=dt||je?1:0);const ut=this.variableOffsets[oe.crossTileID];ut&&this.markUsedJustification(e,ut.anchor,oe,Ie);const et=this.placedOrientations[oe.crossTileID];et&&(this.markUsedJustification(e,"left",oe,et),this.markUsedOrientation(e,et,oe))}if(_e){const Ze=fl(xe.icon),dt=!(Z&&oe.verticalPlacedIconSymbolIndex&&$e);oe.placedIconSymbolIndex>=0&&(te(e.icon,oe.numIconVertices,dt?Ze:yo),e.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=xe.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(te(e.icon,oe.numVerticalIconVertices,dt?yo:Ze),e.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=xe.icon.isHidden())}const Fe=ee&&ee.has(ie)?ee.get(ie):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ze=e.collisionArrays[ie];if(Ze){let dt=new d.P(0,0);if(Ze.textBox||Ze.verticalTextBox){let ut=!0;if(z){const et=this.variableOffsets[me];et?(dt=Ra(et.anchor,et.width,et.height,et.textOffset,et.textBoxScale),B&&dt._rotate(k?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ut=!1}if(Ze.textBox||Ze.verticalTextBox){let et;Ze.textBox&&(et=$e),Ze.verticalTextBox&&(et=je),oc(e.textCollisionBox.collisionVertexArray,xe.text.placed,!ut||et,Fe.text,dt.x,dt.y)}}if(Ze.iconBox||Ze.verticalIconBox){const ut=!!(!je&&Ze.verticalIconBox);let et;Ze.iconBox&&(et=ut),Ze.verticalIconBox&&(et=!ut),oc(e.iconCollisionBox.collisionVertexArray,xe.icon.placed,et,Fe.icon,Z?dt.x:0,Z?dt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const l=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function oc(f,e,n,l,u,m){l&&l.length!==0||(l=[0,0,0,0]);const y=l[0]-yn,b=l[1]-yn,T=l[2]-yn,C=l[3]-yn;f.emplaceBack(e?1:0,n?1:0,u||0,m||0,y,b),f.emplaceBack(e?1:0,n?1:0,u||0,m||0,T,b),f.emplaceBack(e?1:0,n?1:0,u||0,m||0,T,C),f.emplaceBack(e?1:0,n?1:0,u||0,m||0,y,C)}const Fh=Math.pow(2,25),_o=Math.pow(2,24),Ha=Math.pow(2,17),jh=Math.pow(2,16),Qd=Math.pow(2,9),Yc=Math.pow(2,8),Xu=Math.pow(2,1);function fl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,n=Math.floor(127*f.opacity);return n*Fh+e*_o+n*Ha+e*jh+n*Qd+e*Yc+n*Xu+e}const yo=0;class ka{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,l,u,m){const y=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(y,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((b,T)=>b.sortKey-T.sortKey));this._currentPartIndex<y.length;)if(n.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,m())return!0;return!1}}class Kc{constructor(e,n,l,u,m,y,b,T){this.placement=new Xc(e,n,y,b,T),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,n,l){const u=Se.now(),m=()=>!this._forceFullPlacement&&Se.now()-u>2;for(;this._currentPlacementIndex>=0;){const y=n[e[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=b)&&(!y.maxzoom||y.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new ka(y)),this._inProgressLayer.continuePlacement(l[y.source],this.placement,this._showCollisionBoxes,y,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Zs=512/d.Z/2;class lc{constructor(e,n,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let m=0;m<n.length;m++){const y=n.get(m),b=y.key,T=u.get(b);T?T.push(y):u.set(b,[y])}for(const[m,y]of u){const b={positions:y.map(T=>({x:Math.floor(T.anchorX*Zs),y:Math.floor(T.anchorY*Zs)})),crossTileIDs:y.map(T=>T.crossTileID)};if(b.positions.length>128){const T=new d.aF(b.positions.length,16,Uint16Array);for(const{x:C,y:z}of b.positions)T.add(C,z);T.finish(),delete b.positions,b.index=T}this._symbolsByKey[m]=b}}getScaledCoordinates(e,n){const{x:l,y:u,z:m}=this.tileID.canonical,{x:y,y:b,z:T}=n.canonical,C=Zs/Math.pow(2,T-m),z=(b*d.Z+e.anchorY)*C,B=u*d.Z*Zs;return{x:Math.floor((y*d.Z+e.anchorX)*C-l*d.Z*Zs),y:Math.floor(z-B)}}findMatches(e,n,l){const u=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let m=0;m<e.length;m++){const y=e.get(m);if(y.crossTileID)continue;const b=this._symbolsByKey[y.key];if(!b)continue;const T=this.getScaledCoordinates(y,n);if(b.index){const C=b.index.range(T.x-u,T.y-u,T.x+u,T.y+u).sort();for(const z of C){const B=b.crossTileIDs[z];if(!l[B]){l[B]=!0,y.crossTileID=B;break}}}else if(b.positions)for(let C=0;C<b.positions.length;C++){const z=b.positions[C],B=b.crossTileIDs[C];if(Math.abs(z.x-T.x)<=u&&Math.abs(z.y-T.y)<=u&&!l[B]){l[B]=!0,y.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class pl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ml{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const l in this.indexes){const u=this.indexes[l],m={};for(const y in u){const b=u[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+n),m[b.tileID.key]=b}this.indexes[l]=m}this.lng=e}addBucket(e,n,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<n.symbolInstances.length;m++)n.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const y=this.indexes[m];if(Number(m)>e.overscaledZ)for(const b in y){const T=y[b];T.tileID.isChildOf(e)&&T.findMatches(n.symbolInstances,e,u)}else{const b=y[e.scaledTo(Number(m)).key];b&&b.findMatches(n.symbolInstances,e,u)}}for(let m=0;m<n.symbolInstances.length;m++){const y=n.symbolInstances.get(m);y.crossTileID||(y.crossTileID=l.generate(),u[y.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new lc(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const l of n.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let n=!1;for(const l in this.indexes){const u=this.indexes[l];for(const m in u)e[u[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[m]),delete u[m],n=!0)}return n}}class gl{constructor(){this.layerIndexes={},this.crossTileIDs=new pl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new ml);let m=!1;const y={};u.handleWrapJump(l);for(const b of n){const T=b.getBucket(e);T&&e.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(b.tileID,T,this.crossTileIDs)&&(m=!0),y[T.bucketInstanceId]=!0)}return u.removeStaleBuckets(y)&&(m=!0),m}pruneUnusedLayers(e){const n={};e.forEach(l=>{n[l]=!0});for(const l in this.layerIndexes)n[l]||delete this.layerIndexes[l]}}var Gs="void main() {fragColor=vec4(1.0);}";const ba={prelude:pi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:pi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:pi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:pi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:pi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:pi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:pi(Gs,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:pi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:pi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:pi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:pi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:pi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:pi(Gs,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:pi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:pi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:pi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:pi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:pi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:pi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:pi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:pi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:pi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:pi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:pi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:pi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:pi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:pi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:pi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:pi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:pi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:pi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function pi(f,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),u=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=m?m.concat(u):u,b={};return{fragmentSource:f=f.replace(n,(T,C,z,B,k)=>(b[k]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${k}
in ${z} ${B} ${k};
#else
uniform ${z} ${B} u_${k};
#endif
`:`
#ifdef HAS_UNIFORM_u_${k}
    ${z} ${B} ${k} = u_${k};
#endif
`)),vertexSource:e=e.replace(n,(T,C,z,B,k)=>{const Z=B==="float"?"vec2":"vec4",G=k.match(/color/)?"color":Z;return b[k]?C==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
in ${z} ${Z} a_${k};
out ${z} ${B} ${k};
#else
uniform ${z} ${B} u_${k};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = a_${k};
#else
    ${z} ${B} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = unpack_mix_${G}(a_${k}, u_${k}_t);
#else
    ${z} ${B} ${k} = u_${k};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
in ${z} ${Z} a_${k};
#else
uniform ${z} ${B} u_${k};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${z} ${B} ${k} = a_${k};
#else
    ${z} ${B} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${z} ${B} ${k} = unpack_mix_${G}(a_${k}, u_${k}_t);
#else
    ${z} ${B} ${k} = u_${k};
#endif
`}),staticAttributes:l,staticUniforms:y}}class vo{constructor(e,n,l){this.vertexBuffer=e,this.indexBuffer=n,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ia=d.aG([{name:"a_pos",type:"Int16",components:2}]);const xo="#define PROJECTION_MERCATOR",hi="mercator";class qs{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return hi}get shaderDefine(){return xo}get shaderPreludeCode(){return ba.projectionMercator}get vertexShaderPreludeCode(){return ba.projectionMercator.vertexSource}get subdivisionGranularity(){return d.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,l,u,m){if(this._cachedMesh)return this._cachedMesh;const y=new d.aI;y.emplaceBack(0,0),y.emplaceBack(d.Z,0),y.emplaceBack(0,d.Z),y.emplaceBack(d.Z,d.Z);const b=e.createVertexBuffer(y,ia.members),T=d.aJ.simpleSegment(0,0,4,2),C=new d.aK;C.emplaceBack(1,0,2),C.emplaceBack(1,2,3);const z=e.createIndexBuffer(C);return this._cachedMesh=new vo(b,z,T),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class bo{constructor(e=0,n=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=l,this.right=u}interpolate(e,n,l){return n.top!=null&&e.top!=null&&(this.top=d.B.number(e.top,n.top,l)),n.bottom!=null&&e.bottom!=null&&(this.bottom=d.B.number(e.bottom,n.bottom,l)),n.left!=null&&e.left!=null&&(this.left=d.B.number(e.left,n.left,l)),n.right!=null&&e.right!=null&&(this.right=d.B.number(e.right,n.right,l)),this}getCenter(e,n){const l=d.ae((this.left+e-this.right)/2,0,e),u=d.ae((this.top+n-this.bottom)/2,0,n);return new d.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new bo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Hs(f,e){if(!f.renderWorldCopies||f.lngRange)return;const n=e.lng-f.center.lng;e.lng+=n>180?-360:n<-180?360:0}function Nn(f){return Math.max(0,Math.floor(f))}class vn{constructor(e,n,l,u,m,y){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=u??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new d.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Nn(this._zoom),this._scale=d.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new bo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Nn(this._zoom),this._scale=d.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new bo(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const n=d.aL(e,-180,180)*Math.PI/180;var l,u,m,y,b,T,C,z,B;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=re(),l=this._rotationMatrix,m=-this._bearingInRadians,y=(u=this._rotationMatrix)[0],b=u[1],T=u[2],C=u[3],z=Math.sin(m),B=Math.cos(m),l[0]=y*B+T*z,l[1]=b*B+C*z,l[2]=y*-z+T*B,l[3]=b*-z+C*B)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const n=d.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return d.aM(this._fovInRadians)}setFov(e){e=d.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=d.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=d.ac(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,l){this._unmodified=!1,this._edgeInsets.interpolate(e,n,l),this._constrain(),this._calcMatrices()}resize(e,n,l=!0){this._width=e,this._height=n,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new zi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,d.af])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let l=e.x,u=e.y,m=e.x,y=e.y;for(const b of n)l=Math.min(l,b.x),u=Math.min(u,b.y),m=Math.max(m,b.x),y=Math.max(y,b.y);return[new d.P(l,u),new d.P(m,u),new d.P(m,y),new d.P(l,y),new d.P(l,u)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:n,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=d.ad(new Float64Array(16));d.M(e,e,[this._width/2,-this._height/2,1]),d.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=d.ad(new Float64Array(16)),d.M(e,e,[1,-1,1]),d.L(e,e,[-1,-1,0]),d.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,l,u){const m=l!==void 0?l:this.bearing,y=u=u!==void 0?u:this.pitch,b=d.$.fromLngLat(e,n),T=-Math.cos(d.ab(y)),C=Math.sin(d.ab(y)),z=C*Math.sin(d.ab(m)),B=-C*Math.cos(d.ab(m));let k=this.elevation;const Z=n-k;let G;T*Z>=0||Math.abs(T)<.1?(G=1e4,k=n+G*T):G=-Z/T;let te,ee,ie=d.aN(1,b.y),oe=0;do{if(oe+=1,oe>10)break;ee=G/ie,te=new d.$(b.x+z*ee,b.y+B*ee),ie=1/te.meterInMercatorCoordinateUnits()}while(Math.abs(G-ee*ie)>1e-12);return{center:te.toLngLat(),elevation:k,zoom:d.ah(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const n=d.ag(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/n,u=d.$.fromLngLat(this.center,this.elevation),m=X(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const y=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),d.aN(m.z,u.y),this.bearing,this.pitch);this._elevation=y.elevation,this._center=y.center,this.setZoom(y.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=d.ag(1,this.center.lat)*this.worldSize;return X(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/d.Z,1/n/d.Z]}}class xn{constructor(e,n){this.min=e,this.max=n,this.center=d.aO([],d.aP([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],l=d.aQ(this.min),u=d.aQ(this.max);for(let m=0;m<n.length;m++)l[m]=n[m]?this.min[m]:this.center[m],u[m]=n[m]?this.center[m]:this.max[m];return u[2]=this.max[2],new xn(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let l=0;l<e.planes.length;l++){const u=this.intersectsPlane(e.planes[l]);if(u===0)return 0;u===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],l=e[3];for(let u=0;u<3;u++)e[u]>0?(n+=e[u]*this.min[u],l+=e[u]*this.max[u]):(l+=e[u]*this.min[u],n+=e[u]*this.max[u]);return n>=0?2:l<0?0:1}}class Un{distanceToTile2d(e,n,l,u){const m=u.distanceX([e,n]),y=u.distanceY([e,n]);return Math.hypot(m,y)}getWrap(e,n,l){return l}getTileAABB(e,n,l,u){var m,y;let b=l,T=l;if(u.terrain){const z=new d.Y(e.z,n,e.z,e.x,e.y),B=u.terrain.getMinMaxElevation(z);b=(m=B.minElevation)!==null&&m!==void 0?m:l,T=(y=B.maxElevation)!==null&&y!==void 0?y:l}const C=1<<e.z;return new xn([n+e.x/C,e.y/C,b],[n+(e.x+1)/C,(e.y+1)/C,T])}allowVariableZoom(e,n){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,u=d.ae(78.5-l/2,0,60);return!!n.terrain||e.pitch>u}allowWorldCopies(){return!0}recalculateCache(){}}class Ni{constructor(e,n,l){this.points=e,this.planes=n,this.aabb=l}static fromInvProjectionMatrix(e,n=1,l=0){const u=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const z=1/(C=d.at([],C,e))[3]/n*u;return d.aR(C,C,[z,z,1/C[3],z])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const z=d.aS([],m[C[0]],m[C[1]]),B=d.aS([],m[C[2]],m[C[1]]),k=d.aT([],d.aU([],z,B)),Z=-d.aV(k,m[C[1]]);return k.concat(Z)}),b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],T=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const C of m)for(let z=0;z<3;z++)b[z]=Math.min(b[z],C[z]),T[z]=Math.max(T[z],C[z]);return new Ni(m,y,new xn(b,T))}}class Or{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,l=!0){this._helper.resize(e,n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,l,u,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new vn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(y,b)=>this.getConstrained(y,b)},e,n,l,u,m),this._coveringTilesDetailsProvider=new Un}clone(){const e=new Or;return e.apply(this),e}apply(e,n,l){this._helper.apply(e,n,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const n=[new d.aW(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new d.P(0,0)),u=this.screenPointToMercatorCoordinate(new d.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new d.P(this._helper._width,this._helper._height)),y=this.screenPointToMercatorCoordinate(new d.P(0,this._helper._height)),b=Math.floor(Math.min(l.x,u.x,m.x,y.x)),T=Math.floor(Math.max(l.x,u.x,m.x,y.x)),C=1;for(let z=b-C;z<=T+C;z++)z!==0&&n.push(new d.aW(z,e))}return n}getCameraFrustum(){return Ni.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const n=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,n){const l=d.ag(this.elevation,this.center.lat),u=this.screenPointToMercatorCoordinateAtZ(n,l),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),y=d.$.fromLngLat(e),b=new d.$(y.x-(u.x-m.x),y.y-(u.y-m.y));this.setCenter(b==null?void 0:b.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(d.$.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(d.$.fromLngLat(e))}screenPointToLocation(e,n){var l;return(l=this.screenPointToMercatorCoordinate(e,n))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){const l=n.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){const l=n||0,u=[e.x,e.y,0,1],m=[e.x,e.y,1,1];d.at(u,u,this._pixelMatrixInverse),d.at(m,m,this._pixelMatrixInverse);const y=u[3],b=m[3],T=u[1]/y,C=m[1]/b,z=u[2]/y,B=m[2]/b,k=z===B?0:(l-z)/(B-z);return new d.$(d.B.number(u[0]/y,m[0]/b,k)/this.worldSize,d.B.number(T,C,k)/this.worldSize,l)}coordinatePoint(e,n=0,l=this._pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,n,1];return d.at(u,u,l),new d.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Me(this));return new zi().extend(this.screenPointToLocation(new d.P(0,e))).extend(this.screenPointToLocation(new d.P(this._helper._width,e))).extend(this.screenPointToLocation(new d.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new d.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-Me(this)}calculatePosMatrix(e,n=!1,l){var u;const m=(u=e.key)!==null&&u!==void 0?u:d.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),y=n?this._alignedPosMatrixCache:this._posMatrixCache;if(y.has(m)){const C=y.get(m);return l?C.f32:C.f64}const b=$(e,this.worldSize);d.N(b,n?this._alignedProjMatrix:this._viewProjMatrix,b);const T={f64:b,f32:new Float32Array(b)};return y.set(m,T),l?T.f32:T.f64}calculateFogMatrix(e){const n=e.key,l=this._fogMatrixCacheF32;if(l.has(n))return l.get(n);const u=$(e,this.worldSize);return d.N(u,this._fogMatrix,u),l.set(n,new Float32Array(u)),l.get(n)}getConstrained(e,n){n=d.ae(+n,this.minZoom,this.maxZoom);const l={center:new d.Q(e.lng,e.lat),zoom:n};let u=this._helper._lngRange;this._helper._renderWorldCopies||u!==null||(u=[-179.9999999999,180-1e-10]);const m=this.tileSize*d.ac(l.zoom);let y=0,b=m,T=0,C=m,z=0,B=0;const{x:k,y:Z}=this.size;if(this._helper._latRange){const de=this._helper._latRange;y=d.S(de[1])*m,b=d.S(de[0])*m,b-y<Z&&(z=Z/(b-y))}u&&(T=d.aL(d.U(u[0])*m,0,m),C=d.aL(d.U(u[1])*m,0,m),C<T&&(C+=m),C-T<k&&(B=k/(C-T)));const{x:G,y:te}=ta(m,e);let ee,ie;const oe=Math.max(B||0,z||0);if(oe){const de=new d.P(B?(C+T)/2:G,z?(b+y)/2:te);return l.center=Za(m,de).wrap(),l.zoom+=d.ah(oe),l}if(this._helper._latRange){const de=Z/2;te-de<y&&(ie=y+de),te+de>b&&(ie=b-de)}if(u){const de=(T+C)/2;let he=G;this._helper._renderWorldCopies&&(he=d.aL(G,de-m/2,de+m/2));const me=k/2;he-me<T&&(ee=T+me),he+me>C&&(ee=C-me)}if(ee!==void 0||ie!==void 0){const de=new d.P(ee??G,ie??te);l.center=Za(m,de).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,n,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,u)}_calculateNearFarZIfNeeded(e,n,l){if(!this._helper.autoCalculateNearFarZ)return;const u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-u*this._helper._pixelPerMeter/Math.cos(n),y=u<0?m:e,b=Math.PI/2+this.pitchInRadians,T=d.ab(this.fov)*(Math.abs(Math.cos(d.ab(this.roll)))*this.height+Math.abs(Math.sin(d.ab(this.roll)))*this.width)/this.height*(.5+l.y/this.height),C=Math.sin(T)*y/Math.sin(d.ae(Math.PI-b-T,.01,Math.PI-.01)),z=Me(this),B=Math.atan(z/this._helper.cameraToCenterDistance),k=d.ab(.75),Z=B>k?2*B*(.5+l.y/(2*z)):k,G=Math.sin(Z)*y/Math.sin(d.ae(Math.PI-b-Z,.01,Math.PI-.01)),te=Math.min(C,G);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*te+y),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,n=ta(this.worldSize,this.center),l=n.x,u=n.y;this._helper._pixelPerMeter=d.ag(1,this.center.lat)*this.worldSize;const m=d.ab(Math.min(this.pitch,sr)),y=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let b;this._calculateNearFarZIfNeeded(y,m,e),b=new Float64Array(16),d.aY(b,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),d.an(this._invProjMatrix,b),b[8]=2*-e.x/this._helper._width,b[9]=2*e.y/this._helper._height,this._projectionMatrix=d.aZ(b),d.M(b,b,[1,-1,1]),d.L(b,b,[0,0,-this._helper.cameraToCenterDistance]),d.a_(b,b,-this.rollInRadians),d.a$(b,b,this.pitchInRadians),d.a_(b,b,-this.bearingInRadians),d.L(b,b,[-l,-u,0]),this._mercatorMatrix=d.M([],b,[this.worldSize,this.worldSize,this.worldSize]),d.M(b,b,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=d.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,b),d.L(b,b,[0,0,-this.elevation]),this._viewProjMatrix=b,this._invViewProjMatrix=d.an([],b);const T=[0,0,-1,1];d.at(T,T,this._invViewProjMatrix),this._cameraPosition=[T[0]/T[3],T[1]/T[3],T[2]/T[3]],this._fogMatrix=new Float64Array(16),d.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,y,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,d.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),d.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),d.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),d.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),d.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),d.L(this._fogMatrix,this._fogMatrix,[-l,-u,0]),d.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),d.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=d.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,b);const C=this._helper._width%2/2,z=this._helper._height%2/2,B=Math.cos(this.bearingInRadians),k=Math.sin(-this.bearingInRadians),Z=l-Math.round(l)+B*C+k*z,G=u-Math.round(u)+B*z+k*C,te=new Float64Array(b);if(d.L(te,te,[Z>.5?Z-1:Z,G>.5?G-1:G,0]),this._alignedProjMatrix=te,b=d.an(new Float64Array(16),this._pixelMatrix),!b)throw new Error("failed to invert matrix");this._pixelMatrixInverse=b,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new d.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return d.at(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=d.ag(1,this.center.lat)*this.worldSize;return X(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){const l=d.$.fromLngLat(e),u=[l.x*this.worldSize,l.y*this.worldSize,n,1];return d.at(u,u,this._viewProjMatrix),u[2]/u[3]}getProjectionData(e){const{overscaledTileID:n,aligned:l,applyTerrainMatrix:u}=e,m=this._helper.getMercatorTileCoordinates(n),y=n?this.calculatePosMatrix(n,l,!0):null;let b;return b=n&&n.terrainRttPosMatrix32f&&u?n.terrainRttPosMatrix32f:y||d.b0(),{mainMatrix:b,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:b}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,l){return 1}transformLightDirection(e){return d.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,l,u){const m=this.calculatePosMatrix(l);let y;u?(y=[e,n,u(e,n),1],d.at(y,y,m)):(y=[e,n,0,1],Ns(y,y,m));const b=y[3];return{point:new d.P(y[0]/b,y[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}populateCache(e){for(const n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){const l=d.$.fromLngLat(e,n),u=l.meterInMercatorCoordinateUnits(),m=d.b1();return d.L(m,m,[l.x,l.y,l.z]),d.a_(m,m,Math.PI),d.a$(m,m,Math.PI/2),d.M(m,m,[-u,u,u]),m}getProjectionDataForCustomLayer(e=!0){const n=new d.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),u=$(n,this.worldSize);d.N(u,this._viewProjMatrix,u),l.tileMercatorCoords=[0,0,1,1];const m=[d.Z,d.Z,this.worldSize/this._helper.pixelsPerMeter],y=d.b2();return d.M(y,u,m),l.fallbackMatrix=y,l.mainMatrix=y,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function dn(){d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function wa(f){if(f.useSlerp)if(f.k<1){const e=d.b3(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),n=d.b3(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);d.b4(l,e,n,f.k);const u=d.b5(l);f.tr.setRoll(u.roll),f.tr.setPitch(u.pitch),f.tr.setBearing(u.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(d.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(d.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(d.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Xn(f,e,n,l,u){const m=u.padding,y=ta(u.worldSize,n.getNorthWest()),b=ta(u.worldSize,n.getNorthEast()),T=ta(u.worldSize,n.getSouthEast()),C=ta(u.worldSize,n.getSouthWest()),z=d.ab(-l),B=y.rotate(z),k=b.rotate(z),Z=T.rotate(z),G=C.rotate(z),te=new d.P(Math.max(B.x,k.x,G.x,Z.x),Math.max(B.y,k.y,G.y,Z.y)),ee=new d.P(Math.min(B.x,k.x,G.x,Z.x),Math.min(B.y,k.y,G.y,Z.y)),ie=te.sub(ee),oe=(u.width-(m.left+m.right+e.left+e.right))/ie.x,de=(u.height-(m.top+m.bottom+e.top+e.bottom))/ie.y;if(de<0||oe<0)return void dn();const he=Math.min(d.ah(u.scale*Math.min(oe,de)),f.maxZoom),me=d.P.convert(f.offset),xe=new d.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(d.ab(l)),_e=me.add(xe).mult(u.scale/d.ac(he));return{center:Za(u.worldSize,y.add(T).div(2).sub(_e)),zoom:he,bearing:l}}class or{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,l){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,n,l,u,m){return Xn(e,n,l,u,m)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(d.Q.convert(n.center))}handleEaseTo(e,n){const l=e.zoom,u=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},y={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},b=n.zoom!==void 0,T=!e.isPaddingEqual(n.padding);let C=!1;const z=b?+n.zoom:e.zoom;let B=e.centerPoint.add(n.offsetAsPoint);const k=e.screenPointToLocation(B),{center:Z,zoom:G}=e.getConstrained(d.Q.convert(n.center||k),z??l);Hs(e,Z);const te=ta(e.worldSize,k),ee=ta(e.worldSize,Z).sub(te),ie=d.ac(G-l);return C=G!==l,{easeFunc:oe=>{if(C&&e.setZoom(d.B.number(l,G,oe)),d.b6(m,y)||wa({startEulerAngles:m,endEulerAngles:y,tr:e,k:oe,useSlerp:m.roll!=y.roll}),T&&(e.interpolatePadding(u,n.padding,oe),B=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{const de=d.ac(e.zoom-l),he=G>l?Math.min(2,ie):Math.max(.5,ie),me=Math.pow(he,1-oe),xe=Za(e.worldSize,te.add(ee.mult(oe*me)).mult(de));e.setLocationAtPoint(e.renderWorldCopies?xe.wrap():xe,B)}},isZooming:C,elevationCenter:Z}}handleFlyTo(e,n){const l=n.zoom!==void 0,u=e.zoom,m=e.getConstrained(d.Q.convert(n.center||n.locationAtOffset),l?+n.zoom:u),y=m.center,b=m.zoom;Hs(e,y);const T=ta(e.worldSize,n.locationAtOffset),C=ta(e.worldSize,y).sub(T),z=C.mag(),B=d.ac(b-u);let k;if(n.minZoom!==void 0){const Z=Math.min(+n.minZoom,u,b),G=e.getConstrained(y,Z).zoom;k=d.ac(G-u)}return{easeFunc:(Z,G,te,ee)=>{e.setZoom(Z===1?b:u+d.ah(G));const ie=Z===1?y:Za(e.worldSize,T.add(C.mult(te)).mult(G));e.setLocationAtPoint(e.renderWorldCopies?ie.wrap():ie,ee)},scaleOfZoom:B,targetCenter:y,scaleOfMinZoom:k,pixelPathLength:z}}}class Mi{constructor(e,n,l){this.blendFunction=e,this.blendColor=n,this.mask=l}}Mi.Replace=[1,0],Mi.disabled=new Mi(Mi.Replace,d.b7.transparent,[!1,!1,!1,!1]),Mi.unblended=new Mi(Mi.Replace,d.b7.transparent,[!0,!0,!0,!0]),Mi.alphaBlended=new Mi([1,771],d.b7.transparent,[!0,!0,!0,!0]);const qi=2305;class ri{constructor(e,n,l){this.enable=e,this.mode=n,this.frontFace=l}}ri.disabled=new ri(!1,1029,qi),ri.backCCW=new ri(!0,1029,qi),ri.frontCCW=new ri(!0,1028,qi);class $t{constructor(e,n,l){this.func=e,this.mask=n,this.range=l}}$t.ReadOnly=!1,$t.ReadWrite=!0,$t.disabled=new $t(519,$t.ReadOnly,[0,1]);const ls=7680;class Jt{constructor(e,n,l,u,m,y){this.test=e,this.ref=n,this.mask=l,this.fail=u,this.depthFail=m,this.pass=y}}Jt.disabled=new Jt({func:519,mask:0},0,0,ls,ls,ls);const na=new WeakMap;function bn(f){var e;if(na.has(f))return na.get(f);{const n=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return na.set(f,n),n}}class _l{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const n=e.context,l=n.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const u=new d.aI;u.emplaceBack(-1,-1),u.emplaceBack(2,-1),u.emplaceBack(-1,2);const m=new d.aK;m.emplaceBack(0,1,2),this._fullscreenTriangle=new vo(n.createVertexBuffer(u,ia.members),n.createIndexBuffer(m),d.aJ.simpleSegment(0,0,u.length,m.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(l.TEXTURE1);const y=l.createTexture();l.bindTexture(l.TEXTURE_2D,y),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(y),bn(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){const l=this._cachedRenderContext.context,u=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:d.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,u.TRIANGLES,$t.disabled,Jt.disabled,Mi.unblended,ri.disabled,((m,y)=>({u_input:m,u_output_expected:y}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&bn(u)){u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null);const m=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);u.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&bn(e)){const n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return d.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=_l._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}const wo=d.Z/128;function cc(f,e){const n=f.granularity!==void 0?Math.max(f.granularity,1):1,l=n+(f.generateBorders?2:0),u=n+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),m=l+1,y=u+1,b=f.generateBorders?-1:0,T=f.generateBorders||f.extendToNorthPole?-1:0,C=n+(f.generateBorders?1:0),z=n+(f.generateBorders||f.extendToSouthPole?1:0),B=m*y,k=l*u*6,Z=m*y>65536;if(Z&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const G=Z||e==="32bit",te=new Int16Array(2*B);let ee=0;for(let de=T;de<=z;de++)for(let he=b;he<=C;he++){let me=he/n*d.Z;he===-1&&(me=-64),he===n+1&&(me=d.Z+wo);let xe=de/n*d.Z;de===-1&&(xe=f.extendToNorthPole?d.b9:-64),de===n+1&&(xe=f.extendToSouthPole?d.ba:d.Z+wo),te[ee++]=me,te[ee++]=xe}const ie=G?new Uint32Array(k):new Uint16Array(k);let oe=0;for(let de=0;de<u;de++)for(let he=0;he<l;he++){const me=he+1+de*m,xe=he+(de+1)*m,_e=he+1+(de+1)*m;ie[oe++]=he+de*m,ie[oe++]=xe,ie[oe++]=me,ie[oe++]=me,ie[oe++]=xe,ie[oe++]=_e}return{vertices:te.buffer.slice(0),indices:ie.buffer.slice(0),uses32bitIndices:G}}const $s=new d.aH({fill:new d.bb(128,2),line:new d.bb(512,0),tile:new d.bb(128,32),stencil:new d.bb(128,1),circle:3});class To{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return ba.projectionGlobe}get vertexShaderPreludeCode(){return ba.projectionMercator.vertexSource}get subdivisionGranularity(){return $s}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new _l(e));const n=d.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,u=this._errorMeasurement.updateErrorLoop(n,l),m=Se.now();u!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=u,this._errorMeasurementLastChangeTime=m);const y=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=d.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,d.bd(y))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,l,u,m){const y=(m==="stencil"?$s.stencil:$s.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:y,generateBorders:l,extendToNorthPole:n.y===0&&u,extendToSouthPole:n.y===(1<<n.z)-1&&u})}_getMesh(e,n){const l=this._getMeshKey(n);if(l in this._tileMeshCache)return this._tileMeshCache[l];const u=function(m,y){const b=cc(y,"16bit"),T=d.aI.deserialize({arrayBuffer:b.vertices,length:b.vertices.byteLength/2/2}),C=d.aK.deserialize({arrayBuffer:b.indices,length:b.indices.byteLength/2/3});return new vo(m.createVertexBuffer(T,ia.members),m.createIndexBuffer(C),d.aJ.simpleSegment(0,0,T.length,C.length))}(e,n);return this._tileMeshCache[l]=u,u}recalculate(e){}hasTransition(){const e=Se.now();let n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const So=new d.r({type:new d.D(d.v.projection.type)});class Mo extends d.E{constructor(e){super(),this._transitionable=new d.T(So),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.C(0)),this._mercatorProjection=new qs,this._verticalPerspectiveProjection=new To}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof d.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,l,u,m){return this.currentProjection.getMeshFromTileID(e,n,l,u,m)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function yl(f){const e=Co(f.worldSize,f.center.lat);return 2*Math.PI*e}function Eo(f,e,n,l,u){const m=1/(1<<u),y=e/d.Z*m+l*m,b=d.bg((f/d.Z*m+n*m)*Math.PI*2+Math.PI,2*Math.PI),T=2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI,C=Math.cos(T),z=new Float64Array(3);return z[0]=Math.sin(b)*C,z[1]=Math.sin(T),z[2]=Math.cos(b)*C,z}function Yn(f){return function(e,n){const l=Math.cos(n),u=new Float64Array(3);return u[0]=Math.sin(e)*l,u[1]=Math.sin(n),u[2]=Math.cos(e)*l,u}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function Co(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Ao(f){const e=Math.asin(f[1])/Math.PI*180,n=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(n>1e-6){const l=f[0]/n,u=Math.acos(f[2]/n),m=(l>0?u:-u)/Math.PI*180;return new d.Q(d.aL(m,-180,180),e)}return new d.Q(0,e)}function Xs(f){return Math.cos(f*Math.PI/180)}function Kn(f,e){const n=Xs(f),l=Xs(e);return d.ah(l/n)}function Qc(f,e){const n=f.rotate(e.bearingInRadians),l=e.zoom+Kn(e.center.lat,0),u=d.bc(1/Xs(e.center.lat),1/Xs(Math.min(Math.abs(e.center.lat),60)),d.bf(l,7,3,0,1)),m=360/yl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new d.Q(e.center.lng-n.x*m*u,d.ae(e.center.lat+n.y*m,-85.051129,d.af))}function Wc(f){const e=.5*f,n=Math.sin(e),l=Math.cos(e);return Math.log(n+l)-Math.log(l-n)}function Nh(f,e,n,l){const u=f.lat+n*l;if(Math.abs(n)>1){const m=(Math.sign(f.lat+n)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,y=Math.abs(f.lat+n)*Math.PI/180,b=Wc(m+l*(y-m)),T=Wc(m),C=Wc(y);return new d.Q(f.lng+e*((b-T)/(C-T)),u)}return new d.Q(f.lng+e*l,u)}class Uh{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,l,u){const m=`${e.z}_${e.x}_${e.y}`,y=this._cache.get(m);if(y)return y;const b=this._cachePrevious.get(m);if(b)return this._cache.set(m,b),b;const T=this._aabbFactory(e,n,l,u);return this._cache.set(m,T),this._hadAnyChanges=!0,T}}function la(f,e,n){const l=f-e;return l<0?-l:Math.max(0,l-n)}function uc(f,e,n,l,u){const m=f-n;let y;return y=m<0?Math.min(-m,1+m-u):m>1?Math.min(Math.max(m-u,0),1-m):0,Math.max(y,la(e,l,u))}class Fr{constructor(){this._aabbCache=new Uh(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,l,u){const m=1<<l.z,y=1/m,b=l.x/m,T=l.y/m;let C=2;return C=Math.min(C,uc(e,n,b,T,y)),C=Math.min(C,uc(e,n,b+.5,-T-y,y)),C=Math.min(C,uc(e,n,b+.5,2-T-y,y)),C}getWrap(e,n,l){const u=1<<n.z,m=1/u,y=n.x/u,b=la(e.x,y,m),T=la(e.x,y-1,m),C=la(e.x,y+1,m),z=Math.min(b,T,C);return z===C?1:z===T?-1:0}allowVariableZoom(e,n){return De(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,l,u){return this._aabbCache.getTileAABB(e,n,l,u)}_computeTileAABB(e,n,l,u){if(e.z<=0)return new xn([-1,-1,-1],[1,1,1]);if(e.z===1)return new xn([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const m=[Eo(0,0,e.x,e.y,e.z),Eo(d.Z,0,e.x,e.y,e.z),Eo(d.Z,d.Z,e.x,e.y,e.z),Eo(0,d.Z,e.x,e.y,e.z)],y=[1,1,1],b=[-1,-1,-1];for(const T of m)for(let C=0;C<3;C++)y[C]=Math.min(y[C],T[C]),b[C]=Math.max(b[C],T[C]);if(e.y===0||e.y===(1<<e.z)-1){const T=[0,e.y===0?1:-1,0];for(let C=0;C<3;C++)y[C]=Math.min(y[C],T[C]),b[C]=Math.max(b[C],T[C])}return new xn(y,b)}}}class zo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=d.bk(),this._projectionMatrix=d.b1(),this._globeViewProjMatrix32f=d.b0(),this._globeViewProjMatrixNoCorrection=d.b1(),this._globeViewProjMatrixNoCorrectionInverted=d.b1(),this._globeProjMatrixInverted=d.b1(),this._cameraPosition=d.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new vn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new Fr}clone(){const e=new zo;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=d.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:n,applyGlobeMatrix:l}=e,u=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:u,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const n=this.pitchInRadians,l=this.cameraToCenterDistance/e,u=Math.sin(n)*l,m=Math.cos(n)*l+1,y=1/Math.sqrt(u*u+m*m)*1;let b=-u,T=m;const C=Math.sqrt(b*b+T*T);b/=C,T/=C;const z=[0,b,T];d.bl(z,z,[0,0,0],-this.bearingInRadians),d.bm(z,z,[0,0,0],-1*this.center.lat*Math.PI/180),d.bn(z,z,[0,0,0],this.center.lng*Math.PI/180);const B=1/d.bo(z);return d.aO(z,z,B),[...z,-y*B]}isLocationOccluded(e){return!this.isSurfacePointVisible(Yn(e))}transformLightDirection(e){const n=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,u=Math.cos(l),m=[Math.sin(n)*u,Math.sin(l),Math.cos(n)*u],y=[m[2],0,-m[0]],b=[0,0,0];d.aU(b,y,m),d.aT(y,y),d.aT(b,b);const T=[0,0,0];return d.aT(T,[y[0]*e[0]+b[0]*e[1]+m[0]*e[2],y[1]*e[0]+b[1]*e[1]+m[1]*e[2],y[2]*e[0]+b[2]*e[1]+m[2]*e[2]]),T}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,l){const u=function(b,T,C){const z=1/(1<<C.z);return new d.$(b/d.Z*z+C.x*z,T/d.Z*z+C.y*z)}(e,n,l.canonical),m=(y=u.y,[d.bg(u.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI]);var y;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,n,l,u){const m=l.canonical,y=Eo(e,n,m.x,m.y,m.z),b=1+(u?u(e,n):0)/d.bu,T=[y[0]*b,y[1]*b,y[2]*b,1];d.at(T,T,this._globeViewProjMatrixNoCorrection);const C=this._cachedClippingPlane,z=C[0]*y[0]+C[1]*y[1]+C[2]*y[2]+C[3]<0;return{point:new d.P(T[0]/T[3],T[1]/T[3]),signedDistanceFromCamera:T[3],isOccluded:z}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Co(this.worldSize,this.center.lat),n=d.b2(),l=d.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),d.aY(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const u=this.centerOffset;n[8]=2*-u.x/this._helper._width,n[9]=2*u.y/this._helper._height,this._projectionMatrix=d.aZ(n),this._globeProjMatrixInverted=d.b2(),d.an(this._globeProjMatrixInverted,n),d.L(n,n,[0,0,-this.cameraToCenterDistance]),d.a_(n,n,this.rollInRadians),d.a$(n,n,-this.pitchInRadians),d.a_(n,n,this.bearingInRadians),d.L(n,n,[0,0,-e]);const m=d.bh();m[0]=e,m[1]=e,m[2]=e,d.a$(l,n,this.center.lat*Math.PI/180),d.bp(l,l,-this.center.lng*Math.PI/180),d.M(l,l,m),this._globeViewProjMatrixNoCorrection=l,d.a$(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),d.bp(n,n,-this.center.lng*Math.PI/180),d.M(n,n,m),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=d.b2(),d.an(this._globeViewProjMatrixNoCorrectionInverted,l);const y=d.bh();this._cameraPosition=d.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,d.bl(this._cameraPosition,this._cameraPosition,y,-this.rollInRadians),d.bm(this._cameraPosition,this._cameraPosition,y,this.pitchInRadians),d.bl(this._cameraPosition,this._cameraPosition,y,-this.bearingInRadians),d.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),d.bm(this._cameraPosition,this._cameraPosition,y,-this.center.lat*Math.PI/180),d.bn(this._cameraPosition,this._cameraPosition,y,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const b=d.aZ(this._globeViewProjMatrixNoCorrectionInverted);d.M(b,b,[1,1,-1]),this._cachedFrustum=Ni.fromInvProjectionMatrix(b)}calculateFogMatrix(e){d.w("calculateFogMatrix is not supported on globe projection.");const n=d.b2();return d.ad(n),n}getVisibleUnwrappedCoordinates(e){return[new d.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&d.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Yn(e);d.aO(l,l,1+n/d.bu);const u=d.bk();return d.at(u,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),u[2]/u[3]}populateCache(e){}getBounds(){const e=.5*this.width,n=.5*this.height,l=[new d.P(0,0),new d.P(e,0),new d.P(this.width,0),new d.P(this.width,n),new d.P(this.width,this.height),new d.P(e,this.height),new d.P(0,this.height),new d.P(0,n)],u=[];for(const B of l)u.push(this.unprojectScreenPoint(B));let m=0,y=0,b=0,T=0;const C=this.center;for(const B of u){const k=d.bq(C.lng,B.lng),Z=d.bq(C.lat,B.lat);k<y&&(y=k),k>m&&(m=k),Z<T&&(T=Z),Z>b&&(b=Z)}const z=[C.lng+y,C.lat+T,C.lng+m,C.lat+b];return this.isSurfacePointOnScreen([0,1,0])&&(z[3]=90,z[0]=-180,z[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(z[1]=-90,z[0]=-180,z[2]=180),new zi(z)}getConstrained(e,n){const l=d.ae(e.lat,-85.051129,d.af),u=d.ae(+n,this.minZoom+Kn(0,l),this.maxZoom);return{center:new d.Q(e.lng,l),zoom:u}}calculateCenterFromCameraLngLatAlt(e,n,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,u)}setLocationAtPoint(e,n){const l=Yn(this.unprojectScreenPoint(n)),u=Yn(e),m=d.bh();d.br(m);const y=d.bh();d.bn(y,l,m,-this.center.lng*Math.PI/180),d.bm(y,y,m,this.center.lat*Math.PI/180);const b=u[0]*u[0]+u[2]*u[2],T=y[0]*y[0];if(b<T)return;const C=Math.sqrt(b-T),z=-C,B=d.bs(u[0],u[2],y[0],C),k=d.bs(u[0],u[2],y[0],z),Z=d.bh();d.bn(Z,u,m,-B);const G=d.bs(Z[1],Z[2],y[1],y[2]),te=d.bh();d.bn(te,u,m,-k);const ee=d.bs(te[1],te[2],y[1],y[2]),ie=.5*Math.PI,oe=G>=-ie&&G<=ie,de=ee>=-ie&&ee<=ie;let he,me;if(oe&&de){const $e=this.center.lng*Math.PI/180,je=this.center.lat*Math.PI/180;d.bv(B,$e)+d.bv(G,je)<d.bv(k,$e)+d.bv(ee,je)?(he=B,me=G):(he=k,me=ee)}else if(oe)he=B,me=G;else{if(!de)return;he=k,me=ee}const xe=he/Math.PI*180,_e=me/Math.PI*180,Ie=this.center.lat;this.setCenter(new d.Q(xe,d.ae(_e,-90,90))),this.setZoom(this.zoom+Kn(Ie,this.center.lat))}locationToScreenPoint(e,n){const l=Yn(e);if(n){const u=n.getElevationForLngLatZoom(e,this._helper._tileZoom);d.aO(l,l,1+u/d.bu)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const n=d.bk();return d.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new d.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){const l=n.pointCoordinate(e);if(l)return l}return d.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var l;return(l=this.screenPointToMercatorCoordinate(e,n))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,n){const l=this._cameraPosition,u=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,u)}getRayDirectionFromPixel(e){const n=d.bk();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,d.at(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const l=d.bh();l[0]=n[0]-this._cameraPosition[0],l[1]=n[1]-this._cameraPosition[1],l[2]=n[2]-this._cameraPosition[2];const u=d.bh();return d.aT(u,l),u}isSurfacePointVisible(e){const n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const n=d.bk();return d.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){const l=d.aV(e,n),u=d.bh(),m=d.bh();d.aO(m,n,l),d.aS(u,e,m);const y=1-d.aV(u,u);if(y<0)return null;const b=d.aV(e,e)-1,T=-l+(l<0?1:-1)*Math.sqrt(y),C=b/T,z=T;return{tMin:Math.min(C,z),tMax:Math.max(C,z)}}unprojectScreenPoint(e){const n=this._cameraPosition,l=this.getRayDirectionFromPixel(e),u=this.rayPlanetIntersection(n,l);if(u){const z=d.bh();d.aP(z,n,[l[0]*u.tMin,l[1]*u.tMin,l[2]*u.tMin]);const B=d.bh();return d.aT(B,z),Ao(B)}const m=this._cachedClippingPlane,y=m[0]*l[0]+m[1]*l[1]+m[2]*l[2],b=-d.bt(m,n)/y,T=d.bh();if(b>0)d.aP(T,n,[l[0]*b,l[1]*b,l[2]*b]);else{const z=d.bh();d.aP(z,n,[2*l[0],2*l[1],2*l[2]]);const B=d.bt(this._cachedClippingPlane,z);d.aS(T,z,[this._cachedClippingPlane[0]*B,this._cachedClippingPlane[1]*B,this._cachedClippingPlane[2]*B])}const C=function(z){const B=d.bh();return B[0]=z[0]*-z[3],B[1]=z[1]*-z[3],B[2]=z[2]*-z[3],{center:B,radius:Math.sqrt(1-z[3]*z[3])}}(m);return Ao(function(z,B,k){const Z=d.bh();d.aS(Z,k,z);const G=d.bh();return d.bi(G,z,Z,B/d.bj(Z)),G}(C.center,C.radius,T))}getMatrixForModel(e,n){const l=d.Q.convert(e),u=1/d.bu,m=d.b1();return d.bp(m,m,l.lng/180*Math.PI),d.a$(m,m,-l.lat/180*Math.PI),d.L(m,m,[0,0,1+n/d.bu]),d.a$(m,m,.5*Math.PI),d.M(m,m,[u,u,u]),m}getProjectionDataForCustomLayer(e=!0){const n=this.getProjectionData({overscaledTileID:new d.Y(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class Po{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,l=!0){this._helper.resize(e,n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new vn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new Or,this._verticalPerspectiveTransform=new zo}clone(){const e=new Po;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const n=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:n.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return d.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return d.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,l){const u=this._mercatorTransform.getPitchedTextCorrection(e,n,l),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,l);return d.bc(u,m,this._globeness)}projectTileCoordinates(e,n,l,u){return this.currentTransform.projectTileCoordinates(e,n,l,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,u)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=n.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class lr{get useGlobeControls(){return!0}handlePanInertia(e,n){const l=Qc(e,n);return Math.abs(l.lng-n.center.lng)>180&&(l.lng=n.center.lng+179.5*Math.sign(l.lng-n.center.lng)),{easingCenter:l,easingOffset:new d.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){const l=e.around,u=n.screenPointToLocation(l);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);const m=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);const y=n.zoom-m;if(y===0)return;const b=d.bq(n.center.lng,u.lng),T=b/(Math.abs(b/180)+1),C=d.bq(n.center.lat,u.lat),z=n.getRayDirectionFromPixel(l),B=n.cameraPosition,k=-1*d.aV(B,z),Z=d.bh();d.aP(Z,B,[z[0]*k,z[1]*k,z[2]*k]);const G=d.bo(Z)-1,te=Math.exp(.5*-Math.max(G-.3,0)),ee=Co(n.worldSize,n.center.lat)/Math.min(n.width,n.height),ie=d.bf(ee,.9,.5,1,.25),oe=(1-d.ac(-y))*Math.min(te,ie),de=n.center.lat,he=n.zoom,me=new d.Q(n.center.lng+T*oe,d.ae(n.center.lat+C*oe,-85.051129,d.af));n.setLocationAtPoint(u,l);const xe=n.center,_e=d.bf(Math.abs(b),45,85,0,1),Ie=d.bf(ee,.75,.35,0,1),$e=Math.pow(Math.max(_e,Ie),.25),je=d.bq(xe.lng,me.lng),Fe=d.bq(xe.lat,me.lat);n.setCenter(new d.Q(xe.lng+je*$e,xe.lat+Fe*$e).wrap()),n.setZoom(he+Kn(de,n.center.lat))}handleMapControlsPan(e,n,l){if(!e.panDelta)return;const u=n.center.lat,m=n.zoom;n.setCenter(Qc(e.panDelta,n).wrap()),n.setZoom(m+Kn(u,n.center.lat))}cameraForBoxAndBearing(e,n,l,u,m){const y=Xn(e,n,l,u,m),b=n.left/m.width*2-1,T=(m.width-n.right)/m.width*2-1,C=n.top/m.height*-2+1,z=(m.height-n.bottom)/m.height*-2+1,B=d.bq(l.getWest(),l.getEast())<0,k=B?l.getEast():l.getWest(),Z=B?l.getWest():l.getEast(),G=Math.max(l.getNorth(),l.getSouth()),te=Math.min(l.getNorth(),l.getSouth()),ee=k+.5*d.bq(k,Z),ie=G+.5*d.bq(G,te),oe=m.clone();oe.setCenter(y.center),oe.setBearing(y.bearing),oe.setPitch(0),oe.setRoll(0),oe.setZoom(y.zoom);const de=oe.modelViewProjectionMatrix,he=[Yn(l.getNorthWest()),Yn(l.getNorthEast()),Yn(l.getSouthWest()),Yn(l.getSouthEast()),Yn(new d.Q(Z,ie)),Yn(new d.Q(k,ie)),Yn(new d.Q(ee,G)),Yn(new d.Q(ee,te))],me=Yn(y.center);let xe=Number.POSITIVE_INFINITY;for(const _e of he)b<0&&(xe=lr.getLesserNonNegativeNonNull(xe,lr.solveVectorScale(_e,me,de,"x",b))),T>0&&(xe=lr.getLesserNonNegativeNonNull(xe,lr.solveVectorScale(_e,me,de,"x",T))),C>0&&(xe=lr.getLesserNonNegativeNonNull(xe,lr.solveVectorScale(_e,me,de,"y",C))),z<0&&(xe=lr.getLesserNonNegativeNonNull(xe,lr.solveVectorScale(_e,me,de,"y",z)));if(Number.isFinite(xe)&&xe!==0)return y.zoom=oe.zoom+d.ah(xe),y;dn()}handleJumpToCenterZoom(e,n){const l=e.center.lat,u=e.getConstrained(n.center?d.Q.convert(n.center):e.center,e.zoom).center;e.setCenter(u.wrap());const m=n.zoom!==void 0?+n.zoom:e.zoom+Kn(l,u.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,n){const l=e.zoom,u=e.center,m=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},b={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},T=n.zoom!==void 0,C=!e.isPaddingEqual(n.padding);let z=!1;const B=n.center?d.Q.convert(n.center):u,k=e.getConstrained(B,l).center;Hs(e,k);const Z=e.clone();Z.setCenter(k),Z.setZoom(T?+n.zoom:l+Kn(u.lat,B.lat)),Z.setBearing(n.bearing);const G=new d.P(d.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),d.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));Z.setLocationAtPoint(k,G);const te=(n.offset&&n.offsetAsPoint.mag())>0?Z.center:k,ee=T?+n.zoom:l+Kn(u.lat,te.lat),ie=l+Kn(u.lat,0),oe=ee+Kn(te.lat,0),de=d.bq(u.lng,te.lng),he=d.bq(u.lat,te.lat),me=d.ac(oe-ie);return z=ee!==l,{easeFunc:xe=>{if(d.b6(y,b)||wa({startEulerAngles:y,endEulerAngles:b,tr:e,k:xe,useSlerp:y.roll!=b.roll}),C&&e.interpolatePadding(m,n.padding,xe),n.around)d.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{const _e=oe>ie?Math.min(2,me):Math.max(.5,me),Ie=Math.pow(_e,1-xe),$e=Nh(u,de,he,xe*Ie);e.setCenter($e.wrap())}if(z){const _e=d.B.number(ie,oe,xe)+Kn(0,e.center.lat);e.setZoom(_e)}},isZooming:z,elevationCenter:te}}handleFlyTo(e,n){const l=n.zoom!==void 0,u=e.center,m=e.zoom,y=e.padding,b=!e.isPaddingEqual(n.padding),T=e.getConstrained(d.Q.convert(n.center||n.locationAtOffset),m).center,C=l?+n.zoom:e.zoom+Kn(e.center.lat,T.lat),z=e.clone();z.setCenter(T),z.setZoom(C),z.setBearing(n.bearing);const B=new d.P(d.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),d.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));z.setLocationAtPoint(T,B);const k=z.center;Hs(e,k);const Z=function(he,me,xe){const _e=Yn(me),Ie=Yn(xe),$e=d.aV(_e,Ie),je=Math.acos($e),Fe=yl(he);return je/(2*Math.PI)*Fe}(e,u,k),G=m+Kn(u.lat,0),te=C+Kn(k.lat,0),ee=d.ac(te-G);let ie;if(typeof n.minZoom=="number"){const he=+n.minZoom+Kn(k.lat,0),me=Math.min(he,G,te)+Kn(0,k.lat),xe=e.getConstrained(k,me).zoom+Kn(k.lat,0);ie=d.ac(xe-G)}const oe=d.bq(u.lng,k.lng),de=d.bq(u.lat,k.lat);return{easeFunc:(he,me,xe,_e)=>{const Ie=Nh(u,oe,de,xe);b&&e.interpolatePadding(y,n.padding,he);const $e=he===1?k:Ie;e.setCenter($e.wrap());const je=G+d.ah(me);e.setZoom(he===1?C:je+Kn(0,$e.lat))},scaleOfZoom:ee,targetCenter:k,scaleOfMinZoom:ie,pixelPathLength:Z}}static solveVectorScale(e,n,l,u,m){const y=u==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],b=[l[3],l[7],l[11],l[15]],T=e[0]*y[0]+e[1]*y[1]+e[2]*y[2],C=e[0]*b[0]+e[1]*b[1]+e[2]*b[2],z=n[0]*y[0]+n[1]*y[1]+n[2]*y[2],B=n[0]*b[0]+n[1]*b[1]+n[2]*b[2];return z+m*C===T+m*B||b[3]*(T-z)+y[3]*(B-C)+T*B==z*C?null:(z+y[3]-m*B-m*b[3])/(z-T-m*B+m*C)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class Do{constructor(e){this._globe=e,this._mercatorCameraHelper=new or,this._verticalPerspectiveCameraHelper=new lr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,l){this.currentHelper.handleMapControlsPan(e,n,l)}cameraForBoxAndBearing(e,n,l,u,m){return this.currentHelper.cameraForBoxAndBearing(e,n,l,u,m)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}const Jc=(f,e)=>d.x(f,e&&e.filter(n=>n.identifier!=="source.canvas")),Vh=d.bw();class Yu extends d.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new fi(Rt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new ni,this.imageManager.setEventedParent(this),this.glyphManager=new Ct(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new le(256,512),this.crossTileSymbolIndex=new gl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.by()),oa().on(ul,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const m=u.getSource();if(m&&m.vectorLayerIds)for(const y in this._layers){const b=this._layers[y];b.source===m.id&&this._validateLayer(b)}})}loadURL(e,n={},l){this.fire(new d.l("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;d.j(u,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,n,l)}).catch(y=>{this._loadStyleRequest=null,y&&!m.signal.aborted&&this.fire(new d.k(y))})}loadJSON(e,n={},l){this.fire(new d.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Se.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,l)}).catch(()=>{})}loadEmpty(){this.fire(new d.l("dataloading",{dataType:"style"})),this._load(Vh,{validate:!1})}_load(e,n,l){var u,m;const y=n.transformStyle?n.transformStyle(l,e):e;if(!n.validate||!Jc(this,d.y(y))){this._loaded=!0,this.stylesheet=y;for(const b in y.sources)this.addSource(b,y.sources[b],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Ke(this.stylesheet.light),this._setProjectionInternal(((u=this.stylesheet.projection)===null||u===void 0?void 0:u.type)||"mercator"),this.sky=new _t(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new d.l("data",{dataType:"style"})),this.fire(new d.l("style.load"))}}_createLayers(){const e=d.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of e){const l=d.bA(n);l.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=l}}_loadSprite(e,n=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,y,b,T){return d._(this,void 0,void 0,function*(){const C=Zt(m),z=b>1?"@2x":"",B={},k={};for(const{id:Z,url:G}of C){const te=y.transformRequest(di(G,z,".json"),"SpriteJSON");B[Z]=d.j(te,T);const ee=y.transformRequest(di(G,z,".png"),"SpriteImage");k[Z]=qt.getImage(ee,T)}return yield Promise.all([...Object.values(B),...Object.values(k)]),function(Z,G){return d._(this,void 0,void 0,function*(){const te={};for(const ee in Z){te[ee]={};const ie=Se.getImageCanvasContext((yield G[ee]).data),oe=(yield Z[ee]).data;for(const de in oe){const{width:he,height:me,x:xe,y:_e,sdf:Ie,pixelRatio:$e,stretchX:je,stretchY:Fe,content:Ze,textFitWidth:dt,textFitHeight:ut}=oe[de];te[ee][de]={data:null,pixelRatio:$e,sdf:Ie,stretchX:je,stretchY:Fe,content:Ze,textFitWidth:dt,textFitHeight:ut,spriteData:{width:he,height:me,x:xe,y:_e,context:ie}}}}return te})}(B,k)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const y in m){this._spritesImagesIds[y]=[];const b=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(T=>!(T in m)):[];for(const T of b)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in m[y]){const C=y==="default"?T:`${y}:${T}`;this._spritesImagesIds[y].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,m[y][T],!1):this.imageManager.addImage(C,m[y][T]),n&&(this._changedImages[C]=!0)}}}).catch(m=>{this._spriteRequest=null,u=m,this.fire(new d.k(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const l=e.sourceLayer;if(!l)return;const u=n.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new d.k(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?d.bB(l):l);const u=[];for(const m of e)if(l[m]){const y=n?d.bB(l[m]):l[m];u.push(y)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const n=Object.keys(this._layers);for(const l of n){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){var e,n,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const u=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(u.length||m.length)&&this._updateWorkerLayers(u,m);for(const y in this._updatedSources){const b=this._updatedSources[y];if(b==="reload")this._reloadSource(y);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const m=this.sourceCaches[u];l[u]=m.used,m.used=!1}for(const u of this._order){const m=this._layers[u];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const u in l){const m=this.sourceCaches[u];!!l[u]!=!!m.used&&m.fire(new d.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new d.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var l;this._checkLoaded();const u=this.serialize();if(e=n.transformStyle?n.transformStyle(u,e):e,((l=n.validate)===null||l===void 0||l)&&Jc(this,d.y(e)))return!1;(e=d.bB(e)).layers=d.bz(e.layers);const m=d.bC(u,e),y=this._getOperationsToPerform(m);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const b of y.operations)b();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const n=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":n.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":n.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,u.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setSky":n.push(()=>this.setSky.apply(this,u.args));break;case"setProjection":this.setProjection.apply(this,u.args);break;case"setTransition":n.push(()=>{});break;default:l.push(u.command)}return{operations:n,unimplemented:l}}addImage(e,n){if(this.getImage(e))return this.fire(new d.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new d.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(d.y.source,`sources.${e}`,n,null,l))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const u=this.sourceCaches[e]=new ze(e,n,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new d.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new d.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new d.k(new Error(`Layer "${u}" already exists on this map.`)));let m;if(e.type==="custom"){if(Jc(this,d.bD(e)))return;m=d.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=d.bB(e),e=d.e(e,{source:u})),this._validate(d.y.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;m=d.bA(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:u}})}const y=n?this._order.indexOf(n):this._order.length;if(n&&y===-1)this.fire(new d.k(new Error(`Cannot add layer "${u}" before non-existing layer "${n}".`)));else{if(this._order.splice(y,0,u),this._layerOrderChanged=!0,this._layers[u]=m,this._removedLayers[u]&&m.source&&m.type!=="custom"){const b=this._removedLayers[u];delete this._removedLayers[u],b.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new d.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=n?this._order.indexOf(n):this._order.length;n&&u===-1?this.fire(new d.k(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new d.k(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===n&&u.maxzoom===l||(n!=null&&(u.minzoom=n),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new d.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!d.bE(u.filter,n))return n==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(d.y.filter,`layers.${u.id}.filter`,n,null,l)||(u.filter=d.bB(n),this._updateLayer(u)))}else this.fire(new d.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return d.bB(this.getLayer(e).filter)}setLayoutProperty(e,n,l,u={}){this._checkLoaded();const m=this.getLayer(e);m?d.bE(m.getLayoutProperty(n),l)||(m.setLayoutProperty(n,l,u),this._updateLayer(m)):this.fire(new d.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const l=this.getLayer(e);if(l)return l.getLayoutProperty(n);this.fire(new d.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,l,u={}){this._checkLoaded();const m=this.getLayer(e);m?d.bE(m.getPaintProperty(n),l)||(m.setPaintProperty(n,l,u)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new d.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const l=e.source,u=e.sourceLayer,m=this.sourceCaches[l];if(m===void 0)return void this.fire(new d.k(new Error(`The source '${l}' does not exist in the map's style.`)));const y=m.getSource().type;y==="geojson"&&u?this.fire(new d.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||u?(e.id===void 0&&this.fire(new d.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(u,e.id,n)):this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new d.k(new Error(`The source '${l}' does not exist in the map's style.`)));const m=u.getSource().type,y=m==="vector"?e.sourceLayer:void 0;m!=="vector"||y?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new d.k(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(y,e.id,n):this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,l=e.sourceLayer,u=this.sourceCaches[n];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new d.k(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.k(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=d.bF(this.sourceCaches,m=>m.serialize()),n=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return d.bG({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:e,layers:n,terrain:l},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const n=y=>this._layers[y].type==="fill-extrusion",l={},u=[];for(let y=this._order.length-1;y>=0;y--){const b=this._order[y];if(n(b)){l[b]=y;for(const T of e){const C=T[b];if(C)for(const z of C)u.push(z)}}}u.sort((y,b)=>b.intersectionZ-y.intersectionZ);const m=[];for(let y=this._order.length-1;y>=0;y--){const b=this._order[y];if(n(b))for(let T=u.length-1;T>=0;T--){const C=u[T].feature;if(l[C.layer.id]<y)break;m.push(C),u.pop()}else for(const T of e){const C=T[b];if(C)for(const z of C)m.push(z.feature)}}return m}queryRenderedFeatures(e,n,l){n&&n.filter&&this._validate(d.y.filter,"queryRenderedFeatures.filter",n.filter,null,n);const u={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new d.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const C of n.layers){const z=this._layers[C];if(!z)return this.fire(new d.k(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];u[z.source]=!0}}const m=[];n.availableImages=this._availableImages;const y=this._serializedAllLayers(),b=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,T=Object.assign(Object.assign({},n),{layers:b});for(const C in this.sourceCaches)n.layers&&!u[C]||m.push(rn(this.sourceCaches[C],this._layers,y,e,T,l,this.map.terrain?(z,B,k)=>this.map.terrain.getElevation(z,B,k):void 0));return this.placement&&m.push(function(C,z,B,k,Z,G,te){const ee={},ie=G.queryRenderedSymbols(k),oe=[];for(const de of Object.keys(ie).map(Number))oe.push(te[de]);oe.sort(Ii);for(const de of oe){const he=de.featureIndex.lookupSymbolFeatures(ie[de.bucketInstanceId],z,de.bucketIndex,de.sourceLayerIndex,Z.filter,Z.layers,Z.availableImages,C);for(const me in he){const xe=ee[me]=ee[me]||[],_e=he[me];_e.sort((Ie,$e)=>{const je=de.featureSortOrder;if(je){const Fe=je.indexOf(Ie.featureIndex);return je.indexOf($e.featureIndex)-Fe}return $e.featureIndex-Ie.featureIndex});for(const Ie of _e)xe.push(Ie)}}return function(de,he,me){for(const xe in de)for(const _e of de[xe])sn(_e,me[he[xe].source]);return de}(ee,C,B)}(this._layers,y,this.sourceCaches,e,T,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,n){n&&n.filter&&this._validate(d.y.filter,"querySourceFeatures.filter",n.filter,null,n);const l=this.sourceCaches[e];return l?function(u,m){const y=u.getRenderableIds().map(C=>u.getTileByID(C)),b=[],T={};for(let C=0;C<y.length;C++){const z=y[C],B=z.tileID.canonical.key;T[B]||(T[B]=!0,z.querySourceFeatures(b,m))}return b}(l,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const y in e)if(!d.bE(e[y],l[y])){u=!0;break}if(!u)return;const m={now:Se.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const y in e)if(!d.bE(e[y],l[y])){u=!0;break}if(!u)return;const m={now:Se.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(m)}_setProjectionInternal(e){const n=function(l){if(Array.isArray(l)){const u=new Mo({type:l});return{projection:u,transform:new Po,cameraHelper:new Do(u)}}switch(l){case"mercator":return{projection:new qs,transform:new Or,cameraHelper:new or};case"globe":{const u=new Mo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:u,transform:new Po,cameraHelper:new Do(u)}}case"vertical-perspective":return{projection:new To,transform:new zo,cameraHelper:new lr};default:return d.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new qs,transform:new Or,cameraHelper:new or}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,n,l,u,m={}){return(!m||m.validate!==!1)&&Jc(this,e.call(d.y,d.e({key:n,style:this.serialize(),value:l,styleSpec:d.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),oa().off(ul,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const l=this.sourceCaches[n];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,l,u,m=!1){let y=!1,b=!1;const T={};for(const C of this._order){const z=this._layers[C];if(z.type!=="symbol")continue;if(!T[z.source]){const k=this.sourceCaches[z.source];T[z.source]=k.getRenderableIds(!0).map(Z=>k.getTileByID(Z)).sort((Z,G)=>G.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(G.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(z,T[z.source],e.center.lng);y=y||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Se.now(),e.zoom))&&(this.pauseablePlacement=new Kc(e,this.map.terrain,this._order,m,n,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Se.now()),b=!0),y&&this.pauseablePlacement.placement.setStale()),b||y)for(const C of this._order){const z=this._layers[C];z.type==="symbol"&&this.placement.updateLayerOpacities(z,T[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Se.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return d._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[n.source];return u&&u.setDependencies(n.tileID.key,n.type,n.icons),l})}getGlyphs(e,n){return d._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(n.stacks),u=this.sourceCaches[n.source];return u&&u.setDependencies(n.tileID.key,n.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(d.y.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,l={},u){this._checkLoaded();const m=[{id:e,url:n}],y=[...Zt(this.stylesheet.sprite),...m];this._validate(d.y.sprite,"sprite",y,null,l)||(this.stylesheet.sprite=y,this._loadSprite(m,!0,u))}removeSprite(e){this._checkLoaded();const n=Zt(this.stylesheet.sprite);if(n.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;n.splice(n.findIndex(l=>l.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}else this.fire(new d.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Zt(this.stylesheet.sprite)}setSprite(e,n={},l){this._checkLoaded(),e&&this._validate(d.y.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Wd=d.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Jd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,l,u,m,y,b,T,C){this.context=e;let z=this.boundPaintVertexBuffers.length!==u.length;for(let B=0;!z&&B<u.length;B++)this.boundPaintVertexBuffers[B]!==u[B]&&(z=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==l||z||this.boundIndexBuffer!==m||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==C?this.freshBind(n,l,u,m,y,b,T,C):(e.bindVertexArray.set(this.vao),b&&b.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind(),C&&C.bind())}freshBind(e,n,l,u,m,y,b,T){const C=e.numAttributes,z=this.context,B=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=T,n.enableAttributes(B,e);for(const k of l)k.enableAttributes(B,e);y&&y.enableAttributes(B,e),b&&b.enableAttributes(B,e),T&&T.enableAttributes(B,e),n.bind(),n.setVertexAttribPointers(B,e,m);for(const k of l)k.bind(),k.setVertexAttribPointers(B,e,m);y&&(y.bind(),y.setVertexAttribPointers(B,e,m)),u&&u.bind(),b&&(b.bind(),b.setVertexAttribPointers(B,e,m)),T&&(T.bind(),T.setVertexAttribPointers(B,e,m)),z.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ef=(f,e,n,l,u)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):d.b7.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:n?n.calculateFogBlendOpacity(l):0,u_horizon_color:n?n.properties.get("horizon-color"):d.b7.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0}),eu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function vl(f){const e=[];for(let n=0;n<f.length;n++){if(f[n]===null)continue;const l=f[n].split(" ");e.push(l.pop())}return e}class tu{constructor(e,n,l,u,m,y,b,T,C=[]){const z=e.gl;this.program=z.createProgram();const B=vl(n.staticAttributes),k=l?l.getBinderAttributes():[],Z=B.concat(k),G=ba.prelude.staticUniforms?vl(ba.prelude.staticUniforms):[],te=b.staticUniforms?vl(b.staticUniforms):[],ee=n.staticUniforms?vl(n.staticUniforms):[],ie=l?l.getBinderUniforms():[],oe=G.concat(te).concat(ee).concat(ie),de=[];for(const je of oe)de.indexOf(je)<0&&de.push(je);const he=l?l.defines():[];bn(z)&&he.unshift("#version 300 es"),m&&he.push("#define OVERDRAW_INSPECTOR;"),y&&he.push("#define TERRAIN3D;"),T&&he.push(T),C&&he.push(...C);let me=he.concat(ba.prelude.fragmentSource,b.fragmentSource,n.fragmentSource).join(`
`),xe=he.concat(ba.prelude.vertexSource,b.vertexSource,n.vertexSource).join(`
`);bn(z)||(me=function(je){return je.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(me),xe=function(je){return je.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(xe));const _e=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(_e,me),z.compileShader(_e),!z.getShaderParameter(_e,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(_e)}`);z.attachShader(this.program,_e);const Ie=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(Ie,xe),z.compileShader(Ie),!z.getShaderParameter(Ie,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(Ie)}`);z.attachShader(this.program,Ie),this.attributes={};const $e={};this.numAttributes=Z.length;for(let je=0;je<this.numAttributes;je++)Z[je]&&(z.bindAttribLocation(this.program,je,Z[je]),this.attributes[Z[je]]=je);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(Ie),z.deleteShader(_e);for(let je=0;je<de.length;je++){const Fe=de[je];if(Fe&&!$e[Fe]){const Ze=z.getUniformLocation(this.program,Fe);Ze&&($e[Fe]=Ze)}}this.fixedUniforms=u(e,$e),this.terrainUniforms=((je,Fe)=>({u_depth:new d.bH(je,Fe.u_depth),u_terrain:new d.bH(je,Fe.u_terrain),u_terrain_dim:new d.b8(je,Fe.u_terrain_dim),u_terrain_matrix:new d.bJ(je,Fe.u_terrain_matrix),u_terrain_unpack:new d.bK(je,Fe.u_terrain_unpack),u_terrain_exaggeration:new d.b8(je,Fe.u_terrain_exaggeration)}))(e,$e),this.projectionUniforms=((je,Fe)=>({u_projection_matrix:new d.bJ(je,Fe.u_projection_matrix),u_projection_tile_mercator_coords:new d.bK(je,Fe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new d.bK(je,Fe.u_projection_clipping_plane),u_projection_transition:new d.b8(je,Fe.u_projection_transition),u_projection_fallback_matrix:new d.bJ(je,Fe.u_projection_fallback_matrix)}))(e,$e),this.binderUniforms=l?l.getUniforms(e,$e):[]}draw(e,n,l,u,m,y,b,T,C,z,B,k,Z,G,te,ee,ie,oe,de){const he=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(m),e.setCullFace(y),T){e.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,T.depthTexture),e.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,T.texture);for(const xe in this.terrainUniforms)this.terrainUniforms[xe].set(T[xe])}if(C)for(const xe in C)this.projectionUniforms[eu[xe]].set(C[xe]);if(b)for(const xe in this.fixedUniforms)this.fixedUniforms[xe].set(b[xe]);ee&&ee.setUniforms(e,this.binderUniforms,G,{zoom:te});let me=0;switch(n){case he.LINES:me=2;break;case he.TRIANGLES:me=3;break;case he.LINE_STRIP:me=1}for(const xe of Z.get()){const _e=xe.vaos||(xe.vaos={});(_e[z]||(_e[z]=new Jd)).bind(e,this,B,ee?ee.getPaintVertexBuffers():[],k,xe.vertexOffset,ie,oe,de),he.drawElements(n,xe.primitiveLength*me,he.UNSIGNED_SHORT,xe.primitiveOffset*me*2)}}}function iu(f,e,n){const l=1/d.az(n,1,e.transform.tileZoom),u=Math.pow(2,n.tileID.overscaledZ),m=n.tileSize*Math.pow(2,e.transform.tileZoom)/u,y=m*(n.tileID.canonical.x+n.tileID.wrap*u),b=m*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}const nu=(f,e,n,l)=>{const u=f.style.light,m=u.properties.get("position"),y=[m.x,m.y,m.z],b=d.bN();u.properties.get("anchor")==="viewport"&&d.bO(b,f.transform.bearingInRadians),d.bP(y,y,b);const T=f.transform.transformLightDirection(y),C=u.properties.get("color");return{u_lightpos:y,u_lightpos_globe:T,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:l}},cr=(f,e,n,l,u,m,y)=>d.e(nu(f,e,n,l),iu(m,f,y),{u_height_factor:-Math.pow(2,u.overscaledZ)/y.tileSize/8}),xl=(f,e,n,l)=>d.e(iu(e,f,n),{u_fill_translate:l}),Ku=(f,e)=>({u_world:f,u_fill_translate:e}),bl=(f,e,n,l,u)=>d.e(xl(f,e,n,u),{u_world:l}),wl=(f,e,n,l,u)=>{const m=f.transform;let y,b,T=0;if(n.paint.get("circle-pitch-alignment")==="map"){const C=d.az(e,1,m.zoom);y=!0,b=[C,C],T=C/(d.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*u}else y=!1,b=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+y,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:b,u_globe_extrude_scale:T,u_translate:l}},Zh=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),hc=f=>({u_viewport_size:[f.width,f.height]}),Qu=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),ur=(f,e,n,l)=>{const u=d.az(f,1,e)/(d.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:d.az(f,1,e),u_intensity:n,u_globe_extrude_scale:u}},Gh=(f,e,n,l)=>{const u=d.K();d.bQ(u,0,f.width,f.height,0,0,1);const m=f.context.gl;return{u_matrix:u,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:n,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},qh=(f,e,n)=>{const l=n.paint.get("hillshade-accent-color");let u;switch(n.paint.get("hillshade-method")){case"basic":u=4;break;case"combined":u=1;break;case"igor":u=2;break;case"multidirectional":u=3;break;default:u=0}const m=n.getIlluminationProperties();for(let y=0;y<m.directionRadians.length;y++)n.paint.get("hillshade-illumination-anchor")==="viewport"&&(m.directionRadians[y]+=f.transform.bearingInRadians);return{u_image:0,u_latrange:Wu(0,e.tileID),u_exaggeration:n.paint.get("hillshade-exaggeration"),u_altitudes:m.altitudeRadians,u_azimuths:m.directionRadians,u_accent:l,u_method:u,u_highlights:m.highlightColor,u_shadows:m.shadowColor}},tf=(f,e)=>{const n=e.stride,l=d.K();return d.bQ(l,0,d.Z,-8192,0,0,1),d.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[n,n],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function Wu(f,e){const n=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new d.$(0,l/n).toLngLat().lat,new d.$(0,(l+1)/n).toLngLat().lat]}const Tl=(f,e,n,l)=>{const u=f.transform;return{u_translation:cs(f,e,n),u_ratio:l/d.az(e,1,u.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Sl=(f,e,n,l,u)=>d.e(Tl(f,e,n,l),{u_image:0,u_image_height:u}),Ml=(f,e,n,l,u)=>{const m=f.transform,y=El(e,m);return{u_translation:cs(f,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:l/d.az(e,1,m.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[y,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Hh=(f,e,n,l,u,m)=>{const y=f.lineAtlas,b=El(e,f.transform),T=n.layout.get("line-cap")==="round",C=y.getDash(u.from,T),z=y.getDash(u.to,T),B=C.width*m.fromScale,k=z.width*m.toScale;return d.e(Tl(f,e,n,l),{u_patternscale_a:[b/B,-C.height/2],u_patternscale_b:[b/k,-z.height/2],u_sdfgamma:y.width/(256*Math.min(B,k)*f.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:z.y,u_mix:m.t})};function El(f,e){return 1/d.az(f,1,e.tileZoom)}function cs(f,e,n){return d.aA(f.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Ju=(f,e,n,l,u)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(m=l.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:au(l.paint.get("raster-hue-rotate")),u_coords_top:[u[0].x,u[0].y,u[1].x,u[1].y],u_coords_bottom:[u[3].x,u[3].y,u[2].x,u[2].y]};var m,y};function au(f){f*=Math.PI/180;const e=Math.sin(f),n=Math.cos(f);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Ys=(f,e,n,l,u,m,y,b,T,C,z,B,k)=>{const Z=y.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:Z.width/Z.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_label_plane_matrix:b,u_coord_matrix:T,u_is_text:+z,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:m,u_texsize:B,u_texture:0,u_translation:C,u_pitched_scale:k}},eh=(f,e,n,l,u,m,y,b,T,C,z,B,k,Z)=>{const G=y.transform;return d.e(Ys(f,e,n,l,u,m,y,b,T,C,z,B,Z),{u_gamma_scale:l?Math.cos(G.pitch*Math.PI/180)*G.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:1})},dc=(f,e,n,l,u,m,y,b,T,C,z,B,k)=>d.e(eh(f,e,n,l,u,m,y,b,T,C,!0,z,0,k),{u_texsize_icon:B,u_texture_icon:1}),$h=(f,e)=>({u_opacity:f,u_color:e}),nf=(f,e,n,l,u)=>d.e(function(m,y,b,T){const C=b.imageManager.getPattern(m.from.toString()),z=b.imageManager.getPattern(m.to.toString()),{width:B,height:k}=b.imageManager.getPixelSize(),Z=Math.pow(2,T.tileID.overscaledZ),G=T.tileSize*Math.pow(2,b.transform.tileZoom)/Z,te=G*(T.tileID.canonical.x+T.tileID.wrap*Z),ee=G*T.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:C.tl,u_pattern_br_a:C.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[B,k],u_mix:y.t,u_pattern_size_a:C.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/d.az(T,1,b.transform.tileZoom),u_pixel_coord_upper:[te>>16,ee>>16],u_pixel_coord_lower:[65535&te,65535&ee]}}(n,u,e,l),{u_opacity:f}),th=(f,e)=>{},Xh={fillExtrusion:(f,e)=>({u_lightpos:new d.bL(f,e.u_lightpos),u_lightpos_globe:new d.bL(f,e.u_lightpos_globe),u_lightintensity:new d.b8(f,e.u_lightintensity),u_lightcolor:new d.bL(f,e.u_lightcolor),u_vertical_gradient:new d.b8(f,e.u_vertical_gradient),u_opacity:new d.b8(f,e.u_opacity),u_fill_translate:new d.bM(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new d.bL(f,e.u_lightpos),u_lightpos_globe:new d.bL(f,e.u_lightpos_globe),u_lightintensity:new d.b8(f,e.u_lightintensity),u_lightcolor:new d.bL(f,e.u_lightcolor),u_vertical_gradient:new d.b8(f,e.u_vertical_gradient),u_height_factor:new d.b8(f,e.u_height_factor),u_opacity:new d.b8(f,e.u_opacity),u_fill_translate:new d.bM(f,e.u_fill_translate),u_image:new d.bH(f,e.u_image),u_texsize:new d.bM(f,e.u_texsize),u_pixel_coord_upper:new d.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(f,e.u_pixel_coord_lower),u_scale:new d.bL(f,e.u_scale),u_fade:new d.b8(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new d.bM(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new d.bH(f,e.u_image),u_texsize:new d.bM(f,e.u_texsize),u_pixel_coord_upper:new d.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(f,e.u_pixel_coord_lower),u_scale:new d.bL(f,e.u_scale),u_fade:new d.b8(f,e.u_fade),u_fill_translate:new d.bM(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new d.bM(f,e.u_world),u_fill_translate:new d.bM(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new d.bM(f,e.u_world),u_image:new d.bH(f,e.u_image),u_texsize:new d.bM(f,e.u_texsize),u_pixel_coord_upper:new d.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(f,e.u_pixel_coord_lower),u_scale:new d.bL(f,e.u_scale),u_fade:new d.b8(f,e.u_fade),u_fill_translate:new d.bM(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new d.b8(f,e.u_camera_to_center_distance),u_scale_with_map:new d.bH(f,e.u_scale_with_map),u_pitch_with_map:new d.bH(f,e.u_pitch_with_map),u_extrude_scale:new d.bM(f,e.u_extrude_scale),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new d.b8(f,e.u_globe_extrude_scale),u_translate:new d.bM(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new d.bM(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new d.bM(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new d.bI(f,e.u_color),u_overlay:new d.bH(f,e.u_overlay),u_overlay_scale:new d.b8(f,e.u_overlay_scale)}),depth:th,clippingMask:th,heatmap:(f,e)=>({u_extrude_scale:new d.b8(f,e.u_extrude_scale),u_intensity:new d.b8(f,e.u_intensity),u_globe_extrude_scale:new d.b8(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new d.bJ(f,e.u_matrix),u_world:new d.bM(f,e.u_world),u_image:new d.bH(f,e.u_image),u_color_ramp:new d.bH(f,e.u_color_ramp),u_opacity:new d.b8(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new d.bH(f,e.u_image),u_latrange:new d.bM(f,e.u_latrange),u_exaggeration:new d.b8(f,e.u_exaggeration),u_altitudes:new d.bS(f,e.u_altitudes),u_azimuths:new d.bS(f,e.u_azimuths),u_accent:new d.bI(f,e.u_accent),u_method:new d.bH(f,e.u_method),u_shadows:new d.bR(f,e.u_shadows),u_highlights:new d.bR(f,e.u_highlights)}),hillshadePrepare:(f,e)=>({u_matrix:new d.bJ(f,e.u_matrix),u_image:new d.bH(f,e.u_image),u_dimension:new d.bM(f,e.u_dimension),u_zoom:new d.b8(f,e.u_zoom),u_unpack:new d.bK(f,e.u_unpack)}),line:(f,e)=>({u_translation:new d.bM(f,e.u_translation),u_ratio:new d.b8(f,e.u_ratio),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.bM(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new d.bM(f,e.u_translation),u_ratio:new d.b8(f,e.u_ratio),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.bM(f,e.u_units_to_pixels),u_image:new d.bH(f,e.u_image),u_image_height:new d.b8(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new d.bM(f,e.u_translation),u_texsize:new d.bM(f,e.u_texsize),u_ratio:new d.b8(f,e.u_ratio),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_image:new d.bH(f,e.u_image),u_units_to_pixels:new d.bM(f,e.u_units_to_pixels),u_scale:new d.bL(f,e.u_scale),u_fade:new d.b8(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new d.bM(f,e.u_translation),u_ratio:new d.b8(f,e.u_ratio),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.bM(f,e.u_units_to_pixels),u_patternscale_a:new d.bM(f,e.u_patternscale_a),u_patternscale_b:new d.bM(f,e.u_patternscale_b),u_sdfgamma:new d.b8(f,e.u_sdfgamma),u_image:new d.bH(f,e.u_image),u_tex_y_a:new d.b8(f,e.u_tex_y_a),u_tex_y_b:new d.b8(f,e.u_tex_y_b),u_mix:new d.b8(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new d.bM(f,e.u_tl_parent),u_scale_parent:new d.b8(f,e.u_scale_parent),u_buffer_scale:new d.b8(f,e.u_buffer_scale),u_fade_t:new d.b8(f,e.u_fade_t),u_opacity:new d.b8(f,e.u_opacity),u_image0:new d.bH(f,e.u_image0),u_image1:new d.bH(f,e.u_image1),u_brightness_low:new d.b8(f,e.u_brightness_low),u_brightness_high:new d.b8(f,e.u_brightness_high),u_saturation_factor:new d.b8(f,e.u_saturation_factor),u_contrast_factor:new d.b8(f,e.u_contrast_factor),u_spin_weights:new d.bL(f,e.u_spin_weights),u_coords_top:new d.bK(f,e.u_coords_top),u_coords_bottom:new d.bK(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new d.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bH(f,e.u_is_size_feature_constant),u_size_t:new d.b8(f,e.u_size_t),u_size:new d.b8(f,e.u_size),u_camera_to_center_distance:new d.b8(f,e.u_camera_to_center_distance),u_pitch:new d.b8(f,e.u_pitch),u_rotate_symbol:new d.bH(f,e.u_rotate_symbol),u_aspect_ratio:new d.b8(f,e.u_aspect_ratio),u_fade_change:new d.b8(f,e.u_fade_change),u_label_plane_matrix:new d.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.bJ(f,e.u_coord_matrix),u_is_text:new d.bH(f,e.u_is_text),u_pitch_with_map:new d.bH(f,e.u_pitch_with_map),u_is_along_line:new d.bH(f,e.u_is_along_line),u_is_variable_anchor:new d.bH(f,e.u_is_variable_anchor),u_texsize:new d.bM(f,e.u_texsize),u_texture:new d.bH(f,e.u_texture),u_translation:new d.bM(f,e.u_translation),u_pitched_scale:new d.b8(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new d.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bH(f,e.u_is_size_feature_constant),u_size_t:new d.b8(f,e.u_size_t),u_size:new d.b8(f,e.u_size),u_camera_to_center_distance:new d.b8(f,e.u_camera_to_center_distance),u_pitch:new d.b8(f,e.u_pitch),u_rotate_symbol:new d.bH(f,e.u_rotate_symbol),u_aspect_ratio:new d.b8(f,e.u_aspect_ratio),u_fade_change:new d.b8(f,e.u_fade_change),u_label_plane_matrix:new d.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.bJ(f,e.u_coord_matrix),u_is_text:new d.bH(f,e.u_is_text),u_pitch_with_map:new d.bH(f,e.u_pitch_with_map),u_is_along_line:new d.bH(f,e.u_is_along_line),u_is_variable_anchor:new d.bH(f,e.u_is_variable_anchor),u_texsize:new d.bM(f,e.u_texsize),u_texture:new d.bH(f,e.u_texture),u_gamma_scale:new d.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_is_halo:new d.bH(f,e.u_is_halo),u_translation:new d.bM(f,e.u_translation),u_pitched_scale:new d.b8(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new d.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bH(f,e.u_is_size_feature_constant),u_size_t:new d.b8(f,e.u_size_t),u_size:new d.b8(f,e.u_size),u_camera_to_center_distance:new d.b8(f,e.u_camera_to_center_distance),u_pitch:new d.b8(f,e.u_pitch),u_rotate_symbol:new d.bH(f,e.u_rotate_symbol),u_aspect_ratio:new d.b8(f,e.u_aspect_ratio),u_fade_change:new d.b8(f,e.u_fade_change),u_label_plane_matrix:new d.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.bJ(f,e.u_coord_matrix),u_is_text:new d.bH(f,e.u_is_text),u_pitch_with_map:new d.bH(f,e.u_pitch_with_map),u_is_along_line:new d.bH(f,e.u_is_along_line),u_is_variable_anchor:new d.bH(f,e.u_is_variable_anchor),u_texsize:new d.bM(f,e.u_texsize),u_texsize_icon:new d.bM(f,e.u_texsize_icon),u_texture:new d.bH(f,e.u_texture),u_texture_icon:new d.bH(f,e.u_texture_icon),u_gamma_scale:new d.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new d.b8(f,e.u_device_pixel_ratio),u_is_halo:new d.bH(f,e.u_is_halo),u_translation:new d.bM(f,e.u_translation),u_pitched_scale:new d.b8(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new d.b8(f,e.u_opacity),u_color:new d.bI(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new d.b8(f,e.u_opacity),u_image:new d.bH(f,e.u_image),u_pattern_tl_a:new d.bM(f,e.u_pattern_tl_a),u_pattern_br_a:new d.bM(f,e.u_pattern_br_a),u_pattern_tl_b:new d.bM(f,e.u_pattern_tl_b),u_pattern_br_b:new d.bM(f,e.u_pattern_br_b),u_texsize:new d.bM(f,e.u_texsize),u_mix:new d.b8(f,e.u_mix),u_pattern_size_a:new d.bM(f,e.u_pattern_size_a),u_pattern_size_b:new d.bM(f,e.u_pattern_size_b),u_scale_a:new d.b8(f,e.u_scale_a),u_scale_b:new d.b8(f,e.u_scale_b),u_pixel_coord_upper:new d.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new d.b8(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new d.bH(f,e.u_texture),u_ele_delta:new d.b8(f,e.u_ele_delta),u_fog_matrix:new d.bJ(f,e.u_fog_matrix),u_fog_color:new d.bI(f,e.u_fog_color),u_fog_ground_blend:new d.b8(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.b8(f,e.u_fog_ground_blend_opacity),u_horizon_color:new d.bI(f,e.u_horizon_color),u_horizon_fog_blend:new d.b8(f,e.u_horizon_fog_blend),u_is_globe_mode:new d.b8(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new d.b8(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new d.bH(f,e.u_texture),u_terrain_coords_id:new d.b8(f,e.u_terrain_coords_id),u_ele_delta:new d.b8(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new d.b8(f,e.u_input),u_output_expected:new d.b8(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new d.bL(f,e.u_sun_pos),u_atmosphere_blend:new d.b8(f,e.u_atmosphere_blend),u_globe_position:new d.bL(f,e.u_globe_position),u_globe_radius:new d.b8(f,e.u_globe_radius),u_inv_proj_matrix:new d.bJ(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new d.bI(f,e.u_sky_color),u_horizon_color:new d.bI(f,e.u_horizon_color),u_horizon:new d.bM(f,e.u_horizon),u_horizon_normal:new d.bM(f,e.u_horizon_normal),u_sky_horizon_blend:new d.b8(f,e.u_sky_horizon_blend),u_sky_blend:new d.b8(f,e.u_sky_blend)})};class Yh{constructor(e,n,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ih={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class La{constructor(e,n,l,u){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=u,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let l=0;l<this.attributes.length;l++){const u=n.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,n,l){for(let u=0;u<this.attributes.length;u++){const m=this.attributes[u],y=n.attributes[m.name];y!==void 0&&e.vertexAttribPointer(y,m.components,e[ih[m.type]],!1,this.itemSize,m.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class si{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jr extends si{getDefault(){return d.b7.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ru extends si{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class su extends si{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class ou extends si{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class lu extends si{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class nh extends si{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class hr extends si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class fc extends si{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class pc extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class ah extends si{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Kh extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class Io extends si{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Ro extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class rh extends si{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class sh extends si{getDefault(){return d.b7.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Nr extends si{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class mc extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class gc extends si{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class cu extends si{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ko extends si{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class uu extends si{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Cl extends si{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class $a extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class oh extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class hu extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Xa extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ks extends si{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ta extends si{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;const l=this.gl;bn(l)?l.bindVertexArray(e):(n=l.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Sa extends si{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Ur extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Al extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Lo extends si{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class us extends Lo{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Qs extends Lo{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Bo extends Lo{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const _c="Framebuffer is not complete";class ii{constructor(e,n,l,u,m){this.context=e,this.width=n,this.height=l;const y=e.gl,b=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new us(e,b),u)this.depthAttachment=m?new Bo(e,b):new Qs(e,b);else if(m)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error(_c)}destroy(){const e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class hs{constructor(e){var n,l;if(this.gl=e,this.clearColor=new jr(this),this.clearDepth=new ru(this),this.clearStencil=new su(this),this.colorMask=new ou(this),this.depthMask=new lu(this),this.stencilMask=new nh(this),this.stencilFunc=new hr(this),this.stencilOp=new fc(this),this.stencilTest=new pc(this),this.depthRange=new ah(this),this.depthTest=new Kh(this),this.depthFunc=new Io(this),this.blend=new Ro(this),this.blendFunc=new rh(this),this.blendColor=new sh(this),this.blendEquation=new Nr(this),this.cullFace=new mc(this),this.cullFaceSide=new gc(this),this.frontFace=new cu(this),this.program=new ko(this),this.activeTexture=new uu(this),this.viewport=new Cl(this),this.bindFramebuffer=new $a(this),this.bindRenderbuffer=new oh(this),this.bindTexture=new hu(this),this.bindVertexBuffer=new Xa(this),this.bindElementBuffer=new Ks(this),this.bindVertexArray=new Ta(this),this.pixelStoreUnpack=new Sa(this),this.pixelStoreUnpackPremultiplyAlpha=new Ur(this),this.pixelStoreUnpackFlipY=new Al(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),bn(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new Yh(this,e,n)}createVertexBuffer(e,n,l){return new La(this,e,n,l)}createRenderbuffer(e,n,l){const u=this.gl,m=u.createRenderbuffer();return this.bindRenderbuffer.set(m),u.renderbufferStorage(u.RENDERBUFFER,e,n,l),this.bindRenderbuffer.set(null),m}createFramebuffer(e,n,l,u){return new ii(this,e,n,l,u)}clear({color:e,depth:n,stencil:l}){const u=this.gl;let m=0;e&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l!==void 0&&(m|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){d.bE(e.blendFunction,Mi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return bn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return bn(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let du;function Ma(f,e,n,l,u){const m=f.context,y=f.transform,b=m.gl,T=f.useProgram("collisionBox"),C=[];let z=0,B=0;for(let ie=0;ie<l.length;ie++){const oe=l[ie],de=e.getTile(oe).getBucket(n);if(!de)continue;const he=u?de.textCollisionBox:de.iconCollisionBox,me=de.collisionCircleArray;me.length>0&&(C.push({circleArray:me,circleOffset:B,coord:oe}),z+=me.length/4,B=z),he&&T.draw(m,b.LINES,$t.disabled,Jt.disabled,f.colorModeForRenderPass(),ri.disabled,Zh(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(oe),y.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,f.transform.zoom,null,null,he.collisionVertexBuffer)}if(!u||!C.length)return;const k=f.useProgram("collisionCircle"),Z=new d.bT;Z.resize(4*z),Z._trim();let G=0;for(const ie of C)for(let oe=0;oe<ie.circleArray.length/4;oe++){const de=4*oe,he=ie.circleArray[de+0],me=ie.circleArray[de+1],xe=ie.circleArray[de+2],_e=ie.circleArray[de+3];Z.emplace(G++,he,me,xe,_e,0),Z.emplace(G++,he,me,xe,_e,1),Z.emplace(G++,he,me,xe,_e,2),Z.emplace(G++,he,me,xe,_e,3)}(!du||du.length<2*z)&&(du=function(ie){const oe=2*ie,de=new d.bV;de.resize(oe),de._trim();for(let he=0;he<oe;he++){const me=6*he;de.uint16[me+0]=4*he+0,de.uint16[me+1]=4*he+1,de.uint16[me+2]=4*he+2,de.uint16[me+3]=4*he+2,de.uint16[me+4]=4*he+3,de.uint16[me+5]=4*he+0}return de}(z));const te=m.createIndexBuffer(du,!0),ee=m.createVertexBuffer(Z,d.bU.members,!0);for(const ie of C){const oe=hc(f.transform);k.draw(m,b.TRIANGLES,$t.disabled,Jt.disabled,f.colorModeForRenderPass(),ri.disabled,oe,f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie.coord),null,n.id,ee,te,d.aJ.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,f.transform.zoom,null,null,null)}ee.destroy(),te.destroy()}const Oo=d.ad(new Float32Array(16));function ds(f,e,n,l,u,m){const{horizontalAlign:y,verticalAlign:b}=d.aE(f);return new d.P((-(y-.5)*e/u+l[0])*m,(-(b-.5)*n/u+l[1])*m)}function Qh(f,e,n,l,u,m){const y=e.tileAnchorPoint.add(new d.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let b=l.mult(m);n||(b=b.rotate(-u));const T=y.add(b);return Ve(T.x,T.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){const b=ji(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),T=Math.atan(b.y/b.x)+(b.x<0?Math.PI:0);return f.add(l.rotate(T))}return f.add(l)}function yc(f,e,n,l,u,m,y,b,T,C,z,B){const k=f.text.placedSymbolArray,Z=f.text.dynamicLayoutVertexArray,G=f.icon.dynamicLayoutVertexArray,te={};Z.clear();for(let ee=0;ee<k.length;ee++){const ie=k.get(ee),oe=ie.hidden||!ie.crossTileID||f.allowVerticalPlacement&&!ie.placedOrientation?null:l[ie.crossTileID];if(oe){const de=new d.P(ie.anchorX,ie.anchorY),he={getElevation:B,width:u.width,height:u.height,pitchedLabelPlaneMatrix:m,pitchWithMap:n,transform:u,tileAnchorPoint:de,translation:C,unwrappedTileID:z},me=n?Ft(de.x,de.y,he):ji(de.x,de.y,he),xe=yi(u.cameraToCenterDistance,me.signedDistanceFromCamera);let _e=d.am(f.textSizeData,b,ie)*xe/d.ay;n&&(_e*=f.tilePixelRatio/y);const{width:Ie,height:$e,anchor:je,textOffset:Fe,textBoxScale:Ze}=oe,dt=ds(je,Ie,$e,Fe,Ze,_e),ut=u.getPitchedTextCorrection(de.x+C[0],de.y+C[1],z),et=Qh(me.point,he,e,dt,-u.bearingInRadians,ut),Mt=f.allowVerticalPlacement&&ie.placedOrientation===d.al.vertical?Math.PI/2:0;for(let ei=0;ei<ie.numGlyphs;ei++)d.as(Z,et,Mt);T&&ie.associatedIconIndex>=0&&(te[ie.associatedIconIndex]={shiftedAnchor:et,angle:Mt})}else os(ie.numGlyphs,Z)}if(T){G.clear();const ee=f.icon.placedSymbolArray;for(let ie=0;ie<ee.length;ie++){const oe=ee.get(ie);if(oe.hidden)os(oe.numGlyphs,G);else{const de=te[ie];if(de)for(let he=0;he<oe.numGlyphs;he++)d.as(G,de.shiftedAnchor,de.angle);else os(oe.numGlyphs,G)}}f.icon.dynamicLayoutVertexBuffer.updateData(G)}f.text.dynamicLayoutVertexBuffer.updateData(Z)}function Fo(f,e,n){return n.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function zl(f,e,n,l,u,m,y,b,T,C,z,B,k){const Z=f.context,G=Z.gl,te=f.transform,ee=b==="map",ie=T==="map",oe=b!=="viewport"&&n.layout.get("symbol-placement")!=="point",de=ee&&!ie&&!oe,he=!n.layout.get("symbol-sort-key").isConstant();let me=!1;const xe=f.getDepthModeForSublayer(0,$t.ReadOnly),_e=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ie=[],$e=te.getCircleRadiusCorrection();for(const je of l){const Fe=e.getTile(je),Ze=Fe.getBucket(n);if(!Ze)continue;const dt=u?Ze.text:Ze.icon;if(!dt||!dt.segments.get().length||!dt.hasVisibleVertices)continue;const ut=dt.programConfigurations.get(n.id),et=u||Ze.sdfIcons,Mt=u?Ze.textSizeData:Ze.iconSizeData,ei=ie||te.pitch!==0,oi=f.useProgram(Fo(et,u,Ze),ut),tn=d.ak(Mt,te.zoom),Pi=f.style.map.terrain&&f.style.map.terrain.getTerrainData(je);let nn,Hi,Bi,bi,Pn=[0,0],Vn=null;if(u)Hi=Fe.glyphAtlasTexture,Bi=G.LINEAR,nn=Fe.glyphAtlasTexture.size,Ze.iconsInText&&(Pn=Fe.imageAtlasTexture.size,Vn=Fe.imageAtlasTexture,bi=ei||f.options.rotating||f.options.zooming||Mt.kind==="composite"||Mt.kind==="camera"?G.LINEAR:G.NEAREST);else{const pn=n.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear;Hi=Fe.imageAtlasTexture,Bi=et||f.options.rotating||f.options.zooming||pn||ei?G.LINEAR:G.NEAREST,nn=Fe.imageAtlasTexture.size}const Wn=d.az(Fe,1,f.transform.zoom),Ti=zt(ee,f.transform,Wn),Wr=d.K();d.an(Wr,Ti);const Cr=Ot(ie,ee,f.transform,Wn),ws=d.aA(te,Fe,m,y),Ts=te.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),Fl=_e&&Ze.hasTextData(),Ss=n.layout.get("icon-text-fit")!=="none"&&Fl&&Ze.hasIconData();if(oe){const pn=f.style.map.terrain?(pa,Di)=>f.style.map.terrain.getElevation(je,pa,Di):null,Dn=n.layout.get("text-rotation-alignment")==="map";vi(Ze,f,u,Ti,Wr,ie,C,Dn,je.toUnwrapped(),te.width,te.height,ws,pn)}const $o=u&&_e||Ss,Qa=oe||$o?Oo:ie?Ti:f.transform.clipSpaceToPixelsMatrix,Ms=et&&n.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Wa;Wa=et?Ze.iconsInText?dc(Mt.kind,tn,de,ie,oe,$o,f,Qa,Cr,ws,nn,Pn,$e):eh(Mt.kind,tn,de,ie,oe,$o,f,Qa,Cr,ws,u,nn,0,$e):Ys(Mt.kind,tn,de,ie,oe,$o,f,Qa,Cr,ws,u,nn,$e);const Jr={program:oi,buffers:dt,uniformValues:Wa,projectionData:Ts,atlasTexture:Hi,atlasTextureIcon:Vn,atlasInterpolation:Bi,atlasInterpolationIcon:bi,isSDF:et,hasHalo:Ms};if(he&&Ze.canOverlap){me=!0;const pn=dt.segments.get();for(const Dn of pn)Ie.push({segments:new d.aJ([Dn]),sortKey:Dn.sortKey,state:Jr,terrainData:Pi})}else Ie.push({segments:dt.segments,sortKey:0,state:Jr,terrainData:Pi})}me&&Ie.sort((je,Fe)=>je.sortKey-Fe.sortKey);for(const je of Ie){const Fe=je.state;if(Z.activeTexture.set(G.TEXTURE0),Fe.atlasTexture.bind(Fe.atlasInterpolation,G.CLAMP_TO_EDGE),Fe.atlasTextureIcon&&(Z.activeTexture.set(G.TEXTURE1),Fe.atlasTextureIcon&&Fe.atlasTextureIcon.bind(Fe.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),Fe.isSDF){const Ze=Fe.uniformValues;Fe.hasHalo&&(Ze.u_is_halo=1,jo(Fe.buffers,je.segments,n,f,Fe.program,xe,z,B,Ze,Fe.projectionData,je.terrainData)),Ze.u_is_halo=0}jo(Fe.buffers,je.segments,n,f,Fe.program,xe,z,B,Fe.uniformValues,Fe.projectionData,je.terrainData)}}function jo(f,e,n,l,u,m,y,b,T,C,z){const B=l.context;u.draw(B,B.gl.TRIANGLES,m,y,b,ri.backCCW,T,z,C,n.id,f.layoutVertexBuffer,f.indexBuffer,e,n.paint,l.transform.zoom,f.programConfigurations.get(n.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function fs(f,e,n,l,u){const m=f.context,y=m.gl,b=Jt.disabled,T=new Mi([y.ONE,y.ONE],d.b7.transparent,[!0,!0,!0,!0]),C=e.getBucket(n);if(!C)return;const z=l.key;let B=n.heatmapFbos.get(z);B||(B=No(m,e.tileSize,e.tileSize),n.heatmapFbos.set(z,B)),m.bindFramebuffer.set(B.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:d.b7.transparent});const k=C.programConfigurations.get(n.id),Z=f.useProgram("heatmap",k,!u),G=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),te=f.style.map.terrain.getTerrainData(l);Z.draw(m,y.TRIANGLES,$t.disabled,b,T,ri.disabled,ur(e,f.transform.zoom,n.paint.get("heatmap-intensity"),1),te,G,n.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,n.paint,f.transform.zoom,k)}function Ws(f,e,n,l,u){const m=f.context,y=m.gl,b=f.transform;m.setColorMode(f.colorModeForRenderPass());const T=Pl(m,e),C=n.key,z=e.heatmapFbos.get(C);if(!z)return;m.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,z.colorAttachment.get()),m.activeTexture.set(y.TEXTURE1),T.bind(y.LINEAR,y.CLAMP_TO_EDGE);const B=b.getProjectionData({overscaledTileID:n,applyTerrainMatrix:u,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(m,y.TRIANGLES,$t.disabled,Jt.disabled,f.colorModeForRenderPass(),ri.disabled,Gh(f,e,0,1),null,B,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,b.zoom),z.destroy(),e.heatmapFbos.delete(C)}function No(f,e,n){var l,u;const m=f.gl,y=m.createTexture();m.bindTexture(m.TEXTURE_2D,y),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const b=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:m.UNSIGNED_BYTE,T=(u=f.RGBA16F)!==null&&u!==void 0?u:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,T,e,n,0,m.RGBA,b,null);const C=f.createFramebuffer(e,n,!1,!1);return C.colorAttachment.set(y),C}function Pl(f,e){return e.colorRampTexture||(e.colorRampTexture=new Xt(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function ca(f,e,n,l,u){if(!n||!l||!l.imageAtlas)return;const m=l.imageAtlas.patternPositions;let y=m[n.to.toString()],b=m[n.from.toString()];if(!y&&b&&(y=b),!b&&y&&(b=y),!y||!b){const T=u.getPaintProperty(e);y=m[T],b=m[T]}y&&b&&f.setConstantPatternPositions(y,b)}function ua(f,e,n,l,u,m,y,b){const T=f.context.gl,C="fill-pattern",z=n.paint.get(C),B=z&&z.constantOr(1),k=n.getCrossfadeParameters();let Z,G,te,ee,ie;const oe=f.transform,de=n.paint.get("fill-translate"),he=n.paint.get("fill-translate-anchor");y?(G=B&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=T.LINES):(G=B?"fillPattern":"fill",Z=T.TRIANGLES);const me=z.constantOr(null);for(const xe of l){const _e=e.getTile(xe);if(B&&!_e.patternsLoaded())continue;const Ie=_e.getBucket(n);if(!Ie)continue;const $e=Ie.programConfigurations.get(n.id),je=f.useProgram(G,$e),Fe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(xe);B&&(f.context.activeTexture.set(T.TEXTURE0),_e.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),$e.updatePaintBuffers(k)),ca($e,C,me,_e,n);const Ze=oe.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!b,applyTerrainMatrix:!0}),dt=d.aA(oe,_e,de,he);if(y){ee=Ie.indexBuffer2,ie=Ie.segments2;const et=[T.drawingBufferWidth,T.drawingBufferHeight];te=G==="fillOutlinePattern"&&B?bl(f,k,_e,et,dt):Ku(et,dt)}else ee=Ie.indexBuffer,ie=Ie.segments,te=B?xl(f,k,_e,dt):{u_fill_translate:dt};const ut=f.stencilModeForClipping(xe);je.draw(f.context,Z,u,ut,m,ri.backCCW,te,Fe,Ze,n.id,Ie.layoutVertexBuffer,ee,ie,n.paint,f.transform.zoom,$e)}}function vr(f,e,n,l,u,m,y,b){const T=f.context,C=T.gl,z="fill-extrusion-pattern",B=n.paint.get(z),k=B.constantOr(1),Z=n.getCrossfadeParameters(),G=n.paint.get("fill-extrusion-opacity"),te=B.constantOr(null),ee=f.transform;for(const ie of l){const oe=e.getTile(ie),de=oe.getBucket(n);if(!de)continue;const he=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie),me=de.programConfigurations.get(n.id),xe=f.useProgram(k?"fillExtrusionPattern":"fillExtrusion",me);k&&(f.context.activeTexture.set(C.TEXTURE0),oe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),me.updatePaintBuffers(Z));const _e=ee.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!b,applyTerrainMatrix:!0});ca(me,z,te,oe,n);const Ie=d.aA(ee,oe,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),$e=n.paint.get("fill-extrusion-vertical-gradient"),je=k?cr(f,$e,G,Ie,ie,Z,oe):nu(f,$e,G,Ie);xe.draw(T,T.gl.TRIANGLES,u,m,y,ri.backCCW,je,he,_e,n.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,n.paint,f.transform.zoom,me,f.style.map.terrain&&de.centroidVertexBuffer)}}function xr(f,e,n,l,u,m,y,b,T){var C;const z=f.style.projection,B=f.context,k=f.transform,Z=B.gl,G=[`#define NUM_ILLUMINATION_SOURCES ${n.paint.get("hillshade-highlight-color").values.length}`],te=f.useProgram("hillshade",null,!1,G),ee=!f.options.moving;for(const ie of l){const oe=e.getTile(ie),de=oe.fbo;if(!de)continue;const he=z.getMeshFromTileID(B,ie.canonical,b,!0,"raster"),me=(C=f.style.map.terrain)===null||C===void 0?void 0:C.getTerrainData(ie);B.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,de.colorAttachment.get());const xe=k.getProjectionData({overscaledTileID:ie,aligned:ee,applyGlobeMatrix:!T,applyTerrainMatrix:!0});te.draw(B,Z.TRIANGLES,m,u[ie.overscaledZ],y,ri.backCCW,qh(f,oe,n),me,xe,n.id,he.vertexBuffer,he.indexBuffer,he.segments)}}const Ya=[new d.P(0,0),new d.P(d.Z,0),new d.P(d.Z,d.Z),new d.P(0,d.Z)];function Vr(f,e,n,l,u,m,y,b,T=!1,C=!1){const z=l[l.length-1].overscaledZ,B=f.context,k=B.gl,Z=f.useProgram("raster"),G=f.transform,te=f.style.projection,ee=f.colorModeForRenderPass(),ie=!f.options.moving;for(const oe of l){const de=f.getDepthModeForSublayer(oe.overscaledZ-z,n.paint.get("raster-opacity")===1?$t.ReadWrite:$t.ReadOnly,k.LESS),he=e.getTile(oe);he.registerFadeDuration(n.paint.get("raster-fade-duration"));const me=e.findLoadedParent(oe,0),xe=e.findLoadedSibling(oe),_e=lh(he,me||xe||null,e,n,f.transform,f.style.map.terrain);let Ie,$e;const je=n.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;B.activeTexture.set(k.TEXTURE0),he.texture.bind(je,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(k.TEXTURE1),me?(me.texture.bind(je,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),Ie=Math.pow(2,me.tileID.overscaledZ-he.tileID.overscaledZ),$e=[he.tileID.canonical.x*Ie%1,he.tileID.canonical.y*Ie%1]):he.texture.bind(je,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),he.texture.useMipmap&&B.extTextureFilterAnisotropic&&f.transform.pitch>20&&k.texParameterf(k.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const Fe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(oe),Ze=G.getProjectionData({overscaledTileID:oe,aligned:ie,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),dt=Ju($e||[0,0],Ie||1,_e,n,b),ut=te.getMeshFromTileID(B,oe.canonical,m,y,"raster");Z.draw(B,k.TRIANGLES,de,u?u[oe.overscaledZ]:Jt.disabled,ee,T?ri.frontCCW:ri.backCCW,dt,Fe,Ze,n.id,ut.vertexBuffer,ut.indexBuffer,ut.segments)}}function lh(f,e,n,l,u,m){const y=l.paint.get("raster-fade-duration");if(!m&&y>0){const b=Se.now(),T=(b-f.timeAdded)/y,C=e?(b-e.timeAdded)/y:-1,z=n.getSource(),B=De(u,{tileSize:z.tileSize,roundZoom:z.roundZoom}),k=!e||Math.abs(e.tileID.overscaledZ-B)>Math.abs(f.tileID.overscaledZ-B),Z=k&&f.refreshedUponExpiration?1:d.ae(k?T:1-C,0,1);return f.refreshedUponExpiration&&T>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const Dl=new d.b7(1,0,0,1),vc=new d.b7(0,1,0,1),ha=new d.b7(0,0,1,1),fn=new d.b7(1,0,1,1),xi=new d.b7(0,1,1,1);function Zr(f,e,n,l){Uo(f,0,e+n/2,f.transform.width,n,l)}function br(f,e,n,l){Uo(f,e-n/2,0,n,f.transform.height,l)}function Uo(f,e,n,l,u,m){const y=f.context,b=y.gl;b.enable(b.SCISSOR_TEST),b.scissor(e*f.pixelRatio,n*f.pixelRatio,l*f.pixelRatio,u*f.pixelRatio),y.clear({color:m}),b.disable(b.SCISSOR_TEST)}function Li(f,e,n){const l=f.context,u=l.gl,m=f.useProgram("debug"),y=$t.disabled,b=Jt.disabled,T=f.colorModeForRenderPass(),C="$debug",z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(n);l.activeTexture.set(u.TEXTURE0);const B=e.getTileByID(n.key).latestRawTileData,k=Math.floor((B&&B.byteLength||0)/1024),Z=e.getTile(n).tileSize,G=512/Math.min(Z,512)*(n.overscaledZ/f.transform.zoom)*.5;let te=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(te+=` => ${n.overscaledZ}`),function(ie,oe){ie.initDebugOverlayCanvas();const de=ie.debugOverlayCanvas,he=ie.context.gl,me=ie.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,de.width,de.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(oe,5,5),me.strokeText(oe,5,5),ie.debugOverlayTexture.update(de),ie.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(f,`${te} ${k}kB`);const ee=f.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(l,u.TRIANGLES,y,b,Mi.alphaBlended,ri.disabled,Qu(d.b7.transparent,G),null,ee,C,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),m.draw(l,u.LINE_STRIP,y,b,T,ri.disabled,Qu(d.b7.red),z,ee,C,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function ps(f,e,n,l){const{isRenderingGlobe:u}=l,m=f.context,y=m.gl,b=f.transform,T=f.colorModeForRenderPass(),C=f.getDepthModeFor3D(),z=f.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,f.width,f.height]);for(const B of n){const k=e.getTerrainMesh(B.tileID),Z=f.renderToTexture.getTexture(B),G=e.getTerrainData(B.tileID);m.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,Z.texture);const te=e.getMeshFrameDelta(b.zoom),ee=b.calculateFogMatrix(B.tileID.toUnwrapped()),ie=ef(te,ee,f.style.sky,b.pitch,u),oe=b.getProjectionData({overscaledTileID:B.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});z.draw(m,y.TRIANGLES,C,Jt.disabled,T,ri.backCCW,ie,G,oe,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}function Ba(f,e){if(!e.mesh){const n=new d.aI;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const l=new d.aK;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new vo(f.createVertexBuffer(n,ia.members),f.createIndexBuffer(l),d.aJ.simpleSegment(0,0,n.length,l.length))}return e.mesh}class Vo{constructor(e,n){this.context=new hs(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ze.maxUnderzooming+ze.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new gl}resize(e,n,l){if(this.width=Math.floor(e*l),this.height=Math.floor(n*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,n=new d.aI;n.emplaceBack(0,0),n.emplaceBack(d.Z,0),n.emplaceBack(0,d.Z),n.emplaceBack(d.Z,d.Z),this.tileExtentBuffer=e.createVertexBuffer(n,ia.members),this.tileExtentSegments=d.aJ.simpleSegment(0,0,4,2);const l=new d.aI;l.emplaceBack(0,0),l.emplaceBack(d.Z,0),l.emplaceBack(0,d.Z),l.emplaceBack(d.Z,d.Z),this.debugBuffer=e.createVertexBuffer(l,ia.members),this.debugSegments=d.aJ.simpleSegment(0,0,4,5);const u=new d.b_;u.emplaceBack(0,0,0,0),u.emplaceBack(d.Z,0,d.Z,0),u.emplaceBack(0,d.Z,0,d.Z),u.emplaceBack(d.Z,d.Z,d.Z,d.Z),this.rasterBoundsBuffer=e.createVertexBuffer(u,Wd.members),this.rasterBoundsSegments=d.aJ.simpleSegment(0,0,4,2);const m=new d.aI;m.emplaceBack(0,0),m.emplaceBack(d.Z,0),m.emplaceBack(0,d.Z),m.emplaceBack(d.Z,d.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,ia.members),this.rasterBoundsSegmentsPosOnly=d.aJ.simpleSegment(0,0,4,5);const y=new d.aI;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(y,ia.members),this.viewportSegments=d.aJ.simpleSegment(0,0,4,2);const b=new d.b$;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(b);const T=new d.aK;T.emplaceBack(1,0,2),T.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(T);const C=this.context.gl;this.stencilClearMode=new Jt({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO),this.tileExtentMesh=new vo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=d.K();d.bQ(l,0,this.width,this.height,0,0,1),d.M(l,l,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const u={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,$t.disabled,this.stencilClearMode,Mi.disabled,ri.disabled,null,null,u,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();const u=this.context;u.setColorMode(Mi.disabled),u.setDepthMode($t.disabled);const m={};for(const y of n)m[y.key]=this.nextStencilID++;this._renderTileMasks(m,n,l,!0),this._renderTileMasks(m,n,l,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,n,l,u){const m=this.context,y=m.gl,b=this.style.projection,T=this.transform,C=this.useProgram("clippingMask");for(const z of n){const B=e[z.key],k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z),Z=b.getMeshFromTileID(this.context,z.canonical,u,!0,"stencil"),G=T.getProjectionData({overscaledTileID:z,applyGlobeMatrix:!l,applyTerrainMatrix:!0});C.draw(m,y.TRIANGLES,$t.disabled,new Jt({func:y.ALWAYS,mask:0},B,255,y.KEEP,y.KEEP,y.REPLACE),Mi.disabled,l?ri.disabled:ri.backCCW,null,k,G,"$clipping",Z.vertexBuffer,Z.indexBuffer,Z.segments)}}_renderTilesDepthBuffer(){const e=this.context,n=e.gl,l=this.style.projection,u=this.transform,m=this.useProgram("depth"),y=this.getDepthModeFor3D(),b=we(u,{tileSize:u.tileSize});for(const T of b){const C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T),z=l.getMeshFromTileID(this.context,T.canonical,!0,!0,"raster"),B=u.getProjectionData({overscaledTileID:T,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,n.TRIANGLES,y,Jt.disabled,Mi.disabled,ri.backCCW,null,C,B,"$clipping",z.vertexBuffer,z.indexBuffer,z.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new Jt({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){const n=this.context.gl;return new Jt({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const n=this.context.gl,l=e.sort((y,b)=>b.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,m=l[0].overscaledZ-u+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const y={};for(let b=0;b<m;b++)y[b+u]=new Jt({func:n.GEQUAL,mask:255},b+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=m,[y,l]}return[{[u]:Jt.disabled},l]}stencilConfigForOverlapTwoPass(e){const n=this.context.gl,l=e.sort((y,b)=>b.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,m=l[0].overscaledZ-u+1;if(this.clearStencil(),m>1){const y={},b={};for(let T=0;T<m;T++)y[T+u]=new Jt({func:n.GREATER,mask:255},m+1+T,255,n.KEEP,n.KEEP,n.REPLACE),b[T+u]=new Jt({func:n.GREATER,mask:255},1+T,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*m+1,[y,b,l]}return this.nextStencilID=3,[{[u]:new Jt({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[u]:new Jt({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Mi([e.CONSTANT_COLOR,e.ONE],new d.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mi.unblended:Mi.alphaBlended}getDepthModeForSublayer(e,n,l){if(!this.opaquePassEnabledForLayer())return $t.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new $t(l||this.context.gl.LEQUAL,n,[u,u])}getDepthModeFor3D(){return new $t(this.context.gl.LEQUAL,$t.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var l,u;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Se.now()),this.imageManager.beginFrame();const m=this.style._order,y=this.style.sourceCaches,b={},T={},C={},z={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const k in y){const Z=y[k];Z.used&&Z.prepare(this.context),b[k]=Z.getVisibleCoordinates(!1),T[k]=b[k].slice().reverse(),C[k]=Z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<m.length;k++)if(this.style._layers[m[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of m){const Z=this.style._layers[k];if(!Z.hasOffscreenPass()||Z.isHidden(this.transform.zoom))continue;const G=T[Z.source];(Z.type==="custom"||G.length)&&this.renderLayer(this,y[Z.source],Z,G,z)}if((u=this.style.projection)===null||u===void 0||u.updateGPUdependent({context:this.context,useProgram:k=>this.useProgram(k)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?d.b7.black:d.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,Z){const G=k.context,te=G.gl,ee=((xe,_e,Ie)=>{const $e=Math.cos(_e.rollInRadians),je=Math.sin(_e.rollInRadians),Fe=Me(_e),Ze=_e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:xe.properties.get("sky-color"),u_horizon_color:xe.properties.get("horizon-color"),u_horizon:[(_e.width/2-Fe*je)*Ie,(_e.height/2+Fe*$e)*Ie],u_horizon_normal:[-je,$e],u_sky_horizon_blend:xe.properties.get("sky-horizon-blend")*_e.height/2*Ie,u_sky_blend:Ze}})(Z,k.style.map.transform,k.pixelRatio),ie=new $t(te.LEQUAL,$t.ReadWrite,[0,1]),oe=Jt.disabled,de=k.colorModeForRenderPass(),he=k.useProgram("sky"),me=Ba(G,Z);he.draw(G,te.TRIANGLES,ie,oe,de,ri.disabled,ee,null,void 0,"sky",me.vertexBuffer,me.indexBuffer,me.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[m[this.currentLayer]],Z=y[k.source],G=b[k.source];this._renderTileClippingMasks(k,G,!1),this.renderLayer(this,Z,k,G,z)}this.renderPass="translucent";let B=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const k=this.style._layers[m[this.currentLayer]],Z=y[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k,z))continue;this.opaquePassEnabledForLayer()||B||(B=!0,z.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const G=(k.type==="symbol"?C:T)[k.source];this._renderTileClippingMasks(k,b[k.source],!!this.renderToTexture),this.renderLayer(this,Z,k,G,z)}if(z.isRenderingGlobe&&function(k,Z,G){const te=k.context,ee=te.gl,ie=k.useProgram("atmosphere"),oe=new $t(ee.LEQUAL,$t.ReadOnly,[0,1]),de=k.transform,he=function(Ze,dt){const ut=Ze.properties.get("position"),et=[-ut.x,-ut.y,-ut.z],Mt=d.ad(new Float64Array(16));return Ze.properties.get("anchor")==="map"&&(d.a_(Mt,Mt,dt.rollInRadians),d.a$(Mt,Mt,-dt.pitchInRadians),d.a_(Mt,Mt,dt.bearingInRadians),d.a$(Mt,Mt,dt.center.lat*Math.PI/180),d.bp(Mt,Mt,-dt.center.lng*Math.PI/180)),d.bZ(et,et,Mt),et}(G,k.transform),me=de.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),xe=Z.properties.get("atmosphere-blend")*me.projectionTransition;if(xe===0)return;const _e=Co(de.worldSize,de.center.lat),Ie=de.inverseProjectionMatrix,$e=new Float64Array(4);$e[3]=1,d.at($e,$e,de.modelViewProjectionMatrix),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1,d.at($e,$e,Ie),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1;const je=((Ze,dt,ut,et,Mt)=>({u_sun_pos:Ze,u_atmosphere_blend:dt,u_globe_position:ut,u_globe_radius:et,u_inv_proj_matrix:Mt}))(he,xe,[$e[0],$e[1],$e[2]],_e,Ie),Fe=Ba(te,Z);ie.draw(te,ee.TRIANGLES,oe,Jt.disabled,Mi.alphaBlended,ri.disabled,je,null,null,"atmosphere",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const k=function(Z,G){let te=null;const ee=Object.values(Z._layers).flatMap(he=>he.source&&!he.isHidden(G)?[Z.sourceCaches[he.source]]:[]),ie=ee.filter(he=>he.getSource().type==="vector"),oe=ee.filter(he=>he.getSource().type!=="vector"),de=he=>{(!te||te.getSource().maxzoom<he.getSource().maxzoom)&&(te=he)};return ie.forEach(he=>de(he)),te||oe.forEach(he=>de(he)),te}(this.style,this.transform.zoom);k&&function(Z,G,te){for(let ee=0;ee<te.length;ee++)Li(Z,G,te[ee])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const Z=k.transform.padding;Zr(k,k.transform.height-(Z.top||0),3,Dl),Zr(k,Z.bottom||0,3,vc),br(k,Z.left||0,3,ha),br(k,k.transform.width-(Z.right||0),3,fn);const G=k.transform.centerPoint;(function(te,ee,ie,oe){Uo(te,ee-1,ie-10,2,20,oe),Uo(te,ee-10,ie-1,20,2,oe)})(k,G.x,k.transform.height-G.y,xi)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!d.c0(n,l):!d.c1(n,l)),u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),u&&(d.c2(n,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,y){const b=m.context,T=b.gl,C=m.transform,z=Mi.unblended,B=new $t(T.LEQUAL,$t.ReadWrite,[0,1]),k=y.sourceCache.getRenderableTiles(),Z=m.useProgram("terrainDepth");b.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:d.b7.transparent,depth:1});for(const G of k){const te=y.getTerrainMesh(G.tileID),ee=y.getTerrainData(G.tileID),ie=C.getProjectionData({overscaledTileID:G.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),oe={u_ele_delta:y.getMeshFrameDelta(C.zoom)};Z.draw(b,T.TRIANGLES,B,Jt.disabled,z,ri.backCCW,oe,ee,ie,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,y){const b=m.context,T=b.gl,C=m.transform,z=Mi.unblended,B=new $t(T.LEQUAL,$t.ReadWrite,[0,1]),k=y.getCoordsTexture(),Z=y.sourceCache.getRenderableTiles(),G=m.useProgram("terrainCoords");b.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:d.b7.transparent,depth:1}),y.coordsIndex=[];for(const te of Z){const ee=y.getTerrainMesh(te.tileID),ie=y.getTerrainData(te.tileID);b.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,k.texture);const oe={u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(C.zoom)},de=C.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});G.draw(b,T.TRIANGLES,B,Jt.disabled,z,ri.backCCW,oe,ie,de,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),y.coordsIndex.push(te.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,n,l,u,m){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(u||[]).length)&&(this.id=l.id,d.c3(l)?function(y,b,T,C,z,B){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:k}=B,Z=Jt.disabled,G=y.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(te,ee,ie,oe,de,he,me,xe,_e){const Ie=ee.transform,$e=ee.style.map.terrain,je=de==="map",Fe=he==="map";for(const Ze of te){const dt=oe.getTile(Ze),ut=dt.getBucket(ie);if(!ut||!ut.text||!ut.text.segments.get().length)continue;const et=d.ak(ut.textSizeData,Ie.zoom),Mt=d.az(dt,1,ee.transform.zoom),ei=zt(je,ee.transform,Mt),oi=ie.layout.get("icon-text-fit")!=="none"&&ut.hasIconData();if(et){const tn=Math.pow(2,Ie.zoom-dt.tileID.overscaledZ),Pi=$e?(nn,Hi)=>$e.getElevation(Ze,nn,Hi):null;yc(ut,je,Fe,_e,Ie,ei,tn,et,oi,d.aA(Ie,dt,me,xe),Ze.toUnwrapped(),Pi)}}}(C,y,T,b,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),z),T.paint.get("icon-opacity").constantOr(1)!==0&&zl(y,b,T,C,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),Z,G,k),T.paint.get("text-opacity").constantOr(1)!==0&&zl(y,b,T,C,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),Z,G,k),b.map.showCollisionBoxes&&(Ma(y,b,T,C,!0),Ma(y,b,T,C,!1))}(e,n,l,u,this.style.placement.variableOffsets,m):d.c4(l)?function(y,b,T,C,z){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:B}=z,k=T.paint.get("circle-opacity"),Z=T.paint.get("circle-stroke-width"),G=T.paint.get("circle-stroke-opacity"),te=!T.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(Z.constantOr(1)===0||G.constantOr(1)===0))return;const ee=y.context,ie=ee.gl,oe=y.transform,de=y.getDepthModeForSublayer(0,$t.ReadOnly),he=Jt.disabled,me=y.colorModeForRenderPass(),xe=[],_e=oe.getCircleRadiusCorrection();for(let Ie=0;Ie<C.length;Ie++){const $e=C[Ie],je=b.getTile($e),Fe=je.getBucket(T);if(!Fe)continue;const Ze=T.paint.get("circle-translate"),dt=T.paint.get("circle-translate-anchor"),ut=d.aA(oe,je,Ze,dt),et=Fe.programConfigurations.get(T.id),Mt=y.useProgram("circle",et),ei=Fe.layoutVertexBuffer,oi=Fe.indexBuffer,tn=y.style.map.terrain&&y.style.map.terrain.getTerrainData($e),Pi={programConfiguration:et,program:Mt,layoutVertexBuffer:ei,indexBuffer:oi,uniformValues:wl(y,je,T,ut,_e),terrainData:tn,projectionData:oe.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!B,applyTerrainMatrix:!0})};if(te){const nn=Fe.segments.get();for(const Hi of nn)xe.push({segments:new d.aJ([Hi]),sortKey:Hi.sortKey,state:Pi})}else xe.push({segments:Fe.segments,sortKey:0,state:Pi})}te&&xe.sort((Ie,$e)=>Ie.sortKey-$e.sortKey);for(const Ie of xe){const{programConfiguration:$e,program:je,layoutVertexBuffer:Fe,indexBuffer:Ze,uniformValues:dt,terrainData:ut,projectionData:et}=Ie.state;je.draw(ee,ie.TRIANGLES,de,he,me,ri.backCCW,dt,ut,et,T.id,Fe,Ze,Ie.segments,T.paint,y.transform.zoom,$e)}}(e,n,l,u,m):d.c5(l)?function(y,b,T,C,z){if(T.paint.get("heatmap-opacity")===0)return;const B=y.context,{isRenderingToTexture:k,isRenderingGlobe:Z}=z;if(y.style.map.terrain){for(const G of C){const te=b.getTile(G);b.hasRenderableParent(G)||(y.renderPass==="offscreen"?fs(y,te,T,G,Z):y.renderPass==="translucent"&&Ws(y,T,G,k,Z))}B.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(G,te,ee,ie){const oe=G.context,de=oe.gl,he=G.transform,me=Jt.disabled,xe=new Mi([de.ONE,de.ONE],d.b7.transparent,[!0,!0,!0,!0]);(function(_e,Ie,$e){const je=_e.gl;_e.activeTexture.set(je.TEXTURE1),_e.viewport.set([0,0,Ie.width/4,Ie.height/4]);let Fe=$e.heatmapFbos.get(d.bW);Fe?(je.bindTexture(je.TEXTURE_2D,Fe.colorAttachment.get()),_e.bindFramebuffer.set(Fe.framebuffer)):(Fe=No(_e,Ie.width/4,Ie.height/4),$e.heatmapFbos.set(d.bW,Fe))})(oe,G,ee),oe.clear({color:d.b7.transparent});for(let _e=0;_e<ie.length;_e++){const Ie=ie[_e];if(te.hasRenderableParent(Ie))continue;const $e=te.getTile(Ie),je=$e.getBucket(ee);if(!je)continue;const Fe=je.programConfigurations.get(ee.id),Ze=G.useProgram("heatmap",Fe),dt=he.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ut=he.getCircleRadiusCorrection();Ze.draw(oe,de.TRIANGLES,$t.disabled,me,xe,ri.backCCW,ur($e,he.zoom,ee.paint.get("heatmap-intensity"),ut),null,dt,ee.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,ee.paint,he.zoom,Fe)}oe.viewport.set([0,0,G.width,G.height])}(y,b,T,C):y.renderPass==="translucent"&&function(G,te){const ee=G.context,ie=ee.gl;ee.setColorMode(G.colorModeForRenderPass());const oe=te.heatmapFbos.get(d.bW);oe&&(ee.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,oe.colorAttachment.get()),ee.activeTexture.set(ie.TEXTURE1),Pl(ee,te).bind(ie.LINEAR,ie.CLAMP_TO_EDGE),G.useProgram("heatmapTexture").draw(ee,ie.TRIANGLES,$t.disabled,Jt.disabled,G.colorModeForRenderPass(),ri.disabled,Gh(G,te,0,1),null,null,te.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments,te.paint,G.transform.zoom))}(y,T)}(e,n,l,u,m):d.c6(l)?function(y,b,T,C,z){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:B}=z,k=T.paint.get("line-opacity"),Z=T.paint.get("line-width");if(k.constantOr(1)===0||Z.constantOr(1)===0)return;const G=y.getDepthModeForSublayer(0,$t.ReadOnly),te=y.colorModeForRenderPass(),ee=T.paint.get("line-dasharray"),ie=T.paint.get("line-pattern"),oe=ie.constantOr(1),de=T.paint.get("line-gradient"),he=T.getCrossfadeParameters(),me=oe?"linePattern":ee?"lineSDF":de?"lineGradient":"line",xe=y.context,_e=xe.gl,Ie=y.transform;let $e=!0;for(const je of C){const Fe=b.getTile(je);if(oe&&!Fe.patternsLoaded())continue;const Ze=Fe.getBucket(T);if(!Ze)continue;const dt=Ze.programConfigurations.get(T.id),ut=y.context.program.get(),et=y.useProgram(me,dt),Mt=$e||et.program!==ut,ei=y.style.map.terrain&&y.style.map.terrain.getTerrainData(je),oi=ie.constantOr(null);if(oi&&Fe.imageAtlas){const Bi=Fe.imageAtlas,bi=Bi.patternPositions[oi.to.toString()],Pn=Bi.patternPositions[oi.from.toString()];bi&&Pn&&dt.setConstantPatternPositions(bi,Pn)}const tn=Ie.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Pi=Ie.getPixelScale(),nn=oe?Ml(y,Fe,T,Pi,he):ee?Hh(y,Fe,T,Pi,ee,he):de?Sl(y,Fe,T,Pi,Ze.lineClipsArray.length):Tl(y,Fe,T,Pi);if(oe)xe.activeTexture.set(_e.TEXTURE0),Fe.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),dt.updatePaintBuffers(he);else if(ee&&(Mt||y.lineAtlas.dirty))xe.activeTexture.set(_e.TEXTURE0),y.lineAtlas.bind(xe);else if(de){const Bi=Ze.gradients[T.id];let bi=Bi.texture;if(T.gradientVersion!==Bi.version){let Pn=256;if(T.stepInterpolant){const Vn=b.getSource().maxzoom,Wn=je.canonical.z===Vn?Math.ceil(1<<y.transform.maxZoom-je.canonical.z):1;Pn=d.ae(d.bX(Ze.maxLineLength/d.Z*1024*Wn),256,xe.maxTextureSize)}Bi.gradient=d.bY({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Pn,image:Bi.gradient||void 0,clips:Ze.lineClipsArray}),Bi.texture?Bi.texture.update(Bi.gradient):Bi.texture=new Xt(xe,Bi.gradient,_e.RGBA),Bi.version=T.gradientVersion,bi=Bi.texture}xe.activeTexture.set(_e.TEXTURE0),bi.bind(T.stepInterpolant?_e.NEAREST:_e.LINEAR,_e.CLAMP_TO_EDGE)}const Hi=y.stencilModeForClipping(je);et.draw(xe,_e.TRIANGLES,G,Hi,te,ri.disabled,nn,ei,tn,T.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,T.paint,y.transform.zoom,dt,Ze.layoutVertexBuffer2),$e=!1}}(e,n,l,u,m):d.c7(l)?function(y,b,T,C,z){const B=T.paint.get("fill-color"),k=T.paint.get("fill-opacity");if(k.constantOr(1)===0)return;const{isRenderingToTexture:Z}=z,G=y.colorModeForRenderPass(),te=T.paint.get("fill-pattern"),ee=y.opaquePassEnabledForLayer()&&!te.constantOr(1)&&B.constantOr(d.b7.transparent).a===1&&k.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===ee){const ie=y.getDepthModeForSublayer(1,y.renderPass==="opaque"?$t.ReadWrite:$t.ReadOnly);ua(y,b,T,C,ie,G,!1,Z)}if(y.renderPass==="translucent"&&T.paint.get("fill-antialias")){const ie=y.getDepthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,$t.ReadOnly);ua(y,b,T,C,ie,G,!0,Z)}}(e,n,l,u,m):d.c8(l)?function(y,b,T,C,z){const B=T.paint.get("fill-extrusion-opacity");if(B===0)return;const{isRenderingToTexture:k}=z;if(y.renderPass==="translucent"){const Z=new $t(y.context.gl.LEQUAL,$t.ReadWrite,y.depthRangeFor3D);if(B!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))vr(y,b,T,C,Z,Jt.disabled,Mi.disabled,k),vr(y,b,T,C,Z,y.stencilModeFor3D(),y.colorModeForRenderPass(),k);else{const G=y.colorModeForRenderPass();vr(y,b,T,C,Z,Jt.disabled,G,k)}}}(e,n,l,u,m):d.c9(l)?function(y,b,T,C,z){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const{isRenderingToTexture:B}=z,k=y.context,Z=y.style.projection.useSubdivision,G=y.getDepthModeForSublayer(0,$t.ReadOnly),te=y.colorModeForRenderPass();if(y.renderPass==="offscreen")(function(ee,ie,oe,de,he,me,xe){const _e=ee.context,Ie=_e.gl;for(const $e of oe){const je=ie.getTile($e),Fe=je.dem;if(!Fe||!Fe.data||!je.needsHillshadePrepare)continue;const Ze=Fe.dim,dt=Fe.stride,ut=Fe.getPixels();if(_e.activeTexture.set(Ie.TEXTURE1),_e.pixelStoreUnpackPremultiplyAlpha.set(!1),je.demTexture=je.demTexture||ee.getTileTexture(dt),je.demTexture){const Mt=je.demTexture;Mt.update(ut,{premultiply:!1}),Mt.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE)}else je.demTexture=new Xt(_e,ut,Ie.RGBA,{premultiply:!1}),je.demTexture.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE);_e.activeTexture.set(Ie.TEXTURE0);let et=je.fbo;if(!et){const Mt=new Xt(_e,{width:Ze,height:Ze,data:null},Ie.RGBA);Mt.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),et=je.fbo=_e.createFramebuffer(Ze,Ze,!0,!1),et.colorAttachment.set(Mt.texture)}_e.bindFramebuffer.set(et.framebuffer),_e.viewport.set([0,0,Ze,Ze]),ee.useProgram("hillshadePrepare").draw(_e,Ie.TRIANGLES,he,me,xe,ri.disabled,tf(je.tileID,Fe),null,null,de.id,ee.rasterBoundsBuffer,ee.quadTriangleIndexBuffer,ee.rasterBoundsSegments),je.needsHillshadePrepare=!1}})(y,b,C,T,G,Jt.disabled,te),k.viewport.set([0,0,y.width,y.height]);else if(y.renderPass==="translucent")if(Z){const[ee,ie,oe]=y.stencilConfigForOverlapTwoPass(C);xr(y,b,T,oe,ee,G,te,!1,B),xr(y,b,T,oe,ie,G,te,!0,B)}else{const[ee,ie]=y.getStencilConfigForOverlapAndUpdateStencilID(C);xr(y,b,T,ie,ee,G,te,!1,B)}}(e,n,l,u,m):d.ca(l)?function(y,b,T,C,z){if(y.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!C.length)return;const{isRenderingToTexture:B}=z,k=b.getSource(),Z=y.style.projection.useSubdivision;if(k instanceof Da)Vr(y,b,T,C,null,!1,!1,k.tileCoords,k.flippedWindingOrder,B);else if(Z){const[G,te,ee]=y.stencilConfigForOverlapTwoPass(C);Vr(y,b,T,ee,G,!1,!0,Ya,!1,B),Vr(y,b,T,ee,te,!0,!0,Ya,!1,B)}else{const[G,te]=y.getStencilConfigForOverlapAndUpdateStencilID(C);Vr(y,b,T,te,G,!1,!0,Ya,!1,B)}}(e,n,l,u,m):d.cb(l)?function(y,b,T,C,z){const B=T.paint.get("background-color"),k=T.paint.get("background-opacity");if(k===0)return;const{isRenderingToTexture:Z}=z,G=y.context,te=G.gl,ee=y.style.projection,ie=y.transform,oe=ie.tileSize,de=T.paint.get("background-pattern");if(y.isPatternMissing(de))return;const he=!de&&B.a===1&&k===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==he)return;const me=Jt.disabled,xe=y.getDepthModeForSublayer(0,he==="opaque"?$t.ReadWrite:$t.ReadOnly),_e=y.colorModeForRenderPass(),Ie=y.useProgram(de?"backgroundPattern":"background"),$e=C||we(ie,{tileSize:oe,terrain:y.style.map.terrain});de&&(G.activeTexture.set(te.TEXTURE0),y.imageManager.bind(y.context));const je=T.getCrossfadeParameters();for(const Fe of $e){const Ze=ie.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),dt=de?nf(k,y,de,{tileID:Fe,tileSize:oe},je):$h(k,B),ut=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Fe),et=ee.getMeshFromTileID(G,Fe.canonical,!1,!0,"raster");Ie.draw(G,te.TRIANGLES,xe,me,_e,ri.backCCW,dt,ut,Ze,T.id,et.vertexBuffer,et.indexBuffer,et.segments)}}(e,0,l,u,m):d.cc(l)&&function(y,b,T,C){const{isRenderingGlobe:z}=C,B=y.context,k=T.implementation,Z=y.style.projection,G=y.transform,te=G.getProjectionDataForCustomLayer(z),ee={farZ:G.farZ,nearZ:G.nearZ,fov:G.fov*Math.PI/180,modelViewProjectionMatrix:G.modelViewProjectionMatrix,projectionMatrix:G.projectionMatrix,shaderData:{variantName:Z.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Z.shaderPreludeCode.vertexSource}`,define:Z.shaderDefine},defaultProjectionData:te},ie=k.renderingMode?k.renderingMode:"2d";if(y.renderPass==="offscreen"){const oe=k.prerender;oe&&(y.setCustomLayerDefaults(),B.setColorMode(y.colorModeForRenderPass()),oe.call(k,B.gl,ee),B.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),B.setColorMode(y.colorModeForRenderPass()),B.setStencilMode(Jt.disabled);const oe=ie==="3d"?y.getDepthModeFor3D():y.getDepthModeForSublayer(0,$t.ReadOnly);B.setDepthMode(oe),k.render(B.gl,ee),B.setDirty(),y.setBaseState(),B.bindFramebuffer.set(null)}}(e,0,l,m))}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const n=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!n||!l}useProgram(e,n,l=!1,u=[]){this.cache=this.cache||{};const m=!!this.style.map.terrain,y=this.style.projection,b=l?ba.projectionMercator:y.shaderPreludeCode,T=l?xo:y.shaderDefine,C=e+(n?n.cacheKey:"")+`/${l?hi:y.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(m?"/terrain":"")+(u?`/${u.join("/")}`:"");return this.cache[C]||(this.cache[C]=new tu(this.context,ba[e],n,Xh[e],this._showOverdrawInspector,m,b,T,u)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Xt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function ms(f,e){let n,l=!1,u=null,m=null;const y=()=>{u=null,l&&(f.apply(m,n),u=setTimeout(y,e),l=!1)};return(...b)=>(l=!0,m=this,n=b,u||y(),u)}class fu{constructor(e){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let l;return n.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:l,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const l=n.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let m=window.location.hash.replace(u,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let y=window.location.href.replace(/(#.+)?$/,m);y=y.replace("&&","&"),window.history.replaceState(window.history.state,null,y)},this._updateHash=ms(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const n=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,u),y=Math.round(n.lng*m)/m,b=Math.round(n.lat*m)/m,T=this._map.getBearing(),C=this._map.getPitch();let z="";if(z+=e?`/${y}/${b}/${l}`:`${l}/${b}/${y}`,(T||C)&&(z+="/"+Math.round(10*T)/10),C&&(z+=`/${Math.round(C)}`),this._hashName){const B=this._hashName;let k=!1;const Z=window.location.hash.slice(1).split("&").map(G=>{const te=G.split("=")[0];return te===B?(k=!0,`${te}=${z}`):G}).filter(G=>G);return k||Z.push(`${B}=${z}`),`#${Z.join("&")}`}return`#${z}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new d.Q(+e[2],+e[1])}catch{return!1}const n=+e[0],l=+(e[3]||0),u=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&l>=-180&&l<=180&&u>=this._map.getMinPitch()&&u<=this._map.getMaxPitch()}}const Oa={linearity:.3,easing:d.cd(0,0,.3,1)},xc=d.e({deceleration:2500,maxSpeed:1400},Oa),wr=d.e({deceleration:20,maxSpeed:1400},Oa),Tr=d.e({deceleration:1e3,maxSpeed:360},Oa),gs=d.e({deceleration:1e3,maxSpeed:90},Oa),Gr=d.e({deceleration:1e3,maxSpeed:360},Oa);class pu{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Se.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=Se.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)n.zoom+=m.zoomDelta||0,n.bearing+=m.bearingDelta||0,n.pitch+=m.pitchDelta||0,n.roll+=m.rollDelta||0,m.panDelta&&n.pan._add(m.panDelta),m.around&&(n.around=m.around),m.pinchAround&&(n.pinchAround=m.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(n.pan.mag()){const m=qr(n.pan.mag(),l,d.e({},xc,e||{})),y=n.pan.mult(m.amount/n.pan.mag()),b=this._map.cameraHelper.handlePanInertia(y,this._map.transform);u.center=b.easingCenter,u.offset=b.easingOffset,Js(u,m)}if(n.zoom){const m=qr(n.zoom,l,wr);u.zoom=this._map.transform.zoom+m.amount,Js(u,m)}if(n.bearing){const m=qr(n.bearing,l,Tr);u.bearing=this._map.transform.bearing+d.ae(m.amount,-179,179),Js(u,m)}if(n.pitch){const m=qr(n.pitch,l,gs);u.pitch=this._map.transform.pitch+m.amount,Js(u,m)}if(n.roll){const m=qr(n.roll,l,Gr);u.roll=this._map.transform.roll+d.ae(m.amount,-179,179),Js(u,m)}if(u.zoom||u.bearing){const m=n.pinchAround===void 0?n.around:n.pinchAround;u.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),d.e(u,{noMoveStart:!0})}}function Js(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function qr(f,e,n){const{maxSpeed:l,linearity:u,deceleration:m}=n,y=d.ae(f*u/(e/1e3),-l,l),b=Math.abs(y)/(m*u);return{easing:n.easing,duration:1e3*b,amount:y*(b/2)}}class wn extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l,u={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const m=pe.mousePos(n.getCanvas(),l),y=n.unproject(m);super(e,d.e({point:m,lngLat:y,originalEvent:l},u)),this._defaultPrevented=!1,this.target=n}}class dr extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l){const u=e==="touchend"?l.changedTouches:l.touches,m=pe.touchPos(n.getCanvasContainer(),u),y=m.map(T=>n.unproject(T)),b=m.reduce((T,C,z,B)=>T.add(C.div(B.length)),new d.P(0,0));super(e,{points:m,point:b,lngLats:y,lngLat:n.unproject(b),originalEvent:l}),this._defaultPrevented=!1}}class Qn extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class bc{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Qn(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new wn(e.type,this._map,e))}mouseup(e){this._map.fire(new wn(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new wn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new wn(e.type,this._map,e))}mouseover(e){this._map.fire(new wn(e.type,this._map,e))}mouseout(e){this._map.fire(new wn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new dr(e.type,this._map,e))}touchmove(e){this._map.fire(new dr(e.type,this._map,e))}touchend(e){this._map.fire(new dr(e.type,this._map,e))}touchcancel(e){this._map.fire(new dr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ch{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new wn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new wn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Il{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(d.P.convert(e),this._map.terrain)}}class uh{constructor(e,n){this._map=e,this._tr=new Il(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(pe.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const l=n;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=pe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(u.x,l.x),y=Math.max(u.x,l.x),b=Math.min(u.y,l.y),T=Math.max(u.y,l.y);pe.setTransform(this._box,`translate(${m}px,${b}px)`),this._box.style.width=y-m+"px",this._box.style.height=T-b+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;const l=this._startPos,u=n;if(this.reset(),pe.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new d.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(pe.remove(this._box),this._box=null),pe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new d.l(e,{originalEvent:n}))}}function mu(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const n={};for(let l=0;l<f.length;l++)n[f[l].identifier]=e[l];return n}class On{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const m=new d.P(0,0);for(const y of u)m._add(y);return m.div(u.length)}(n),this.touches=mu(l,n)))}touchmove(e,n,l){if(this.aborted||!this.centroid)return;const u=mu(l,n);for(const m in this.touches){const y=u[m];(!y||y.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,n,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class eo{constructor(e){this.singleTap=new On(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,l){this.singleTap.touchstart(e,n,l)}touchmove(e,n,l){this.singleTap.touchmove(e,n,l)}touchend(e,n,l){const u=this.singleTap.touchend(e,n,l);if(u){const m=e.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(u)<30;if(m&&y||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Rl{constructor(e){this._tr=new Il(e),this._zoomIn=new eo({numTouches:1,numTaps:2}),this._zoomOut=new eo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,l){this._zoomIn.touchstart(e,n,l),this._zoomOut.touchstart(e,n,l)}touchmove(e,n,l){this._zoomIn.touchmove(e,n,l),this._zoomOut.touchmove(e,n,l)}touchend(e,n,l){const u=this._zoomIn.touchend(e,n,l),m=this._zoomOut.touchend(e,n,l),y=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(u)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=Array.isArray(n)?n[0]:n;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&pe.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ka={0:1,2:2};class Sr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const n=pe.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,l){const u=Ka[l];return n.buttons===void 0||(n.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return pe.mouseButton(e)===this._eventButton}}class da{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class kl{constructor(e=new Sr({checkCorrectEvent:()=>!0}),n=new da){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,l){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const wc=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class af{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,l){return this._calculateTransform(e,n,l)}touchmove(e,n,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,n,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,l){this._calculateTransform(e,n,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,l){l.length>0&&(this._active=!0);const u=mu(l,n),m=new d.P(0,0),y=new d.P(0,0);let b=0;for(const C in u){const z=u[C],B=this._touches[C];B&&(m._add(z),y._add(z.sub(B)),b++,u[C]=z)}if(this._touches=u,this._shouldBePrevented(b)||!y.mag())return;const T=y.div(b);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(b),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,m]=this._firstTwoTouches,y=Hr(l,n,u),b=Hr(l,n,m);if(!y||!b)return;const T=this._aroundCenter?null:y.add(b).div(2);return this._move([y,b],T,e)}touchend(e,n,l){if(!this._firstTwoTouches)return;const[u,m]=this._firstTwoTouches,y=Hr(l,n,u),b=Hr(l,n,m);y&&b||(this._active&&pe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Hr(f,e,n){for(let l=0;l<f.length;l++)if(f[l].identifier===n)return e[l]}function Tc(f,e){return Math.log(f/e)/Math.LN2}class _s extends gu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Tc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Tc(this._distance,l),pinchAround:n}}}function Mr(f,e){return 180*f.angleWith(e)/Math.PI}class vt extends gu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Mr(this._vector,u),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,l=Mr(e,this._startVector);return Math.abs(l)<n}}function Sc(f){return Math.abs(f.y)>Math.abs(f.x)}class Zo extends gu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,l){super.touchstart(e,n,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Sc(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,m,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,m=n.mag()>=2;if(!u&&!m)return;if(!u||!m)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const y=e.y>0==n.y>0;return Sc(e)&&Sc(n)&&y}}const _u={panStep:100,bearingStep:15,pitchStep:10};class Go{constructor(e){this._tr=new Il(e);const n=_u;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,l=0,u=0,m=0,y=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),y=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:b=>{const T=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:to,zoom:n?Math.round(T.zoom)+n*(e.shiftKey?2:1):T.zoom,bearing:T.bearing+l*this._bearingStep,pitch:T.pitch+u*this._pitchStep,offset:[-m*this._panStep,-y*this._panStep],center:T.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function to(f){return f*(2-f)}const yu=4.000244140625;class ti{constructor(e,n){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Il(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=Se.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,n!==0&&n%yu==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=pe.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(d.Q.convert(l.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const b=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=b),typeof this._targetZoom=="number"&&(this._targetZoom+=b)}if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>yu?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&T!==0&&(T=1/T);const C=typeof this._targetZoom!="number"?e.scale:d.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),d.ah(C*T)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,u=this._easing;let m,y=!1;if(this._type==="wheel"&&l&&u){const b=Se.now()-this._lastWheelEventTime,T=Math.min((b+5)/200,1),C=u(T);m=d.B.number(l,n,C),T<1?this._frameId||(this._frameId=!0):y=!0}else m=n,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!y,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=d.cf;if(this._prevEase){const l=this._prevEase,u=(Se.now()-l.start)/l.duration,m=l.easing(u+.01)-l.easing(u),y=.27/Math.sqrt(m*m+1e-4)*.01,b=Math.sqrt(.0729-y*y);n=d.cd(y,b,.25,1)}return this._prevEase={start:Se.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Mc{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wh{constructor(e){this._tr=new Il(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $r{constructor(){this._tap=new eo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,l){if(!this._swipePoint)if(this._tapTime){const u=n[0],m=e.timeStamp-this._tapTime<500,y=this._tapPoint.dist(u)<30;m&&y?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,n,l)}touchmove(e,n,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=n[0],m=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,n,l)}touchend(e,n,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,n,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vu{constructor(e,n,l){this._el=e,this._mousePan=n,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xu{constructor(e,n,l,u){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=l,this._mouseRoll=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Xr{constructor(e,n,l,u){this._el=e,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Er{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=pe.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=n,this._container.appendChild(u);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=l,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(pe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new d.l("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ys=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class hh extends d.l{}function Ll(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class Ec{constructor(e,n){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,m)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=u.type==="renderFrame"?void 0:u,b={needsRenderFrame:!1},T={},C={};for(const{handlerName:k,handler:Z,allowed:G}of this._handlers){if(!Z.isEnabled())continue;let te;if(this._blockedByActive(C,G,k))Z.reset();else if(Z[m||u.type]){if(d.cg(u,m||u.type)){const ee=pe.mousePos(this._map.getCanvas(),u);te=Z[m||u.type](u,ee)}else if(d.ch(u,m||u.type)){const ee=this._getMapTouches(u.touches),ie=pe.touchPos(this._map.getCanvas(),ee);te=Z[m||u.type](u,ie,ee)}else d.ci(m||u.type)||(te=Z[m||u.type](u));this.mergeHandlerResult(b,T,te,k,y),te&&te.needsRenderFrame&&this._triggerRenderFrame()}(te||Z.isActive())&&(C[k]=Z)}const z={};for(const k in this._previousActiveHandlers)C[k]||(z[k]=y);this._previousActiveHandlers=C,(Object.keys(z).length||Ll(b))&&(this._changes.push([b,T,z]),this._triggerRenderFrame()),(Object.keys(C).length||Ll(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=b;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pu(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,m,y]of this._listeners)pe.addEventListener(u,m,u===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[e,n,l]of this._listeners)pe.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const n=this._map,l=n.getCanvasContainer();this._add("mapEvent",new bc(n,e));const u=n.boxZoom=new uh(n,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const m=n.cooperativeGestures=new Er(n,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const y=new Rl(n),b=new Wh(n);n.doubleClickZoom=new Mc(b,y),this._add("tapZoom",y),this._add("clickZoom",b),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();const T=new $r;this._add("tapDragZoom",T);const C=n.touchPitch=new Zo(n);this._add("touchPitch",C),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);const z=()=>n.project(n.getCenter()),B=function({enable:he,clickTolerance:me,aroundCenter:xe=!0,minPixelCenterThreshold:_e=100,rotateDegreesPerPixelMoved:Ie=.8},$e){const je=new Sr({checkCorrectEvent:Fe=>pe.mouseButton(Fe)===0&&Fe.ctrlKey||pe.mouseButton(Fe)===2&&!Fe.ctrlKey});return new Fn({clickTolerance:me,move:(Fe,Ze)=>{const dt=$e();if(xe&&Math.abs(dt.y-Fe.y)>_e)return{bearingDelta:d.ce(new d.P(Fe.x,Ze.y),Ze,dt)};let ut=(Ze.x-Fe.x)*Ie;return xe&&Ze.y<dt.y&&(ut=-ut),{bearingDelta:ut}},moveStateManager:je,enable:he,assignEvents:wc})}(e,z),k=function({enable:he,clickTolerance:me,pitchDegreesPerPixelMoved:xe=-.5}){const _e=new Sr({checkCorrectEvent:Ie=>pe.mouseButton(Ie)===0&&Ie.ctrlKey||pe.mouseButton(Ie)===2});return new Fn({clickTolerance:me,move:(Ie,$e)=>({pitchDelta:($e.y-Ie.y)*xe}),moveStateManager:_e,enable:he,assignEvents:wc})}(e),Z=function({enable:he,clickTolerance:me,rollDegreesPerPixelMoved:xe=.3},_e){const Ie=new Sr({checkCorrectEvent:$e=>pe.mouseButton($e)===2&&$e.ctrlKey});return new Fn({clickTolerance:me,move:($e,je)=>{const Fe=_e();let Ze=(je.x-$e.x)*xe;return je.y<Fe.y&&(Ze=-Ze),{rollDelta:Ze}},moveStateManager:Ie,enable:he,assignEvents:wc})}(e,z);n.dragRotate=new xu(e,B,k,Z),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",k,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Z,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();const G=function({enable:he,clickTolerance:me}){const xe=new Sr({checkCorrectEvent:_e=>pe.mouseButton(_e)===0&&!_e.ctrlKey});return new Fn({clickTolerance:me,move:(_e,Ie)=>({around:Ie,panDelta:Ie.sub(_e)}),activateOnStart:!0,moveStateManager:xe,enable:he,assignEvents:wc})}(e),te=new af(e,n);n.dragPan=new vu(l,G,te),this._add("mousePan",G),this._add("touchPan",te,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);const ee=new vt,ie=new _s;n.touchZoomRotate=new Xr(l,ie,ee,T),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);const oe=n.scrollZoom=new ti(n,()=>this._triggerRenderFrame());this._add("scrollZoom",oe,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);const de=n.keyboard=new Go(n);this._add("keyboard",de),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new ch(n))}_add(e,n,l){this._handlers.push({handlerName:e,handler:n,allowed:l}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ys(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,l){for(const u in e)if(u!==l&&(!n||n.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const n=[];for(const l of e)this._el.contains(l.target)&&n.push(l);return n}mergeHandlerResult(e,n,l,u,m){if(!l)return;d.e(e,l);const y={handlerName:u,originalEvent:l.originalEvent||m};l.zoomDelta!==void 0&&(n.zoom=y),l.panDelta!==void 0&&(n.drag=y),l.rollDelta!==void 0&&(n.roll=y),l.pitchDelta!==void 0&&(n.pitch=y),l.bearingDelta!==void 0&&(n.rotate=y)}_applyChanges(){const e={},n={},l={};for(const[u,m,y]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new d.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(e.rollDelta=(e.rollDelta||0)+u.rollDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),d.e(n,m),d.e(l,y);this._updateMapTransform(e,n,l),this._changes=[]}_updateMapTransform(e,n,l){const u=this._map,m=u._getTransformForUpdate(),y=u.terrain;if(!(Ll(e)||y&&this._terrainMovement))return this._fireEvents(n,l,!0);u._stop(!0);let{panDelta:b,zoomDelta:T,bearingDelta:C,pitchDelta:z,rollDelta:B,around:k,pinchAround:Z}=e;Z!==void 0&&(k=Z),k=k||u.transform.centerPoint,y&&!m.isPointOnMapSurface(k)&&(k=m.centerPoint);const G={panDelta:b,zoomDelta:T,rollDelta:B,pitchDelta:z,bearingDelta:C,around:k};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(k)&&(k=m.centerPoint);const te=k.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(b?k.sub(b):k);y?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(G,m),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(b))):this._map.cameraHelper.handleMapControlsPan(G,m,te):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(G,m,te))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(G,m),this._map.cameraHelper.handleMapControlsPan(G,m,te)),u._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,l,!0)}_fireEvents(e,n,l){const u=ys(this._eventsInProgress),m=ys(e),y={};for(const B in e){const{originalEvent:k}=e[B];this._eventsInProgress[B]||(y[`${B}start`]=k),this._eventsInProgress[B]=e[B]}!u&&m&&this._fireEvent("movestart",m.originalEvent);for(const B in y)this._fireEvent(B,y[B]);m&&this._fireEvent("move",m.originalEvent);for(const B in e){const{originalEvent:k}=e[B];this._fireEvent(B,k)}const b={};let T;for(const B in this._eventsInProgress){const{handlerName:k,originalEvent:Z}=this._eventsInProgress[B];this._handlersById[k].isActive()||(delete this._eventsInProgress[B],T=n[k]||Z,b[`${B}end`]=T)}for(const B in b)this._fireEvent(B,b[B]);const C=ys(this._eventsInProgress),z=(u||m)&&!C;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const B=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&B.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(B)}if(l&&z){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),k=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;!B||!B.essential&&Se.prefersReducedMotion?(this._map.fire(new d.l("moveend",{originalEvent:T})),k(this._map.getBearing())&&this._map.resetNorth()):(k(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new d.l(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new hh("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Cc extends d.E{constructor(e,n,l){super(),this._renderFrameCallback=()=>{const u=Math.min((Se.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new d.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,l){return e=d.P.convert(e).mult(-1),this.panTo(this.transform.center,d.e({offset:e},n),l)}panTo(e,n,l){return this.easeTo(d.e({center:e},n),l)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,l){return this.easeTo(d.e({zoom:e},n),l)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new d.l("movestart",n)).fire(new d.l("move",n)).fire(new d.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,l){return this.easeTo(d.e({bearing:e},n),l)}resetNorth(e,n){return this.rotateTo(0,d.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(d.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=zi.convert(e).adjustAntiMeridian();const l=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,n)}_cameraForBoxAndBearing(e,n,l,u){const m={top:0,bottom:0,right:0,left:0};if(typeof(u=d.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const C=u.padding;u.padding={top:C,bottom:C,right:C,left:C}}const y=d.e(m,u.padding);u.padding=y;const b=this.transform,T=new zi(e,n);return this.cameraHelper.cameraForBoxAndBearing(u,y,T,l,b)}fitBounds(e,n,l){return this._fitInternal(this.cameraForBounds(e,n),n,l)}fitScreenCoordinates(e,n,l,u,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(d.P.convert(e)),this.transform.screenPointToLocation(d.P.convert(n)),l,u),u,m)}_fitInternal(e,n,l){return e?(delete(n=d.e(e,n)).padding,n.linear?this.easeTo(n,l):this.flyTo(n,l)):this}jumpTo(e,n){this.stop();const l=this._getTransformForUpdate();let u=!1,m=!1,y=!1;const b=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const T=l.zoom!==b;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(u=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(m=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(y=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new d.l("movestart",n)).fire(new d.l("move",n)),T&&this.fire(new d.l("zoomstart",n)).fire(new d.l("zoom",n)).fire(new d.l("zoomend",n)),u&&this.fire(new d.l("rotatestart",n)).fire(new d.l("rotate",n)).fire(new d.l("rotateend",n)),m&&this.fire(new d.l("pitchstart",n)).fire(new d.l("pitch",n)).fire(new d.l("pitchend",n)),y&&this.fire(new d.l("rollstart",n)).fire(new d.l("roll",n)).fire(new d.l("rollend",n)),this.fire(new d.l("moveend",n))}calculateCameraOptionsFromTo(e,n,l,u=0){const m=d.$.fromLngLat(e,n),y=d.$.fromLngLat(l,u),b=y.x-m.x,T=y.y-m.y,C=y.z-m.z,z=Math.hypot(b,T,C);if(z===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(b,T),k=d.ah(this.transform.cameraToCenterDistance/z/this.transform.tileSize),Z=180*Math.atan2(b,-T)/Math.PI;let G=180*Math.acos(B/z)/Math.PI;return G=C<0?90-G:90+G,{center:y.toLngLat(),elevation:u,zoom:k,pitch:G,bearing:Z}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,l,u,m){const y=this.transform.calculateCenterFromCameraLngLatAlt(e,n,l,u);return{center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:l,pitch:u,roll:m}}easeTo(e,n){this._stop(!1,e.easeId),((e=d.e({offset:[0,0],duration:500,easing:d.cf},e)).animate===!1||!e.essential&&Se.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),u=this.getBearing(),m=l.pitch,y=l.roll,b="bearing"in e?this._normalizeBearing(e.bearing,u):u,T="pitch"in e?+e.pitch:m,C="roll"in e?this._normalizeBearing(e.roll,y):y,z="padding"in e?e.padding:l.padding,B=d.P.convert(e.offset);let k,Z;e.around&&(k=d.Q.convert(e.around),Z=l.locationToScreenPoint(k));const G={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},te=this.cameraHelper.handleEaseTo(l,{bearing:b,pitch:T,roll:C,padding:z,around:k,aroundPoint:Z,offsetAsPoint:B,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||u!==b,this._pitching=this._pitching||T!==m,this._rolling=this._rolling||C!==y,this._padding=!l.isPaddingEqual(z),this._zooming=this._zooming||te.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,G),this.terrain&&this._prepareElevation(te.elevationCenter),this._ease(ee=>{te.easeFunc(ee),this.terrain&&!e.freezeElevation&&this._updateElevation(ee),this._applyUpdatedTransform(l),this._fireMoveEvents(n)},ee=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ee)},e),this}_prepareEase(e,n,l={}){this._moving=!0,n||l.moving||this.fire(new d.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new d.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new d.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new d.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new d.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(n-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(d.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const n=e.getCameraLngLat(),l=e.getCameraAltitude(),u=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(l<u){const m=this.calculateCameraOptionsFromTo(n,u,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const n=[];if(n.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&n.push(u=>this.transformCameraUpdate(u)),!n.length)return;const l=e.clone();for(const u of n){const m=l.clone(),{center:y,zoom:b,roll:T,pitch:C,bearing:z,elevation:B}=u(m);y&&m.setCenter(y),B!==void 0&&m.setElevation(B),b!==void 0&&m.setZoom(b),T!==void 0&&m.setRoll(T),C!==void 0&&m.setPitch(C),z!==void 0&&m.setBearing(z),l.apply(m)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new d.l("move",e)),this._zooming&&this.fire(new d.l("zoom",e)),this._rotating&&this.fire(new d.l("rotate",e)),this._pitching&&this.fire(new d.l("pitch",e)),this._rolling&&this.fire(new d.l("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const l=this._zooming,u=this._rotating,m=this._pitching,y=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new d.l("zoomend",e)),u&&this.fire(new d.l("rotateend",e)),m&&this.fire(new d.l("pitchend",e)),y&&this.fire(new d.l("rollend",e)),this.fire(new d.l("moveend",e))}flyTo(e,n){if(!e.essential&&Se.prefersReducedMotion){const Ze=d.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ze,n)}this.stop(),e=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.cf},e);const l=this._getTransformForUpdate(),u=l.bearing,m=l.pitch,y=l.roll,b=l.padding,T="bearing"in e?this._normalizeBearing(e.bearing,u):u,C="pitch"in e?+e.pitch:m,z="roll"in e?this._normalizeBearing(e.roll,y):y,B="padding"in e?e.padding:l.padding,k=d.P.convert(e.offset);let Z=l.centerPoint.add(k);const G=l.screenPointToLocation(Z),te=this.cameraHelper.handleFlyTo(l,{bearing:T,pitch:C,roll:z,padding:B,locationAtOffset:G,offsetAsPoint:k,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ee=e.curve;const ie=Math.max(l.width,l.height),oe=ie/te.scaleOfZoom,de=te.pixelPathLength;typeof te.scaleOfMinZoom=="number"&&(ee=Math.sqrt(ie/te.scaleOfMinZoom/de*2));const he=ee*ee;function me(Ze){const dt=(oe*oe-ie*ie+(Ze?-1:1)*he*he*de*de)/(2*(Ze?oe:ie)*he*de);return Math.log(Math.sqrt(dt*dt+1)-dt)}function xe(Ze){return(Math.exp(Ze)-Math.exp(-Ze))/2}function _e(Ze){return(Math.exp(Ze)+Math.exp(-Ze))/2}const Ie=me(!1);let $e=function(Ze){return _e(Ie)/_e(Ie+ee*Ze)},je=function(Ze){return ie*((_e(Ie)*(xe(dt=Ie+ee*Ze)/_e(dt))-xe(Ie))/he)/de;var dt},Fe=(me(!0)-Ie)/ee;if(Math.abs(de)<2e-6||!isFinite(Fe)){if(Math.abs(ie-oe)<1e-6)return this.easeTo(e,n);const Ze=oe<ie?-1:1;Fe=Math.abs(Math.log(oe/ie))/ee,je=()=>0,$e=dt=>Math.exp(Ze*ee*dt)}return e.duration="duration"in e?+e.duration:1e3*Fe/("screenSpeed"in e?+e.screenSpeed/ee:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==T,this._pitching=C!==m,this._rolling=z!==y,this._padding=!l.isPaddingEqual(B),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(te.targetCenter),this._ease(Ze=>{const dt=Ze*Fe,ut=1/$e(dt),et=je(dt);this._rotating&&l.setBearing(d.B.number(u,T,Ze)),this._pitching&&l.setPitch(d.B.number(m,C,Ze)),this._rolling&&l.setRoll(d.B.number(y,z,Ze)),this._padding&&(l.interpolatePadding(b,B,Ze),Z=l.centerPoint.add(k)),te.easeFunc(Ze,ut,et,Z),this.terrain&&!e.freezeElevation&&this._updateElevation(Ze),this._applyUpdatedTransform(l),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,n)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,n,l){l.animate===!1||l.duration===0?(e(1),n()):(this._easeStart=Se.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=d.aL(e,-180,180);const l=Math.abs(e-n);return Math.abs(e-360-n)<l&&(e-=360),Math.abs(e+360-n)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(d.Q.convert(e),this.transform.tileZoom):null}}const Yr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ui{constructor(e=Yr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=pe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=pe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=pe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){pe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,n){const l=this._map._getUIString(`AttributionControl.${n}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const n=this._map.style.sourceCaches;for(const u in n){const m=n[u];if(m.used||m.usedForTerrain){const y=m.getSource();y.attribution&&e.indexOf(y.attribution)<0&&e.push(y.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,m)=>u.length-m.length),e=e.filter((u,m)=>{for(let y=m+1;y<e.length;y++)if(e[y].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=pe.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Kr{constructor(e={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const l=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=pe.create("div","maplibregl-ctrl");const n=pe.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){pe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Bl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,l=n?this._queue.concat(n):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const l of n)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var dh=d.aG([{name:"a_pos3d",type:"Int16",components:3}]);class bu extends d.E{constructor(e){super(),this._lastTilesetChange=Se.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const l={};for(const u of we(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),d.bQ(u.terrainRttPosMatrix32f,0,d.Z,d.Z,0,0,1),this._tiles[u.key]=new zn(u,this.tileSize),this._lastTilesetChange=Se.now());for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const n in this._tiles){const l=this._tiles[n];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,n){return n?this._getTerrainCoordsForTileRanges(e,n):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const n={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID,m=e.clone(),y=d.b2();if(u.canonical.equals(e.canonical))d.bQ(y,0,d.Z,d.Z,0,0,1);else if(u.canonical.isChildOf(e.canonical)){const b=u.canonical.z-e.canonical.z,T=u.canonical.x-(u.canonical.x>>b<<b),C=u.canonical.y-(u.canonical.y>>b<<b),z=d.Z>>b;d.bQ(y,0,z,z,0,0,1),d.L(y,y,[-T*z,-C*z,0])}else{if(!e.canonical.isChildOf(u.canonical))continue;{const b=e.canonical.z-u.canonical.z,T=e.canonical.x-(e.canonical.x>>b<<b),C=e.canonical.y-(e.canonical.y>>b<<b),z=d.Z>>b;d.bQ(y,0,d.Z,d.Z,0,0,1),d.L(y,y,[T*z,C*z,0]),d.M(y,y,[1/2**b,1/2**b,0])}}m.terrainRttPosMatrix32f=new Float32Array(y),n[l]=m}return n}_getTerrainCoordsForTileRanges(e,n){const l={};for(const u of this._renderableTilesKeys){const m=this._tiles[u].tileID;if(!this._isWithinTileRanges(m,n))continue;const y=e.clone(),b=d.b2();if(m.canonical.z===e.canonical.z){const T=e.canonical.x-m.canonical.x,C=e.canonical.y-m.canonical.y;d.bQ(b,0,d.Z,d.Z,0,0,1),d.L(b,b,[T*d.Z,C*d.Z,0])}else if(m.canonical.z>e.canonical.z){const T=m.canonical.z-e.canonical.z,C=m.canonical.x-(m.canonical.x>>T<<T),z=m.canonical.y-(m.canonical.y>>T<<T),B=e.canonical.x-(m.canonical.x>>T),k=e.canonical.y-(m.canonical.y>>T),Z=d.Z>>T;d.bQ(b,0,Z,Z,0,0,1),d.L(b,b,[-C*Z+B*d.Z,-z*Z+k*d.Z,0])}else{const T=e.canonical.z-m.canonical.z,C=e.canonical.x-(e.canonical.x>>T<<T),z=e.canonical.y-(e.canonical.y>>T<<T),B=(e.canonical.x>>T)-m.canonical.x,k=(e.canonical.y>>T)-m.canonical.y,Z=d.Z<<T;d.bQ(b,0,Z,Z,0,0,1),d.L(b,b,[C*d.Z+B*Z,z*d.Z+k*Z,0])}y.terrainRttPosMatrix32f=new Float32Array(b),l[u]=y}return l}getSourceTile(e,n){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&n)for(;u>=l.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(u--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,n){return n[e.canonical.z]&&e.canonical.x>=n[e.canonical.z].minTileX&&e.canonical.x<=n[e.canonical.z].maxTileX&&e.canonical.y>=n[e.canonical.z].minTileY&&e.canonical.y<=n[e.canonical.z].maxTileY}}class wu{constructor(e,n,l){this._meshCache={},this.painter=e,this.sourceCache=new bu(n),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,l,u=d.Z){var m;if(!(n>=0&&n<u&&l>=0&&l<u))return 0;const y=this.getTerrainData(e),b=(m=y.tile)===null||m===void 0?void 0:m.dem;if(!b)return 0;const T=d.cj([],[n/u*d.Z,l/u*d.Z],y.u_terrain_matrix),C=[T[0]*b.dim,T[1]*b.dim],z=Math.floor(C[0]),B=Math.floor(C[1]),k=C[0]-z,Z=C[1]-B;return b.get(z,B)*(1-k)*(1-Z)+b.get(z+1,B)*k*(1-Z)+b.get(z,B+1)*(1-k)*Z+b.get(z+1,B+1)*k*Z}getElevationForLngLatZoom(e,n){if(!d.ck(n,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(l,u%d.Z,m%d.Z,d.Z)}getElevation(e,n,l,u=d.Z){return this.getDEMElevation(e,n,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,m=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Xt(u,m,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Xt(u,new d.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.ad([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const u=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new Xt(u,n.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),n.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const l=n&&n+n.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?m=e.canonical.z-u:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=e.canonical.x-(e.canonical.x>>m<<m),b=e.canonical.y-(e.canonical.y>>m<<m),T=d.cl(new Float64Array(16),[1/(d.Z<<m),1/(d.Z<<m),0]);d.L(T,T,[y*d.Z,b*d.Z,0]),this._demMatrixCache[e.key]={matrix:T,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const n=this.painter,l=n.width/devicePixelRatio,u=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Xt(n.context,{width:l,height:u,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Xt(n.context,{width:l,height:u,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,y=0;m<this._coordsTextureSize;m++)for(let b=0;b<this._coordsTextureSize;b++,y+=4)n[y+0]=255&b,n[y+1]=255&m,n[y+2]=b>>8<<4|m>>8,n[y+3]=0;const l=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),u=new Xt(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),l=this.painter.context,u=l.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),y=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),b=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(m,b-y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,n),l.bindFramebuffer.set(null);const T=n[0]+(n[2]>>4<<8),C=n[1]+((15&n[2])<<8),z=this.coordsIndex[255-n[3]],B=z&&this.sourceCache.getTileByID(z);if(!B)return null;const k=this._coordsTextureSize,Z=(1<<B.tileID.canonical.z)*k;return new d.$((B.tileID.canonical.x*k+T)/Z+B.tileID.wrap,(B.tileID.canonical.y*k+C)/Z,this.getElevation(B.tileID,T,C,k))}depthAtPoint(e){const n=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,n),l.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;const l=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,u=l&&e.canonical.y===0,m=l&&e.canonical.y===(1<<e.canonical.z)-1,y=`m_${u?"n":""}_${m?"s":""}`;if(this._meshCache[y])return this._meshCache[y];const b=this.painter.context,T=new d.cm,C=new d.aK,z=this.meshSize,B=d.Z/z,k=z*z;for(let _e=0;_e<=z;_e++)for(let Ie=0;Ie<=z;Ie++)T.emplaceBack(Ie*B,_e*B,0);for(let _e=0;_e<k;_e+=z+1)for(let Ie=0;Ie<z;Ie++)C.emplaceBack(Ie+_e,z+Ie+_e+1,z+Ie+_e+2),C.emplaceBack(Ie+_e,z+Ie+_e+2,Ie+_e+1);const Z=T.length,G=Z+(z+1),te=(z+1)*z,ee=u?d.b9:0,ie=u?0:1,oe=m?d.ba:d.Z,de=m?0:1;for(let _e=0;_e<=z;_e++)T.emplaceBack(_e*B,ee,ie);for(let _e=0;_e<=z;_e++)T.emplaceBack(_e*B,oe,de);for(let _e=0;_e<z;_e++)C.emplaceBack(te+_e,G+_e,G+_e+1),C.emplaceBack(te+_e,G+_e+1,te+_e+1),C.emplaceBack(0+_e,Z+_e+1,Z+_e),C.emplaceBack(0+_e,0+_e+1,Z+_e+1);const he=T.length,me=he+2*(z+1);for(const _e of[0,1])for(let Ie=0;Ie<=z;Ie++)for(const $e of[0,1])T.emplaceBack(_e*d.Z,Ie*B,$e);for(let _e=0;_e<2*z;_e+=2)C.emplaceBack(he+_e,he+_e+1,he+_e+3),C.emplaceBack(he+_e,he+_e+3,he+_e+2),C.emplaceBack(me+_e,me+_e+3,me+_e+1),C.emplaceBack(me+_e,me+_e+2,me+_e+3);const xe=new vo(b.createVertexBuffer(T,dh.members),b.createIndexBuffer(C),d.aJ.simpleSegment(0,0,T.length,C.length));return this._meshCache[y]=xe,xe}getMeshFrameDelta(e){return 2*Math.PI*d.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const n=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return n&&n.dem&&(l.minElevation=n.dem.min*this.exaggeration,l.maxElevation=n.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,n){const l=d.$.fromLngLat(e.wrap()),u=(1<<n)*d.Z,m=l.x*u,y=l.y*u,b=Math.floor(m/d.Z),T=Math.floor(y/d.Z);return{tileID:new d.Y(n,0,n,b,T),mercatorX:m,mercatorY:y}}}class io{constructor(e,n,l){this._context=e,this._size=n,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new Xt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(l.texture),{id:e,fbo:n,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Gt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ei{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new io(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(n)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const u=e.sourceCaches[l].getVisibleCoordinates(),m=e.sourceCaches[l].getSource(),y=m instanceof Da?m.terrainTileRanges:null;for(const b of u){const T=this.terrain.sourceCache.getTerrainCoords(b,y);for(const C in T)this._coordsAscending[l][C]||(this._coordsAscending[l][C]=[]),this._coordsAscending[l][C].push(T[C])}}this._coordsAscendingStr={};for(const l of e._order){const u=e._layers[l],m=u.source;if(Gt[u.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const y in this._coordsAscending[m])this._coordsAscendingStr[m][y]=this._coordsAscending[m][y].map(b=>b.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsAscendingStr){const m=this._coordsAscendingStr[u][l.tileID.key];m&&m!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),u=e.type,m=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Gt[u]&&(this._prevType&&Gt[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(e.id),!y))return!0;if(Gt[this._prevType]||Gt[u]&&y){this._prevType=u;const b=this._stacks.length-1,T=this._stacks[b]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(ps(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[b]){const B=this.pool.getObjectForId(C.rtt[b].id);if(B.stamp===C.rtt[b].stamp){this.pool.useObject(B);continue}}const z=this.pool.getOrCreateFreeObject();this.pool.useObject(z),this.pool.stampObject(z),C.rtt[b]={id:z.id,stamp:z.stamp},m.context.bindFramebuffer.set(z.fbo.framebuffer),m.context.clear({color:d.b7.transparent,stencil:0}),m.currentStencilSource=void 0;for(let B=0;B<T.length;B++){const k=m.style._layers[T[B]],Z=k.source?this._coordsAscending[k.source][C.tileID.key]:[C.tileID];m.context.viewport.set([0,0,z.fbo.width,z.fbo.height]),m._renderTileClippingMasks(k,Z,!0),m.renderLayer(m,m.style.sourceCaches[k.source],k,Z,l),k.source&&(C.rttCoords[k.source]=this._coordsAscendingStr[k.source][C.tileID.key])}}return ps(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Gt[u]}return!1}}const gt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},jt=ge,Qr={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Yr,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},vs={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Ol{constructor(e,n,l=!1){this.mousedown=m=>{this.startMove(m,pe.mousePos(this.element,m)),pe.addEventListener(window,"mousemove",this.mousemove),pe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,pe.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHanlder.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=pe.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),pe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=pe.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const u=new kl;this._rotatePitchHanlder=new Fn({clickTolerance:3,move:(m,y)=>{const b=n.getBoundingClientRect(),T=new d.P((b.bottom-b.top)/2,(b.right-b.left)/2);return{bearingDelta:d.ce(new d.P(m.x,y.y),y,T),pitchDelta:l?-.5*(y.y-m.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}}),this.map=e,pe.addEventListener(n,"mousedown",this.mousedown),pe.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),pe.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),pe.disableDrag()}move(e,n){const l=this.map,{bearingDelta:u,pitchDelta:m}=this._rotatePitchHanlder.dragMove(e,n)||{};u&&l.setBearing(l.getBearing()+u),m&&l.setPitch(l.getPitch()+m)}off(){const e=this.element;pe.removeEventListener(e,"mousedown",this.mousedown),pe.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.removeEventListener(window,"touchend",this.touchend),pe.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){pe.enableDrag(),pe.removeEventListener(window,"mousemove",this.mousemove),pe.removeEventListener(window,"mouseup",this.mouseup),pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.removeEventListener(window,"touchend",this.touchend)}}let on;function no(f,e,n,l=!1){if(l||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return f==null?void 0:f.wrap();const u=new d.Q(f.lng,f.lat);if(f=new d.Q(f.lng,f.lat),e){const m=new d.Q(f.lng-360,f.lat),y=new d.Q(f.lng+360,f.lat),b=n.locationToScreenPoint(f).distSqr(e);n.locationToScreenPoint(m).distSqr(e)<b?f=m:n.locationToScreenPoint(y).distSqr(e)<b&&(f=y)}for(;Math.abs(f.lng-n.center.lng)>180;){const m=n.locationToScreenPoint(f);if(m.x>=0&&m.y>=0&&m.x<=n.width&&m.y<=n.height)break;f.lng>n.center.lng?f.lng-=360:f.lng+=360}return f.lng!==u.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(f))?f:u}const fr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Tn(f,e,n){const l=f.classList;for(const u in fr)l.remove(`maplibregl-${n}-anchor-${u}`);l.add(`maplibregl-${n}-anchor-${e}`)}class xs extends d.E{constructor(e){if(super(),this._onKeyPress=n=>{const l=n.code,u=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=n=>{const l=n.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=n=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=no(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(u=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),pe.setTransform(this._element,`${fr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${u}`),Se.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.l("dragstart"))),this.fire(new d.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.l("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=d.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=pe.create("div");const n=pe.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${l}px`),n.setAttributeNS(null,"width",`${u}px`),n.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const m=pe.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const y=pe.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const b=pe.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ie of T){const oe=pe.createNS("http://www.w3.org/2000/svg","ellipse");oe.setAttributeNS(null,"opacity","0.04"),oe.setAttributeNS(null,"cx","10.5"),oe.setAttributeNS(null,"cy","5.80029008"),oe.setAttributeNS(null,"rx",ie.rx),oe.setAttributeNS(null,"ry",ie.ry),b.appendChild(oe)}const C=pe.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);const z=pe.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(z);const B=pe.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const k=pe.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild(k);const Z=pe.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const G=pe.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=pe.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const ee=pe.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),G.appendChild(te),G.appendChild(ee),y.appendChild(b),y.appendChild(C),y.appendChild(B),y.appendChild(Z),y.appendChild(G),n.appendChild(y),n.setAttributeNS(null,"height",l*this._scale+"px"),n.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(n),this._offset=d.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),Tn(this._element,this._anchor,"marker"),e&&e.className)for(const n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),pe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=d.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,l;const u=(n=this._map)===null||n===void 0?void 0:n.terrain,m=this._map.transform.isLocationOccluded(this._lngLat);if(!u||m){const Z=m?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Z&&(this._element.style.opacity=Z))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const y=this._map,b=y.terrain.depthAtPoint(this._pos),T=y.terrain.getElevationForLngLatZoom(this._lngLat,y.transform.tileZoom);if(y.transform.lngLatToCameraDepth(this._lngLat,T)-b<.006)return void(this._element.style.opacity=this._opacity);const C=-this._offset.y/y.transform.pixelsPerMeter,z=Math.sin(y.getPitch()*Math.PI/180)*C,B=y.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),k=y.transform.lngLatToCameraDepth(this._lngLat,T+z)-B>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=d.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return(this._opacity===void 0||e===void 0&&n===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const Wi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ji=0,qo=!1;const Ac={maxWidth:100,unit:"metric"};function Ho(f,e,n){const l=n&&n.maxWidth||100,u=f._container.clientHeight/2,m=f._container.clientWidth/2,y=f.unproject([m-l/2,u]),b=f.unproject([m+l/2,u]),T=Math.round(f.project(b).x-f.project(y).x),C=Math.min(l,T,f._container.clientWidth),z=y.distanceTo(b);if(n&&n.unit==="imperial"){const B=3.2808*z;B>5280?bs(e,C,B/5280,f._getUIString("ScaleControl.Miles")):bs(e,C,B,f._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?bs(e,C,z/1852,f._getUIString("ScaleControl.NauticalMiles")):z>=1e3?bs(e,C,z/1e3,f._getUIString("ScaleControl.Kilometers")):bs(e,C,z,f._getUIString("ScaleControl.Meters"))}function bs(f,e,n,l){const u=function(m){const y=Math.pow(10,`${Math.floor(m)}`.length-1);let b=m/y;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(T){const C=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*C)/C}(b),y*b}(n);f.style.width=e*(u/n)+"px",f.innerHTML=`${u}&nbsp;${l}`}const zc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},fa=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function en(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,f),"top-left":new d.P(e,e),"top-right":new d.P(-e,e),bottom:new d.P(0,-f),"bottom-left":new d.P(e,-e),"bottom-right":new d.P(-e,-e),left:new d.P(f,0),right:new d.P(-f,0)}}if(f instanceof d.P||Array.isArray(f)){const e=d.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:d.P.convert(f.center||[0,0]),top:d.P.convert(f.top||[0,0]),"top-left":d.P.convert(f["top-left"]||[0,0]),"top-right":d.P.convert(f["top-right"]||[0,0]),bottom:d.P.convert(f.bottom||[0,0]),"bottom-left":d.P.convert(f["bottom-left"]||[0,0]),"bottom-right":d.P.convert(f["bottom-right"]||[0,0]),left:d.P.convert(f.left||[0,0]),right:d.P.convert(f.right||[0,0])}}return en(new d.P(0,0))}const Pc=ge;P.AJAXError=d.cq,P.Event=d.l,P.Evented=d.E,P.LngLat=d.Q,P.MercatorCoordinate=d.$,P.Point=d.P,P.addProtocol=d.cr,P.config=d.a,P.removeProtocol=d.cs,P.AttributionControl=Ui,P.BoxZoomHandler=uh,P.CanvasSource=mo,P.CooperativeGesturesHandler=Er,P.DoubleClickZoomHandler=Mc,P.DragPanHandler=vu,P.DragRotateHandler=xu,P.EdgeInsets=bo,P.FullscreenControl=class extends d.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n==null?void 0:n.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){pe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=pe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);pe.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},P.GeoJSONSource=cl,P.GeolocateControl=class extends d.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new d.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new d.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),m=d.e({bearing:u},this.options.fitBoundsOptions),y=zi.fromLngLat(n,l);this._map.fitBounds(y,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new d.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&qo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=pe.create("button","maplibregl-ctrl-geolocate",this._container),pe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xs({element:this._dotElement}),this._circleElement=pe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.l("trackuserlocationend")),this.fire(new d.l("userlocationlostfocus")))})}},this.options=d.e({},Wi,f)}onAdd(f){return this._map=f,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return d._(this,arguments,void 0,function*(e=!1){if(on!==void 0&&!e)return on;if(window.navigator.permissions===void 0)return on=!!window.navigator.geolocation,on;try{on=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{on=!!window.navigator.geolocation}return on})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),pe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ji=0,qo=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),n=f.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),n=f.getNorthEast(),l=e.distanceTo(n),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ji--,qo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.l("trackuserlocationstart")),this.fire(new d.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ji++,Ji>1?(f={maximumAge:6e5,timeout:0},qo=!0):(f=this.options.positionOptions,qo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},P.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=pe.create("button","maplibregl-ctrl-globe",this._container),pe.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){pe.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},P.Hash=fu,P.ImageSource=Da,P.KeyboardHandler=Go,P.LngLatBounds=zi,P.LogoControl=Kr,P.Map=class extends Cc{constructor(f){var e,n;d.cn.mark(d.co.create);const l=Object.assign(Object.assign(Object.assign({},Qr),f),{canvasContextAttributes:Object.assign(Object.assign({},Qr.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const u=new Or,m=new or;if(l.minZoom!==void 0&&u.setMinZoom(l.minZoom),l.maxZoom!==void 0&&u.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&u.setMinPitch(l.minPitch),l.maxPitch!==void 0&&u.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&u.setRenderWorldCopies(l.renderWorldCopies),super(u,m,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Bl,this._controls=[],this._mapId=d.a4(),this._contextLost=b=>{b.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.l("webglcontextlost",{originalEvent:b}))},this._contextRestored=b=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.l("webglcontextrestored",{originalEvent:b}))},this._onMapScroll=b=>{if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},gt),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=qt.addThrottleControl(()=>this.isMoving()),this._requestManager=new bt(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let b=!1;const T=ms(C=>{this._trackResize&&!this._removed&&(this.resize(C),this.redraw())},50);this._resizeObserver=new ResizeObserver(C=>{b?T(C):b=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ec(this,l),this._hash=l.hash&&new fu(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,d.e({},l.fitBoundsOptions,{duration:0}))));const y=typeof l.style=="string"||((n=(e=l.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,y),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Ui(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Kr,l.logoPosition),this.on("style.load",()=>{if(y||this._resizeTransform(),this.transform.unmodified){const b=d.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(b)}}),this.on("data",b=>{this._update(b.dataType==="style"),this.fire(new d.l(`${b.dataType}data`,b))}),this.on("dataloading",b=>{this.fire(new d.l(`${b.dataType}dataloading`,b))}),this.on("dataabort",b=>{this.fire(new d.l("sourcedataabort",b))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new d.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(n,l.firstChild):l.appendChild(n),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new d.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,n,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,n,l)}resize(f,e=!0){const[n,l]=this._containerDimensions(),u=this._getClampedPixelRatio(n,l);if(this._resizeCanvas(n,l,u),this.painter.resize(n,l,u),this.painter.overLimit()){const y=this.painter.context.gl;this._maxCanvasSize=[y.drawingBufferWidth,y.drawingBufferHeight];const b=this._getClampedPixelRatio(n,l);this._resizeCanvas(n,l,b),this.painter.resize(n,l,b)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new d.l("movestart",f)).fire(new d.l("move",f))),this.fire(new d.l("resize",f)),m&&this.fire(new d.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[n,l]=this._containerDimensions();this.transform.resize(n,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,l,f)}_getClampedPixelRatio(f,e){const{0:n,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),m=f*u,y=e*u;return Math.min(m>n?n/m:1,y>l?l/y:1)*u}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(zi.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(d.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(d.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,n){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:n,delegates:{mousemove:m=>{const y=e.filter(T=>this.getLayer(T)),b=y.length!==0?this.queryRenderedFeatures(m.point,{layers:y}):[];b.length?l||(l=!0,n.call(this,new wn(f,this,m.originalEvent,{features:b}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:n,delegates:{mousemove:y=>{const b=e.filter(T=>this.getLayer(T));(b.length!==0?this.queryRenderedFeatures(y.point,{layers:b}):[]).length?l=!0:l&&(l=!1,n.call(this,new wn(f,this,y.originalEvent)))},mouseout:y=>{l&&(l=!1,n.call(this,new wn(f,this,y.originalEvent)))}}}}{const l=u=>{const m=e.filter(b=>this.getLayer(b)),y=m.length!==0?this.queryRenderedFeatures(u.point,{layers:m}):[];y.length&&(u.features=y,n.call(this,u),delete u.features)};return{layers:e,listener:n,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,n){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let u=0;u<l.length;u++){const m=l[u];if(m.listener===n&&m.layers.length===e.length&&m.layers.every(y=>e.includes(y))){for(const y in m.delegates)this.off(y,m.delegates[y]);return void l.splice(u,1)}}}on(f,e,n){if(n===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,n);this._saveDelegatedListener(f,u);for(const m in u.delegates)this.on(m,u.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,n)}}}once(f,e,n){if(n===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,n);for(const m in u.delegates){const y=u.delegates[m];u.delegates[m]=(...b)=>{this._removeDelegatedListener(f,l,n),y(...b)}}this._saveDelegatedListener(f,u);for(const m in u.delegates)this.once(m,u.delegates[m]);return this}off(f,e,n){return n===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let n;const l=f instanceof d.P||Array.isArray(f),u=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},u instanceof d.P||typeof u[0]=="number")n=[d.P.convert(u)];else{const m=d.P.convert(u[0]),y=d.P.convert(u[1]);n=[m,new d.P(y.x,m.y),y,new d.P(m.x,y.y),m]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var n,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const u=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Yu(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,u):this.style.loadJSON(f,e,u),this):((l=(n=this.style)===null||n===void 0?void 0:n.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Yu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const n=this._requestManager.transformRequest(f,"Style");d.j(n,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new d.k(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(n){d.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new d.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const n in this.style._layers){const l=this.style._layers[n];l.type==="hillshade"&&l.source===f.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new wu(this.painter,e,f),this.painter.renderToTexture=new Ei(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{var l;n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=n.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new d.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const n=f[e]._tiles;for(const l in n){const u=n[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}setSourceTileLodParams(f,e,n){if(n){const l=this.getSource(n);if(!l)throw new Error(`There is no source with ID "${n}", cannot set LOD parameters`);l.calculateTileZoom=ve(Math.max(1,f),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=ve(Math.max(1,f),Math.max(1,e));return this._update(!0),this}refreshTiles(f,e){const n=this.style.sourceCaches[f];if(!n)throw new Error(`There is no source cache with ID "${f}", cannot refresh tile`);e===void 0?n.reload():n.refreshTiles(e.map(l=>new d.a1(l.z,l.x,l.y)))}addImage(f,e,n={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:m,stretchY:y,content:b,textFitWidth:T,textFitHeight:C}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||d.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new d.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:B,data:k}=e,Z=e;return this.style.addImage(f,{data:new d.R({width:z,height:B},new Uint8Array(k)),pixelRatio:l,stretchX:m,stretchY:y,content:b,textFitWidth:T,textFitHeight:C,sdf:u,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,f),this}}{const{width:z,height:B,data:k}=Se.getImageData(e);this.style.addImage(f,{data:new d.R({width:z,height:B},k),pixelRatio:l,stretchX:m,stretchY:y,content:b,textFitWidth:T,textFitHeight:C,sdf:u,version:0})}}updateImage(f,e){const n=this.style.getImage(f);if(!n)return this.fire(new d.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||d.b(e)?Se.getImageData(e):e,{width:u,height:m,data:y}=l;if(u===void 0||m===void 0)return this.fire(new d.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==n.data.width||m!==n.data.height)return this.fire(new d.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(e instanceof HTMLImageElement||d.b(e));return n.data.replace(y,b),this.style.updateImage(f,n),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new d.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return qt.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,n){return this.style.setLayerZoomRange(f,e,n),this._update(!0)}setFilter(f,e,n={}){return this.style.setFilter(f,e,n),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,n,l={}){return this.style.setPaintProperty(f,e,n,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,n,l={}){return this.style.setLayoutProperty(f,e,n,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,n,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,n=>{n||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=pe.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=pe.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),l=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],l);const u=this._controlContainer=pe.create("div","maplibregl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{m[y]=pe.create("div",`maplibregl-ctrl-${y} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,n){this._canvas.width=Math.floor(n*f),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!n){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new Vo(n,this.transform),Pe.testSupport(n)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new d.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,n,l,u,m;const y=this._idleTriggered?this._fadeDuration:0,b=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let T=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,k=Se.now();this.style.zoomHistory.update(B,k);const Z=new d.C(B,{now:k,fadeDuration:y,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),G=Z.crossFadingFactor();G===1&&G===this._crossFadingFactor||(T=!0,this._crossFadingFactor=G),this.style.update(Z)}const C=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==b;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((u=this.style.projection)===null||u===void 0?void 0:u.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||C)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,C),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,showPadding:this.showPadding}),this.fire(new d.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.cn.mark(d.co.load),this.fire(new d.l("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const z=this._sourcesDirty||this._styleDirty||this._placementDirty;return z||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.l("idle")),!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,d.cn.mark(d.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),qt.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),pe.remove(this._canvasContainer),pe.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),d.cn.clearMetrics(),this._removed=!0,this.fire(new d.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Se.frame(this._frameRequest,f=>{d.cn.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!d.cp(e)&&!function(n){return n.message===_c}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return jt}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},P.MapMouseEvent=wn,P.MapTouchEvent=dr,P.MapWheelEvent=Qn,P.Marker=xs,P.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),n=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{const l=this._map._getUIString(`NavigationControl.${n}`);e.title=l,e.setAttribute("aria-label",l)},this.options=d.e({},vs,f),this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),pe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),pe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=pe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ol(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){pe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const n=pe.create("button",f,this._container);return n.type="button",n.addEventListener("click",e),n}},P.Popup=class extends d.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&pe.remove(this._content),this._container&&(pe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=pe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=pe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const y of this.options.className.split(" "))this._container.classList.add(y);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=no(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const n=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const u=en(this.options.offset);if(!l){const y=this._container.offsetWidth,b=this._container.offsetHeight;let T;T=n.y+u.bottom.y<b?["top"]:n.y>this._map.transform.height-b?["bottom"]:[],n.x<y/2?T.push("left"):n.x>this._map.transform.width-y/2&&T.push("right"),l=T.length===0?"bottom":T.join("-")}let m=n.add(u[l]);this.options.subpixelPositioning||(m=m.round()),pe.setTransform(this._container,`${fr[l]} translate(${m.x}px,${m.y}px)`),Tn(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(zc),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=d.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),n=document.createElement("body");let l;for(n.innerHTML=f;l=n.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=pe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=pe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(fa);f&&f.focus()}},P.RasterDEMTileSource=rc,P.RasterTileSource=An,P.ScaleControl=class{constructor(f){this._onMove=()=>{Ho(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ho(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ac),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){pe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},P.ScrollZoomHandler=ti,P.Style=Yu,P.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=pe.create("button","maplibregl-ctrl-terrain",this._container),pe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){pe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},P.TwoFingersTouchPitchHandler=Zo,P.TwoFingersTouchRotateHandler=vt,P.TwoFingersTouchZoomHandler=_s,P.TwoFingersTouchZoomRotateHandler=Xr,P.VectorTileSource=Os,P.VideoSource=Va,P.addSourceType=(f,e)=>d._(void 0,void 0,void 0,function*(){if(ss(f))throw new Error(`A source type called "${f}" already exists.`);((n,l)=>{Fs[n]=l})(f,e)}),P.clearPrewarmedResources=function(){const f=xt;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Ye),xt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},P.createTileMesh=cc,P.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},P.getRTLTextPluginStatus=function(){return oa().getRTLTextPluginStatus()},P.getVersion=function(){return Pc},P.getWorkerCount=function(){return ot.workerCount},P.getWorkerUrl=function(){return d.a.WORKER_URL},P.importScriptInWorkers=function(f){return ci().broadcast("IS",f)},P.prewarm=function(){Rt().acquire(Ye)},P.setMaxParallelImageRequests=function(f){d.a.MAX_PARALLEL_IMAGE_REQUESTS=f},P.setRTLTextPlugin=function(f,e){return oa().setRTLTextPlugin(f,e)},P.setWorkerCount=function(f){ot.workerCount=f},P.setWorkerUrl=function(f){d.a.WORKER_URL=f}});var ae=O;return ae})}(Up)),Up.exports}var zy=Ay();const Km=Wm(zy);var Bs=Uint8Array,Xd=Uint16Array,Py=Int32Array,_g=new Bs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yg=new Bs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dy=new Bs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vg=function(E,D){for(var O=new Xd(31),R=0;R<31;++R)O[R]=D+=1<<E[R-1];for(var H=new Py(O[30]),R=1;R<30;++R)for(var ae=O[R];ae<O[R+1];++ae)H[ae]=ae-O[R]<<5|R;return{b:O,r:H}},xg=vg(_g,2),bg=xg.b,Iy=xg.r;bg[28]=258,Iy[258]=28;var Ry=vg(yg,0),ky=Ry.b,ym=new Xd(32768);for(var Bn=0;Bn<32768;++Bn){var $u=(Bn&43690)>>1|(Bn&21845)<<1;$u=($u&52428)>>2|($u&13107)<<2,$u=($u&61680)>>4|($u&3855)<<4,ym[Bn]=(($u&65280)>>8|($u&255)<<8)>>1}var Qf=function(E,D,O){for(var R=E.length,H=0,ae=new Xd(D);H<R;++H)E[H]&&++ae[E[H]-1];var P=new Xd(D);for(H=1;H<D;++H)P[H]=P[H-1]+ae[H-1]<<1;var d;if(O){d=new Xd(1<<D);var ge=15-D;for(H=0;H<R;++H)if(E[H])for(var re=H<<4|E[H],Ce=D-E[H],Ne=P[E[H]-1]++<<Ce,Se=Ne|(1<<Ce)-1;Ne<=Se;++Ne)d[ym[Ne]>>ge]=re}else for(d=new Xd(R),H=0;H<R;++H)E[H]&&(d[H]=ym[P[E[H]-1]++]>>15-E[H]);return d},np=new Bs(288);for(var Bn=0;Bn<144;++Bn)np[Bn]=8;for(var Bn=144;Bn<256;++Bn)np[Bn]=9;for(var Bn=256;Bn<280;++Bn)np[Bn]=7;for(var Bn=280;Bn<288;++Bn)np[Bn]=8;var wg=new Bs(32);for(var Bn=0;Bn<32;++Bn)wg[Bn]=5;var Ly=Qf(np,9,1),By=Qf(wg,5,1),fm=function(E){for(var D=E[0],O=1;O<E.length;++O)E[O]>D&&(D=E[O]);return D},sl=function(E,D,O){var R=D/8|0;return(E[R]|E[R+1]<<8)>>(D&7)&O},pm=function(E,D){var O=D/8|0;return(E[O]|E[O+1]<<8|E[O+2]<<16)>>(D&7)},Oy=function(E){return(E+7)/8|0},Fy=function(E,D,O){return(O==null||O>E.length)&&(O=E.length),new Bs(E.subarray(D,O))},jy=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ls=function(E,D,O){var R=new Error(D||jy[E]);if(R.code=E,Error.captureStackTrace&&Error.captureStackTrace(R,Ls),!O)throw R;return R},Em=function(E,D,O,R){var H=E.length,ae=0;if(!H||D.f&&!D.l)return O||new Bs(0);var P=!O,d=P||D.i!=2,ge=D.i;P&&(O=new Bs(H*3));var re=function(Ii){var sn=O.length;if(Ii>sn){var Qi=new Bs(Math.max(sn*2,Ii));Qi.set(O),O=Qi}},Ce=D.f||0,Ne=D.p||0,Se=D.b||0,pe=D.l,Pe=D.d,ht=D.m,Tt=D.n,pt=H*8;do{if(!pe){Ce=sl(E,Ne,1);var St=sl(E,Ne+1,3);if(Ne+=3,St)if(St==1)pe=Ly,Pe=By,ht=9,Tt=5;else if(St==2){var Zt=sl(E,Ne,31)+257,di=sl(E,Ne+10,15)+4,Xt=Zt+sl(E,Ne+5,31)+1;Ne+=14;for(var li=new Bs(Xt),ni=new Bs(19),Bt=0;Bt<di;++Bt)ni[Dy[Bt]]=sl(E,Ne+Bt*3,7);Ne+=di*3;for(var wi=fm(ni),_n=(1<<wi)-1,Ct=Qf(ni,wi,1),Bt=0;Bt<Xt;){var mt=Ct[sl(E,Ne,_n)];Ne+=mt&15;var Pt=mt>>4;if(Pt<16)li[Bt++]=Pt;else{var be=0,Ke=0;for(Pt==16?(Ke=3+sl(E,Ne,3),Ne+=2,be=li[Bt-1]):Pt==17?(Ke=3+sl(E,Ne,7),Ne+=3):Pt==18&&(Ke=11+sl(E,Ne,127),Ne+=7);Ke--;)li[Bt++]=be}}var Ge=li.subarray(0,Zt),_t=li.subarray(Zt);ht=fm(Ge),Tt=fm(_t),pe=Qf(Ge,ht,1),Pe=Qf(_t,Tt,1)}else Ls(1);else{var Pt=Oy(Ne)+4,qt=E[Pt-4]|E[Pt-3]<<8,bt=Pt+qt;if(bt>H){ge&&Ls(0);break}d&&re(Se+qt),O.set(E.subarray(Pt,bt),Se),D.b=Se+=qt,D.p=Ne=bt*8,D.f=Ce;continue}if(Ne>pt){ge&&Ls(0);break}}d&&re(Se+131072);for(var le=(1<<ht)-1,Ye=(1<<Tt)-1,ot=Ne;;ot=Ne){var be=pe[pm(E,Ne)&le],ct=be>>4;if(Ne+=be&15,Ne>pt){ge&&Ls(0);break}if(be||Ls(2),ct<256)O[Se++]=ct;else if(ct==256){ot=Ne,pe=null;break}else{var xt=ct-254;if(ct>264){var Bt=ct-257,At=_g[Bt];xt=sl(E,Ne,(1<<At)-1)+bg[Bt],Ne+=At}var Rt=Pe[pm(E,Ne)&Ye],fi=Rt>>4;Rt||Ls(3),Ne+=Rt&15;var _t=ky[fi];if(fi>3){var At=yg[fi];_t+=pm(E,Ne)&(1<<At)-1,Ne+=At}if(Ne>pt){ge&&Ls(0);break}d&&re(Se+131072);var ci=Se+xt;if(Se<_t){var Ki=ae-_t,rn=Math.min(_t,ci);for(Ki+Se<0&&Ls(3);Se<rn;++Se)O[Se]=R[Ki+Se]}for(;Se<ci;++Se)O[Se]=O[Se-_t]}}D.l=pe,D.p=ot,D.b=Se,D.f=Ce,pe&&(Ce=1,D.m=ht,D.d=Pe,D.n=Tt)}while(!Ce);return Se!=O.length&&P?Fy(O,0,Se):O.subarray(0,Se)},Ny=new Bs(0),Uy=function(E){(E[0]!=31||E[1]!=139||E[2]!=8)&&Ls(6,"invalid gzip data");var D=E[3],O=10;D&4&&(O+=(E[10]|E[11]<<8)+2);for(var R=(D>>3&1)+(D>>4&1);R>0;R-=!E[O++]);return O+(D&2)},Vy=function(E){var D=E.length;return(E[D-4]|E[D-3]<<8|E[D-2]<<16|E[D-1]<<24)>>>0},Zy=function(E,D){return((E[0]&15)!=8||E[0]>>4>7||(E[0]<<8|E[1])%31)&&Ls(6,"invalid zlib data"),(E[1]>>5&1)==1&&Ls(6,"invalid zlib data: "+(E[1]&32?"need":"unexpected")+" dictionary"),(E[1]>>3&4)+2};function Gy(E,D){return Em(E,{i:2},D,D)}function qy(E,D){var O=Uy(E);return O+8>E.length&&Ls(6,"invalid gzip data"),Em(E.subarray(O,-8),{i:2},new Bs(Vy(E)),D)}function Hy(E,D){return Em(E.subarray(Zy(E),-4),{i:2},D,D)}function $y(E,D){return E[0]==31&&E[1]==139&&E[2]==8?qy(E,D):(E[0]&15)!=8||E[0]>>4>7||(E[0]<<8|E[1])%31?Gy(E,D):Hy(E,D)}var Xy=typeof TextDecoder<"u"&&new TextDecoder,Yy=0;try{Xy.decode(Ny,{stream:!0}),Yy=1}catch{}var Ky=Object.defineProperty,Wf=Math.pow,hn=(E,D)=>Ky(E,"name",{value:D,configurable:!0}),Ua=(E,D,O)=>new Promise((R,H)=>{var ae=ge=>{try{d(O.next(ge))}catch(re){H(re)}},P=ge=>{try{d(O.throw(ge))}catch(re){H(re)}},d=ge=>ge.done?R(ge.value):Promise.resolve(ge.value).then(ae,P);d((O=O.apply(E,D)).next())});hn((E,D)=>{let O=!1,R="",H=L.GridLayer.extend({createTile:hn((ae,P)=>{let d=document.createElement("img"),ge=new AbortController,re=ge.signal;return d.cancel=()=>{ge.abort()},O||(E.getHeader().then(Ce=>{Ce.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):Ce.tileType===2?R="image/png":Ce.tileType===3?R="image/jpeg":Ce.tileType===4?R="image/webp":Ce.tileType===5&&(R="image/avif")}),O=!0),E.getZxy(ae.z,ae.x,ae.y,re).then(Ce=>{if(Ce){let Ne=new Blob([Ce.data],{type:R}),Se=window.URL.createObjectURL(Ne);d.src=Se,d.cancel=void 0,P(void 0,d)}}).catch(Ce=>{if(Ce.name!=="AbortError")throw Ce}),d},"createTile"),_removeTile:hn(function(ae){let P=this._tiles[ae];P&&(P.el.cancel&&P.el.cancel(),P.el.width=0,P.el.height=0,P.el.deleted=!0,L.DomUtil.remove(P.el),delete this._tiles[ae],this.fire("tileunload",{tile:P.el,coords:this._keyToTileCoords(ae)}))},"_removeTile")});return new H(D)},"leafletRasterLayer");var Qy=hn(E=>(D,O)=>{if(O instanceof AbortController)return E(D,O);let R=new AbortController;return E(D,R).then(H=>O(void 0,H.data,H.cacheControl||"",H.expires||""),H=>O(H)).catch(H=>O(H)),{cancel:hn(()=>R.abort(),"cancel")}},"v3compat"),Tg=class{constructor(D){this.tilev4=hn((O,R)=>Ua(this,null,function*(){if(O.type==="json"){let pe=O.url.substr(10),Pe=this.tiles.get(pe);if(Pe||(Pe=new Qm(pe),this.tiles.set(pe,Pe)),this.metadata)return{data:yield Pe.getTileJson(O.url)};let ht=yield Pe.getHeader();return(ht.minLon>=ht.maxLon||ht.minLat>=ht.maxLat)&&console.error(`Bounds of PMTiles archive ${ht.minLon},${ht.minLat},${ht.maxLon},${ht.maxLat} are not valid.`),{data:{tiles:[`${O.url}/{z}/{x}/{y}`],minzoom:ht.minZoom,maxzoom:ht.maxZoom,bounds:[ht.minLon,ht.minLat,ht.maxLon,ht.maxLat]}}}let H=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),ae=O.url.match(H);if(!ae)throw new Error("Invalid PMTiles protocol URL");let P=ae[1],d=this.tiles.get(P);d||(d=new Qm(P),this.tiles.set(P,d));let ge=ae[2],re=ae[3],Ce=ae[4],Ne=yield d.getHeader(),Se=yield d==null?void 0:d.getZxy(+ge,+re,+Ce,R.signal);if(Se)return{data:new Uint8Array(Se.data),cacheControl:Se.cacheControl,expires:Se.expires};if(Ne.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=Qy(this.tilev4),this.tiles=new Map,this.metadata=(D==null?void 0:D.metadata)||!1,this.errorOnMissingTile=(D==null?void 0:D.errorOnMissingTile)||!1}add(D){this.tiles.set(D.source.getKey(),D)}get(D){return this.tiles.get(D)}};hn(Tg,"Protocol");var Wy=Tg;function Sg(E,D){return(D>>>0)*4294967296+(E>>>0)}hn(Sg,"toNum");function Mg(E,D){let O=D.buf,R=O[D.pos++],H=(R&112)>>4;if(R<128||(R=O[D.pos++],H|=(R&127)<<3,R<128)||(R=O[D.pos++],H|=(R&127)<<10,R<128)||(R=O[D.pos++],H|=(R&127)<<17,R<128)||(R=O[D.pos++],H|=(R&127)<<24,R<128)||(R=O[D.pos++],H|=(R&1)<<31,R<128))return Sg(E,H);throw new Error("Expected varint not more than 10 bytes")}hn(Mg,"readVarintRemainder");function $d(E){let D=E.buf,O=D[E.pos++],R=O&127;return O<128||(O=D[E.pos++],R|=(O&127)<<7,O<128)||(O=D[E.pos++],R|=(O&127)<<14,O<128)||(O=D[E.pos++],R|=(O&127)<<21,O<128)?R:(O=D[E.pos],R|=(O&15)<<28,Mg(R,E))}hn($d,"readVarint");function Cm(E,D,O,R){if(R===0){O===1&&(D[0]=E-1-D[0],D[1]=E-1-D[1]);let H=D[0];D[0]=D[1],D[1]=H}}hn(Cm,"rotate");function Eg(E,D){let O=Wf(2,E),R=D,H=D,ae=D,P=[0,0],d=1;for(;d<O;)R=1&ae/2,H=1&(ae^R),Cm(d,P,R,H),P[0]+=d*R,P[1]+=d*H,ae=ae/4,d*=2;return[E,P[0],P[1]]}hn(Eg,"idOnLevel");var Jy=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Cg(E,D,O){if(E>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(D>Wf(2,E)-1||O>Wf(2,E)-1)throw new Error("tile x/y outside zoom level bounds");let R=Jy[E],H=Wf(2,E),ae=0,P=0,d=0,ge=[D,O],re=H/2;for(;re>0;)ae=(ge[0]&re)>0?1:0,P=(ge[1]&re)>0?1:0,d+=re*re*(3*ae^P),Cm(re,ge,ae,P),re=re/2;return R+d}hn(Cg,"zxyToTileId");function ev(E){let D=0;for(let O=0;O<27;O++){let R=(1<<O)*(1<<O);if(D+R>E)return Eg(O,E-D);D+=R}throw new Error("Tile zoom level exceeds max safe number limit (26)")}hn(ev,"tileIdToZxy");var tv=(E=>(E[E.Unknown=0]="Unknown",E[E.None=1]="None",E[E.Gzip=2]="Gzip",E[E.Brotli=3]="Brotli",E[E.Zstd=4]="Zstd",E))(tv||{});function qp(E,D){return Ua(this,null,function*(){if(D===1||D===0)return E;if(D===2){if(typeof globalThis.DecompressionStream>"u")return $y(new Uint8Array(E));let O=new Response(E).body;if(!O)throw new Error("Failed to read response stream");let R=O.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(R).arrayBuffer()}throw new Error("Compression method not supported")})}hn(qp,"defaultDecompress");var iv=(E=>(E[E.Unknown=0]="Unknown",E[E.Mvt=1]="Mvt",E[E.Png=2]="Png",E[E.Jpeg=3]="Jpeg",E[E.Webp=4]="Webp",E[E.Avif=5]="Avif",E))(iv||{});function Ag(E){return E===1?".mvt":E===2?".png":E===3?".jpg":E===4?".webp":E===5?".avif":""}hn(Ag,"tileTypeExt");var nv=127;function zg(E,D){let O=0,R=E.length-1;for(;O<=R;){let H=R+O>>1,ae=D-E[H].tileId;if(ae>0)O=H+1;else if(ae<0)R=H-1;else return E[H]}return R>=0&&(E[R].runLength===0||D-E[R].tileId<E[R].runLength)?E[R]:null}hn(zg,"findTile");var av=class{constructor(D){this.file=D}getKey(){return this.file.name}getBytes(D,O){return Ua(this,null,function*(){return{data:yield this.file.slice(D,D+O).arrayBuffer()}})}};hn(av,"FileSource");var Pg=class{constructor(D,O=new Headers){this.url=D,this.customHeaders=O,this.mustReload=!1;let R="";"navigator"in globalThis&&(R=globalThis.navigator.userAgent||"");let H=R.indexOf("Windows")>-1,ae=/Chrome|Chromium|Edg|OPR|Brave/.test(R);this.chromeWindowsNoCache=!1,H&&ae&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(D){this.customHeaders=D}getBytes(D,O,R,H){return Ua(this,null,function*(){let ae,P;R?P=R:(ae=new AbortController,P=ae.signal);let d=new Headers(this.customHeaders);d.set("range",`bytes=${D}-${D+O-1}`);let ge;this.mustReload?ge="reload":this.chromeWindowsNoCache&&(ge="no-store");let re=yield fetch(this.url,{signal:P,cache:ge,headers:d});if(D===0&&re.status===416){let Se=re.headers.get("Content-Range");if(!Se||!Se.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let pe=+Se.substr(8);re=yield fetch(this.url,{signal:P,cache:"reload",headers:{range:`bytes=0-${pe-1}`}})}let Ce=re.headers.get("Etag");if(Ce!=null&&Ce.startsWith("W/")&&(Ce=null),re.status===416||H&&Ce&&Ce!==H)throw this.mustReload=!0,new vm(`Server returned non-matching ETag ${H} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(re.status>=300)throw new Error(`Bad response code: ${re.status}`);let Ne=re.headers.get("Content-Length");if(re.status===200&&(!Ne||+Ne>O))throw ae&&ae.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield re.arrayBuffer(),etag:Ce||void 0,cacheControl:re.headers.get("Cache-Control")||void 0,expires:re.headers.get("Expires")||void 0}})}};hn(Pg,"FetchSource");var rv=Pg;function po(E,D){let O=E.getUint32(D+4,!0),R=E.getUint32(D+0,!0);return O*Wf(2,32)+R}hn(po,"getUint64");function Dg(E,D){let O=new DataView(E),R=O.getUint8(7);if(R>3)throw new Error(`Archive is spec version ${R} but this library supports up to spec version 3`);return{specVersion:R,rootDirectoryOffset:po(O,8),rootDirectoryLength:po(O,16),jsonMetadataOffset:po(O,24),jsonMetadataLength:po(O,32),leafDirectoryOffset:po(O,40),leafDirectoryLength:po(O,48),tileDataOffset:po(O,56),tileDataLength:po(O,64),numAddressedTiles:po(O,72),numTileEntries:po(O,80),numTileContents:po(O,88),clustered:O.getUint8(96)===1,internalCompression:O.getUint8(97),tileCompression:O.getUint8(98),tileType:O.getUint8(99),minZoom:O.getUint8(100),maxZoom:O.getUint8(101),minLon:O.getInt32(102,!0)/1e7,minLat:O.getInt32(106,!0)/1e7,maxLon:O.getInt32(110,!0)/1e7,maxLat:O.getInt32(114,!0)/1e7,centerZoom:O.getUint8(118),centerLon:O.getInt32(119,!0)/1e7,centerLat:O.getInt32(123,!0)/1e7,etag:D}}hn(Dg,"bytesToHeader");function Am(E){let D={buf:new Uint8Array(E),pos:0},O=$d(D),R=[],H=0;for(let ae=0;ae<O;ae++){let P=$d(D);R.push({tileId:H+P,offset:0,length:0,runLength:1}),H+=P}for(let ae=0;ae<O;ae++)R[ae].runLength=$d(D);for(let ae=0;ae<O;ae++)R[ae].length=$d(D);for(let ae=0;ae<O;ae++){let P=$d(D);P===0&&ae>0?R[ae].offset=R[ae-1].offset+R[ae-1].length:R[ae].offset=P-1}return R}hn(Am,"deserializeIndex");var Ig=class extends Error{};hn(Ig,"EtagMismatch");var vm=Ig;function zm(E,D){return Ua(this,null,function*(){let O=yield E.getBytes(0,16384);if(new DataView(O.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let R=O.data.slice(0,nv),H=Dg(R,O.etag),ae=O.data.slice(H.rootDirectoryOffset,H.rootDirectoryOffset+H.rootDirectoryLength),P=`${E.getKey()}|${H.etag||""}|${H.rootDirectoryOffset}|${H.rootDirectoryLength}`,d=Am(yield D(ae,H.internalCompression));return[H,[P,d.length,d]]})}hn(zm,"getHeaderAndRoot");function Pm(E,D,O,R,H){return Ua(this,null,function*(){let ae=yield E.getBytes(O,R,void 0,H.etag),P=yield D(ae.data,H.internalCompression),d=Am(P);if(d.length===0)throw new Error("Empty directory is invalid");return d})}hn(Pm,"getDirectory");var sv=class{constructor(D=100,O=!0,R=qp){this.cache=new Map,this.maxCacheEntries=D,this.counter=1,this.decompress=R}getHeader(D){return Ua(this,null,function*(){let O=D.getKey(),R=this.cache.get(O);if(R)return R.lastUsed=this.counter++,R.data;let H=yield zm(D,this.decompress);return H[1]&&this.cache.set(H[1][0],{lastUsed:this.counter++,data:H[1][2]}),this.cache.set(O,{lastUsed:this.counter++,data:H[0]}),this.prune(),H[0]})}getDirectory(D,O,R,H){return Ua(this,null,function*(){let ae=`${D.getKey()}|${H.etag||""}|${O}|${R}`,P=this.cache.get(ae);if(P)return P.lastUsed=this.counter++,P.data;let d=yield Pm(D,this.decompress,O,R,H);return this.cache.set(ae,{lastUsed:this.counter++,data:d}),this.prune(),d})}prune(){if(this.cache.size>this.maxCacheEntries){let D=1/0,O;this.cache.forEach((R,H)=>{R.lastUsed<D&&(D=R.lastUsed,O=H)}),O&&this.cache.delete(O)}}invalidate(D){return Ua(this,null,function*(){this.cache.delete(D.getKey())})}};hn(sv,"ResolvedValueCache");var Rg=class{constructor(D=100,O=!0,R=qp){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=D,this.counter=1,this.decompress=R}getHeader(D){return Ua(this,null,function*(){let O=D.getKey(),R=this.cache.get(O);if(R)return R.lastUsed=this.counter++,yield R.data;let H=new Promise((ae,P)=>{zm(D,this.decompress).then(d=>{d[1]&&this.cache.set(d[1][0],{lastUsed:this.counter++,data:Promise.resolve(d[1][2])}),ae(d[0]),this.prune()}).catch(d=>{P(d)})});return this.cache.set(O,{lastUsed:this.counter++,data:H}),H})}getDirectory(D,O,R,H){return Ua(this,null,function*(){let ae=`${D.getKey()}|${H.etag||""}|${O}|${R}`,P=this.cache.get(ae);if(P)return P.lastUsed=this.counter++,yield P.data;let d=new Promise((ge,re)=>{Pm(D,this.decompress,O,R,H).then(Ce=>{ge(Ce),this.prune()}).catch(Ce=>{re(Ce)})});return this.cache.set(ae,{lastUsed:this.counter++,data:d}),d})}prune(){if(this.cache.size>=this.maxCacheEntries){let D=1/0,O;this.cache.forEach((R,H)=>{R.lastUsed<D&&(D=R.lastUsed,O=H)}),O&&this.cache.delete(O)}}invalidate(D){return Ua(this,null,function*(){let O=D.getKey();if(this.invalidations.get(O))return yield this.invalidations.get(O);this.cache.delete(D.getKey());let R=new Promise((H,ae)=>{this.getHeader(D).then(P=>{H(),this.invalidations.delete(O)}).catch(P=>{ae(P)})});this.invalidations.set(O,R)})}};hn(Rg,"SharedPromiseCache");var ov=Rg,kg=class{constructor(D,O,R){typeof D=="string"?this.source=new rv(D):this.source=D,R?this.decompress=R:this.decompress=qp,O?this.cache=O:this.cache=new ov}getHeader(){return Ua(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(D,O,R,H){return Ua(this,null,function*(){let ae=Cg(D,O,R),P=yield this.cache.getHeader(this.source);if(D<P.minZoom||D>P.maxZoom)return;let d=P.rootDirectoryOffset,ge=P.rootDirectoryLength;for(let re=0;re<=3;re++){let Ce=yield this.cache.getDirectory(this.source,d,ge,P),Ne=zg(Ce,ae);if(Ne){if(Ne.runLength>0){let Se=yield this.source.getBytes(P.tileDataOffset+Ne.offset,Ne.length,H,P.etag);return{data:yield this.decompress(Se.data,P.tileCompression),cacheControl:Se.cacheControl,expires:Se.expires}}d=P.leafDirectoryOffset+Ne.offset,ge=Ne.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(D,O,R,H){return Ua(this,null,function*(){try{return yield this.getZxyAttempt(D,O,R,H)}catch(ae){if(ae instanceof vm)return this.cache.invalidate(this.source),yield this.getZxyAttempt(D,O,R,H);throw ae}})}getMetadataAttempt(){return Ua(this,null,function*(){let D=yield this.cache.getHeader(this.source),O=yield this.source.getBytes(D.jsonMetadataOffset,D.jsonMetadataLength,void 0,D.etag),R=yield this.decompress(O.data,D.internalCompression),H=new TextDecoder("utf-8");return JSON.parse(H.decode(R))})}getMetadata(){return Ua(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(D){if(D instanceof vm)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw D}})}getTileJson(D){return Ua(this,null,function*(){let O=yield this.getHeader(),R=yield this.getMetadata(),H=Ag(O.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${D}/{z}/{x}/{y}${H}`],vector_layers:R.vector_layers,attribution:R.attribution,description:R.description,name:R.name,version:R.version,bounds:[O.minLon,O.minLat,O.maxLon,O.maxLat],center:[O.centerLon,O.centerLat,O.centerZoom],minzoom:O.minZoom,maxzoom:O.maxZoom}})}};hn(kg,"PMTiles");var Qm=kg,lv=Object.defineProperty,ac=(E,D)=>lv(E,"name",{value:D,configurable:!0});function rs(E,D){let O="script";return E==="name"?O="script":E==="name2"?O="script2":E==="name3"&&(O="script3"),[["coalesce",["get",`pgf:${E}`],["get",E]],{"text-font":["case",["==",["get",O],"Devanagari"],["literal",["Noto Sans Devanagari Regular v1"]],["literal",[D||"Noto Sans Regular"]]]}]}ac(rs,"get_name_block");function tc(E,D,O){let R="name";return O==="name"?R="":O==="name2"?R="2":O==="name3"&&(R="3"),D==="Latin"?["has",`script${R}`]:E==="ja"?["all",["!=",["get",`script${R}`],"Han"],["!=",["get",`script${R}`],"Hiragana"],["!=",["get",`script${R}`],"Katakana"],["!=",["get",`script${R}`],"Mixed-Japanese"]]:["!=",["get",`script${R}`],D]}ac(tc,"is_not_in_target_script");function ll(E){return E==="Devanagari"?{"text-font":["literal",["Noto Sans Devanagari Regular v1"]]}:{}}ac(ll,"get_font_formatting");function Dm(E){let D=cv.find(O=>O.lang===E);return D===void 0?"Latin":D.script}ac(Dm,"get_default_script");function Lg(E,D){let O=D||Dm(E),R;return O==="Devanagari"?R="pgf:":R="",["format",["coalesce",["get",`${R}name:${E}`],["get","name:en"]],ll(O)]}ac(Lg,"get_country_name");function ol(E,D,O){let R=D||Dm(E),H;return R==="Devanagari"?H="pgf:":H="",["case",["all",["any",["has","name"],["has","pgf:name"]],["!",["any",["has","name2"],["has","pgf:name2"]]],["!",["any",["has","name3"],["has","pgf:name3"]]]],["case",tc(E,R,"name"),["case",["any",["is-supported-script",["get","name"]],["has","pgf:name"]],["format",["coalesce",["get",`${H}name:${E}`],["get","name:en"]],ll(R),`
`,{},["case",["all",["!",["has",`${H}name:${E}`]],["has","name:en"],["!",["has","script"]]],"",["coalesce",["get","pgf:name"],["get","name"]]],{"text-font":["case",["==",["get","script"],"Devanagari"],["literal",["Noto Sans Devanagari Regular v1"]],["literal",[O||"Noto Sans Regular"]]]}],["get","name:en"]],["format",["coalesce",["get",`${H}name:${E}`],["get","pgf:name"],["get","name"]],ll(R)]],["all",["any",["has","name"],["has","pgf:name"]],["any",["has","name2"],["has","pgf:name2"]],["!",["any",["has","name3"],["has","pgf:name3"]]]],["case",["all",tc(E,R,"name"),tc(E,R,"name2")],["format",["get",`${H}name:${E}`],ll(R),`
`,{},...rs("name",O),`
`,{},...rs("name2",O)],["case",tc(E,R,"name2"),["format",["coalesce",["get",`${H}name:${E}`],["get","pgf:name"],["get","name"]],ll(R),`
`,{},...rs("name2",O)],["format",["coalesce",["get",`${H}name:${E}`],["get","pgf:name2"],["get","name2"]],ll(R),`
`,{},...rs("name",O)]]],["case",["all",tc(E,R,"name"),tc(E,R,"name2"),tc(E,R,"name3")],["format",["get",`${H}name:${E}`],ll(R),`
`,{},...rs("name",O),`
`,{},...rs("name2",O),`
`,{},...rs("name3",O)],["case",["!",tc(E,R,"name")],["format",["coalesce",["get",`${H}name:${E}`],["get","pgf:name"],["get","name"]],ll(R),`
`,{},...rs("name2",O),`
`,{},...rs("name3",O)],["!",tc(E,R,"name2")],["format",["coalesce",["get",`${H}name:${E}`],["get","pgf:name2"],["get","name2"]],ll(R),`
`,{},...rs("name",O),`
`,{},...rs("name3",O)],["format",["coalesce",["get",`${H}name:${E}`],["get","pgf:name3"],["get","name3"]],ll(R),`
`,{},...rs("name",O),`
`,{},...rs("name2",O)]]]]}ac(ol,"get_multiline_name");var cv=[{lang:"ar",full_name:"Arabic",script:"Arabic"},{lang:"cs",full_name:"Czech",script:"Latin"},{lang:"bg",full_name:"Bulgarian",script:"Cyrillic"},{lang:"da",full_name:"Danish",script:"Latin"},{lang:"de",full_name:"German",script:"Latin"},{lang:"el",full_name:"Greek",script:"Greek"},{lang:"en",full_name:"English",script:"Latin"},{lang:"es",full_name:"Spanish",script:"Latin"},{lang:"et",full_name:"Estonian",script:"Latin"},{lang:"fa",full_name:"Persian",script:"Arabic"},{lang:"fi",full_name:"Finnish",script:"Latin"},{lang:"fr",full_name:"French",script:"Latin"},{lang:"ga",full_name:"Irish",script:"Latin"},{lang:"he",full_name:"Hebrew",script:"Hebrew"},{lang:"hi",full_name:"Hindi",script:"Devanagari"},{lang:"hr",full_name:"Croatian",script:"Latin"},{lang:"hu",full_name:"Hungarian",script:"Latin"},{lang:"id",full_name:"Indonesian",script:"Latin"},{lang:"it",full_name:"Italian",script:"Latin"},{lang:"ja",full_name:"Japanese",script:""},{lang:"ko",full_name:"Korean",script:"Hangul"},{lang:"lt",full_name:"Lithuanian",script:"Latin"},{lang:"lv",full_name:"Latvian",script:"Latin"},{lang:"ne",full_name:"Nepali",script:"Devanagari"},{lang:"nl",full_name:"Dutch",script:"Latin"},{lang:"no",full_name:"Norwegian",script:"Latin"},{lang:"mr",full_name:"Marathi",script:"Devanagari"},{lang:"mt",full_name:"Maltese",script:"Latin"},{lang:"pl",full_name:"Polish",script:"Latin"},{lang:"pt",full_name:"Portuguese",script:"Latin"},{lang:"ro",full_name:"Romanian",script:"Latin"},{lang:"ru",full_name:"Russian",script:"Cyrillic"},{lang:"sk",full_name:"Slovak",script:"Latin"},{lang:"sl",full_name:"Slovenian",script:"Latin"},{lang:"sv",full_name:"Swedish",script:"Latin"},{lang:"tr",full_name:"Turkish",script:"Latin"},{lang:"uk",full_name:"Ukrainian",script:"Cyrillic"},{lang:"ur",full_name:"Urdu",script:"Arabic"},{lang:"vi",full_name:"Vietnamese",script:"Latin"},{lang:"zh-Hans",full_name:"Chinese (Simplified)",script:"Han"},{lang:"zh-Hant",full_name:"Chinese (Traditional)",script:"Han"}];function Bg(E,D){return[{id:"background",type:"background",paint:{"background-color":D.background}},{id:"earth",type:"fill",filter:["==","$type","Polygon"],source:E,"source-layer":"earth",paint:{"fill-color":D.earth}},...D.landcover?[{id:"landcover",type:"fill",source:E,"source-layer":"landcover",paint:{"fill-color":["match",["get","kind"],"grassland",D.landcover.grassland,"barren",D.landcover.barren,"urban_area",D.landcover.urban_area,"farmland",D.landcover.farmland,"glacier",D.landcover.glacier,"scrub",D.landcover.scrub,D.landcover.forest],"fill-opacity":["interpolate",["linear"],["zoom"],5,1,7,0]}}]:[],{id:"landuse_park",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course","wood","nature_reserve","forest","scrub","grassland","grass","military","naval_base","airfield"],paint:{"fill-opacity":["interpolate",["linear"],["zoom"],6,0,11,1],"fill-color":["case",["in",["get","kind"],["literal",["national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"]]],D.park_b,["in",["get","kind"],["literal",["wood","nature_reserve","forest"]]],D.wood_b,["in",["get","kind"],["literal",["scrub","grassland","grass"]]],D.scrub_b,["in",["get","kind"],["literal",["glacier"]]],D.glacier,["in",["get","kind"],["literal",["sand"]]],D.sand,["in",["get","kind"],["literal",["military","naval_base","airfield"]]],D.zoo,D.earth]}},{id:"landuse_urban_green",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","allotments","village_green","playground"],paint:{"fill-color":D.park_b,"fill-opacity":.7}},{id:"landuse_hospital",type:"fill",source:E,"source-layer":"landuse",filter:["==","kind","hospital"],paint:{"fill-color":D.hospital}},{id:"landuse_industrial",type:"fill",source:E,"source-layer":"landuse",filter:["==","kind","industrial"],paint:{"fill-color":D.industrial}},{id:"landuse_school",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","school","university","college"],paint:{"fill-color":D.school}},{id:"landuse_beach",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","beach"],paint:{"fill-color":D.beach}},{id:"landuse_zoo",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","zoo"],paint:{"fill-color":D.zoo}},{id:"landuse_aerodrome",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","aerodrome"],paint:{"fill-color":D.aerodrome}},{id:"roads_runway",type:"line",source:E,"source-layer":"roads",filter:["==","kind_detail","runway"],paint:{"line-color":D.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,12,4,18,30]}},{id:"roads_taxiway",type:"line",source:E,"source-layer":"roads",minzoom:13,filter:["==","kind_detail","taxiway"],paint:{"line-color":D.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,15,6]}},{id:"landuse_runway",type:"fill",source:E,"source-layer":"landuse",filter:["any",["in","kind","runway","taxiway"]],paint:{"fill-color":D.runway}},{id:"water",type:"fill",filter:["==","$type","Polygon"],source:E,"source-layer":"water",paint:{"fill-color":D.water}},{id:"water_stream",type:"line",source:E,"source-layer":"water",minzoom:14,filter:["in","kind","stream"],paint:{"line-color":D.water,"line-width":.5}},{id:"water_river",type:"line",source:E,"source-layer":"water",minzoom:9,filter:["in","kind","river"],paint:{"line-color":D.water,"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1,18,12]}},{id:"landuse_pedestrian",type:"fill",source:E,"source-layer":"landuse",filter:["in","kind","pedestrian","dam"],paint:{"fill-color":D.pedestrian}},{id:"landuse_pier",type:"fill",source:E,"source-layer":"landuse",filter:["==","kind","pier"],paint:{"fill-color":D.pier}},{id:"roads_tunnels_other_casing",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["in","kind","other","path"]],paint:{"line-color":D.tunnel_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor_casing",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","minor_road"]],paint:{"line-color":D.tunnel_minor_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_link_casing",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["has","is_link"]],paint:{"line-color":D.tunnel_link_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_major_casing",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":D.tunnel_major_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_tunnels_highway_casing",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":D.tunnel_highway_casing,"line-dasharray":[6,.5],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_tunnels_other",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["in","kind","other","path"]],paint:{"line-color":D.tunnel_other,"line-dasharray":[4.5,.5],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","minor_road"]],paint:{"line-color":D.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_tunnels_link",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["has","is_link"]],paint:{"line-color":D.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_tunnels_major",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","major_road"]],paint:{"line-color":D.tunnel_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_tunnels_highway",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==",["get","kind"],"highway"],["!",["has","is_link"]]],paint:{"line-color":D.tunnel_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"buildings",type:"fill",source:E,"source-layer":"buildings",filter:["in","kind","building","building_part"],paint:{"fill-color":D.buildings,"fill-opacity":.5}},{id:"roads_pier",type:"line",source:E,"source-layer":"roads",filter:["==","kind_detail","pier"],paint:{"line-color":D.pier,"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,16]}},{id:"roads_minor_service_casing",type:"line",source:E,"source-layer":"roads",minzoom:13,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["==","kind_detail","service"]],paint:{"line-color":D.minor_service_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_minor_casing",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["!=","kind_detail","service"]],paint:{"line-color":D.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_link_casing",type:"line",source:E,"source-layer":"roads",minzoom:13,filter:["has","is_link"],paint:{"line-color":D.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1.5]}},{id:"roads_major_casing_late",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":D.major_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_highway_casing_late",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":D.highway_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_other",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["in","kind","other","path"],["!=","kind_detail","pier"]],paint:{"line-color":D.other,"line-dasharray":[3,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_link",type:"line",source:E,"source-layer":"roads",filter:["has","is_link"],paint:{"line-color":D.link,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_minor_service",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["==","kind_detail","service"]],paint:{"line-color":D.minor_service,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8]}},{id:"roads_minor",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["!=","kind_detail","service"]],paint:{"line-color":["interpolate",["exponential",1.6],["zoom"],11,D.minor_a,16,D.minor_b],"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_major_casing_early",type:"line",source:E,"source-layer":"roads",maxzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":D.major_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_major",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":D.major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_highway_casing_early",type:"line",source:E,"source-layer":"roads",maxzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":D.highway_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_highway",type:"line",source:E,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":D.highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"roads_rail",type:"line",source:E,"source-layer":"roads",filter:["==","kind","rail"],paint:{"line-dasharray":[.3,.75],"line-opacity":.5,"line-color":D.railway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,.15,18,9]}},{id:"boundaries_country",type:"line",source:E,"source-layer":"boundaries",filter:["<=","kind_detail",2],paint:{"line-color":D.boundaries,"line-width":.7,"line-dasharray":["step",["zoom"],["literal",[2]],4,["literal",[2,1]]]}},{id:"boundaries",type:"line",source:E,"source-layer":"boundaries",filter:[">","kind_detail",2],paint:{"line-color":D.boundaries,"line-width":.4,"line-dasharray":["step",["zoom"],["literal",[2]],4,["literal",[2,1]]]}},{id:"roads_bridges_other_casing",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["in","kind","other","path"]],paint:{"line-color":D.bridges_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_link_casing",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["has","is_link"]],paint:{"line-color":D.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1.5]}},{id:"roads_bridges_minor_casing",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","minor_road"]],paint:{"line-color":D.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_bridges_major_casing",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":D.bridges_major_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,10],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1.5]}},{id:"roads_bridges_other",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["in","kind","other","path"]],paint:{"line-color":D.bridges_other,"line-dasharray":[2,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_minor",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","minor_road"]],paint:{"line-color":D.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_bridges_link",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["has","is_link"]],paint:{"line-color":D.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_bridges_major",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":D.bridges_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_bridges_highway_casing",type:"line",source:E,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":D.bridges_highway_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_bridges_highway",type:"line",source:E,"source-layer":"roads",filter:["all",["has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":D.bridges_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}}]}ac(Bg,"nolabels_layers");function Og(E,D,O,R){return[{id:"address_label",type:"symbol",source:E,"source-layer":"buildings",minzoom:18,filter:["==","kind","address"],layout:{"symbol-placement":"point","text-font":[D.italic||"Noto Sans Italic"],"text-field":["get","addr_housenumber"],"text-size":12},paint:{"text-color":D.address_label,"text-halo-color":D.address_label_halo,"text-halo-width":1}},{id:"water_waterway_label",type:"symbol",source:E,"source-layer":"water",minzoom:13,filter:["in","kind","river","stream"],layout:{"symbol-placement":"line","text-font":[D.italic||"Noto Sans Italic"],"text-field":ol(O,R,D.regular),"text-size":12,"text-letter-spacing":.2},paint:{"text-color":D.ocean_label,"text-halo-color":D.water,"text-halo-width":1}},{id:"roads_labels_minor",type:"symbol",source:E,"source-layer":"roads",minzoom:15,filter:["in","kind","minor_road","other","path"],layout:{"symbol-sort-key":["get","min_zoom"],"symbol-placement":"line","text-font":[D.regular||"Noto Sans Regular"],"text-field":ol(O,R,D.regular),"text-size":12},paint:{"text-color":D.roads_label_minor,"text-halo-color":D.roads_label_minor_halo,"text-halo-width":1}},{id:"water_label_ocean",type:"symbol",source:E,"source-layer":"water",filter:["in","kind","sea","ocean","bay","strait","fjord"],layout:{"text-font":[D.italic||"Noto Sans Italic"],"text-field":ol(O,R,D.regular),"text-size":["interpolate",["linear"],["zoom"],3,10,10,12],"text-letter-spacing":.1,"text-max-width":9,"text-transform":"uppercase"},paint:{"text-color":D.ocean_label,"text-halo-width":1,"text-halo-color":D.water}},{id:"earth_label_islands",type:"symbol",source:E,"source-layer":"earth",filter:["in","kind","island"],layout:{"text-font":[D.italic||"Noto Sans Italic"],"text-field":ol(O,R,D.regular),"text-size":10,"text-letter-spacing":.1,"text-max-width":8},paint:{"text-color":D.subplace_label,"text-halo-color":D.subplace_label_halo,"text-halo-width":1}},{id:"water_label_lakes",type:"symbol",source:E,"source-layer":"water",filter:["in","kind","lake","water"],layout:{"text-font":[D.italic||"Noto Sans Italic"],"text-field":ol(O,R,D.regular),"text-size":["interpolate",["linear"],["zoom"],3,10,6,12,10,12],"text-letter-spacing":.1,"text-max-width":9},paint:{"text-color":D.ocean_label,"text-halo-color":D.water,"text-halo-width":1}},{id:"roads_labels_major",type:"symbol",source:E,"source-layer":"roads",minzoom:11,filter:["in","kind","highway","major_road"],layout:{"symbol-sort-key":["get","min_zoom"],"symbol-placement":"line","text-font":[D.regular||"Noto Sans Regular"],"text-field":ol(O,R,D.regular),"text-size":12},paint:{"text-color":D.roads_label_major,"text-halo-color":D.roads_label_major_halo,"text-halo-width":1}},...D.pois?[{id:"pois",type:"symbol",source:E,"source-layer":"pois",filter:["all",["in",["get","kind"],["literal",["beach","forest","marina","park","peak","zoo","garden","bench","aerodrome","station","bus_stop","ferry_terminal","stadium","university","library","school","animal","toilets","drinking_water"]]],[">=",["zoom"],["+",["get","min_zoom"],0]]],layout:{"icon-image":["match",["get","kind"],"station","train_station",["get","kind"]],"text-font":[D.regular||"Noto Sans Regular"],"text-justify":"auto","text-field":ol(O,R,D.regular),"text-size":["interpolate",["linear"],["zoom"],17,10,19,16],"text-max-width":8,"text-offset":[1.1,0],"text-variable-anchor":["left","right"]},paint:{"text-color":["case",["in",["get","kind"],["literal",["beach","forest","marina","park","peak","zoo","garden","bench"]]],D.pois.green,["in",["get","kind"],["literal",["aerodrome","station","bus_stop","ferry_terminal"]]],D.pois.lapis,["in",["get","kind"],["literal",["stadium","university","library","school","animal","toilets","drinking_water"]]],D.pois.slategray,D.earth],"text-halo-color":D.earth,"text-halo-width":1}}]:[],{id:"places_subplace",type:"symbol",source:E,"source-layer":"places",filter:["==","kind","neighbourhood"],layout:{"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-field":ol(O,R,D.regular),"text-font":[D.regular||"Noto Sans Regular"],"text-max-width":7,"text-letter-spacing":.1,"text-padding":["interpolate",["linear"],["zoom"],5,2,8,4,12,18,15,20],"text-size":["interpolate",["exponential",1.2],["zoom"],11,8,14,14,18,24],"text-transform":"uppercase"},paint:{"text-color":D.subplace_label,"text-halo-color":D.subplace_label_halo,"text-halo-width":1}},{id:"places_region",type:"symbol",source:E,"source-layer":"places",filter:["==","kind","region"],layout:{"symbol-sort-key":["get","sort_key"],"text-field":["step",["zoom"],["coalesce",["get","ref:en"],["get","ref"]],6,ol(O,R,D.regular)],"text-font":[D.regular||"Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],3,11,7,16],"text-radial-offset":.2,"text-anchor":"center","text-transform":"uppercase"},paint:{"text-color":D.state_label,"text-halo-color":D.state_label_halo,"text-halo-width":1}},{id:"places_locality",type:"symbol",source:E,"source-layer":"places",filter:["==","kind","locality"],layout:{"icon-image":["step",["zoom"],"townspot",8,""],"icon-size":.7,"text-field":ol(O,R,D.regular),"text-font":["case",["<=",["get","min_zoom"],5],["literal",[D.bold||"Noto Sans Medium"]],["literal",[D.regular||"Noto Sans Regular"]]],"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-padding":["interpolate",["linear"],["zoom"],5,3,8,7,12,11],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","population_rank"],13],8,[">=",["get","population_rank"],13],13,0],4,["case",["<",["get","population_rank"],13],10,[">=",["get","population_rank"],13],15,0],6,["case",["<",["get","population_rank"],12],11,[">=",["get","population_rank"],12],17,0],8,["case",["<",["get","population_rank"],11],11,[">=",["get","population_rank"],11],18,0],10,["case",["<",["get","population_rank"],9],12,[">=",["get","population_rank"],9],20,0],15,["case",["<",["get","population_rank"],8],12,[">=",["get","population_rank"],8],22,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,0,8,4,10,8,12,6,22,2],"text-justify":"auto","text-variable-anchor":["step",["zoom"],["literal",["bottom","left","right","top"]],8,["literal",["center"]]],"text-radial-offset":.3},paint:{"text-color":D.city_label,"text-halo-color":D.city_label_halo,"text-halo-width":1}},{id:"places_country",type:"symbol",source:E,"source-layer":"places",filter:["==","kind","country"],layout:{"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-field":Lg(O,R),"text-font":[D.bold||"Noto Sans Medium"],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","population_rank"],10],8,[">=",["get","population_rank"],10],12,0],6,["case",["<",["get","population_rank"],8],10,[">=",["get","population_rank"],8],18,0],8,["case",["<",["get","population_rank"],7],11,[">=",["get","population_rank"],7],20,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,2,14,2,16,20,17,2,22,2],"text-transform":"uppercase"},paint:{"text-color":D.country_label,"text-halo-color":D.earth,"text-halo-width":1}}]}ac(Og,"labels_layers");var uv={background:"#cccccc",earth:"#e2dfda",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#728dd4",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3",address_label:"#91888b",address_label_halo:"#ffffff",pois:{blue:"#1A8CBD",green:"#20834D",lapis:"#315BCF",pink:"#EF56BA",red:"#F2567A",slategray:"#6A5B8F",tangerine:"#CB6704",turquoise:"#00C3D4"},landcover:{grassland:"rgba(210, 239, 207, 1)",barren:"rgba(255, 243, 215, 1)",urban_area:"rgba(230, 230, 230, 1)",farmland:"rgba(216, 239, 210, 1)",glacier:"rgba(255, 255, 255, 1)",scrub:"rgba(234, 239, 210, 1)",forest:"rgba(196, 231, 210, 1)"}},hv={background:"#34373d",earth:"#1f1f1f",park_a:"#1c2421",park_b:"#192a24",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#31353f",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c",address_label:"#525252",address_label_halo:"#1f1f1f",pois:{blue:"#4299BB",green:"#30C573",lapis:"#2B5CEA",pink:"#EF56BA",red:"#F2567A",slategray:"#93939F",tangerine:"#F19B6E",turquoise:"#00C3D4"},landcover:{grassland:"rgba(30, 41, 31, 1)",barren:"rgba(38, 38, 36, 1)",urban_area:"rgba(28, 28, 28, 1)",farmland:"rgba(31, 36, 32, 1)",glacier:"rgba(43, 43, 43, 1)",scrub:"rgba(34, 36, 30, 1)",forest:"rgba(28, 41, 37, 1)"}},dv={background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8",address_label:"#adadad",address_label_halo:"#ffffff"},fv={background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585",address_label:"#999999",address_label_halo:"#e0e0e0"},pv={background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070",address_label:"#525252",address_label_halo:"#141414"};function Fg(E){switch(E){case"light":return uv;case"dark":return hv;case"white":return dv;case"grayscale":return fv;case"black":return pv}throw new Error("Flavor not found")}ac(Fg,"namedFlavor");function jg(E,D,O){let R=[];return O!=null&&O.labelsOnly||(R=Bg(E,D)),O!=null&&O.lang&&(R=R.concat(Og(E,D,O.lang))),R}ac(jg,"layers");function mv(){const E=st.useRef(null);return st.useEffect(()=>{if(!E.current)return;const D=new Wy;Km.addProtocol("pmtiles",D.tile);const O=new Km.Map({container:E.current,center:[-78.7224957,35.7836484],zoom:12,style:{version:8,glyphs:"https://protomaps.github.io/basemaps-assets/fonts/{fontstack}/{range}.pbf",sprite:"https://protomaps.github.io/basemaps-assets/sprites/v4/light",sources:{protomaps:{type:"vector",url:"pmtiles://https://demo-bucket.protomaps.com/v4.pmtiles",attribution:'<a href="https://protomaps.com">Protomaps</a>  <a href="https://openstreetmap.org">OpenStreetMap</a>'}},layers:jg("protomaps",Fg("light"),{lang:"en"})}});return O.on("load",async()=>{try{const R=await fetch("src/coords.json");console.log(R);const H=await R.json(),ae={type:"FeatureCollection",features:H.map(({ratingId:ge,lat:re,lng:Ce})=>({type:"Feature",geometry:{type:"Point",coordinates:[Ce,re]},properties:{title:ge}}))};O.addSource("marker-source",{type:"geojson",data:ae}),O.addLayer({id:"marker-layer",type:"circle",source:"marker-source",paint:{"circle-radius":8,"circle-color":"#FF5722","circle-stroke-width":2,"circle-stroke-color":"#ffffff"}});const P=H.map(ge=>ge.lat),d=H.map(ge=>ge.lng);if(P.length&&d.length){const ge=[[Math.min(...d),Math.min(...P)],[Math.max(...d),Math.max(...P)]]}}catch(R){console.error("Error loading coords.json:",R)}}),()=>O.remove()},[]),Yi.jsx("div",{ref:E,className:"bodyMap"})}Yg.createRoot(document.getElementById("root")).render(Yi.jsx(st.StrictMode,{children:Yi.jsx(hy,{children:Yi.jsxs(U_,{children:[Yi.jsx(gm,{path:"/",element:Yi.jsxs("div",{className:"app-list",children:[Yi.jsx("h1",{children:"Napkin Ratings"}),Yi.jsx(Ey,{data:by})]})}),Yi.jsx(gm,{path:"/map",element:Yi.jsx(mv,{})})]})})}));
